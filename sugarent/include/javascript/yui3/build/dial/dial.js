/*
     YUI 3.15.0 (build 834026e)
     Copyright 2014 Yahoo! Inc. All rights reserved.
     Licensed under the BSD License.
     http://yuilibrary.com/license/
     */
YUI.add('dial',function(Y,NAME){var supportsVML=false;if(Y.UA.ie&&Y.UA.ie<9){supportsVML=true;}
var Lang=Y.Lang,Widget=Y.Widget,Node=Y.Node;function Dial(config){Dial.superclass.constructor.apply(this,arguments);}
Dial.NAME="dial";Dial.ATTRS={min:{value:-220},max:{value:220},diameter:{value:100},handleDiameter:{value:0.2},markerDiameter:{value:0.1},centerButtonDiameter:{value:0.5},value:{value:0,validator:function(val){return this._validateValue(val);}},minorStep:{value:1},majorStep:{value:10},stepsPerRevolution:{value:100},decimalPlaces:{value:0},strings:{valueFn:function(){return Y.Intl.get('dial');}},handleDistance:{value:0.75}};function makeClassName(str){return Y.ClassNameManager.getClassName(Dial.NAME,str);}
Dial.CSS_CLASSES={label:makeClassName("label"),labelString:makeClassName("label-string"),valueString:makeClassName("value-string"),northMark:makeClassName("north-mark"),ring:makeClassName('ring'),ringVml:makeClassName('ring-vml'),marker:makeClassName("marker"),markerVml:makeClassName("marker-vml"),markerMaxMin:makeClassName("marker-max-min"),centerButton:makeClassName("center-button"),centerButtonVml:makeClassName('center-button-vml'),resetString:makeClassName("reset-string"),handle:makeClassName("handle"),handleVml:makeClassName("handle-vml"),hidden:makeClassName("hidden"),dragging:Y.ClassNameManager.getClassName("dd-dragging")};Dial.LABEL_TEMPLATE='<div class="'+Dial.CSS_CLASSES.label+'"><span id="" class="'+Dial.CSS_CLASSES.labelString+'">{label}</span><span class="'+Dial.CSS_CLASSES.valueString+'"></span></div>';if(supportsVML===false){Dial.RING_TEMPLATE='<div class="'+Dial.CSS_CLASSES.ring+'"><div class="'+Dial.CSS_CLASSES.northMark+'"></div></div>';Dial.MARKER_TEMPLATE='<div class="'+Dial.CSS_CLASSES.marker+' '+Dial.CSS_CLASSES.hidden+'"></div>';Dial.CENTER_BUTTON_TEMPLATE='<div class="'+Dial.CSS_CLASSES.centerButton+'"><div class="'+Dial.CSS_CLASSES.resetString+' '+Dial.CSS_CLASSES.hidden+'">{resetStr}</div></div>';Dial.HANDLE_TEMPLATE='<div class="'+Dial.CSS_CLASSES.handle+'" aria-labelledby="" aria-valuetext="" aria-valuemax="" aria-valuemin="" aria-valuenow="" role="slider"  tabindex="0" title="{tooltipHandle}">';}else{Dial.RING_TEMPLATE='<div class="'+Dial.CSS_CLASSES.ring+' '+Dial.CSS_CLASSES.ringVml+'">'+'<div class="'+Dial.CSS_CLASSES.northMark+'"></div>'+'<v:oval strokecolor="#ceccc0" strokeweight="1px"><v:fill type=gradient color="#8B8A7F" color2="#EDEDEB" angle="45"/></v:oval>'+'</div>'+'';Dial.MARKER_TEMPLATE='<div class="'+Dial.CSS_CLASSES.markerVml+' '+Dial.CSS_CLASSES.hidden+'">'+'<v:oval stroked="false">'+'<v:fill opacity="20%" color="#000"/>'+'</v:oval>'+'</div>'+'';Dial.CENTER_BUTTON_TEMPLATE='<div class="'+Dial.CSS_CLASSES.centerButton+' '+Dial.CSS_CLASSES.centerButtonVml+'">'+'<v:oval strokecolor="#ceccc0" strokeweight="1px">'+'<v:fill type=gradient color="#C7C5B9" color2="#fefcf6" colors="35% #d9d7cb, 65% #fefcf6" angle="45"/>'+'<v:shadow on="True" color="#000" opacity="10%" offset="2px, 2px"/>'+'</v:oval>'+'<div class="'+Dial.CSS_CLASSES.resetString+' '+Dial.CSS_CLASSES.hidden+'">{resetStr}</div>'+'</div>'+'';Dial.HANDLE_TEMPLATE='<div class="'+Dial.CSS_CLASSES.handleVml+'" aria-labelledby="" aria-valuetext="" aria-valuemax="" aria-valuemin="" aria-valuenow="" role="slider"  tabindex="0" title="{tooltipHandle}">'+'<v:oval stroked="false">'+'<v:fill opacity="20%" color="#6C3A3A"/>'+'</v:oval>'+'</div>'+'';}
Y.extend(Dial,Widget,{renderUI:function(){this._renderLabel();this._renderRing();this._renderMarker();this._renderCenterButton();this._renderHandle();this.contentBox=this.get("contentBox");this._originalValue=this.get('value');this._minValue=this.get('min');this._maxValue=this.get('max');this._stepsPerRevolution=this.get('stepsPerRevolution');this._minTimesWrapped=(Math.floor(this._minValue / this._stepsPerRevolution-1));this._maxTimesWrapped=(Math.floor(this._maxValue / this._stepsPerRevolution+1));this._timesWrapped=0;this._angle=this._getAngleFromValue(this.get('value'));this._prevAng=this._angle;this._setTimesWrappedFromValue(this._originalValue);this._handleNode.set('aria-valuemin',this._minValue);this._handleNode.set('aria-valuemax',this._maxValue);},_setBorderRadius:function(){this._ringNode.setStyles({'WebkitBorderRadius':this._ringNodeRadius+'px','MozBorderRadius':this._ringNodeRadius+'px','borderRadius':this._ringNodeRadius+'px'});this._handleNode.setStyles({'WebkitBorderRadius':this._handleNodeRadius+'px','MozBorderRadius':this._handleNodeRadius+'px','borderRadius':this._handleNodeRadius+'px'});this._markerNode.setStyles({'WebkitBorderRadius':this._markerNodeRadius+'px','MozBorderRadius':this._markerNodeRadius+'px','borderRadius':this._markerNodeRadius+'px'});this._centerButtonNode.setStyles({'WebkitBorderRadius':this._centerButtonNodeRadius+'px','MozBorderRadius':this._centerButtonNodeRadius+'px','borderRadius':this._centerButtonNodeRadius+'px'});},_handleCenterButtonEnter:function(){this._resetString.removeClass(Dial.CSS_CLASSES.hidden);},_handleCenterButtonLeave:function(){this._resetString.addClass(Dial.CSS_CLASSES.hidden);},bindUI:function(){this.after("valueChange",this._afterValueChange);var boundingBox=this.get("boundingBox"),keyEvent=(!Y.UA.opera)?"down:":"press:",keyEventSpec=keyEvent+"38,40,33,34,35,36",keyLeftRightSpec=keyEvent+"37,39",keyLeftRightSpecMeta=keyEvent+"37+meta,39+meta",Drag=Y.DD.Drag;Y.on("key",Y.bind(this._onDirectionKey,this),boundingBox,keyEventSpec);Y.on("key",Y.bind(this._onLeftRightKey,this),boundingBox,keyLeftRightSpec);boundingBox.on("key",this._onLeftRightKeyMeta,keyLeftRightSpecMeta,this);Y.on('mouseenter',Y.bind(this._handleCenterButtonEnter,this),this._centerButtonNode);Y.on('mouseleave',Y.bind(this._handleCenterButtonLeave,this),this._centerButtonNode);Y.on('gesturemovestart',Y.bind(this._resetDial,this),this._centerButtonNode);Y.on('gesturemoveend',Y.bind(this._handleCenterButtonMouseup,this),this._centerButtonNode);Y.on(Drag.START_EVENT,Y.bind(this._handleHandleMousedown,this),this._handleNode);Y.on(Drag.START_EVENT,Y.bind(this._handleMousedown,this),this._ringNode);Y.on('gesturemoveend',Y.bind(this._handleRingMouseup,this),this._ringNode);this._dd1=new Drag({node:this._handleNode,on:{'drag:drag':Y.bind(this._handleDrag,this),'drag:start':Y.bind(this._handleDragStart,this),'drag:end':Y.bind(this._handleDragEnd,this)}});Y.bind(this._dd1.addHandle(this._ringNode),this);},_setTimesWrappedFromValue:function(val){if(val%this._stepsPerRevolution===0){this._timesWrapped=(val / this._stepsPerRevolution);}else{this._timesWrapped=Math.floor(val / this._stepsPerRevolution);}},_getAngleFromHandleCenter:function(handleCenterX,handleCenterY){var ang=Math.atan((this._dialCenterY-handleCenterY)/(this._dialCenterX-handleCenterX))*(180 / Math.PI);ang=((this._dialCenterX-handleCenterX)<0)?ang+90:ang+90+180;return ang;},_calculateDialCenter:function(){this._dialCenterX=this._ringNode.get('offsetWidth')/ 2;this._dialCenterY=this._ringNode.get('offsetHeight')/ 2;},_handleRingMouseup:function(){this._handleNode.focus();},_handleCenterButtonMouseup:function(){this._handleNode.focus();},_handleHandleMousedown:function(){this._handleNode.focus();},_handleDrag:function(e){var handleCenterX,handleCenterY,ang,newValue;handleCenterX=(parseInt(this._handleNode.getStyle('left'),10)+this._handleNodeRadius);handleCenterY=(parseInt(this._handleNode.getStyle('top'),10)+this._handleNodeRadius);ang=this._getAngleFromHandleCenter(handleCenterX,handleCenterY);if((this._prevAng>270)&&(ang<90)){if(this._timesWrapped<this._maxTimesWrapped){this._timesWrapped=(this._timesWrapped+1);}}else if((this._prevAng<90)&&(ang>270)){if(this._timesWrapped>this._minTimesWrapped){this._timesWrapped=(this._timesWrapped-1);}}
newValue=this._getValueFromAngle(ang);if(newValue>(this._maxValue+this._stepsPerRevolution)){this._timesWrapped--;}else if(newValue<(this._minValue-this._stepsPerRevolution)){this._timesWrapped++;}
this._prevAng=ang;this._handleValuesBeyondMinMax(e,newValue);},_handleMousedown:function(e){if(this._ringNode.compareTo(e.target)){var minAng=this._getAngleFromValue(this._minValue),maxAng=this._getAngleFromValue(this._maxValue),newValue,oppositeMidRangeAngle,handleCenterX,handleCenterY,ang;if(Y.UA.ios){handleCenterX=(e.clientX-this._ringNode.getX());handleCenterY=(e.clientY-this._ringNode.getY());}else{handleCenterX=(e.clientX+Y.one('document').get('scrollLeft')-this._ringNode.getX());handleCenterY=(e.clientY+Y.one('document').get('scrollTop')-this._ringNode.getY());}
ang=this._getAngleFromHandleCenter(handleCenterX,handleCenterY);if(this._maxValue-this._minValue>this._stepsPerRevolution){if(Math.abs(this._prevAng-ang)>180){if((this._timesWrapped>this._minTimesWrapped)&&(this._timesWrapped<this._maxTimesWrapped)){this._timesWrapped=((this._prevAng-ang)>0)?(this._timesWrapped+1):(this._timesWrapped-1);}}else if((this._timesWrapped===this._minTimesWrapped)&&(ang-this._prevAng<180)){this._timesWrapped++;}}
else if(this._maxValue-this._minValue===this._stepsPerRevolution){if(ang<minAng){this._timesWrapped=1;}else{this._timesWrapped=0;}}
else if(minAng>maxAng){if((this._prevAng>=minAng)&&(ang<=(minAng+maxAng)/ 2)){this._timesWrapped++;}else if((this._prevAng<=maxAng)&&(ang>(minAng+maxAng)/ 2)){this._timesWrapped--;}}
else{if((ang<minAng)||(ang>maxAng)){oppositeMidRangeAngle=(((minAng+maxAng)/ 2)+180)%360;if(oppositeMidRangeAngle>180){newValue=((maxAng<ang)&&(ang<oppositeMidRangeAngle))?this.get('max'):this.get('min');}else{newValue=((minAng>ang)&&(ang>oppositeMidRangeAngle))?this.get('min'):this.get('max');}
this._prevAng=this._getAngleFromValue(newValue);this.set('value',newValue);this._setTimesWrappedFromValue(newValue);return;}}
newValue=this._getValueFromAngle(ang);if(newValue>this._maxValue){this._prevAng=this._getAngleFromValue(this._maxValue);}else if(newValue<this._minValue){this._prevAng=this._getAngleFromValue(this._minValue);}else{this._prevAng=ang;}
this._handleValuesBeyondMinMax(e,newValue);}},_handleValuesBeyondMinMax:function(e,newValue){if((newValue>=this._minValue)&&(newValue<=this._maxValue)){this.set('value',newValue);if(e.currentTarget===this._ringNode){this._dd1._handleMouseDownEvent(e);}}else if(newValue>this._maxValue){this.set('value',this._maxValue);}else if(newValue<this._minValue){this.set('value',this._minValue);}},_handleDragStart:function(e){this._markerNode.removeClass(Dial.CSS_CLASSES.hidden);},_handleDragEnd:function(){var node=this._handleNode;node.transition({duration:0.08,easing:'ease-in',left:this._setNodeToFixedRadius(this._handleNode,true)[0]+'px',top:this._setNodeToFixedRadius(this._handleNode,true)[1]+'px'},Y.bind(function(){var value=this.get('value');if((value>this._minValue)&&(value<this._maxValue)){this._markerNode.addClass(Dial.CSS_CLASSES.hidden);}else{this._setTimesWrappedFromValue(value);this._prevAng=this._getAngleFromValue(value);}},this));},_setNodeToFixedRadius:function(obj,typeArray){var thisAngle=(this._angle-90),rad=(Math.PI / 180),newY=Math.round(Math.sin(thisAngle*rad)*this._handleDistance),newX=Math.round(Math.cos(thisAngle*rad)*this._handleDistance),dia=obj.get('offsetWidth');newY=newY-(dia*0.5);newX=newX-(dia*0.5);if(typeArray){return[(this._ringNodeRadius+newX),(this._ringNodeRadius+newY)];}else{obj.setStyle('left',(this._ringNodeRadius+newX)+'px');obj.setStyle('top',(this._ringNodeRadius+newY)+'px');}},syncUI:function(){this._setSizes();this._calculateDialCenter();this._setBorderRadius();this._uiSetValue(this.get("value"));this._markerNode.addClass(Dial.CSS_CLASSES.hidden);this._resetString.addClass(Dial.CSS_CLASSES.hidden);},_setSizes:function(){var dia=this.get('diameter'),offset,offsetResetX,offsetResetY,setSize=function(node,dia,percent){var suffix='px';node.getElementsByTagName('oval').setStyle('width',(dia*percent)+suffix);node.getElementsByTagName('oval').setStyle('height',(dia*percent)+suffix);node.setStyle('width',(dia*percent)+suffix);node.setStyle('height',(dia*percent)+suffix);};setSize(this._ringNode,dia,1.0);setSize(this._handleNode,dia,this.get('handleDiameter'));setSize(this._markerNode,dia,this.get('markerDiameter'));setSize(this._centerButtonNode,dia,this.get('centerButtonDiameter'));this._ringNodeRadius=this._ringNode.get('offsetWidth')*0.5;this._handleNodeRadius=this._handleNode.get('offsetWidth')*0.5;this._markerNodeRadius=this._markerNode.get('offsetWidth')*0.5;this._centerButtonNodeRadius=this._centerButtonNode.get('offsetWidth')*0.5;this._handleDistance=this._ringNodeRadius*this.get('handleDistance');offset=(this._ringNodeRadius-this._centerButtonNodeRadius);this._centerButtonNode.setStyle('left',offset+'px');this._centerButtonNode.setStyle('top',offset+'px');offsetResetX=(this._centerButtonNodeRadius-(this._resetString.get('offsetWidth')*0.5));offsetResetY=(this._centerButtonNodeRadius-(this._resetString.get('offsetHeight')*0.5));this._resetString.setStyles({'left':offsetResetX+'px','top':offsetResetY+'px'});},_renderLabel:function(){var contentBox=this.get("contentBox"),label=contentBox.one("."+Dial.CSS_CLASSES.label);if(!label){label=Node.create(Y.Lang.sub(Dial.LABEL_TEMPLATE,this.get('strings')));contentBox.append(label);}
this._labelNode=label;this._valueStringNode=this._labelNode.one("."+Dial.CSS_CLASSES.valueString);},_renderRing:function(){var contentBox=this.get("contentBox"),ring=contentBox.one("."+Dial.CSS_CLASSES.ring);if(!ring){ring=contentBox.appendChild(Dial.RING_TEMPLATE);ring.setStyles({width:this.get('diameter')+'px',height:this.get('diameter')+'px'});}
this._ringNode=ring;},_renderMarker:function(){var contentBox=this.get("contentBox"),marker=contentBox.one("."+Dial.CSS_CLASSES.marker);if(!marker){marker=contentBox.one('.'+Dial.CSS_CLASSES.ring).appendChild(Dial.MARKER_TEMPLATE);}
this._markerNode=marker;},_renderCenterButton:function(){var contentBox=this.get("contentBox"),centerButton=contentBox.one("."+Dial.CSS_CLASSES.centerButton);if(!centerButton){centerButton=Node.create(Y.Lang.sub(Dial.CENTER_BUTTON_TEMPLATE,this.get('strings')));contentBox.one('.'+Dial.CSS_CLASSES.ring).append(centerButton);}
this._centerButtonNode=centerButton;this._resetString=this._centerButtonNode.one('.'+Dial.CSS_CLASSES.resetString);},_renderHandle:function(){var labelId=Dial.CSS_CLASSES.label+Y.guid(),contentBox=this.get("contentBox"),handle=contentBox.one("."+Dial.CSS_CLASSES.handle);if(!handle){handle=Node.create(Y.Lang.sub(Dial.HANDLE_TEMPLATE,this.get('strings')));handle.setAttribute('aria-labelledby',labelId);this._labelNode.one('.'+Dial.CSS_CLASSES.labelString).setAttribute('id',labelId);contentBox.one('.'+Dial.CSS_CLASSES.ring).append(handle);}
this._handleNode=handle;},_setLabelString:function(str){this.get("contentBox").one("."+Dial.CSS_CLASSES.labelString).setHTML(str);},_setResetString:function(str){this.get("contentBox").one("."+Dial.CSS_CLASSES.resetString).setHTML(str);},_setTooltipString:function(str){this._handleNode.set('title',str);},_onDirectionKey:function(e){e.preventDefault();switch(e.charCode){case 38:this._incrMinor();break;case 40:this._decrMinor();break;case 36:this._setToMin();break;case 35:this._setToMax();break;case 33:this._incrMajor();break;case 34:this._decrMajor();break;}},_onLeftRightKey:function(e){e.preventDefault();switch(e.charCode){case 37:this._decrMinor();break;case 39:this._incrMinor();break;}},_onLeftRightKeyMeta:function(e){e.preventDefault();switch(e.charCode){case 37:this._setToMin();break;case 39:this._setToMax();break;}},_incrMinor:function(){var newVal=(this.get('value')+this.get("minorStep"));newVal=Math.min(newVal,this.get("max"));this.set('value',newVal.toFixed(this.get('decimalPlaces'))-0);},_decrMinor:function(){var newVal=(this.get('value')-this.get("minorStep"));newVal=Math.max(newVal,this.get("min"));this.set('value',newVal.toFixed(this.get('decimalPlaces'))-0);},_incrMajor:function(){var newVal=(this.get('value')+this.get("majorStep"));newVal=Math.min(newVal,this.get("max"));this.set('value',newVal.toFixed(this.get('decimalPlaces'))-0);},_decrMajor:function(){var newVal=(this.get('value')-this.get("majorStep"));newVal=Math.max(newVal,this.get("min"));this.set('value',newVal.toFixed(this.get('decimalPlaces'))-0);},_setToMax:function(){this.set('value',this.get("max"));},_setToMin:function(){this.set('value',this.get("min"));},_resetDial:function(e){if(e){e.stopPropagation();}
this.set('value',this._originalValue);this._resetString.addClass(Dial.CSS_CLASSES.hidden);this._handleNode.focus();},_getAngleFromValue:function(newVal){var nonWrappedPartOfValue=newVal%this._stepsPerRevolution,angleFromValue=nonWrappedPartOfValue / this._stepsPerRevolution*360;return(angleFromValue<0)?(angleFromValue+360):angleFromValue;},_getValueFromAngle:function(angle){if(angle<0){angle=(360+angle);}else if(angle===0){angle=360;}
var value=(angle / 360)*this._stepsPerRevolution;value=(value+(this._timesWrapped*this._stepsPerRevolution));return value.toFixed(this.get('decimalPlaces'))-0;},_afterValueChange:function(e){this._uiSetValue(e.newVal);},_valueToDecimalPlaces:function(val){},_uiSetValue:function(val){this._angle=this._getAngleFromValue(val);if(this._handleNode.hasClass(Dial.CSS_CLASSES.dragging)===false){this._setTimesWrappedFromValue(val);this._setNodeToFixedRadius(this._handleNode,false);this._prevAng=this._getAngleFromValue(this.get('value'));}
this._valueStringNode.setHTML(val.toFixed(this.get('decimalPlaces')));this._handleNode.set('aria-valuenow',val);this._handleNode.set('aria-valuetext',val);this._setNodeToFixedRadius(this._markerNode,false);if((val===this._maxValue)||(val===this._minValue)){this._markerNode.addClass(Dial.CSS_CLASSES.markerMaxMin);if(supportsVML===true){this._markerNode.getElementsByTagName('fill').set('color','#AB3232');}
this._markerNode.removeClass(Dial.CSS_CLASSES.hidden);}else{if(supportsVML===true){this._markerNode.getElementsByTagName('fill').set('color','#000');}
this._markerNode.removeClass(Dial.CSS_CLASSES.markerMaxMin);if(this._handleNode.hasClass(Dial.CSS_CLASSES.dragging)===false){this._markerNode.addClass(Dial.CSS_CLASSES.hidden);}}},_validateValue:function(val){var min=this.get("min"),max=this.get("max");return(Lang.isNumber(val)&&val>=min&&val<=max);}});Y.Dial=Dial;},'3.15.0',{"requires":["widget","dd-drag","event-mouseenter","event-move","event-key","transition","intl"],"lang":["en","es","hu"],"skinnable":true});