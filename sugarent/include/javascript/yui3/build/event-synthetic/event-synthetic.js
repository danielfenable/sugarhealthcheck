/*
     YUI 3.15.0 (build 834026e)
     Copyright 2014 Yahoo! Inc. All rights reserved.
     Licensed under the BSD License.
     http://yuilibrary.com/license/
     */
YUI.add('event-synthetic',function(Y,NAME){var CustomEvent=Y.CustomEvent,DOMMap=Y.Env.evt.dom_map,toArray=Y.Array,YLang=Y.Lang,isObject=YLang.isObject,isString=YLang.isString,isArray=YLang.isArray,query=Y.Selector.query,noop=function(){};function Notifier(handle,emitFacade){this.handle=handle;this.emitFacade=emitFacade;}
Notifier.prototype.fire=function(e){var args=toArray(arguments,0,true),handle=this.handle,ce=handle.evt,sub=handle.sub,thisObj=sub.context,delegate=sub.filter,event=e||{},ret;if(this.emitFacade){if(!e||!e.preventDefault){event=ce._getFacade();if(isObject(e)&&!e.preventDefault){Y.mix(event,e,true);args[0]=event;}else{args.unshift(event);}}
event.type=ce.type;event.details=args.slice();if(delegate){event.container=ce.host;}}else if(delegate&&isObject(e)&&e.currentTarget){args.shift();}
sub.context=thisObj||event.currentTarget||ce.host;ret=ce.fire.apply(ce,args);if(e.prevented&&ce.preventedFn){ce.preventedFn.apply(ce,args);}
if(e.stopped&&ce.stoppedFn){ce.stoppedFn.apply(ce,args);}
sub.context=thisObj;return ret;};function SynthRegistry(el,yuid,key){this.handles=[];this.el=el;this.key=key;this.domkey=yuid;}
SynthRegistry.prototype={constructor:SynthRegistry,type:'_synth',fn:noop,capture:false,register:function(handle){handle.evt.registry=this;this.handles.push(handle);},unregister:function(sub){var handles=this.handles,events=DOMMap[this.domkey],i;for(i=handles.length-1;i>=0;--i){if(handles[i].sub===sub){handles.splice(i,1);break;}}
if(!handles.length){delete events[this.key];if(!Y.Object.size(events)){delete DOMMap[this.domkey];}}},detachAll:function(){var handles=this.handles,i=handles.length;while(--i>=0){handles[i].detach();}}};function SyntheticEvent(){this._init.apply(this,arguments);}
Y.mix(SyntheticEvent,{Notifier:Notifier,SynthRegistry:SynthRegistry,getRegistry:function(node,type,create){var el=node._node,yuid=Y.stamp(el),key='event:'+yuid+type+'_synth',events=DOMMap[yuid];if(create){if(!events){events=DOMMap[yuid]={};}
if(!events[key]){events[key]=new SynthRegistry(el,yuid,key);}}
return(events&&events[key])||null;},_deleteSub:function(sub){if(sub&&sub.fn){var synth=this.eventDef,method=(sub.filter)?'detachDelegate':'detach';this._subscribers=[];if(CustomEvent.keepDeprecatedSubs){this.subscribers={};}
synth[method](sub.node,sub,this.notifier,sub.filter);this.registry.unregister(sub);delete sub.fn;delete sub.node;delete sub.context;}},prototype:{constructor:SyntheticEvent,_init:function(){var config=this.publishConfig||(this.publishConfig={});this.emitFacade=('emitFacade'in config)?config.emitFacade:true;config.emitFacade=false;},processArgs:noop,on:noop,detach:noop,delegate:noop,detachDelegate:noop,_on:function(args,delegate){var handles=[],originalArgs=args.slice(),extra=this.processArgs(args,delegate),selector=args[2],method=delegate?'delegate':'on',nodes,handle;nodes=(isString(selector))?query(selector):toArray(selector||Y.one(Y.config.win));if(!nodes.length&&isString(selector)){handle=Y.on('available',function(){Y.mix(handle,Y[method].apply(Y,originalArgs),true);},selector);return handle;}
Y.Array.each(nodes,function(node){var subArgs=args.slice(),filter;node=Y.one(node);if(node){if(delegate){filter=subArgs.splice(3,1)[0];}
subArgs.splice(0,4,subArgs[1],subArgs[3]);if(!this.preventDups||!this.getSubs(node,args,null,true))
{handles.push(this._subscribe(node,method,subArgs,extra,filter));}}},this);return(handles.length===1)?handles[0]:new Y.EventHandle(handles);},_subscribe:function(node,method,args,extra,filter){var dispatcher=new Y.CustomEvent(this.type,this.publishConfig),handle=dispatcher.on.apply(dispatcher,args),notifier=new Notifier(handle,this.emitFacade),registry=SyntheticEvent.getRegistry(node,this.type,true),sub=handle.sub;sub.node=node;sub.filter=filter;if(extra){this.applyArgExtras(extra,sub);}
Y.mix(dispatcher,{eventDef:this,notifier:notifier,host:node,currentTarget:node,target:node,el:node._node,_delete:SyntheticEvent._deleteSub},true);handle.notifier=notifier;registry.register(handle);this[method](node,sub,notifier,filter);return handle;},applyArgExtras:function(extra,sub){sub._extra=extra;},_detach:function(args){var target=args[2],els=(isString(target))?query(target):toArray(target),node,i,len,handles,j;args.splice(2,1);for(i=0,len=els.length;i<len;++i){node=Y.one(els[i]);if(node){handles=this.getSubs(node,args);if(handles){for(j=handles.length-1;j>=0;--j){handles[j].detach();}}}}},getSubs:function(node,args,filter,first){var registry=SyntheticEvent.getRegistry(node,this.type),handles=[],allHandles,i,len,handle;if(registry){allHandles=registry.handles;if(!filter){filter=this.subMatch;}
for(i=0,len=allHandles.length;i<len;++i){handle=allHandles[i];if(filter.call(this,handle.sub,args)){if(first){return handle;}else{handles.push(allHandles[i]);}}}}
return handles.length&&handles;},subMatch:function(sub,args){return!args[1]||sub.fn===args[1];}}},true);Y.SyntheticEvent=SyntheticEvent;Y.Event.define=function(type,config,force){var eventDef,Impl,synth;if(type&&type.type){eventDef=type;force=config;}else if(config){eventDef=Y.merge({type:type},config);}
if(eventDef){if(force||!Y.Node.DOM_EVENTS[eventDef.type]){Impl=function(){SyntheticEvent.apply(this,arguments);};Y.extend(Impl,SyntheticEvent,eventDef);synth=new Impl();type=synth.type;Y.Node.DOM_EVENTS[type]=Y.Env.evt.plugins[type]={eventDef:synth,on:function(){return synth._on(toArray(arguments));},delegate:function(){return synth._on(toArray(arguments),true);},detach:function(){return synth._detach(toArray(arguments));}};}}else if(isString(type)||isArray(type)){Y.Array.each(toArray(type),function(t){Y.Node.DOM_EVENTS[t]=1;});}
return synth;};},'3.15.0',{"requires":["node-base","event-custom-complex"]});