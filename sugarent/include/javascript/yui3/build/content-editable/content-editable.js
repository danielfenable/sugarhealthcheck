/*
     YUI 3.15.0 (build 834026e)
     Copyright 2014 Yahoo! Inc. All rights reserved.
     Licensed under the BSD License.
     http://yuilibrary.com/license/
     */
YUI.add('content-editable',function(Y,NAME){var Lang=Y.Lang,YNode=Y.Node,EVENT_CONTENT_READY='contentready',EVENT_READY='ready',TAG_PARAGRAPH='p',BLUR='blur',CONTAINER='container',CONTENT_EDITABLE='contentEditable',EMPTY='',FOCUS='focus',HOST='host',INNER_HTML='innerHTML',KEY='key',PARENT_NODE='parentNode',PASTE='paste',TEXT='Text',USE='use',ContentEditable=function(){ContentEditable.superclass.constructor.apply(this,arguments);};Y.extend(ContentEditable,Y.Plugin.Base,{_rendered:null,_instance:null,initializer:function(){var host=this.get(HOST);if(host){host.frame=this;}
this._eventHandles=[];this.publish(EVENT_READY,{emitFacade:true,defaultFn:this._defReadyFn});},destructor:function(){new Y.EventHandle(this._eventHandles).detach();this._container.removeAttribute(CONTENT_EDITABLE);},_onDomEvent:function(e){var xy;e.frameX=e.frameY=0;if(e.pageX>0||e.pageY>0){if(e.type.substring(0,3)!==KEY){xy=this._container.getXY();e.frameX=xy[0];e.frameY=xy[1];}}
e.frameTarget=e.target;e.frameCurrentTarget=e.currentTarget;e.frameEvent=e;this.fire('dom:'+e.type,e);},_DOMPaste:function(e){var inst=this.getInstance(),data=EMPTY,win=inst.config.win;if(e._event.originalTarget){data=e._event.originalTarget;}
if(e._event.clipboardData){data=e._event.clipboardData.getData(TEXT);}
if(win.clipboardData){data=win.clipboardData.getData(TEXT);if(data===EMPTY){if(!win.clipboardData.setData(TEXT,data)){data=null;}}}
e.frameTarget=e.target;e.frameCurrentTarget=e.currentTarget;e.frameEvent=e;if(data){e.clipboardData={data:data,getData:function(){return data;}};}else{e.clipboardData=null;}
this.fire('dom:paste',e);},_defReadyFn:function(){var inst=this.getInstance(),container=this.get(CONTAINER);Y.each(ContentEditable.DOM_EVENTS,function(value,key){var fn=Y.bind(this._onDomEvent,this),kfn=((Y.UA.ie&&ContentEditable.THROTTLE_TIME>0)?Y.throttle(fn,ContentEditable.THROTTLE_TIME):fn);if(!inst.Node.DOM_EVENTS[key]){inst.Node.DOM_EVENTS[key]=1;}
if(value===1){if(key!==FOCUS&&key!==BLUR&&key!==PASTE){if(key.substring(0,3)===KEY){this._eventHandles.push(container.on(key,kfn,container));}else{this._eventHandles.push(container.on(key,fn,container));}}}},this);inst.Node.DOM_EVENTS.paste=1;this._eventHandles.push(container.on(PASTE,Y.bind(this._DOMPaste,this),container),container.on(FOCUS,Y.bind(this._onDomEvent,this),container),container.on(BLUR,Y.bind(this._onDomEvent,this),container));inst.__use=inst.use;inst.use=Y.bind(this.use,this);},_onContentReady:function(event){if(!this._ready){this._ready=true;var inst=this.getInstance(),args=Y.clone(this.get(USE));this.fire(EVENT_CONTENT_READY);if(event){inst.config.doc=YNode.getDOMNode(event.target);}
args.push(Y.bind(function(){if(inst.EditorSelection){inst.EditorSelection.DEFAULT_BLOCK_TAG=this.get('defaultblock');inst.EditorSelection.ROOT=this.get(CONTAINER);}
this.fire(EVENT_READY);},this));inst.use.apply(inst,args);}},_getDefaultBlock:function(){return this._getHostValue('defaultblock');},_getDir:function(){return this._getHostValue('dir');},_getExtraCSS:function(){return this._getHostValue('extracss');},_getHTML:function(){var html,container;if(this._ready){container=this.get(CONTAINER);html=container.get(INNER_HTML);}
return html;},_getHostValue:function(attr){var host=this.get(HOST);if(host){return host.get(attr);}},_setHTML:function(html){if(this._ready){var container=this.get(CONTAINER);container.set(INNER_HTML,html);}else{this.once(EVENT_CONTENT_READY,Y.bind(this._setHTML,this,html));}
return html;},_setLinkedCSS:function(css){if(this._ready){var inst=this.getInstance();inst.Get.css(css);}else{this.once(EVENT_CONTENT_READY,Y.bind(this._setLinkedCSS,this,css));}
return css;},_setDir:function(value){var container;if(this._ready){container=this.get(CONTAINER);container.setAttribute('dir',value);}else{this.once(EVENT_CONTENT_READY,Y.bind(this._setDir,this,value));}
return value;},_setExtraCSS:function(css){if(this._ready){if(css){var inst=this.getInstance(),head=inst.one('head');if(this._extraCSSNode){this._extraCSSNode.remove();}
this._extraCSSNode=YNode.create('<style>'+css+'</style>');head.append(this._extraCSSNode);}}else{this.once(EVENT_CONTENT_READY,Y.bind(this._setExtraCSS,this,css));}
return css;},_setLang:function(value){var container;if(this._ready){container=this.get(CONTAINER);container.setAttribute('lang',value);}else{this.once(EVENT_CONTENT_READY,Y.bind(this._setLang,this,value));}
return value;},_instanceLoaded:function(inst){this._instance=inst;this._onContentReady();var doc=this._instance.config.doc;if(!Y.UA.ie){try{doc.execCommand('styleWithCSS',false,false);doc.execCommand('insertbronreturn',false,false);}catch(err){}}},_validateLinkedCSS:function(value){return Lang.isString(value)||Lang.isArray(value);},use:function(){var inst=this.getInstance(),args=Y.Array(arguments),callback=false;if(Lang.isFunction(args[args.length-1])){callback=args.pop();}
if(callback){args.push(function(){callback.apply(inst,arguments);});}
return inst.__use.apply(inst,args);},delegate:function(type,fn,cont,sel){var inst=this.getInstance();if(!inst){return false;}
if(!sel){sel=cont;cont=this.get(CONTAINER);}
return inst.delegate(type,fn,cont,sel);},getInstance:function(){return this._instance;},render:function(node){var args,inst,fn;if(this._rendered){return this;}
if(node){this.set(CONTAINER,node);}
container=this.get(CONTAINER);if(!container){container=YNode.create(ContentEditable.HTML);Y.one('body').prepend(container);this.set(CONTAINER,container);}
this._rendered=true;this._container.setAttribute(CONTENT_EDITABLE,true);args=Y.clone(this.get(USE));fn=Y.bind(function(){inst=YUI();inst.host=this.get(HOST);inst.use('node-base',Y.bind(this._instanceLoaded,this));},this);args.push(fn);Y.use.apply(Y,args);return this;},focus:function(){this._container.focus();return this;},show:function(){this._container.show();this.focus();return this;},hide:function(){this._container.hide();return this;}},{THROTTLE_TIME:100,DOM_EVENTS:{click:1,dblclick:1,focusin:1,focusout:1,keydown:1,keypress:1,keyup:1,mousedown:1,mouseup:1,paste:1},HTML:'<div></div>',NAME:'contentEditable',NS:CONTENT_EDITABLE,ATTRS:{dir:{lazyAdd:false,validator:Lang.isString,setter:'_setDir',valueFn:'_getDir'},container:{setter:function(n){this._container=Y.one(n);return this._container;}},content:{getter:'_getHTML',lazyAdd:false,setter:'_setHTML',validator:Lang.isString,value:'<br>'},defaultblock:{validator:Lang.isString,value:TAG_PARAGRAPH,valueFn:'_getDefaultBlock'},extracss:{lazyAdd:false,setter:'_setExtraCSS',validator:Lang.isString,valueFn:'_getExtraCSS'},id:{writeOnce:true,getter:function(id){if(!id){id='inlineedit-'+Y.guid();}
return id;}},lang:{validator:Lang.isString,setter:'_setLang',lazyAdd:false,value:'en-US'},linkedcss:{setter:'_setLinkedCSS',validator:'_validateLinkedCSS'},node:{readOnly:true,value:null,getter:function(){return this._container;}},use:{validator:Lang.isArray,writeOnce:true,value:['node-base','editor-selection','stylesheet']}}});Y.namespace('Plugin');Y.Plugin.ContentEditable=ContentEditable;},'3.15.0',{"requires":["node-base","editor-selection","stylesheet","plugin"]});