/*
     YUI 3.15.0 (build 834026e)
     Copyright 2014 Yahoo! Inc. All rights reserved.
     Licensed under the BSD License.
     http://yuilibrary.com/license/
     */
YUI.add('event-tap',function(Y,NAME){var doc=Y.config.doc,GESTURE_MAP=Y.Event._GESTURE_MAP,EVT_START=GESTURE_MAP.start,EVT_TAP='tap',POINTER_EVENT_TEST=/pointer/i,HANDLES={START:'Y_TAP_ON_START_HANDLE',END:'Y_TAP_ON_END_HANDLE',CANCEL:'Y_TAP_ON_CANCEL_HANDLE'};function detachHandles(subscription,handles){handles=handles||Y.Object.values(HANDLES);Y.Array.each(handles,function(item){var handle=subscription[item];if(handle){handle.detach();subscription[item]=null;}});}
Y.Event.define(EVT_TAP,{publishConfig:{preventedFn:function(e){var sub=e.target.once('click',function(click){click.preventDefault();});setTimeout(function(){sub.detach();},100);}},processArgs:function(args,isDelegate){if(!isDelegate){var extra=args[3];args.splice(3,1);return extra;}},on:function(node,subscription,notifier){subscription[HANDLES.START]=node.on(EVT_START,this._start,this,node,subscription,notifier);},detach:function(node,subscription,notifier){detachHandles(subscription);},delegate:function(node,subscription,notifier,filter){subscription[HANDLES.START]=Y.delegate(EVT_START,function(e){this._start(e,node,subscription,notifier,true);},node,filter,this);},detachDelegate:function(node,subscription,notifier){detachHandles(subscription);},_start:function(event,node,subscription,notifier,delegate){var context={canceled:false,eventType:event.type},preventMouse=subscription.preventMouse||false;if(event.button&&event.button===3){return;}
if(event.touches&&event.touches.length!==1){return;}
context.node=delegate?event.currentTarget:node;if(event.touches){context.startXY=[event.touches[0].pageX,event.touches[0].pageY];}
else{context.startXY=[event.pageX,event.pageY];}
if(event.touches){subscription[HANDLES.END]=node.once('touchend',this._end,this,node,subscription,notifier,delegate,context);subscription[HANDLES.CANCEL]=node.once('touchcancel',this.detach,this,node,subscription,notifier,delegate,context);subscription.preventMouse=true;}
else if(context.eventType.indexOf('mouse')!==-1&&!preventMouse){subscription[HANDLES.END]=node.once('mouseup',this._end,this,node,subscription,notifier,delegate,context);subscription[HANDLES.CANCEL]=node.once('mousecancel',this.detach,this,node,subscription,notifier,delegate,context);}
else if(context.eventType.indexOf('mouse')!==-1&&preventMouse){subscription.preventMouse=false;}
else if(POINTER_EVENT_TEST.test(context.eventType)){subscription[HANDLES.END]=node.once(GESTURE_MAP.end,this._end,this,node,subscription,notifier,delegate,context);subscription[HANDLES.CANCEL]=node.once(GESTURE_MAP.cancel,this.detach,this,node,subscription,notifier,delegate,context);}},_end:function(event,node,subscription,notifier,delegate,context){var startXY=context.startXY,endXY,clientXY,sensitivity=15;if(subscription._extra&&subscription._extra.sensitivity>=0){sensitivity=subscription._extra.sensitivity;}
if(event.changedTouches){endXY=[event.changedTouches[0].pageX,event.changedTouches[0].pageY];clientXY=[event.changedTouches[0].clientX,event.changedTouches[0].clientY];}
else{endXY=[event.pageX,event.pageY];clientXY=[event.clientX,event.clientY];}
if(Math.abs(endXY[0]-startXY[0])<=sensitivity&&Math.abs(endXY[1]-startXY[1])<=sensitivity){event.type=EVT_TAP;event.pageX=endXY[0];event.pageY=endXY[1];event.clientX=clientXY[0];event.clientY=clientXY[1];event.currentTarget=context.node;notifier.fire(event);}
detachHandles(subscription,[HANDLES.END,HANDLES.CANCEL]);}});},'3.15.0',{"requires":["node-base","event-base","event-touch","event-synthetic"]});