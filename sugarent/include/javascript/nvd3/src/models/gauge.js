nv.models.gauge=function(){var margin={top:0,right:0,bottom:0,left:0},width=null,height=null,clipEdge=true,getValues=function(d){return d.values;},getX=function(d){return d.key;},getY=function(d){return d.y;},id=Math.floor(Math.random()*10000),labelFormat=d3.format(',g'),valueFormat=d3.format(',.f'),showLabels=true,showPointer=true,color=function(d,i){return nv.utils.defaultColor()(d,d.series);},fill=color,classes=function(d,i){return'nv-arc-path nv-series-'+d.series;},dispatch=d3.dispatch('chartClick','elementClick','elementDblClick','elementMouseover','elementMouseout','elementMousemove');var ringWidth=50,pointerWidth=5,pointerTailLength=5,pointerHeadLength=90,minValue=0,maxValue=10,minAngle=-90,maxAngle=90,transitionMs=750,labelInset=10;function chart(selection)
{selection.each(function(chartData){var properties=chartData.properties,data=chartData.data;var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,radius=Math.min((availableWidth/2),availableHeight)/((100+labelInset)/100),container=d3.select(this),range=maxAngle-minAngle,scale=d3.scale.linear().range([0,1]).domain([minValue,maxValue]),previousTick=0,arcData=data.map(function(d,i){var rtn={key:d.key,series:d.series,y0:previousTick,y1:d.y,color:d.color,classes:d.classes};previousTick=d.y;return rtn;}),labelData=[0].concat(data.map(function(d){return d.y;})),prop=function(d){return d*radius/100;},pointerValue=properties.values[0].t;var wrap=container.selectAll('g.nv-wrap.nv-gauge').data([data]);var wrapEnter=wrap.enter().append('g').attr('class','nvd3 nv-wrap nv-gauge');var defsEnter=wrapEnter.append('defs');var gEnter=wrapEnter.append('g');var g=wrap.select('g');chart.gradient=function(d,i){return nv.utils.colorRadialGradient(d,id+'-'+i,{x:0,y:0,r:radius,s:ringWidth/100,u:'userSpaceOnUse'},color(d,i),wrap.select('defs'));};gEnter.append('g').attr('class','nv-arc-group');gEnter.append('g').attr('class','nv-labels');gEnter.append('g').attr('class','nv-pointer');gEnter.append('g').attr('class','nv-odometer');wrap.attr('transform','translate('+(margin.left/2+margin.right/2+prop(labelInset))+','+(margin.top+prop(labelInset))+')');var arc=d3.svg.arc().innerRadius(prop(ringWidth)).outerRadius(radius).startAngle(function(d,i){return deg2rad(newAngle(d.y0));}).endAngle(function(d,i){return deg2rad(newAngle(d.y1));});var ag=g.select('.nv-arc-group').attr('transform',centerTx);ag.selectAll('.nv-arc-path').data(arcData).enter().append('path').attr('class','nv-arc-path').attr('stroke','#ffffff').attr('stroke-width',3).attr('d',arc).on('mouseover',function(d,i){d3.select(this).classed('hover',true);dispatch.elementMouseover({point:d,pointIndex:i,pos:[d3.event.pageX,d3.event.pageY],id:id});}).on('mouseout',function(d,i){d3.select(this).classed('hover',false);dispatch.elementMouseout({point:d,index:i,id:id});}).on('mousemove',function(d,i){dispatch.elementMousemove({point:d,pointIndex:i,pos:[d3.event.pageX,d3.event.pageY],id:id});}).on('click',function(d,i){dispatch.elementClick({point:d,index:i,pos:d3.event,id:id});d3.event.stopPropagation();}).on('dblclick',function(d,i){dispatch.elementDblClick({point:d,index:i,pos:d3.event,id:id});d3.event.stopPropagation();});ag.selectAll('.nv-arc-path').transition().duration(10).attr('class',classes).attr('fill',fill).attr('d',arc);var lg=g.select('.nv-labels').attr('transform',centerTx);lg.selectAll('text').transition().duration(0).attr('transform',function(d){return'rotate('+newAngle(d)+') translate(0,'+(-radius-prop(1.5))+')';}).style('font-size',prop(0.6)+'em');lg.selectAll('text').data(labelData).enter().append('text').attr('transform',function(d){return'rotate('+newAngle(d)+') translate(0,'+(-radius-prop(1.5))+')';}).text(labelFormat).style('text-anchor','middle').style('font-size',prop(0.6)+'em');if(showPointer){var pointerData=[[Math.round(prop(pointerWidth)/2),0],[0,-Math.round(prop(pointerHeadLength))],[-(Math.round(prop(pointerWidth)/2)),0],[0,Math.round(prop(pointerWidth))],[Math.round(prop(pointerWidth)/2),0]];var pg=g.select('.nv-pointer').attr('transform',centerTx);pg.selectAll('path').transition().duration(120).attr('d',d3.svg.line().interpolate('monotone'));var pointer=pg.selectAll('path').data([pointerData]).enter().append('path').attr('d',d3.svg.line().interpolate('monotone')).attr('transform','rotate('+minAngle+')');setGaugePointer(pointerValue);g.selectAll('.nv-odom').remove();g.select('.nv-odomText').transition().duration(0).style('font-size',prop(0.7)+'em');g.select('.nv-odometer').append('text').attr('class','nv-odom nv-odomText').attr('x',0).attr('y',0).attr('text-anchor','middle').text(valueFormat(pointerValue)).style('stroke','none').style('fill','black').style('font-size',prop(0.7)+'em');var bbox=g.select('.nv-odomText').node().getBoundingClientRect();g.select('.nv-odometer').insert('path','.nv-odomText').attr('class','nv-odom nv-odomBox').attr("d",nv.utils.roundedRectangle(-bbox.width/2,-bbox.height+prop(1.5),bbox.width+prop(4),bbox.height+prop(2),prop(2))).attr('fill','#eeffff').attr('stroke','black').attr('stroke-width','2px').attr('opacity',0.8);g.select('.nv-odometer').attr('transform','translate('+radius+','+(margin.top+prop(70)+bbox.width)+')');}else{g.select('.nv-odometer').select('.nv-odomText').remove();g.select('.nv-odometer').select('.nv-odomBox').remove();g.select('.nv-pointer').selectAll('path').remove();}
function setGaugePointer(d){pointer.transition().duration(transitionMs).ease('elastic').attr('transform','rotate('+newAngle(d)+')');}
function deg2rad(deg){return deg*Math.PI/180;}
function newAngle(d){return minAngle+(scale(d)*range);}
function centerTx(){return'translate('+radius+','+radius+')';}
chart.setGaugePointer=setGaugePointer;});return chart;}
chart.dispatch=dispatch;chart.color=function(_){if(!arguments.length)return color;color=_;return chart;};chart.fill=function(_){if(!arguments.length)return fill;fill=_;return chart;};chart.classes=function(_){if(!arguments.length)return classes;classes=_;return chart;};chart.gradient=function(_){if(!arguments.length)return gradient;gradient=_;return chart;};chart.margin=function(_){if(!arguments.length)return margin;margin=_;return chart;};chart.width=function(_){if(!arguments.length)return width;width=_;return chart;};chart.height=function(_){if(!arguments.length)return height;height=_;return chart;};chart.values=function(_){if(!arguments.length)return getValues;getValues=_;return chart;};chart.x=function(_){if(!arguments.length)return getX;getX=_;return chart;};chart.y=function(_){if(!arguments.length)return getY;getY=d3.functor(_);return chart;};chart.showLabels=function(_){if(!arguments.length)return showLabels;showLabels=_;return chart;};chart.id=function(_){if(!arguments.length)return id;id=_;return chart;};chart.valueFormat=function(_){if(!arguments.length)return valueFormat;valueFormat=_;return chart;};chart.labelThreshold=function(_){if(!arguments.length)return labelThreshold;labelThreshold=_;return chart;};chart.ringWidth=function(_){if(!arguments.length)return ringWidth;ringWidth=_;return chart;};chart.pointerWidth=function(_){if(!arguments.length)return pointerWidth;pointerWidth=_;return chart;};chart.pointerTailLength=function(_){if(!arguments.length)return pointerTailLength;pointerTailLength=_;return chart;};chart.pointerHeadLength=function(_){if(!arguments.length)return pointerHeadLength;pointerHeadLength=_;return chart;};chart.minValue=function(_){if(!arguments.length)return minValue;minValue=_;return chart;};chart.maxValue=function(_){if(!arguments.length)return maxValue;maxValue=_;return chart;};chart.minAngle=function(_){if(!arguments.length)return minAngle;minAngle=_;return chart;};chart.maxAngle=function(_){if(!arguments.length)return maxAngle;maxAngle=_;return chart;};chart.transitionMs=function(_){if(!arguments.length)return transitionMs;transitionMs=_;return chart;};chart.labelFormat=function(_){if(!arguments.length)return labelFormat;labelFormat=_;return chart;};chart.labelInset=function(_){if(!arguments.length)return labelInset;labelInset=_;return chart;};chart.setPointer=function(_){if(!arguments.length)return chart.setGaugePointer;chart.setGaugePointer(_);return chart;};chart.isRendered=function(_){return(svg!==undefined);};chart.showPointer=function(_){if(!arguments.length)return showPointer;showPointer=_;return chart;};return chart;}