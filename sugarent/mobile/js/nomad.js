/*
 * Your installation or use of this SugarCRM file is subject to the applicable
 * terms available at
 * http://support.sugarcrm.com/06_Customer_Center/10_Master_Subscription_Agreements/.
 * If you do not agree to all of the applicable terms or do not have the
 * authority to bind the entity as an authorized representative, then do not
 * install or use this SugarCRM file.
 *
 * Copyright (C) SugarCRM Inc. All rights reserved.
 */
(function(e){e.augment("config",{appId:"nomad",appName:"SugarCRM",keychainService:"SugarCRM",productName:"SugarCRM",appVersion:"3.0.2",appBuild:"340/336",nomadVersion:"3.0.2",nomadBuild:"340/336",buildTag:"",brandName:"SugarCRM",env:"prod",scheme:"store",debugSugarApi:false,debugMemory:false,logLevel:"WARN",logWriter:"ConsoleWriter",logFormatter:"SimpleFormatter",showLogLevelSetting:false,deviceMode:{type:"auto",landscape:false,portrait:false},fastClickEnabled:true,layoutCacheSize:10,maxAlertsPerLayout:2,disableLayoutCache:["associate","pickerlist"],pullToRefresh:true,refreshOnResumeTimeout:3e4,authStore:"cache",keyValueStore:"sqlKeyValueStore",keyValueStoreEncryptionEnabled:false,cacheMeta:true,minServerVersion:"6.7.1",supportedServerFlavors:["PRO","CORP","ENT","ULT"],siteUrl:"..",serverUrl:"../rest/v10",serverTimeout:30,logoutTimeout:3e3,searchDelay:600,hideLoginUrl:false,allowUrlReconfigure:false,nativeRedirectEnabled:true,clientID:"sugar",restVersion:"10",useHttps:true,externalLoginEnabled:true,alertAutoCloseDelay:6e3,maxQueryResult:20,maxHttpCacheAge:10,fetchLimit:{activities:10,activityItemsPerModule:3,bulkQueryRelatedRecords:10,maxPageSize:60,recentlyUpdated:40,recents:20,filters:100},alwaysShowMyItems:false,configurableFontSize:true,platform:"mobile",metadataTypes:["server_info","labels","ordered_labels","modules","relationships","currencies","_override_values","config","modules_info","views","editable_dropdown_filters"],knownModules:["Settings","About","TxLog","Error","Forecasts","Users","Accounts","Contacts","Documents","Leads","Opportunities","RevenueLineItems","Meetings","Calls","Tasks","Notes","Reports","Cases","Quotes","Employees","Bugs","Campaigns","Contracts","KBDocuments","Products","Project","Prospects","Targets","Emails"],unsupportedModules:["Bugs","Campaigns","Contracts","KBDocuments","Products","Project","Prospects","Targets","Emails"],modulesWithFiles:["Documents"],modulesWithPDFs:["Reports"],modulesWithAvatars:["Contacts","Leads","Employees","Users"],nonDuplicatableModules:["Users","Documents","Employees","KBDocuments","Reports","Quotes","Emails"],nonCreatableModules:["TxLog","Users","Documents","Employees","KBDocuments","Reports","Quotes","Emails"],nonEditableModules:["KBDocuments","Quotes","Employees","Reports","Emails"],nonDeletableModules:["Users","Employees"],nonDeletableSalesStages:["Closed Won","Closed Lost"],nonLinkableModules:[],followableModules:["Accounts","Contacts","Leads","Opportunities","Cases","RevenueLineItems","Tasks","Notes","Products"],readonlyModules:["Teams","ProductTypes","ProductCategories","ProductTemplates","Manufacturers"],nonAclModules:["Error","Login","About"],modulesToAlwaysRefresh:["TxLog"],hiddenModules:["Forecasts","Activities","Filters","Comments"],customViews:["offlineSettings","offlineStats"],numberOfAdditionalListFields:1,displayListFieldLabel:false,displayDetailFieldLabel:false,showAdditionalFieldsOnSearch:true,detailAfterCreate:false,forceListReload:false,about:{privacy:"http://www.sugarcrm.com/mobile_privacy",tos:"http://support.sugarcrm.com/06_Customer_Center/10_Master_Subscription_Agreements",trademark:"http://www.sugarcrm.com/about/trademark-information",displayTrademarks:false,support:"support.sugarcrm.com",sugarcrm:"http://www.sugarcrm.com",supportEmail:"support@sugarcrm.com",displaySupportEmail:false,thirdPartySoftware:"http://www.sugarcrm.com/third-party-software",copyrightText:"",trademarkText:"",trademarkText2:""},analytics:{enabled:false,id:{"native":"UA-33012372-5",web:"UA-33012372-6"},appName:"SugarCRM",optOut:false,debug:false,dryRun:false,dispatchInterval:120,sampleRate:100,anonymize:false,useHttps:true,instanceTracking:true,serverUrlWhiteList:["sugarinternal.sugarondemand.com",".*\\.sugarondemand.com"]},canvasTestModeOnUpload:false,resizeImagesOnUpload:600,imageResizeTimeout:8e3,iosCanvasSizeLimit:5,jpegEncoderQuality:80,defaultViewScheme:"Search",fileSizeLimit:10,additionalComponents:{"main-menu":{target:"#menu-left"}},syncConfig:false,transMap:null,allowBrowserContextMenu:false,skipStringCleanup:false,emulateBackButton:true,skipTutorial:false,skipSetupBuddy:false,maxPreloaderPanelMessages:4,navigationHistoryLimit:10,UI:{supportedRTL:true,defaultFontSize:"normal",fontSizes:{tiny:10,small:12,normal:14,large:16,larger:18,huge:20,extra_huge:22}},sugarLogic:{enabled:true,minServerVersion:"7.2",isDynamic:false},localSecurity:{enabled:false,minServerVersion:"7.2",maxAllowedPasswordAttempt:3,touchIdForLoginEnabled:true,passkeyEnabled:false,touchIdForPasskeyEnabled:false},offline:{enabled:false,storageProvider:"sql",storageAdapter:"native",storageSize:5,dbEncryptionEnabled:false,debug:{ignoreEnabled:false,render:false,forceMigrate:false,online:true,syncManagerEnabled:true,monitorStatus:true,outOfSpace:false},minServerVersion:"7.1.5RC1",httpThrottlingEnabled:false,httpThrottleTimeout:1e4,httpThrottleCacheSize:10,exclude:["About","Settings","Search","Login","Offline","Error","ErrorEmulation","Recents","Forecasts","BubbleChart","Dashboards","Activities","Filters","Comments","Twitter","Home","SetupBuddy","TxLog"],customOfflineModules:["TxLog","Recents"],prefetch:{enabled:true,staticModules:{Users:20,Teams:20,ProductCategories:20,ProductTypes:40,ProductTemplates:20,Manufacturers:20},maxThreshold:100,pageSize:20,relationships:{pageSize:20,maxThreshold:100}},syncManager:{enabled:true,syncTimeout:10,executors:{wins:{enabled:true,interval:180,priority:1,preSyncMaxRecords:100,syncPageSize:20,preSyncPageSize:20},txLog:{enabled:true,interval:20,priority:0}}},defaultPurgeInterval:7,maxMixedCollectionQueryResult:30,monitorTimeout:5e3,cleanupConfirmationInterval:6e4,periodicSync:{enabled:false}},dashboards:{enabled:true,minServerVersion:"7.2",recordDashboardsEnabled:true,dashlets:{dashablelist:{enabled:true,minServerVersion:"7.2",icon:"icon-table"},"tabbed-dashlet":{enabled:true,minServerVersion:"7.2",icon:{"active-tasks":{icon:"icon-check-square-o"},"planned-activities":{icon:"icon-calendar-o"},"inactive-tasks":{icon:"icon-check"},history:{icon:"icon-history"}}},"forecast-pareto":{enabled:true,minServerVersion:"7.6.0.0RC3",icon:"icon-bar-chart"},bubblechart:{enabled:true,minServerVersion:"7.2",icon:"icon-trophy"},"forecast-pipeline":{enabled:true,minServerVersion:"7.6.0.0RC3",icon:"icon-pipeline"},"activitystream-dashlet":{enabled:true,minServerVersion:"7.2",icon:"icon-clock-o"},"saved-reports-chart":{enabled:true,minServerVersion:"7.2",icon:"icon-area-chart"},forecastdetails:{enabled:true,minServerVersion:"7.6.0.0RC3",icon:"icon-th-list"},twitter:{enabled:true,minServerVersion:"7.5.0.0",icon:"icon-twitter"},webpage:{enabled:true,minServerVersion:"7.5.0.0",icon:"icon-list-alt"},"opportunity-metrics":{enabled:true,minServerVersion:"7.6.0.0RC3",icon:"icon-circle-o"},casessummary:{enabled:true,minServerVersion:"7.5.0.0",icon:"icon-folder-open"}}},raven:{enabled:true,url:"https://0c866dad58bb4a29b88e405491cfc6a6@app.getsentry.com/22007",enhancedErrorReporting:true,maxLogSize:30,env:"store"},errorEmulation:{enabled:false,user:"Max"}},false)})(SUGAR.App);(function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={exports:{},id:n,loaded:false};e[n].call(a.exports,a,a.exports,i);a.loaded=true;return a.exports}i.m=e;i.c=t;i.p="";return i(0)})([function(e,t,i){e.exports=i(157)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports=function(){var e=[];e.toString=function t(){var e=[];for(var t=0;t<this.length;t++){var i=this[t];if(i[2]){e.push("@media "+i[2]+"{"+i[1]+"}")}else{e.push(i[1])}}return e.join("")};e.i=function(t,i){if(typeof t==="string")t=[[null,t,""]];var n={};for(var a=0;a<this.length;a++){var o=this[a][0];if(typeof o==="number")n[o]=true}for(a=0;a<t.length;a++){var s=t[a];if(typeof s[0]!=="number"||!n[s[0]]){if(i&&!s[2]){s[2]=i}else if(i){s[2]="("+s[2]+") and ("+i+")"}e.push(s)}}};return e}},function(e,t,i){var n={},a=function(e){var t;return function(){if(typeof t==="undefined")t=e.apply(this,arguments);return t}},o=a(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),s=a(function(){return document.head||document.getElementsByTagName("head")[0]}),r=null,l=0,c=[];e.exports=function(e,t){if(false){if(typeof document!=="object")throw new Error("The style-loader cannot be used in a non-browser environment")}t=t||{};if(typeof t.singleton==="undefined")t.singleton=o();if(typeof t.insertAt==="undefined")t.insertAt="bottom";var i=u(e);d(i,t);return function a(e){var a=[];for(var o=0;o<i.length;o++){var s=i[o];var r=n[s.id];r.refs--;a.push(r)}if(e){var l=u(e);d(l,t)}for(var o=0;o<a.length;o++){var r=a[o];if(r.refs===0){for(var c=0;c<r.parts.length;c++)r.parts[c]();delete n[r.id]}}}};function d(e,t){for(var i=0;i<e.length;i++){var a=e[i];var o=n[a.id];if(o){o.refs++;for(var s=0;s<o.parts.length;s++){o.parts[s](a.parts[s])}for(;s<a.parts.length;s++){o.parts.push(g(a.parts[s],t))}}else{var r=[];for(var s=0;s<a.parts.length;s++){r.push(g(a.parts[s],t))}n[a.id]={id:a.id,refs:1,parts:r}}}}function u(e){var t=[];var i={};for(var n=0;n<e.length;n++){var a=e[n];var o=a[0];var s=a[1];var r=a[2];var l=a[3];var c={css:s,media:r,sourceMap:l};if(!i[o])t.push(i[o]={id:o,parts:[c]});else i[o].parts.push(c)}return t}function f(e,t){var i=s();var n=c[c.length-1];if(e.insertAt==="top"){if(!n){i.insertBefore(t,i.firstChild)}else if(n.nextSibling){i.insertBefore(t,n.nextSibling)}else{i.appendChild(t)}c.push(t)}else if(e.insertAt==="bottom"){i.appendChild(t)}else{throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.")}}function h(e){e.parentNode.removeChild(e);var t=c.indexOf(e);if(t>=0){c.splice(t,1)}}function p(e){var t=document.createElement("style");t.type="text/css";f(e,t);return t}function m(e){var t=document.createElement("link");t.rel="stylesheet";f(e,t);return t}function g(e,t){var i,n,a;if(t.singleton){var o=l++;i=r||(r=p(t));n=v.bind(null,i,o,false);a=v.bind(null,i,o,true)}else if(e.sourceMap&&typeof URL==="function"&&typeof URL.createObjectURL==="function"&&typeof URL.revokeObjectURL==="function"&&typeof Blob==="function"&&typeof btoa==="function"){i=m(t);n=y.bind(null,i);a=function(){h(i);if(i.href)URL.revokeObjectURL(i.href)}}else{i=p(t);n=b.bind(null,i);a=function(){h(i)}}n(e);return function s(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else{a()}}}var _=function(){var e=[];return function(t,i){e[t]=i;return e.filter(Boolean).join("\n")}}();function v(e,t,i,n){var a=i?"":n.css;if(e.styleSheet){e.styleSheet.cssText=_(t,a)}else{var o=document.createTextNode(a);var s=e.childNodes;if(s[t])e.removeChild(s[t]);if(s.length){e.insertBefore(o,s[t])}else{e.appendChild(o)}}}function b(e,t){var i=t.css;var n=t.media;var a=t.sourceMap;if(n){e.setAttribute("media",n)}if(e.styleSheet){e.styleSheet.cssText=i}else{while(e.firstChild){e.removeChild(e.firstChild)}e.appendChild(document.createTextNode(i))}}function y(e,t){var i=t.css;var n=t.media;var a=t.sourceMap;if(a){i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"}var o=new Blob([i],{type:"text/css"});var s=e.href;e.href=URL.createObjectURL(o);if(s)URL.revokeObjectURL(s)}},function(e,t,i){i.p="js/";i(158);i(164);i(165);i(166);i(167);i(168);i(169);i(170);i(171);i(172);i(173);i(174);i(175);i(176);i(177);i(178);i(179);i(180);i(181);i(182);i(183);i(184);i(185);i(186);i(187);i(188);i(189);i(190);i(191);i(192);i(193);i(194);i(195);i(196);i(197);i(198);i(199);i(200);i(201);i(202);i(203);i(204);i(205);i(206);i(207);i(208);i(209);i(210);i(211);i(212);i(213);i(214);i(215);i(216);i(217);i(218);i(219);i(220);i(221);i(222);i(223);i(224);i(225);i(226);i(227);i(228);i(229);i(230);i(231);i(232);i(233);i(234);i(235);i(236);i(237);i(238);i(239);i(240);i(241);i(242);i(243);i(244);i(245);i(246);i(247);i(248);i(245);i(249);i(250);i(251);i(252);i(253);i(254);i(255);i(256);i(257);i(258);i(259);i(260);i(261);i(262);i(263);i(264);i(265);i(266);i(267);i(268);i(269);i(270);i(271);i(272);i(273);i(274);i(275);i(276);i(277);i(278);i(279);i(280);i(281);i(282);i(283);i(284);i(285);i(286);i(287);i(288);i(289);i(290);i(291);i(292);i(293);i(294);i(295);i(296);i(297);i(298);i(299);i(300);i(301);i(302);i(303);i(304);i(305);i(306);i(307);i(308);i(309);i(310);i(311);if(true){i(312);i(313);i(314)}else{require("%app.js%/native/nomad");require("%app.js%/native/local-security");require("%app.js%/native/keychain");require("%app.js%/native/translation")}if(["e2e","debug","qa"].indexOf("store")!==-1){i(315)}if(false){require("%app%/entries/custom")}if(false){e.hot.accept("%app%/less/bootstrap-mobile.less")}},function(e,t,i){var n=i(159);if(typeof n==="string")n=[[e.id,n,""]];var a=i(156)(n,{});if(n.locals)e.exports=n.locals;if(false){if(!n.locals){e.hot.accept("!!./../../node_modules/css-loader/index.js!./../../node_modules/less-loader/index.js?noIeCompat!./bootstrap-mobile.less",function(){var t=require("!!./../../node_modules/css-loader/index.js!./../../node_modules/less-loader/index.js?noIeCompat!./bootstrap-mobile.less");if(typeof t==="string")t=[[e.id,t,""]];a(t)})}e.hot.dispose(function(){a()})}},function(e,t,i){t=e.exports=i(155)();t.push([e.id,'/*!\n * Bootstrap v2.0.1\n *\n * Copyright 2012 Twitter, Inc\n * Licensed under the Apache License v2.0\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Designed and built with all the love in the world @twitter by @mdo and @fat.\n *//*!\n// https://github.com/FortAwesome/Font-Awesome\n// MIT License\n\nThis Font Software is licensed under the SIL Open Font License, Version 1.1.\nThis license is copied below, and is also available with a FAQ at:\nhttp://scripts.sil.org/OFL\n\n\n-----------------------------------------------------------\nSIL OPEN FONT LICENSE Version 1.1 - 26 February 2007\n-----------------------------------------------------------\n\nPREAMBLE\nThe goals of the Open Font License (OFL) are to stimulate worldwide\ndevelopment of collaborative font projects, to support the font creation\nefforts of academic and linguistic communities, and to provide a free and\nopen framework in which fonts may be shared and improved in partnership\nwith others.\n\nThe OFL allows the licensed fonts to be used, studied, modified and\nredistributed freely as long as they are not sold by themselves. The\nfonts, including any derivative works, can be bundled, embedded,\nredistributed and/or sold with any software provided that any reserved\nnames are not used by derivative works. The fonts and derivatives,\nhowever, cannot be released under any other type of license. The\nrequirement for fonts to remain under this license does not apply\nto any document created using the fonts or their derivatives.\n\nDEFINITIONS\n"Font Software" refers to the set of files released by the Copyright\nHolder(s) under this license and clearly marked as such. This may\ninclude source files, build scripts and documentation.\n\n"Reserved Font Name" refers to any names specified as such after the\ncopyright statement(s).\n\n"Original Version" refers to the collection of Font Software components as\ndistributed by the Copyright Holder(s).\n\n"Modified Version" refers to any derivative made by adding to, deleting,\nor substituting -- in part or in whole -- any of the components of the\nOriginal Version, by changing formats or by porting the Font Software to a\nnew environment.\n\n"Author" refers to any designer, engineer, programmer, technical\nwriter or other person who contributed to the Font Software.\n\nPERMISSION & CONDITIONS\nPermission is hereby granted, free of charge, to any person obtaining\na copy of the Font Software, to use, study, copy, merge, embed, modify,\nredistribute, and sell modified and unmodified copies of the Font\nSoftware, subject to the following conditions:\n\n1) Neither the Font Software nor any of its individual components,\nin Original or Modified Versions, may be sold by itself.\n\n2) Original or Modified Versions of the Font Software may be bundled,\nredistributed and/or sold with any software, provided that each copy\ncontains the above copyright notice and this license. These can be\nincluded either as stand-alone text files, human-readable headers or\nin the appropriate machine-readable metadata fields within text or\nbinary files as long as those fields can be easily viewed by the user.\n\n3) No Modified Version of the Font Software may use the Reserved Font\nName(s) unless explicit written permission is granted by the corresponding\nCopyright Holder. This restriction only applies to the primary font name as\npresented to the users.\n\n4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font\nSoftware shall not be used to promote, endorse or advertise any\nModified Version, except to acknowledge the contribution(s) of the\nCopyright Holder(s) and the Author(s) or with their explicit written\npermission.\n\n5) The Font Software, modified or unmodified, in part or in whole,\nmust be distributed entirely under this license, and must not be\ndistributed under any other license. The requirement for fonts to\nremain under this license does not apply to any document created\nusing the Font Software.\n\nTERMINATION\nThis license becomes null and void if any of the above conditions are\nnot met.\n\nDISCLAIMER\nTHE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT\nOF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE\nCOPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\nINCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL\nDAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\nFROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM\nOTHER DEALINGS IN THE FONT SOFTWARE.\n*//*!\n * Your installation or use of this SugarCRM file is subject to the applicable\n * terms available at\n * http://support.sugarcrm.com/06_Customer_Center/10_Master_Subscription_Agreements/.\n * If you do not agree to all of the applicable terms or do not have the\n * authority to bind the entity as an authorized representative, then do not\n * install or use this SugarCRM file.\n *\n * Copyright (C) SugarCRM Inc. All rights reserved.\n */body,svg{-webkit-touch-callout:none;-webkit-user-select:none}#nomad,.dashboard{bottom:0}@keyframes triggerRepaint{0%,100%{width:100%}50%{width:100.001%}}@-webkit-keyframes triggerRepaint{0%,100%{width:100%}50%{width:100.001%}}svg{user-select:none;display:block;width:100%;height:100%;max-height:500px}svg text{font:400 13px "Helvetica Neue",Helvetica,Arial,sans-serif;fill:#555;stroke:none;cursor:default}svg .title{font:700 13px + 2 "Helvetica Neue",Helvetica,Arial,sans-serif}.nv-axis .nv-axisMaxMin text,.nv-labels text,.nv-noData{font-weight:700}.nv-axislabel,em{font-style:italic}body,input,select,textarea{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.nv-background{fill:#fff}.nv-chart{min-width:300px;min-height:100px;position:relative}#nomad,.tooltip,.tooltip-arrow{position:absolute}.nv-chart svg{max-height:none}.nv-noData{font-size:17px}.nv-label-value text,.nv-title,text.nv-label-value{font-size:15px}.nv-labels text{fill:#666}.nv-label-box{fill:transparent}.nvtooltip{pointer-events:none}.nvtooltip-pending-removal{position:absolute;pointer-events:none}.nv-brush .resize path{fill:#eee;stroke:#666}.nv-brush .extent{shape-rendering:crispEdges;fill-opacity:0!important}.nv-brushBackground rect{stroke:#000;stroke-width:.4;fill:#fff;fill-opacity:.7}.nv-legend .nv-series{cursor:pointer;font-size:13px}.nv-legend .nv-series line{fill:none}.nv-legend .nv-series text{cursor:pointer}.nv-legend .disabled circle{fill:#fff}.nv-legend-background{fill:rgba(255,255,255,.9);stroke:rgba(161,160,160,.75);stroke-width:1px}.nv-legend-link{cursor:pointer;fill:#176AE6}.nv-legend-link:hover{fill:#1255b8;text-decoration:underline}.tooltip-inner,a{text-decoration:none}.nv-lineLegend .nv-series,.nv-lineLegend .nv-series text{cursor:default}.nv-axis line,.nv-axis path,.nv-axis polyline{fill:none;stroke:#CDCCCB;stroke-width:2px;shape-rendering:crispEdges;pointer-events:none}.nv-axis line,.nv-axis polyline{stroke-opacity:.3}.nv-axis line.zero,.nv-axis path{stroke-opacity:.75}.nv-axis path.domain{stroke-width:2px;stroke:#bbb}.nv-x.nv-axis text{font-size:13px}.nv-axislabel{font-weight:900}.nv-multibar .nv-group rect{stroke-opacity:1;stroke-width:2px;stroke:#fff}.nv-multibar .nv-group.hover rect{fill-opacity:.75}.nv-texture{fill-opacity:0!important;pointer-events:none}.texture-line{stroke-width:1px}.nv-active .nv-texture{fill-opacity:1!important}.nv-active .nv-label-box{fill:inherit}.nv-inactive .nv-texture{fill-opacity:0!important}.calc-text-strings,.nv-multibar .nv-groups text{fill:#000;stroke:transparent;pointer-events:none}.nv-pie .nv-slice.hover path{fill-opacity:.75}.nv-holeWrap text{text-anchor:middle}text.nv-pie-hole-value{font-size:32px;font-weight:700}text.nv-pie-hole-label{font-size:11px}.nv-groups path.nv-line{fill:none;stroke-width:2.5px;stroke-linecap:round;shape-rendering:geometricPrecision}.nv-groups path.nv-area{stroke:none;stroke-linecap:round;shape-rendering:geometricPrecision}.nv-line.hover path{stroke-width:6px}.nv-line .nv-scatter .nv-groups .nv-point{fill-opacity:1;stroke-opacity:1;stroke:#fff}.nv-scatter.nv-single-point .nv-groups .nv-point{stroke-width:2px}.nv-groups .nv-point.hover,.nv-scatter .nv-groups .nv-point.hover{stroke-width:16px;stroke-opacity:.5!important;stroke:inherit}.nv-point-paths path{stroke:transparent;stroke-opacity:0;fill:transparent;fill-opacity:0}.nv-indexLine{cursor:ew-resize}.nv-card .nv-expcoll,.nv-treemap svg .nv-children .nv-parent,.nv-treemap svg .nv-grandparent rect{cursor:pointer}.nv-distribution,.nv-groups .nv-point{pointer-events:none}.nv-groups .nv-point.hover{stroke-width:20px;stroke-opacity:.5}.nv-scatter .nv-point.hover{fill-opacity:1}.nv-stackedarea path.nv-area{fill-opacity:.7;stroke-opacity:0}.nv-stackedarea path.nv-area.hover{fill-opacity:.9}.nv-stackedarea .nv-groups .nv-point{stroke-opacity:0;fill-opacity:0}.nv-stackedarea .nv-groups .nv-point.hover{stroke-width:20px;stroke-opacity:.75;fill-opacity:1}.nv-linePlusBar .nv-bar rect{fill-opacity:.75}.nv-linePlusBar .nv-bar rect:hover{fill-opacity:1}.nv-sparklineplus .nv-hoverValue line{stroke:#f44;stroke-width:1.5px}.nv-sparklineplus,.nv-sparklineplus g{pointer-events:all}.nv-hoverArea{fill-opacity:0;stroke-opacity:0}.nv-sparklineplus .nv-xValue,.nv-sparklineplus .nv-yValue{stroke:#666;font-size:.5em;font-weight:400}.nv-odomText,.nv-pareto .nv-y.nv-axis text.nv-quotaValue,.nv-pareto .nv-y.nv-axis text.nv-targetQuotaValue{font-weight:700}.nv-sparklineplus .nv-yValue{stroke:#f66}.nv-odomText{fill:#000}.nv-arc-group{fill:#4682b4}.nv-pointer{fill:#888;stroke:#fff}.nv-funnelChart .nv-slice.hover polygon{fill-opacity:.75}.nv-funnelChart .nv-y path{stroke:none}.nv-funnelChart .nv-label-value text.nv-label{font-size:13px}.nv-funnelChart .nv-label-value text.nv-value{font-size:15px}.nv-bubbleChart .nv-scatter.nv-single-point .nv-groups .nv-point{fill-opacity:1;stroke-opacity:1}.nv-multiBarWithLegend .nv-line .nv-scatter .nv-groups .nv-point{fill-opacity:1;stroke-opacity:1;stroke-width:2px}.nv-pareto .nv-quotaWrap line{opacity:.8;stroke:#444;stroke-width:4px;fill:none}.nv-pareto .nv-quotaWrap line.nv-quotaLineTarget{stroke:#777}.nv-pareto .nv-quotaWrap line.nv-quotaLineBackground{opacity:0;stroke-width:12px}.nv-pareto .nv-y.nv-axis .domain{display:none}.nv-pareto .nv-line .nv-groups path{stroke-width:4px}.nv-pareto .nv-linesWrap1 .nv-line .nv-groups path{stroke-width:6px}.nv-pareto .nv-linesWrap2 .nv-scatter .nv-groups circle,.nv-treemap svg rect{stroke:#fff}.nv-treemap svg{background-color:#fff}.nv-treemap svg text{pointer-events:none;fill:#fff}.nv-treemap svg .nv-depth text{fill:#fff}.nv-treemap svg .nv-grandparent text{font-weight:700;fill:#58595B}.nv-treemap svg .nv-children.hover .nv-parent{fill:#fff;opacity:.3}.nv-treemap svg .nv-grandparent rect,.nv-treemap svg .nv-parent{stroke-width:3px}.nv-treemap svg .nv-child{stroke-width:1px}.nv-treemap svg .nv-parent{fill:none;font-weight:400;pointer-events:all}.nv-treemap svg .nv-grandparent rect{fill:#fff}.nv-card{fill:#E9EFEF;stroke:#AAA;stroke-width:.5px}.nv-card .nv-circ-front{stroke-width:0}.nv-card line{stroke-width:2}.nv-tree path.link{fill:none;stroke:#ccc;stroke-width:1.5px}.nv-fill-green{fill:#33800d;background-color:#33800d}.nv-fill-red{fill:#e61718;background-color:#e61718}.nv-fill-blue{fill:#176de5;background-color:#176de5}.nv-fill00{fill:#e61718;background-color:#e61718}.nv-fill01{fill:#cc3314;background-color:#cc3314}.nv-fill02{fill:#e5a117;background-color:#e5a117}.nv-fill03{fill:#6a800d;background-color:#6a800d}.nv-fill04{fill:#33800d;background-color:#33800d}.nv-fill05{fill:#0d8046;background-color:#0d8046}.nv-fill06{fill:#0d806c;background-color:#0d806c}.nv-fill07{fill:#0f7799;background-color:#0f7799}.nv-fill08{fill:#1378bf;background-color:#1378bf}.nv-fill09{fill:#176de5;background-color:#176de5}.nv-fill10{fill:#1f12b3;background-color:#1f12b3}.nv-fill11{fill:#6d17e5;background-color:#6d17e5}.nv-fill12{fill:#e5176d;background-color:#e5176d}.nv-fill13{fill:#ff6fcf;background-color:#ff6fcf}.nv-legend .nv-fill00{stroke:#e61718}.nv-legend .nv-fill01{stroke:#cc3314}.nv-legend .nv-fill02{stroke:#e5a117}.nv-legend .nv-fill03{stroke:#6a800d}.nv-legend .nv-fill04{stroke:#33800d}.nv-legend .nv-fill05{stroke:#0d8046}.nv-legend .nv-fill06{stroke:#0d806c}.nv-legend .nv-fill07{stroke:#0f7799}.nv-legend .nv-fill08{stroke:#1378bf}.nv-legend .nv-fill09{stroke:#176de5}.nv-legend .nv-fill10{stroke:#1f12b3}.nv-legend .nv-fill11{stroke:#6d17e5}.nv-legend .nv-fill12{stroke:#e5176d}.nv-legend .nv-fill13{stroke:#ff6fcf}.nv-stroke00{stroke:#e61718;color:#e61718}.nv-stroke01{stroke:#cc3314;color:#cc3314}.nv-stroke02{stroke:#e5a117;color:#e5a117}.nv-stroke03{stroke:#6a800d;color:#6a800d}.nv-stroke04{stroke:#33800d;color:#33800d}.nv-stroke05{stroke:#0d8046;color:#0d8046}.nv-stroke06{stroke:#0d806c;color:#0d806c}.nv-stroke07{stroke:#0f7799;color:#0f7799}.nv-stroke08{stroke:#1378bf;color:#1378bf}.nv-stroke09{stroke:#58595B;color:#58595B}.nv-stroke10{stroke:#1f12b3;color:#1f12b3}.nv-stroke11{stroke:#6d17e5;color:#6d17e5}.nv-stroke12{stroke:#e5176d;color:#e5176d}.nv-stroke13{stroke:#ff6fcf;color:#ff6fcf}@media screen and (max-width:767px){.nv-funnelChart .nv-label-value text.nv-label,.nv-legend .nv-series,.nv-x.nv-axis text,svg text{font-size:11px}.nv-funnelChart .nv-label-value text.nv-value{font-size:14px}}.tooltip{display:block;visibility:visible;padding:5px;font-size:11px;opacity:0;z-index:1020;text-shadow:none;font-weight:400;word-wrap:break-word;pointer-events:none}.table th,strong{font-weight:700}.tooltip.top{margin-top:-3px}.tooltip.right{margin-left:3px}.tooltip.left{margin-left:-3px}.tooltip-inner{max-width:200px;padding:3px 8px;color:#fff;text-align:center;background-color:#000;border-radius:3px;white-space:pre-wrap;word-wrap:break-word}.tooltip-inner p b{unicode-bidi:bidi-override}.tooltip-arrow{width:0;height:0;border-color:transparent;border-style:solid}body,html{position:relative;overflow:hidden;height:100%}.tooltip.top .tooltip-arrow{bottom:0;left:50%;margin-left:-5px;border-width:5px 5px 0;border-top-color:#000}.tooltip.right .tooltip-arrow{top:50%;left:0;margin-top:-5px;border-width:5px 5px 5px 0;border-right-color:#000}.tooltip.left .tooltip-arrow{top:50%;right:0;margin-top:-5px;border-width:5px 0 5px 5px;border-left-color:#000}.tooltip.bottom .tooltip-arrow{top:0;left:50%;margin-left:-5px;border-width:0 5px 5px;border-bottom-color:#000}.tooltip.bottom{margin-top:8px}.tooltip.in{opacity:1}.tooltip a,.tooltip div,.tooltip span{color:#fff}.tooltip-inner>div{text-align:left}.tooltip-inner>p{margin:0}.tooltip-inner h3{font-size:13px;color:#CDCCCB;line-height:normal;margin:3px 0}html{width:100%;font-size:24px;direction:ltr}body{margin:0;padding:0;background:#000;-webkit-tap-highlight-color:transparent;-webkit-focus-ring-color:transparent;-webkit-text-size-adjust:none;-webkit-highlight:none;tap-highlight-color:transparent;focus-ring-color:transparent;touch-callout:none;text-size-adjust:none;user-select:none;highlight:none;font-size:1em;line-height:1.286em;color:#555}fieldset,form,img,input,label,select,ul{margin:0;padding:0;border:0;outline:0}button,div,span{outline:0}#nomad{top:0;right:0;left:0}a{color:#176AE6;-webkit-touch-callout:none;outline:0;-webkit-tap-highlight-color:transparent;-webkit-focus-ring-color:transparent}.edit .control-group .controls .line-through,.line-through{text-decoration:line-through}p{margin:0 0 .643em}p small{font-size:.857em;color:#CDCCCB}h1,h3{margin:0;color:#58595B;text-rendering:optimizelegibility}h1{line-height:36px}h3{line-height:27px;font-size:18px}h3 small{font-size:14px}.close:active,.menuBtn,.navbar .nav li a{text-decoration:none}input,select,textarea{background-color:transparent;border:none;font-size:1em;color:#111}textarea{height:auto}.checkbox.inline,.radio.inline{display:inline-block;padding-top:5px;margin-bottom:0;vertical-align:middle}.checkbox.inline+.checkbox.inline,.radio.inline+.radio.inline{margin-left:10px}input[disabled],input[readonly],select[disabled],select[readonly],textarea[disabled],textarea[readonly]{cursor:not-allowed;background-color:#f5f5f5;border-color:#ddd}.control-group.warning .help-block,.control-group.warning .help-inline,.control-group.warning input,.control-group.warning select,.control-group.warning textarea,.control-group.warning>label{color:#6e5e0c}.control-group.warning .input-append .add-on,.control-group.warning .input-prepend .add-on{color:#6e5e0c;background-color:#fcf8e3}.control-group.error .help-block,.control-group.error .help-inline,.control-group.error input,.control-group.error select,.control-group.error textarea,.control-group.error>label{color:#4d1e1e}.control-group.error .input-append .add-on,.control-group.error .input-prepend .add-on{color:#4d1e1e;background-color:#f2dede}.control-group.success .help-block,.control-group.success .help-inline,.control-group.success input,.control-group.success select,.control-group.success textarea,.control-group.success>label{color:#28471c}.control-group.success .input-append .add-on,.control-group.success .input-prepend .add-on{color:#28471c;background-color:#dff0d8}::-webkit-input-placeholder{color:#cfcecd}.form-horizontal .control-group:after{display:table;clear:both}.form-horizontal .control-label{float:left;padding-top:.286rem;text-align:right;color:#343433}.email-body-content{padding:4px}.form-search .active .icon-star-o:before{content:"\\f005"}.form-search .active .icon-users:before{content:"\\f007"}table{max-width:100%;background-color:transparent;border-collapse:collapse;border-spacing:0}.btn,button.close{background:0 0;cursor:pointer}.table{width:100%;margin-bottom:18px}.table td,.table th{padding:8px;line-height:18px;text-align:left;vertical-align:top;border-bottom:1px solid #e8e8e8}.table thead th{vertical-align:bottom}.table caption+thead tr:first-child td,.table caption+thead tr:first-child th,.table colgroup+thead tr:first-child td,.table colgroup+thead tr:first-child th,.table thead:first-child tr:first-child td,.table thead:first-child tr:first-child th{border-top:0}.table tbody+tbody{border-top:2px solid #e8e8e8}/*!\n *  Font Awesome 4.2.0 by @davegandy - http://fontawesome.io - @fontawesome\n *  License - http://fontawesome.io/license (Font: SIL OFL 1.1, CSS: MIT License)\n */@font-face{font-family:FontAwesome;src:url('+i(160)+') format(\'truetype\');font-weight:400;font-style:normal}.icon{display:inline-block;font-family:FontAwesome;font-style:normal;font-weight:400;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-lg{font-size:1.33333333em;line-height:.75em;vertical-align:-15%}.btn,.icon-stack{vertical-align:middle;display:inline-block}.icon-2x{font-size:2em}.icon-3x{font-size:3em}.icon-4x{font-size:4em}.icon-5x{font-size:5em}.icon-fw{width:1.28571429em;text-align:center}.icon-ul{padding-left:0;margin-left:2.14285714em;list-style-type:none}.icon-ul>li{position:relative}.icon-li{position:absolute;left:-2.14285714em;width:2.14285714em;top:.14285714em;text-align:center}.icon-li.icon-lg{left:-1.85714286em}.icon-border{padding:.2em .25em .15em;border:.08em solid #eee;border-radius:.1em}.icon.pull-left{margin-right:.3em}.icon.pull-right{margin-left:.3em}.icon-spin{-webkit-animation:fa-spin 2s infinite linear;animation:fa-spin 2s infinite linear}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}.icon-rotate-90{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg)}.icon-rotate-180{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=2);-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.icon-rotate-270{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=3);-webkit-transform:rotate(270deg);-ms-transform:rotate(270deg);transform:rotate(270deg)}.icon-flip-horizontal{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1);-webkit-transform:scale(-1,1);-ms-transform:scale(-1,1);transform:scale(-1,1)}.icon-flip-vertical{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1);-webkit-transform:scale(1,-1);-ms-transform:scale(1,-1);transform:scale(1,-1)}.icon-stack{position:relative;width:2em;height:2em;line-height:2em}.icon-stack-1x,.icon-stack-2x{position:absolute;left:0;width:100%;text-align:center}.btn-group,.btn-group .btn,.navbar .nav{position:relative}.icon-stack-1x{line-height:inherit}.icon-stack-2x{font-size:2em}.icon-inverse{color:#fff}.icon-circle-thin:before{content:"\\f1db"}.icon-glass:before{content:"\\f000"}.icon-music:before{content:"\\f001"}.icon-search:before{content:"\\f002"}.icon-envelope-o:before{content:"\\f003"}.icon-heart:before{content:"\\f004"}.icon-star:before{content:"\\f005"}.icon-star-o:before{content:"\\f006"}.icon-user:before{content:"\\f007"}.icon-film:before{content:"\\f008"}.icon-th-large:before{content:"\\f009"}.icon-th:before{content:"\\f00a"}.icon-th-list:before{content:"\\f00b"}.icon-check:before{content:"\\f00c"}.icon-close:before,.icon-remove:before,.icon-times:before{content:"\\f00d"}.icon-search-plus:before{content:"\\f00e"}.icon-search-minus:before{content:"\\f010"}.icon-power-off:before{content:"\\f011"}.icon-signal:before{content:"\\f012"}.icon-cog:before,.icon-gear:before{content:"\\f013"}.icon-trash-o:before{content:"\\f014"}.icon-home:before{content:"\\f015"}.icon-file-o:before{content:"\\f016"}.icon-clock-o:before{content:"\\f017"}.icon-road:before{content:"\\f018"}.icon-download:before{content:"\\f019"}.icon-arrow-circle-o-down:before{content:"\\f01a"}.icon-arrow-circle-o-up:before{content:"\\f01b"}.icon-inbox:before{content:"\\f01c"}.icon-play-circle-o:before{content:"\\f01d"}.icon-repeat:before,.icon-rotate-right:before{content:"\\f01e"}.icon-refresh:before{content:"\\f021"}.icon-list-alt:before{content:"\\f022"}.icon-lock:before{content:"\\f023"}.icon-flag:before{content:"\\f024"}.icon-headphones:before{content:"\\f025"}.icon-volume-off:before{content:"\\f026"}.icon-volume-down:before{content:"\\f027"}.icon-volume-up:before{content:"\\f028"}.icon-qrcode:before{content:"\\f029"}.icon-barcode:before{content:"\\f02a"}.icon-tag:before{content:"\\f02b"}.icon-tags:before{content:"\\f02c"}.icon-book:before{content:"\\f02d"}.icon-bookmark:before{content:"\\f02e"}.icon-print:before{content:"\\f02f"}.icon-camera:before{content:"\\f030"}.icon-font:before{content:"\\f031"}.icon-bold:before{content:"\\f032"}.icon-italic:before{content:"\\f033"}.icon-text-height:before{content:"\\f034"}.icon-text-width:before{content:"\\f035"}.icon-align-left:before{content:"\\f036"}.icon-align-center:before{content:"\\f037"}.icon-align-right:before{content:"\\f038"}.icon-align-justify:before{content:"\\f039"}.icon-list:before{content:"\\f03a"}.icon-dedent:before,.icon-outdent:before{content:"\\f03b"}.icon-indent:before{content:"\\f03c"}.icon-video-camera:before{content:"\\f03d"}.icon-image:before,.icon-photo:before,.icon-picture-o:before{content:"\\f03e"}.icon-pencil:before{content:"\\f040"}.icon-map-marker:before{content:"\\f041"}.icon-adjust:before{content:"\\f042"}.icon-tint:before{content:"\\f043"}.icon-edit:before,.icon-pencil-square-o:before{content:"\\f044"}.icon-share-square-o:before{content:"\\f045"}.icon-check-square-o:before{content:"\\f046"}.icon-arrows:before{content:"\\f047"}.icon-step-backward:before{content:"\\f048"}.icon-fast-backward:before{content:"\\f049"}.icon-backward:before{content:"\\f04a"}.icon-play:before{content:"\\f04b"}.icon-pause:before{content:"\\f04c"}.icon-stop:before{content:"\\f04d"}.icon-forward:before{content:"\\f04e"}.icon-fast-forward:before{content:"\\f050"}.icon-step-forward:before{content:"\\f051"}.icon-eject:before{content:"\\f052"}.icon-chevron-left:before{content:"\\f053"}.icon-chevron-right:before{content:"\\f054"}.icon-plus-circle:before{content:"\\f055"}.icon-minus-circle:before{content:"\\f056"}.icon-times-circle:before{content:"\\f057"}.icon-check-circle:before{content:"\\f058"}.icon-question-circle:before{content:"\\f059"}.icon-info-circle:before{content:"\\f05a"}.icon-crosshairs:before{content:"\\f05b"}.icon-times-circle-o:before{content:"\\f05c"}.icon-check-circle-o:before{content:"\\f05d"}.icon-ban:before{content:"\\f05e"}.icon-arrow-left:before{content:"\\f060"}.icon-arrow-right:before{content:"\\f061"}.icon-arrow-up:before{content:"\\f062"}.icon-arrow-down:before{content:"\\f063"}.icon-mail-forward:before,.icon-share:before{content:"\\f064"}.icon-expand:before{content:"\\f065"}.icon-compress:before{content:"\\f066"}.icon-plus:before{content:"\\f067"}.icon-minus:before{content:"\\f068"}.icon-asterisk:before{content:"\\f069"}.icon-exclamation-circle:before{content:"\\f06a"}.icon-gift:before{content:"\\f06b"}.icon-leaf:before{content:"\\f06c"}.icon-fire:before{content:"\\f06d"}.icon-eye:before{content:"\\f06e"}.icon-eye-slash:before{content:"\\f070"}.icon-exclamation-triangle:before,.icon-warning:before{content:"\\f071"}.icon-plane:before{content:"\\f072"}.icon-calendar:before{content:"\\f073"}.icon-random:before{content:"\\f074"}.icon-comment:before{content:"\\f075"}.icon-magnet:before{content:"\\f076"}.icon-chevron-up:before{content:"\\f077"}.icon-chevron-down:before{content:"\\f078"}.icon-retweet:before{content:"\\f079"}.icon-shopping-cart:before{content:"\\f07a"}.icon-folder:before{content:"\\f07b"}.icon-folder-open:before{content:"\\f07c"}.icon-arrows-v:before{content:"\\f07d"}.icon-arrows-h:before{content:"\\f07e"}.icon-bar-chart-o:before,.icon-bar-chart:before{content:"\\f080"}.icon-twitter-square:before{content:"\\f081"}.icon-facebook-square:before{content:"\\f082"}.icon-camera-retro:before{content:"\\f083"}.icon-key:before{content:"\\f084"}.icon-cogs:before,.icon-gears:before{content:"\\f085"}.icon-comments:before{content:"\\f086"}.icon-thumbs-o-up:before{content:"\\f087"}.icon-thumbs-o-down:before{content:"\\f088"}.icon-star-half:before{content:"\\f089"}.icon-heart-o:before{content:"\\f08a"}.icon-sign-out:before{content:"\\f08b"}.icon-linkedin-square:before{content:"\\f08c"}.icon-thumb-tack:before{content:"\\f08d"}.icon-external-link:before{content:"\\f08e"}.icon-sign-in:before{content:"\\f090"}.icon-trophy:before{content:"\\f091"}.icon-github-square:before{content:"\\f092"}.icon-upload:before{content:"\\f093"}.icon-lemon-o:before{content:"\\f094"}.icon-phone:before{content:"\\f095"}.icon-square-o:before{content:"\\f096"}.icon-bookmark-o:before{content:"\\f097"}.icon-phone-square:before{content:"\\f098"}.icon-twitter:before{content:"\\f099"}.icon-facebook:before{content:"\\f09a"}.icon-github:before{content:"\\f09b"}.icon-unlock:before{content:"\\f09c"}.icon-credit-card:before{content:"\\f09d"}.icon-rss:before{content:"\\f09e"}.icon-hdd-o:before{content:"\\f0a0"}.icon-bullhorn:before{content:"\\f0a1"}.icon-bell:before{content:"\\f0f3"}.icon-certificate:before{content:"\\f0a3"}.icon-hand-o-right:before{content:"\\f0a4"}.icon-hand-o-left:before{content:"\\f0a5"}.icon-hand-o-up:before{content:"\\f0a6"}.icon-hand-o-down:before{content:"\\f0a7"}.icon-arrow-circle-left:before{content:"\\f0a8"}.icon-arrow-circle-right:before{content:"\\f0a9"}.icon-arrow-circle-up:before{content:"\\f0aa"}.icon-arrow-circle-down:before{content:"\\f0ab"}.icon-globe:before{content:"\\f0ac"}.icon-wrench:before{content:"\\f0ad"}.icon-tasks:before{content:"\\f0ae"}.icon-filter:before{content:"\\f0b0"}.icon-briefcase:before{content:"\\f0b1"}.icon-arrows-alt:before{content:"\\f0b2"}.icon-group:before,.icon-users:before{content:"\\f0c0"}.icon-chain:before,.icon-link:before{content:"\\f0c1"}.icon-cloud:before{content:"\\f0c2"}.icon-flask:before{content:"\\f0c3"}.icon-cut:before,.icon-scissors:before{content:"\\f0c4"}.icon-copy:before,.icon-files-o:before{content:"\\f0c5"}.icon-paperclip:before{content:"\\f0c6"}.icon-floppy-o:before,.icon-save:before{content:"\\f0c7"}.icon-square:before{content:"\\f0c8"}.icon-bars:before,.icon-navicon:before,.icon-reorder:before{content:"\\f0c9"}.icon-list-ul:before{content:"\\f0ca"}.icon-list-ol:before{content:"\\f0cb"}.icon-strikethrough:before{content:"\\f0cc"}.icon-underline:before{content:"\\f0cd"}.icon-table:before{content:"\\f0ce"}.icon-magic:before{content:"\\f0d0"}.icon-truck:before{content:"\\f0d1"}.icon-pinterest:before{content:"\\f0d2"}.icon-pinterest-square:before{content:"\\f0d3"}.icon-google-plus-square:before{content:"\\f0d4"}.icon-google-plus:before{content:"\\f0d5"}.icon-money:before{content:"\\f0d6"}.icon-caret-down:before{content:"\\f0d7"}.icon-caret-up:before{content:"\\f0d8"}.icon-caret-left:before{content:"\\f0d9"}.icon-caret-right:before{content:"\\f0da"}.icon-columns:before{content:"\\f0db"}.icon-sort:before,.icon-unsorted:before{content:"\\f0dc"}.icon-sort-desc:before,.icon-sort-down:before{content:"\\f0dd"}.icon-sort-asc:before,.icon-sort-up:before{content:"\\f0de"}.icon-envelope:before{content:"\\f0e0"}.icon-linkedin:before{content:"\\f0e1"}.icon-rotate-left:before,.icon-undo:before{content:"\\f0e2"}.icon-gavel:before,.icon-legal:before{content:"\\f0e3"}.icon-dashboard:before,.icon-tachometer:before{content:"\\f0e4"}.icon-comment-o:before{content:"\\f0e5"}.icon-comments-o:before{content:"\\f0e6"}.icon-bolt:before,.icon-flash:before{content:"\\f0e7"}.icon-sitemap:before{content:"\\f0e8"}.icon-umbrella:before{content:"\\f0e9"}.icon-clipboard:before,.icon-paste:before{content:"\\f0ea"}.icon-lightbulb-o:before{content:"\\f0eb"}.icon-exchange:before{content:"\\f0ec"}.icon-cloud-download:before{content:"\\f0ed"}.icon-cloud-upload:before{content:"\\f0ee"}.icon-user-md:before{content:"\\f0f0"}.icon-stethoscope:before{content:"\\f0f1"}.icon-suitcase:before{content:"\\f0f2"}.icon-bell-o:before{content:"\\f0a2"}.icon-coffee:before{content:"\\f0f4"}.icon-cutlery:before{content:"\\f0f5"}.icon-file-text-o:before{content:"\\f0f6"}.icon-building-o:before{content:"\\f0f7"}.icon-hospital-o:before{content:"\\f0f8"}.icon-ambulance:before{content:"\\f0f9"}.icon-medkit:before{content:"\\f0fa"}.icon-fighter-jet:before{content:"\\f0fb"}.icon-beer:before{content:"\\f0fc"}.icon-h-square:before{content:"\\f0fd"}.icon-plus-square:before{content:"\\f0fe"}.icon-angle-double-left:before{content:"\\f100"}.icon-angle-double-right:before{content:"\\f101"}.icon-angle-double-up:before{content:"\\f102"}.icon-angle-double-down:before{content:"\\f103"}.icon-angle-left:before{content:"\\f104"}.icon-angle-right:before{content:"\\f105"}.icon-angle-up:before{content:"\\f106"}.icon-angle-down:before{content:"\\f107"}.icon-desktop:before{content:"\\f108"}.icon-laptop:before{content:"\\f109"}.icon-tablet:before{content:"\\f10a"}.icon-mobile-phone:before,.icon-mobile:before{content:"\\f10b"}.icon-circle-o:before{content:"\\f10c"}.icon-quote-left:before{content:"\\f10d"}.icon-quote-right:before{content:"\\f10e"}.icon-spinner:before{content:"\\f110"}.icon-circle:before{content:"\\f111"}.icon-mail-reply:before,.icon-reply:before{content:"\\f112"}.icon-github-alt:before{content:"\\f113"}.icon-folder-o:before{content:"\\f114"}.icon-folder-open-o:before{content:"\\f115"}.icon-smile-o:before{content:"\\f118"}.icon-frown-o:before{content:"\\f119"}.icon-meh-o:before{content:"\\f11a"}.icon-gamepad:before{content:"\\f11b"}.icon-keyboard-o:before{content:"\\f11c"}.icon-flag-o:before{content:"\\f11d"}.icon-flag-checkered:before{content:"\\f11e"}.icon-terminal:before{content:"\\f120"}.icon-code:before{content:"\\f121"}.icon-mail-reply-all:before,.icon-reply-all:before{content:"\\f122"}.icon-star-half-empty:before,.icon-star-half-full:before,.icon-star-half-o:before{content:"\\f123"}.icon-location-arrow:before{content:"\\f124"}.icon-crop:before{content:"\\f125"}.icon-code-fork:before{content:"\\f126"}.icon-chain-broken:before,.icon-unlink:before{content:"\\f127"}.icon-question:before{content:"\\f128"}.icon-info:before{content:"\\f129"}.icon-exclamation:before{content:"\\f12a"}.icon-superscript:before{content:"\\f12b"}.icon-subscript:before{content:"\\f12c"}.icon-eraser:before{content:"\\f12d"}.icon-puzzle-piece:before{content:"\\f12e"}.icon-microphone:before{content:"\\f130"}.icon-microphone-slash:before{content:"\\f131"}.icon-shield:before{content:"\\f132"}.icon-calendar-o:before{content:"\\f133"}.icon-fire-extinguisher:before{content:"\\f134"}.icon-rocket:before{content:"\\f135"}.icon-maxcdn:before{content:"\\f136"}.icon-chevron-circle-left:before{content:"\\f137"}.icon-chevron-circle-right:before{content:"\\f138"}.icon-chevron-circle-up:before{content:"\\f139"}.icon-chevron-circle-down:before{content:"\\f13a"}.icon-html5:before{content:"\\f13b"}.icon-css3:before{content:"\\f13c"}.icon-anchor:before{content:"\\f13d"}.icon-unlock-alt:before{content:"\\f13e"}.icon-bullseye:before{content:"\\f140"}.icon-ellipsis-h:before{content:"\\f141"}.icon-ellipsis-v:before{content:"\\f142"}.icon-rss-square:before{content:"\\f143"}.icon-play-circle:before{content:"\\f144"}.icon-ticket:before{content:"\\f145"}.icon-minus-square:before{content:"\\f146"}.icon-minus-square-o:before{content:"\\f147"}.icon-level-up:before{content:"\\f148"}.icon-level-down:before{content:"\\f149"}.icon-check-square:before{content:"\\f14a"}.icon-pencil-square:before{content:"\\f14b"}.icon-external-link-square:before{content:"\\f14c"}.icon-share-square:before{content:"\\f14d"}.icon-compass:before{content:"\\f14e"}.icon-caret-square-o-down:before,.icon-toggle-down:before{content:"\\f150"}.icon-caret-square-o-up:before,.icon-toggle-up:before{content:"\\f151"}.icon-caret-square-o-right:before,.icon-toggle-right:before{content:"\\f152"}.icon-eur:before,.icon-euro:before{content:"\\f153"}.icon-gbp:before{content:"\\f154"}.icon-dollar:before,.icon-usd:before{content:"\\f155"}.icon-inr:before,.icon-rupee:before{content:"\\f156"}.icon-cny:before,.icon-jpy:before,.icon-rmb:before,.icon-yen:before{content:"\\f157"}.icon-rouble:before,.icon-rub:before,.icon-ruble:before{content:"\\f158"}.icon-krw:before,.icon-won:before{content:"\\f159"}.icon-bitcoin:before,.icon-btc:before{content:"\\f15a"}.icon-file:before{content:"\\f15b"}.icon-file-text:before{content:"\\f15c"}.icon-sort-alpha-asc:before{content:"\\f15d"}.icon-sort-alpha-desc:before{content:"\\f15e"}.icon-sort-amount-asc:before{content:"\\f160"}.icon-sort-amount-desc:before{content:"\\f161"}.icon-sort-numeric-asc:before{content:"\\f162"}.icon-sort-numeric-desc:before{content:"\\f163"}.icon-thumbs-up:before{content:"\\f164"}.icon-thumbs-down:before{content:"\\f165"}.icon-youtube-square:before{content:"\\f166"}.icon-youtube:before{content:"\\f167"}.icon-xing:before{content:"\\f168"}.icon-xing-square:before{content:"\\f169"}.icon-youtube-play:before{content:"\\f16a"}.icon-dropbox:before{content:"\\f16b"}.icon-stack-overflow:before{content:"\\f16c"}.icon-instagram:before{content:"\\f16d"}.icon-flickr:before{content:"\\f16e"}.icon-adn:before{content:"\\f170"}.icon-bitbucket:before{content:"\\f171"}.icon-bitbucket-square:before{content:"\\f172"}.icon-tumblr:before{content:"\\f173"}.icon-tumblr-square:before{content:"\\f174"}.icon-long-arrow-down:before{content:"\\f175"}.icon-long-arrow-up:before{content:"\\f176"}.icon-long-arrow-left:before{content:"\\f177"}.icon-long-arrow-right:before{content:"\\f178"}.icon-apple:before{content:"\\f179"}.icon-windows:before{content:"\\f17a"}.icon-android:before{content:"\\f17b"}.icon-linux:before{content:"\\f17c"}.icon-dribbble:before{content:"\\f17d"}.icon-skype:before{content:"\\f17e"}.icon-foursquare:before{content:"\\f180"}.icon-trello:before{content:"\\f181"}.icon-female:before{content:"\\f182"}.icon-male:before{content:"\\f183"}.icon-gittip:before{content:"\\f184"}.icon-sun-o:before{content:"\\f185"}.icon-moon-o:before{content:"\\f186"}.icon-archive:before{content:"\\f187"}.icon-bug:before{content:"\\f188"}.icon-vk:before{content:"\\f189"}.icon-weibo:before{content:"\\f18a"}.icon-renren:before{content:"\\f18b"}.icon-pagelines:before{content:"\\f18c"}.icon-stack-exchange:before{content:"\\f18d"}.icon-arrow-circle-o-right:before{content:"\\f18e"}.icon-arrow-circle-o-left:before{content:"\\f190"}.icon-caret-square-o-left:before,.icon-toggle-left:before{content:"\\f191"}.icon-dot-circle-o:before{content:"\\f192"}.icon-wheelchair:before{content:"\\f193"}.icon-vimeo-square:before{content:"\\f194"}.icon-try:before,.icon-turkish-lira:before{content:"\\f195"}.icon-plus-square-o:before{content:"\\f196"}.icon-space-shuttle:before{content:"\\f197"}.icon-slack:before{content:"\\f198"}.icon-envelope-square:before{content:"\\f199"}.icon-wordpress:before{content:"\\f19a"}.icon-openid:before{content:"\\f19b"}.icon-bank:before,.icon-institution:before,.icon-university:before{content:"\\f19c"}.icon-graduation-cap:before,.icon-mortar-board:before{content:"\\f19d"}.icon-yahoo:before{content:"\\f19e"}.icon-google:before{content:"\\f1a0"}.icon-reddit:before{content:"\\f1a1"}.icon-reddit-square:before{content:"\\f1a2"}.icon-stumbleupon-circle:before{content:"\\f1a3"}.icon-stumbleupon:before{content:"\\f1a4"}.icon-delicious:before{content:"\\f1a5"}.icon-digg:before{content:"\\f1a6"}.icon-pied-piper:before{content:"\\f1a7"}.icon-pied-piper-alt:before{content:"\\f1a8"}.icon-drupal:before{content:"\\f1a9"}.icon-joomla:before{content:"\\f1aa"}.icon-language:before{content:"\\f1ab"}.icon-fax:before{content:"\\f1ac"}.icon-building:before{content:"\\f1ad"}.icon-child:before{content:"\\f1ae"}.icon-paw:before{content:"\\f1b0"}.icon-spoon:before{content:"\\f1b1"}.icon-cube:before{content:"\\f1b2"}.icon-cubes:before{content:"\\f1b3"}.icon-behance:before{content:"\\f1b4"}.icon-behance-square:before{content:"\\f1b5"}.icon-steam:before{content:"\\f1b6"}.icon-steam-square:before{content:"\\f1b7"}.icon-recycle:before{content:"\\f1b8"}.icon-automobile:before,.icon-car:before{content:"\\f1b9"}.icon-cab:before,.icon-taxi:before{content:"\\f1ba"}.icon-tree:before{content:"\\f1bb"}.icon-spotify:before{content:"\\f1bc"}.icon-deviantart:before{content:"\\f1bd"}.icon-soundcloud:before{content:"\\f1be"}.icon-database:before{content:"\\f1c0"}.icon-file-pdf-o:before{content:"\\f1c1"}.icon-file-word-o:before{content:"\\f1c2"}.icon-file-excel-o:before{content:"\\f1c3"}.icon-file-powerpoint-o:before{content:"\\f1c4"}.icon-file-image-o:before,.icon-file-photo-o:before,.icon-file-picture-o:before{content:"\\f1c5"}.icon-file-archive-o:before,.icon-file-zip-o:before{content:"\\f1c6"}.icon-file-audio-o:before,.icon-file-sound-o:before{content:"\\f1c7"}.icon-file-movie-o:before,.icon-file-video-o:before{content:"\\f1c8"}.icon-file-code-o:before{content:"\\f1c9"}.icon-vine:before{content:"\\f1ca"}.icon-codepen:before{content:"\\f1cb"}.icon-jsfiddle:before{content:"\\f1cc"}.icon-life-bouy:before,.icon-life-buoy:before,.icon-life-ring:before,.icon-life-saver:before,.icon-support:before{content:"\\f1cd"}.icon-circle-o-notch:before{content:"\\f1ce"}.icon-ra:before,.icon-rebel:before{content:"\\f1d0"}.icon-empire:before,.icon-ge:before{content:"\\f1d1"}.icon-git-square:before{content:"\\f1d2"}.icon-git:before{content:"\\f1d3"}.icon-hacker-news:before{content:"\\f1d4"}.icon-tencent-weibo:before{content:"\\f1d5"}.icon-qq:before{content:"\\f1d6"}.icon-wechat:before,.icon-weixin:before{content:"\\f1d7"}.icon-paper-plane:before,.icon-send:before{content:"\\f1d8"}.icon-paper-plane-o:before,.icon-send-o:before{content:"\\f1d9"}.icon-history:before{content:"\\f1da"}.icon-header:before{content:"\\f1dc"}.icon-paragraph:before{content:"\\f1dd"}.icon-sliders:before{content:"\\f1de"}.icon-share-alt:before{content:"\\f1e0"}.icon-share-alt-square:before{content:"\\f1e1"}.icon-bomb:before{content:"\\f1e2"}.icon-futbol-o:before,.icon-soccer-ball-o:before{content:"\\f1e3"}.icon-tty:before{content:"\\f1e4"}.icon-binoculars:before{content:"\\f1e5"}.icon-plug:before{content:"\\f1e6"}.icon-slideshare:before{content:"\\f1e7"}.icon-twitch:before{content:"\\f1e8"}.icon-yelp:before{content:"\\f1e9"}.icon-newspaper-o:before{content:"\\f1ea"}.icon-wifi:before{content:"\\f1eb"}.icon-calculator:before{content:"\\f1ec"}.icon-paypal:before{content:"\\f1ed"}.icon-google-wallet:before{content:"\\f1ee"}.icon-cc-visa:before{content:"\\f1f0"}.icon-cc-mastercard:before{content:"\\f1f1"}.icon-cc-discover:before{content:"\\f1f2"}.icon-cc-amex:before{content:"\\f1f3"}.icon-cc-paypal:before{content:"\\f1f4"}.icon-cc-stripe:before{content:"\\f1f5"}.icon-bell-slash:before{content:"\\f1f6"}.icon-bell-slash-o:before{content:"\\f1f7"}.icon-trash:before{content:"\\f1f8"}.icon-copyright:before{content:"\\f1f9"}.icon-at:before{content:"\\f1fa"}.icon-eyedropper:before{content:"\\f1fb"}.icon-paint-brush:before{content:"\\f1fc"}.icon-birthday-cake:before{content:"\\f1fd"}.icon-area-chart:before{content:"\\f1fe"}.icon-pie-chart:before{content:"\\f200"}.icon-line-chart:before{content:"\\f201"}.icon-lastfm:before{content:"\\f202"}.icon-lastfm-square:before{content:"\\f203"}.icon-toggle-off:before{content:"\\f204"}.icon-toggle-on:before{content:"\\f205"}.icon-bicycle:before{content:"\\f206"}.icon-bus:before{content:"\\f207"}.icon-ioxhost:before{content:"\\f208"}.icon-angellist:before{content:"\\f209"}.icon-cc:before{content:"\\f20a"}.icon-ils:before,.icon-shekel:before,.icon-sheqel:before{content:"\\f20b"}.icon-meanpath:before{content:"\\f20c"}.close{float:right;font-size:20px;font-weight:700;line-height:18px;color:#000;text-shadow:0 1px 0 #fff;opacity:.2}.close:active{color:#000;cursor:pointer;opacity:.4}button.close{padding:0;border:0;-webkit-appearance:none}.btn{padding:4px 10px;margin:0;font-size:1em;line-height:1.286em;color:#58595B;font-weight:500;text-align:center;border-radius:2px;border:none;outline:0}.btn.active{background-color:#3f4041;background-image:none;color:#f5f5f5!important;outline:0}.btn.disabled,.btn[disabled]{background-color:#e6e6e6;background-image:none}.btn.btn-inverse.disabled,.btn.btn-inverse[disabled]{background-color:#202020;color:#2c2c2c!important}.btn-large{padding:9px 14px;font-size:26px;line-height:normal;border-radius:5px}.btn-large .icon{margin-top:1px}.btn-small{padding:5px 9px;font-size:22px;line-height:16px}.btn-small .icon{margin-top:-1px}.btn-mini{padding:2px 6px;font-size:22px;line-height:14px}.btn-danger,.btn-info,.btn-inverse,.btn-primary,.btn-success,.btn-warning{color:#fff}.btn-danger.active,.btn-info.active,.btn-inverse.active,.btn-primary.active,.btn-success.active,.btn-warning.active{color:rgba(255,255,255,.75)}.btn{background-color:transparent}.btn-area-more.selected-item .btn,.btn.selected-item{background-color:#000}.btn-primary{background-color:#176de5}.btn-area-more.selected-item .btn-primary,.btn-primary.disabled,.btn-primary.selected-item{background-color:#1257b7}.btn-warning{background-color:#cc3314}.btn-danger{background-color:#c72516}.btn-success{background-color:#33800d}.btn-info{background-color:#71a6f1}.btn-inverse{background-color:#000}.btn-inverse.selected-item{background-color:#202020}.btn-transparent{background-color:transparent;border:1px solid #717171}.btn-filter{display:inline-block;min-width:20px;height:30px;line-height:30px;padding:0 5px;border:1px solid #d4d4d4;border-radius:2px;box-shadow:0 1px rgba(212,212,212,.75);text-align:center;color:#575757;opacity:.75;font-size:.857rem}.btn-filter.selected-item{background:#d4d4d4}.btn-filter.active{background-color:#c1c0c0;background-image:-webkit-gradient(linear,0 0,0 100%,from(#b5b3b3),to(#d4d4d4));background-image:-webkit-linear-gradient(top,#b5b3b3,#d4d4d4);background-image:linear-gradient(top,#b5b3b3,#d4d4d4);background-repeat:repeat-x;box-shadow:none}.btn-group:after{display:table;clear:both}.btn-group+.btn-group{margin-left:5px}.btn-group .btn{float:left;margin-left:-1px;border:1px solid #CDCCCB;border-radius:0}.btn-group .btn:first-child{margin-left:0;border-top-left-radius:3px;border-bottom-left-radius:3px}.btn-group .btn:last-child,.btn-group .dropdown-toggle{border-top-right-radius:3px;border-bottom-right-radius:3px}.btn-group .btn.active,.btn-group .btn:active{z-index:2}.navbar-inner{background:#2d2d2d;border-bottom:4px solid #e61718}.navbar .nav{left:0;display:block;margin:0 10px 0 0;list-style:none}.dashboard,.dashlets__slider-area{position:absolute;overflow:hidden;top:0;right:0;left:0}.navbar .nav.pull-right{float:right}.navbar .nav li a{display:block;line-height:1.357rem;text-shadow:0 -1px 1px rgba(0,0,0,.25)}.navbar .nav li.current a{background:rgba(0,0,0,.5)}.badge,.label{font-size:20.3px;line-height:14px;color:#fff;vertical-align:baseline;white-space:nowrap;background-color:#CDCCCB}.label{padding:1px 4px 2px;border-radius:3px}.badge{padding:1px 9px 2px;border-radius:9px}a.badge:hover,a.label:hover{color:#fff;text-decoration:none;cursor:pointer}.c-,.dashlet__item{background-color:#9F9F9F}.c-active-tasks{background-color:#73AC56}.c-planned-activities{background-color:#7CB1F2}.c-inactive-tasks{background-color:#9C5BDD}.c-bubblechart{background-color:#CE595A}.c-history{background-color:#EDC75C}.c-saved-reports-chart{background-color:#E35EA7}.c-activitystream-dashlet{background-color:#F5744C}.c-forecast-pipeline{background-color:#6CB86F}.c-forecastdetails{background-color:#5EA0D4}.c-webpage{background-color:#F96666}.c-dashablelist{background-color:#DAB652}.c-forecast-pareto{background-color:#CD7CDE}.c-twitter{background-color:#599EFF}.c-opportunity-metrics{background-color:#6D2AE1}.c-casessummary{background-color:#871014}.dashlets__list,.dashlets__slider .dashlet__b:empty,.pagination__bar,.tabs__bar{background:#fff}.layout__Dashboards .backBtn{display:none}.layout__Dashboards.show-paginator .backBtn{display:block}.dashboard .dashlets__slider-area{visibility:hidden}.dashboard+.pagination__bar{display:none}.show-paginator .dashboard{bottom:51px}.show-paginator .dashboard+.pagination__bar{display:block}.show-dashlets .dashboard .dashlets__list{display:none}.show-dashlets .dashboard .dashlets__slider-area{visibility:visible}.show-dashlets .dashboard .dashlets__slider{display:-webkit-box;display:-webkit-flex;display:flex}.dashlets__slider-area{z-index:1;bottom:0}.dashlets__list{position:relative;z-index:2;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch;height:100%;padding:10px;-webkit-box-sizing:border-box;box-sizing:border-box}.dashlets__list:after{display:table;clear:both}.dashlets__list .dashlet__item{overflow:hidden;min-height:90px;border-radius:6px;-webkit-box-sizing:border-box;box-sizing:border-box;font-size:1rem;text-align:center;color:#fff}.dashlets__list .dashlet__item .dashlet__title{display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:15px 10px 12px;text-transform:uppercase}.dashlets__list .dashlet__item .dashlet__icon{height:45px}.dashlets__list .dashlet__item .icon{font-size:30px;line-height:1em}.dashlets__list .dashlet__item.selected-item{opacity:.9}.dashlets__list__col{float:left;padding:5px;width:50%;-webkit-box-sizing:border-box;box-sizing:border-box}.layout__detail .dashlets__list__col{width:50%}@media screen and (min-width:700px){.dashlets__list__col{width:33.33333333%}}@media screen and (min-width:768px){.dashlets__list__col{width:25%}}@media screen and (min-width:1024px){.dashlets__list__col{width:20%}.layout__detail .dashlets__list__col{width:33.33333333%}}.dashlets__title{position:relative;width:100%;height:44px;line-height:44px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-align:center;background:#fff;font-size:1.143rem;font-weight:700;display:none;z-index:1}.dashlets__title.show+.dashlets__slider-area{top:44px}.dashlets__slider{position:relative;width:100%;height:100%;z-index:1;display:-webkit-box;display:-webkit-flex;display:flex;box-shadow:content-box;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;-webkit-transition-property:-webkit-transform;transition-property:transform}.dashlets__slider .dashlet__b,.tabs__bar{display:-webkit-box;display:-webkit-flex}.dashlets__slider .dashlet__b{height:100%;position:relative;display:flex;transform-style:preserve-3d;-webkit-flex-shrink:0;flex-shrink:0}.pagination__bar{position:absolute;bottom:0;left:0;right:0;height:50px;line-height:50px;border-top:solid 1px #e5e5e5;text-align:center;color:#676767}.panel__addpost .btn,.panel__addpost .placeholder{white-space:nowrap;line-height:1.571rem;overflow:hidden;text-overflow:ellipsis}.pagination__bar .icon{height:50px;padding:0 2px;margin:0 2px;font-size:10px}.pagination__bar .icon.disabled{color:#ccc}.pagination__bar .next,.pagination__bar .prev{padding:0 12px;font-size:20px}.pagination__bar .prev{float:left}.pagination__bar .next{float:right}.pagination__bar .icon-circle-thin{color:#a8a8a8}.hide-tab{display:block;visibility:hidden}.tabbed__dashlet{position:absolute;top:0;right:0;bottom:0;left:0}.tabbed__dashlet .tabs__bar{position:absolute;z-index:2}.tabbed__dashlet.has-dashlet-options .easy-scroller-parent{top:40px}.tabs__bar{position:relative;width:100%;height:54px;display:flex;flex-flow:wrap;border-bottom:solid 1px #d8d8d8;z-index:2}.tabs__bar .tab{position:relative;-webkit-box-flex:1;-webkit-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-flex-align:center;-webkit-align-items:center;align-items:center;border-bottom:4px solid transparent;list-style:none}.tabs__bar .tab:after{position:absolute;top:100%;left:0;right:0;height:17px;background:0 0;content:\' \'}.tabs__bar .tab.selected-item{background:#f6f6f6}.tabs__bar .tab .tab__title{overflow:hidden;display:block;width:100%;max-height:54px;font-size:1rem;text-align:center}.tabs__bar .tab .title{display:-webkit-box;overflow:hidden;-webkit-line-clamp:1;-webkit-box-orient:vertical}.dropdown li .name,.line-clamp,.navbar .navbar-inner .nomad{-webkit-line-clamp:2;-webkit-box-orient:vertical}.tabs__bar .tab .count{display:inline-block;font-size:.857rem;min-width:22px;width:auto;padding:3px;background-color:#e61718;border-color:#e61718;border-radius:3px;margin:2px 0;color:#fff}.tabs__bar .active-tab{border-color:#e61718;color:#e61718}.tabs__bar--dd{height:55px;padding:0 10px;-webkit-box-align:center;-webkit-flex-align:center;-webkit-align-items:center;align-items:center;border-bottom:1px solid;background:#f6f6f6}.tabs__container{position:absolute;top:0;right:0;bottom:0;left:0;overflow:hidden}.tabs__container .easy-scroller-holder{background:#fff}.tabs__bar+.tabs__container{top:55px}.activitystream-item{padding:0!important;border-top:1px solid #d8d8d8}.panel__addpost{display:-webkit-box;display:-webkit-flex;display:flex;padding:8px 10px}.panel__addpost .btn{display:block;opacity:.5}.panel__addpost .placeholder{-webkit-box-flex:1;-webkit-flex:1;flex:1;display:block;padding:4px 5px;margin-right:10px;border:1px solid #ccc;border-radius:2px;color:#cfcecd}.as__detail{position:relative;min-height:46px;padding:8px 32px 8px 46px}.as__detail .as__icon,.as__detail .label-module-sm{float:left;margin:4px 0 0 -36px}.as__detail .icon-user{border:2px solid #999}.as__detail .as__title{padding-bottom:2px}.as__detail .as__info{font-size:.785rem;color:#717171}.comments-container{margin-left:46px}.comment__item{overflow:hidden;border-top:1px dotted #d8d8d8;padding:6px 10px 6px 38px;font-size:.857rem}.comment__item .icon-user{float:left;margin:4px 0 0 -38px;border:2px solid #999}.comment__item .comment__info{padding-top:3px;font-size:.785rem;color:#717171}.comments-more-btn{display:block;padding:10px 0;border-top:1px dotted #d8d8d8}.sugar_tag{display:inline-block;padding:2px 4px 1px;border-radius:2px;color:#fff;background:#000}.tb__detail{padding-top:4px}.tb__detail .tb__icon{float:left;padding:2px 5px 0 0}.tb__detail .tb__info{color:#717171}.tb__detail .icon-user{border:2px solid #999}.view__taggable{position:relative;height:100%;background:#fff}.taggable,.taggable-shadow{position:absolute;top:0;height:100%;width:100%;padding:20px;white-space:pre-wrap;word-wrap:break-word;text-indent:0;display:block;resize:none;-webkit-box-sizing:border-box;-webkit-line-break:after-white-space;-webkit-appearance:none;overflow-x:hidden;overflow-y:scroll;line-height:1.286rem}.taggable{-webkit-overflow-scrolling:auto;background-color:transparent;z-index:4;-webkit-box-shadow:0;letter-spacing:0}.ios .taggable{-webkit-transform:translate3d(-4px,0,0);transform:translate3d(-4px,0,0);left:0;right:-10px;width:auto}.taggable-shadow{background:#fff;border-color:transparent;color:transparent;left:0;right:0;top:0;bottom:0;pointer:none;-webkit-user-select:none;word-spacing:0;letter-spacing:normal}.taggable-shadow .sugar_tag{display:inline;position:relative;z-index:5;padding:0;color:#fff}.chart-wrapper,.taggable-dropdown{position:absolute;background:#fff;left:0}.taggable-dropdown{top:100px;bottom:0;right:0;overflow-y:scroll;border-top:solid 1px #2d2d2d;border-bottom:solid 1px #2d2d2d;z-index:5}.taggable-dropdown .taggable-listItem{padding:0 10px;line-height:2.5rem;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.taggable-dropdown .taggable-status{float:right;font-style:italic}.taggable-dropdown .label-module-sm{margin:0 10px 0 0;vertical-align:middle}.show-dropdown .taggable,.show-dropdown .taggable-shadow{height:60px}.show-dropdown .taggable-dropdown{top:60px}.nv-chart{height:100%}.chart-wrapper{width:100%;min-height:100%;top:0;overflow-y:auto}.chart-wrapper.has-scroll{position:static}.chart-wrapper .chart{position:absolute;top:0;left:0;right:0;bottom:0}.chart-wrapper.has-dashlet-options .chart{top:40px}.chart-wrapper .warning-message{padding:20px 0}.forecast-details .fd__b{padding:20px}.forecast-details .fd__b .row-fluid{padding:10px;border-bottom:1px solid #e9e9e9;box-sizing:border-box}.forecast-details .fd__b .row-fluid:after{clear:both;display:table;content:"";line-height:0}.forecast-details .fd__b .row-fluid.deficitRow{border-top:1px solid #e9e9e9;font-weight:600}.forecast-details .fd__b .row-fluid.deficitRow.font-green{color:#33800d}.forecast-details .fd__b .row-fluid.deficitRow.font-red{color:#e61718}.forecast-details .fd__b .row-fluid.details-cols{padding:10px 0;border-bottom:none}.forecast-details .fd__b .row-fluid .span1{float:left;width:100%}.forecast-details .fd__b .row-fluid .span2{float:left;width:48.9%;margin-left:2.2%}.forecast-details .fd__b .row-fluid .span2:first-child{margin-left:0}.forecast-details .fd__b .row-fluid .span3{float:left;width:32%;margin-left:2%}.forecast-details .fd__b .row-fluid .span3:first-child{margin-left:0}.forecast-details .fd__b .row-fluid .ellipsis_inline{display:block!important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.forecast-details .fd__b .row-fluid .ellipsis_inline.green{background:#33800d}.forecast-details .fd__b .row-fluid .ellipsis_inline.grayLight{background:#717171}.forecast-details .fd__b .row-fluid .ellipsis_inline.red{background:#e61718}.forecast-details .fd__b .row-fluid .ellipsis_inline .forecast_details_amount,.forecast-details .fd__b .row-fluid .ellipsis_inline .forecast_details_feedback,.forecast-details .fd__b .row-fluid .ellipsis_inline .forecast_details_label{display:block}.forecast-details .fd__b .row-fluid:last-child div[class*=span]>.forecast_details_likely_feedback{font-size:11px;line-height:16px;color:#fff;border-radius:3px;padding:8px;margin-top:4px}.forecast-details .fd__b .row-fluid .forecast_details_no_access{padding:3px 6px;color:#fff;background:#666;border-radius:4px;font-size:11px;display:inline-block;margin-top:3px}.forecast-details .warning-message{padding:20px}@media screen and (max-height:360px){.landscape .forecast-details .fd__b{padding:5px 20px 20px}.landscape .forecast-details .fd__b .row-fluid{padding:5px}.landscape .forecast-details .fd__b .row-fluid .ellipsis_inline .forecast_details_amount,.landscape .forecast-details .fd__b .row-fluid .ellipsis_inline .forecast_details_amount .fdf_ln1,.landscape .forecast-details .fd__b .row-fluid .ellipsis_inline .forecast_details_feedback,.landscape .forecast-details .fd__b .row-fluid .ellipsis_inline .forecast_details_feedback .fdf_ln1,.landscape .forecast-details .fd__b .row-fluid .ellipsis_inline .forecast_details_label,.landscape .forecast-details .fd__b .row-fluid .ellipsis_inline .forecast_details_label .fdf_ln1{display:inline}}.filters-wrap{display:-webkit-box;display:-webkit-flex;display:flex;padding:5px 5px 5px 10px}.filter{white-space:nowrap;padding-right:20px}.filter .control-label,.filter .placeholder{display:none}.filter .actionsheet-select,.filter select{position:relative;padding-right:16px;-webkit-appearance:none;z-index:1}.dashlet-options{position:relative;height:40px;background:#fff;border-bottom:1px solid #e5e5e5;z-index:2;display:-webkit-box;display:-webkit-flex;display:flex}.dashlet-options .dashlet-options_bigbar{-webkit-box-flex:1;-webkit-flex:1;flex:1}.dashlet-options .visibility-switcher{min-height:28px;padding:5px}.dashlet-options .my-items-btn{width:32px;height:36px;line-height:36px;padding:0;border:none;font-size:16px;text-align:center;color:#555;position:absolute;top:0;right:5px}.dashlet-options .my-items-btn.active{background-color:transparent;color:inherit!important}.dashlet-options .my-items-btn.active .icon-users:before{content:"\\f007"}.twitter-wrapper .tw__user_icon{border:none!important;border-radius:5px!important;background-color:#fff}.twitter-wrapper .tw__as__title{padding-top:2px}.twitter-wrapper .tw__as_profile_link{color:#585858}.twitter-wrapper .tw__as_content_url{word-wrap:break-word;width:100%}.dashlet-webpage{height:100%;width:100%;background:#fff}.dashlet-webpage .wp__wrapper{position:absolute;top:40%;left:0;right:0;text-align:center}.dashlet-webpage .wp__container{display:inline-block;min-width:60%;max-width:70%;border:1px solid #ddd;padding:5px;-webkit-border-radius:3px;background-color:#f5f5f5}.dashlet-webpage .wp__favlogo{position:absolute;float:left;top:38%;padding-left:10px;color:#666}.dashlet-webpage .wp__content{overflow:hidden;text-align:left;padding-left:35px}.dashlet-webpage .wp__title{right:auto;padding:2px;color:#000}.dashlet-webpage .wp__url{font-size:.885rem;right:auto;padding:2px;word-wrap:break-word}.donut-chart{position:absolute;width:100%;height:100%;left:0;top:0}.donut-chart .nv-chart{position:absolute;width:100%;height:auto;min-height:50px;min-width:100px;top:0;bottom:0}.donut-chart .donut-chart-metric-container{position:absolute;width:100%;height:auto;bottom:0;left:0}.donut-chart .chart-metric{text-align:center;width:33%;position:relative;border-top:1px solid #e8e8e8;border-right:1px solid #e8e8e8;float:left;padding:14px 0 4px;-webkit-box-sizing:border-box;box-sizing:border-box;bottom:0}.donut-chart .chart-metric:last-child{border-right:none}.donut-chart .chart-metric span.label{width:26px;height:26px;padding:3px;position:absolute;top:-22px;left:50%;margin-left:-12px;border:none;font-size:1rem;line-height:1.786rem}.donut-chart .chart-metric div.metric-description span{float:none;display:inline-block;font-weight:700;font-size:10px;text-align:center;text-shadow:0 1px 0 #636363;margin-right:3px!important}.altview,.background,.vis_action_hidden{display:none}.donut-chart .chart-metric div.metric-amount{font-weight:700;-webkit-box-sizing:border-box;box-sizing:border-box}.opportunity-metrics-wrapper{position:absolute;height:100%;width:100%}.opportunity-metrics-wrapper .nv-chart{bottom:70px}.opportunity-metrics-wrapper .nv-chart .active{fill:#176de5}.opportunity-metrics-wrapper .nv-chart .won{fill:#33800d}.opportunity-metrics-wrapper .nv-chart .lost{fill:#e61718}.dropdown li.filters-preloader .icon-spinner .icon-spinner-path,.listing article.nav .loading-holder .icon-spinner .icon-spinner-path,.view__search .icon-spinner .icon-spinner-path{fill:#c2c2c2}.opportunity-metrics-wrapper .chart-metric span.label.won{background-color:#33800d}.opportunity-metrics-wrapper .chart-metric span.label.lost{background-color:#e61718}.opportunity-metrics-wrapper .chart-metric span.label.active{background-color:#176de5}.opportunity-metrics-wrapper .chart-metric div.metric-amount.won{color:#33800d}.opportunity-metrics-wrapper .chart-metric div.metric-amount.lost{color:#e61718}.opportunity-metrics-wrapper .chart-metric div.metric-amount.active{color:#176de5}.background{position:absolute!important;top:50px;left:0;right:0;bottom:0;background:#fff;z-index:9999!important}.fno{float:none!important}.fleft{float:left!important}.fright{float:right!important}h1,h2,h3,h4,h5,h6{font-family:"Open Sans",arial,sans-serif;font-weight:400}h1{font-size:26px}.ellipsis{display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.line-clamp{display:-webkit-box;overflow:hidden}input[type=checkbox]{-webkit-appearance:none;width:1.286rem;height:1.286rem;border-width:1px;border-style:solid;border-color:#999;border-radius:3px}input[type=checkbox]:checked:after{content:"\\2713";font-size:130%;line-height:16px}input[type=checkbox].custom{position:relative;border:none;background:0 0;box-shadow:none;z-index:2}article i.list-checkbox,input[type=checkbox].custom+i{display:inline-block;line-height:1;color:#a6a6a6;z-index:1;font-size:1.357rem}input[type=checkbox].custom:checked:after{content:""}input[type=checkbox].custom+i{margin-left:-18px}input[type=checkbox].custom+i:before{content:"\\f096"}input[type=checkbox].custom:checked+i:before{content:"\\f046"}article i.list-checkbox{float:right;width:18px;margin:17px -18px 0 0}article i.list-checkbox:before{content:"\\f096"}article.selected-item i.list-checkbox:before{content:"\\f046"}@-webkit-keyframes rotate{from{-webkit-transform:rotate(0)}to{-webkit-transform:rotate(360deg)}}.rotation{-webkit-animation-name:rotate;-webkit-animation-duration:2s;-webkit-animation-iteration-count:infinite;-webkit-animation-timing-function:linear}.modal{position:absolute;top:10px;left:10px;right:10px;width:auto;margin:0}#overlay,.overlay-view,.overlay-view .message{position:absolute;left:0;width:100%}.modal.fade.in{top:auto}.modal .modal-header .close{padding:10px;margin:-10px}.overlay-view{top:0;height:100%;background-color:rgba(0,0,0,.7);z-index:1001}.overlay-view .message{top:45%;text-align:center;opacity:.8;color:#fff}#overlay{top:0;height:100%;z-index:999990;font-size:1.357rem;font-weight:700;text-align:center}#overlay #overlay-spinner{height:32px;width:32px;margin-top:20px;display:none}#overlay .current,#overlay.spinner #overlay-spinner,.label-module-sm{display:inline-block}#overlay #overlay-spinner .icon-spinner{width:32px;height:32px}#overlay .current{padding-bottom:10px}#overlay .completed{font-size:.632em;color:#CDCCCB}#overlay.spinner #overlay-message,#overlay.spinner #overlay-spinner{position:relative;top:40%}#tutorial,#tutorial__view{left:0;top:0;z-index:999981;position:absolute}#overlay.tint{background:#2d2d2d;border-top:solid 2px #e61718;color:#fff}#overlay .icon-spinner{display:inline-block;vertical-align:top;width:18px;height:18px;margin-right:3px}#tutorial__view{right:0;bottom:0;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0);opacity:0;-webkit-transition:opacity .3s linear;transition:opacity .3s linear}#tutorial,.navbar .navbar-inner,.tablet #wrapper{-webkit-transform:translate3d(0,0,0)}#tutorial{max-height:inherit;transform:translate3d(0,0,0)}#tutorial-content .text{position:absolute;width:160px;padding:4px 10px 0;font-size:1rem;font-weight:700;line-height:1.25;color:#fff;z-index:999982}#tutorial-content .text-container{top:15%;position:absolute;left:50%;width:186px}#tutorial-content .text-container .text{position:relative;left:-50%;font-size:1.071em;font-weight:400;text-align:center;width:100%;border-radius:10px;border:2px solid #000;background-color:#313130;opacity:.8;padding:10px;margin-left:-12px}.label-module-sm{position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;height:26px;width:26px;font-weight:400;font-size:11px;line-height:11px;padding:4px 0 0 4px;border-radius:2px;background:#000;white-space:nowrap;vertical-align:middle;color:#fff}.label-module-sm .icon{font-size:18px;width:18px;height:18px;line-height:18px;text-align:center;color:#58595b}.label-module-sm.icon-inside .label-module-sm_title{position:absolute;top:4px;left:4px}.navbar,.navbar .navbar-inner{left:0;top:0;position:absolute;width:100%}.label-module-sm .icon-th{margin-top:1px;color:#2b2b2b}.label-Bugs{background-color:#e61718}.label-Cases{background-color:#890e0e}.label-ProspectLists,.label-Prospects,.label-TargetLists,.label-Targets{background-color:#6a800d}.label-CampaignLog,.label-Campaigns{background-color:#445208}.label-Opportunities{background-color:#6d17e5}.label-RevenueLineItems{background-color:#410e88}.label-Products{background-color:#1f12b3}.label-Forecasts{background-color:#0d8046}.label-Quotes{background-color:#063b20}.label-Accounts{background-color:#33800d}.label-Contacts{background-color:#215208}.label-Leads{background-color:#176de5}.label-Reports{background-color:#cc3314}.label-Documents,.label-Files,.label-KBDocuments{background-color:#6f1c0b}.label-Calendar{background-color:#0d806c}.label-Meetings{background-color:#085245}.label-Calls{background-color:#0b3671}.label-Emails{background-color:#1257b7}.label-Tasks{background-color:#e5176d}.label-Notes{background-color:#0f7799}.label-Workflow{background-color:#1378bf}.label-Users{background-color:#111}.label-empty{background:#fff;border:1px solid #555;color:#555;padding:3px 0 0 3px}.navbar{height:100%}.navbar .navbar-inner{transform:translate3d(0,0,0);-webkit-box-sizing:border-box;box-sizing:border-box;height:50px;z-index:9000}.box__filter,.view__search{-webkit-box-sizing:border-box}.navbar .navbar-inner .nomad{position:absolute;left:76px;right:76px;top:50%;max-height:1.9em;padding:2px 0;-webkit-transform:translateY(-50%);transform:translateY(-50%);text-align:center;color:#fff;font-size:1.143em;font-weight:700;line-height:1;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;z-index:-1}.navbar .navbar-inner .backBtn+.nomad,.navbar .navbar-inner .dashHomeBtn+.nomad{left:90px}.navbar .navbar-inner .header-subtitle{display:inline;position:relative;top:-4px;font-size:.785rem;font-weight:400}.navbar .navbar-inner .header-subtitle:empty{display:none}.navbar .navbar-inner .header-subtitle:after{content:"\\A";white-space:pre}.icon-user.withPicture:before,.menuBtn::after{content:""}.navbar .nav-collapse{width:100%;height:100%;overflow:hidden;background:#000}.navbar .nav-collapse .nav{float:none;margin:0;overflow:hidden}.navbar .nav-collapse .nav.scroll-fix{overflow:hidden!important}.navbar .nav-collapse .nav li{background:#2d2d2d;border-bottom:solid 1px #000}.navbar .nav-collapse .nav li.divider-horizontal{background-color:#414141;height:5px;display:block}.navbar .nav-collapse .nav li.selected-item{background:#171717}.navbar .nav-collapse .nav li a{padding:13px 12% 13px 15px;color:#cdcccb}.navbar .nav-collapse .nav li .icon-user,.navbar .nav-collapse .nav li .label-module-sm{margin:-6px 7px -4px 0}.navbar .nav-collapse .nav .icon-circle{margin-right:5px;font-size:10px;vertical-align:top}.navbar.btns-long .btn{max-width:100px}.navbar.has-edit-button.has-search .nomad{right:110px}#me{display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}#createList,#moduleList{position:absolute;height:100%;width:100%;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch;-webkit-transform:translate3d(-100%,0,0)}#menu-left .nav-collapse li a,.navbar-inner .btn{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.navbar-inner .save-container{float:right}.navbar-inner .btn-area-more{float:left;padding:9px 10px}.navbar-inner .btn-area-more.cancelBtn .btn{color:#fff}.navbar-inner .btn-area-more.cancelBtn .btn.disabled{background:0 0}.navbar-inner .btn-area-more.saveBtn.combined{right:44px;padding-right:0}.navbar-inner .btn-area-more.saveBtn.combined a{border-bottom-right-radius:0;border-top-right-radius:0;border-right:1px solid #064267}.navbar-inner .btn-area-more.caretBtn{width:34px;padding-left:0}.navbar-inner .btn-area-more.caretBtn>a{border-bottom-left-radius:0;border-top-left-radius:0}.navbar-inner .btn-area-more.caretBtn .icon{margin-top:-2px}.navbar-inner .btn{max-width:50px;margin:0;line-height:22px;display:block;z-index:2002}.navbar-inner .offline-status.status-success{display:none}#menu-left .nav-collapse li a{display:block}i.icon-user{width:26px;height:26px;line-height:26px;padding:0;border:none;border-radius:15px;font-size:13px;color:#454545}.icon-user.withPicture{background-size:100%;background-position:50% 50%}.backBtn,.createBtn,.dashHomeBtn,.menuBtn,.offline-status,.searchBtn{float:left;height:46px;width:44px;line-height:44px;color:#fff;text-align:center;z-index:2000}.backBtn.selected-item,.createBtn.selected-item,.dashHomeBtn.selected-item,.menuBtn.selected-item,.offline-status.selected-item,.searchBtn.selected-item{background:#222}.menuBtn{position:relative}.menuBtn::after{position:absolute;top:0;left:0;bottom:0;right:0}.offline-status{width:12px;color:#000}.offline-status .icon{font-size:10px;vertical-align:middle}.icon.status-default{color:#000}.icon.status-success{color:#368f01}.icon.status-warning{color:#ffa800}.icon.status-error{color:#c72516}.createBtn,.searchBtn{float:right}.createBtn.active,.searchBtn.active{background:rgba(0,0,0,.5)}#nomad .disabled a,#nomad .disabled a .icon{color:#717275}.navbar .right-menu .icon{margin:0 8px 0 -2px;line-height:1;vertical-align:inherit;color:#fff}.tablet .right-menu{width:300px;position:absolute;top:46px;right:0;z-index:9999;max-height:100%;overflow-y:auto;display:none}.tablet .right-menu .nav-collapse{width:auto;border:2px solid #000;border-width:2px 2px 1px;border-radius:4px 0 4px 4px}.tablet .overlay_right-menu{position:absolute;top:-50px;left:0;right:0;bottom:-50px;z-index:9998;overflow:scroll;-webkit-overflow-scrolling:touch;visibility:hidden;opacity:0;transition:visibility 0s .2s,opacity .2s linear}.tablet .overlay_right-menu.show{visibility:visible;opacity:1;transition:opacity .2s linear}.actionsheet-overlay .invisible,.invisible{visibility:hidden}.tablet #content .overlay_right-menu{left:-56px}.mobile .right-menu{position:absolute;top:0;right:-3px;bottom:-50px;left:0;-webkit-transform:translate3d(100%,0,0)}.mobile .right-menu .nav{height:100%;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch}.view__filters.filters-hidden{display:none}.box__filter{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:flex;padding:6px 7px;background:#f5f5f5;white-space:nowrap}.box__filter .filter__item{padding-left:4px}.box__filter .filter__item:first-child{padding-left:0}.box__filter .filter__seporate{-webkit-box-flex:1;-webkit-flex:1;flex:1;padding-left:0}.box__filter .filter__item-by{max-width:160px}.box__filter .filter__item-sort{width:32px}.box__filter .btn-filter{display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.view__search{display:none;position:absolute;top:-50px;left:0;width:100%;box-sizing:border-box;-webkit-transition:all .6s linear;transition:all .6s linear;height:46px;padding:6px 5px;background:#2d2d2d;z-index:9002;opacity:0}.view__search.show-search{display:-webkit-box;display:-webkit-flex;display:flex}.view__search .box__search-query{position:relative;-webkit-box-flex:1;-webkit-flex:1;flex:1}.view__search .icon-search{position:absolute;top:8px;left:10px;color:#c2c2c2}.view__search .icon-spinner{display:none;position:absolute;top:9px;left:9px;width:16px;height:16px}.view__search .search-query{-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;height:34px;padding:4px 35px 4px 32px;border-radius:2px;background:#fff}.view__search .icon-remove-sign{display:none;position:absolute;top:0;right:0;padding:6px 6px 5px 12px;margin:0;font-size:24px;line-height:24px;color:#c2c2c2}.view__search .not-empty .icon-remove-sign{display:block}.view__search .searchCancelBtn{padding:10px;margin:-7px -10px -6px -7px;float:none}.view__search .searchCancelBtn .btn{color:#cbcbcb}.view__search-box.in-progress .icon-search{display:none}.view__search-box.in-progress .icon-spinner{display:block}.dropdown,.overlay-dropdown{position:absolute;top:44px;z-index:2;display:none}.overlay-dropdown{left:0;width:100%;height:1500px;background:#000;opacity:.55}.dropdown{overflow-y:auto;border-radius:0 0 2px 2px;background:#fff;max-height:50%}.dropdown.dropdown__filter{left:7px;width:190px}.dropdown.dropdown__sortBy{right:7px;width:183px}.dropdown li{display:block;border-top:1px solid #e8e8e8}.dropdown li:first-child{border:none}.dropdown li.filters-preloader{display:none}.dropdown li.filters-preloader .icon-spinner{display:inline-block;width:16px;height:16px;margin-right:8px;vertical-align:top}.dropdown li.filters-preloader.show{display:block}.dropdown li.selected-item{background:#f6f6f6}.dropdown li.filters-fetching-error{display:none;padding:8px 10px;text-align:center}.dropdown li a.active .icon-check,.dropdown li.filters-fetching-error.show{display:block}.dropdown li.filters-fetching-error .filters-try-again{color:#176AE6;text-decoration:underline}.dropdown li a{position:relative;display:block;height:2.857rem;color:#323232}.dropdown li a.active{color:#176AE6}.dropdown li .name{position:absolute;top:50%;left:22px;right:7px;-webkit-transform:translateY(-50%);transform:translateY(-50%);max-height:2.857rem;overflow:hidden;text-overflow:ellipsis;display:-webkit-box}.dropdown li .icon-check{display:none;position:absolute;top:50%;left:6px;margin-top:-9px;font-size:13px}.listing .no-records-found p,.listing article p:last-child{margin:0}.dropdown li .loading-error{height:auto;padding:12px 0;text-align:center}.dropdown li .loading-error .message{display:block;padding-bottom:6px}.dropdown li .loading-error .link{color:#176AE6;text-decoration:underline}.mobile #wrapper{box-shadow:0 0 0 3px #0f0f0f}.mobile.show-content-child #content{display:none}.mobile.show-content-child #content-child,.tablet.show-content-child #content-child{display:block}.tablet.android #menu-left{width:300px}.tablet #menu-left{overflow:hidden;width:54px}.tablet #menu-left .label-name{opacity:0;-webkit-transition-duration:.3s;transition-duration:.3s}.tablet #menu-left .nav-collapse li a{padding-right:15px}.tablet.show-menu-left #menu-left{width:300px}.tablet.show-menu-left #menu-left .label-name{opacity:1}.tablet #wrapper{transform:translate3d(0,0,0);left:56px;background:#000}.tablet #content,.tablet #content-child{box-shadow:0 0 10px rgba(0,0,0,.8)}.tablet #content-child .navbar-inner{border-left:solid 1px #4e4e4e}.tablet.show-content-child #content{display:block;width:340px}.tablet #moduleList{-webkit-transform:translate3d(0,0,0)}.tablet .layout__detail .bizcard{min-height:305px}.tablet .layout__detail .view__detail-tabs{top:305px}#content,#content-child,#wrapper{top:0;left:0;right:0;position:absolute;bottom:0}#content,#content-child{z-index:2002}#content-child{display:none}.layout__def{position:absolute;top:50px;bottom:0;left:0;right:0;z-index:1}.layout__def .navbar{top:-50px}.layout__def .edit{top:50px}#content-overlay{position:absolute;width:100%;left:0;top:50px;bottom:0;z-index:2003;-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0);overflow:scroll;-webkit-overflow-scrolling:touch}#content-overlay.full{top:0;border-top:solid 3px #e61718}.show-menu-left #content-overlay{top:0}.easy-scroller-parent{position:absolute;top:0;right:0;bottom:0;left:0}.view__filters~.easy-scroller-parent{top:44px}.filters-hidden .easy-scroller-parent{top:0}.easy-scroller-holder{position:absolute;top:0;min-height:100%;left:0;right:0;z-index:1}.layout__Dashboards .easy-scroller-holder,.layout__list .easy-scroller-holder{background:#fff}.actionsheet-overlay{top:0;background-color:rgba(0,0,0,.7);z-index:9999;width:100%;bottom:0;position:absolute;display:none}.actionsheet-overlay .popup{-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0);min-width:250px;max-width:90%;font-weight:700;box-shadow:inset 0 -1px 0 #000,inset 0 1px 0 #333;background-color:#1a1a1a;color:#fff;font-size:16px;position:absolute}.actionsheet-overlay .popup .footer .cancel.selected-item,.actionsheet-overlay .popup .items .item.selected-item{background:#666}.actionsheet-overlay .popup .header{border-bottom:3px solid #e61718;padding:16px 0;text-align:center}.actionsheet-overlay .popup .items{max-height:120px;overflow:auto;overflow-x:hidden}.actionsheet-overlay .popup .items .item{height:40px!important;line-height:40px;width:auto;padding-left:20px;padding-right:20px;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.actionsheet-overlay .popup.compact .footer .cancel,.actionsheet-overlay .popup.compact .header{padding:10px!important}.actionsheet-overlay .popup.compact .items{max-height:80px!important}.actionsheet-overlay .popup .footer{border-top:2px solid #fff}.actionsheet-overlay .popup .footer .cancel{display:block;color:#fff;text-align:center;padding:16px}.items article,.scroll>.pad>span .control-group,.summary-view .scroll>ul>li{position:relative}.ios .items article,.ios .scroll>.pad>span .control-group,.ios .summary-view .scroll>ul>li{-webkit-transform:translatez(0)}.layout__Login{overflow:auto;top:0}.tablet .layout__Login,.tablet .layout__SetupBuddy,.tablet .no-main-menu{left:-56px}.listing{background:#fff;min-height:100%;width:100%;padding-bottom:1px;overflow:hidden;z-index:2}.listing .no-records-found{display:none;color:grey;background-color:#f4f4f4;padding:18px 15px 20px}.listing #activity-stream .no-records-found{background:#fff}.listing article{display:block;padding:8px 8px 8px 12px;border-top:1px solid #d8d8d8;min-height:52px}.listing article p{display:block}.listing article>input[type=checkbox]{margin-top:20px}.listing article>input[type=checkbox]+i{float:right;width:18px;margin:17px -18px 0 0}.listing article.bucket-header{min-height:15px;background:#f5f5f5;font-weight:700}.listing article.selected-item{background-color:#ededed!important}.listing article.current{background:#2d2d2d;border-color:#dcdcdc;color:#999}.listing article.current .item-name,.listing article.current a{color:#fff!important}.listing article.current .fields .value,.listing article.current .item-label,.listing article.current .module-name,.listing article.current .module-name-comma,.listing article.current div.search-result{color:#999!important}.listing article.current>input[type=checkbox]+i{color:#00A}.listing article.deleted{opacity:0}.listing .list-item{background:#fff}.listing .list-item .txt{margin-top:6px;min-height:2.7em}.listing .list-item .txt .clip{display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.listing .list-item .txt .clip a em{font-style:normal;color:#555}.listing .list-item .txt .item-name,.listing .list-item .txt>.clip:first-child{font-size:1.143rem;line-height:1.3em}.listing .list-item .txt .module-name{float:left;max-width:50%;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-style:normal;color:#555;font-size:1.143rem;line-height:1.3em}.listing .list-item .txt .module-name-comma{float:left;font-size:1.143rem;line-height:1.3em;padding-right:4px;color:#555}.listing .list-item .txt .highlight{font-weight:700;color:inherit}.listing .list-item .txt div.search-result{color:#555;font-size:1rem}.listing .list-item .txt div.search-result .highlight{padding:0 2px;background:#dfdfdf;color:#555;font-weight:400}.listing .list-item .txt div.search-result .relate-link{color:#555}.listing .list-item .search{height:auto}.listing .list-item .additional{padding-top:.3em;padding-bottom:.3em;font-size:.929rem}.listing .list-item .additional div.search-result{display:block}.listing .list-item .txt.has-access .item-name{color:#176AE6}.listing .list-item .fields .value{color:#555}.listing .list-item .fields .field{overflow:hidden}.listing .list-item .fields .item-label{float:left;width:46%;padding-right:10px;font-weight:500;color:#343433}.listing .list-item.error{color:#fff;background:#e61718;border-top:none;border-bottom:solid 3px #8a1a0f}.listing .list-item.error .module-name,.listing .list-item.error .module-name-comma{color:#fff}.listing .list-item.warning{color:#fff;background:#ffa800;border-top:none;border-bottom:solid 3px #b27500}.listing .list-item.warning .module-name,.listing .list-item.warning .module-name-comma{color:#fff}.listing .bucket-show-more-item{min-height:26px;background-color:#fff}.listing article.has-grip{padding-right:32px}.listing article.item-checkbox{position:relative;padding-right:32px}.listing article.item-checkbox .asscacct,.listing article.item-checkbox .icon-checkbox{position:absolute;top:50%;right:22px;margin:-.5em -.5em 0 0}.listing .selected-item+article{border-color:#dcdcdc}.listing article.nav{background:#f5f5f5;border-top:1px solid #dcdcdc;padding:0 14px;margin-bottom:0;min-height:42px;line-height:42px}.listing article.nav.show-more-top-btn{z-index:1}.listing article.nav:last-child{border-top:1px solid #d8d8d8}.listing article.nav div{height:42px}.listing article.nav div a{margin:0}.listing article.nav:first-child,.listing article.nav:nth-child(2),.listing article.nav:nth-child(3){border-bottom:1px solid #dcdcdc;margin-bottom:-1px}.listing article.nav .loading-holder .icon-spinner{display:inline-block;margin-right:5px;vertical-align:text-top}.menu-container a .icon-spinner .icon-spinner-path,.view__login .icon-spinner .icon-spinner-path{fill:#fff}.listing>i{height:45px;display:inline-block}.picker-list-row{line-height:52px;font-size:1.143em}.picker-list-row .label-module-sm{margin:-2px 9px 0 0}.picker-list-row a{color:#555}.menu-container-grip{position:absolute;top:0;right:0;height:100%;width:20px;padding:0 0 0 15px;font-size:14px;font-style:normal;line-height:68px}.menu-container{position:absolute;top:0;bottom:0;left:100%;width:100%;background:#2d2d2d;text-align:center}.menu-container.on{left:0}.menu-container a{display:inline-block;padding:18px 2.5% 300px;height:26px;width:auto;color:#999;text-align:center;font-size:11px;line-height:18px}.menu-container a .icon{color:#fff}.menu-container a.selected-item .icon{color:#999}.menu-container a .icon-spinner{display:inline-block;width:14px;height:14px}.menu-container .grip{position:absolute;top:0;left:0;height:100%;line-height:68px;width:16px;padding:0 2px 0 10px;font-size:14px;color:#999}.menu-container .context-menu .disabled{opacity:.2}.ios .menu-container{-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0);-webkit-transition-duration:.15s;transition-duration:.15s}.ios .menu-container.on{left:100%;-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}.error-box{padding:18px 15px 20px;background-color:#c72516;font-weight:700;color:#fff}.view__detail-tabs{position:absolute;top:195px;bottom:0;left:0;right:0}ul.actions{margin:0;padding:0}ul.actions li{list-style:none;padding:0 0 0 10px;line-height:41px;border-bottom:1px solid #d8d8d8;min-height:42px;position:relative}ul.actions li.selected-item{background-color:#ededed}ul.actions li a{position:relative;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-right:44px;color:#555;text-decoration:none}ul.actions li .label-module-sm{margin:-2px 9px 0 0}ul.actions li .more{position:absolute;top:0;right:10px}ul.actions li .create-related{position:absolute;right:0;top:0;width:44px;padding:0;text-align:center}.bizcard{position:absolute;left:0;top:0;width:100%;z-index:1000;min-height:195px;background:#2d2d2d;color:#fff;font-size:1.071rem}.bizcard .avatar{position:absolute;overflow:hidden;top:10px;left:10px;height:68px;width:68px;border-radius:36px;border:2px solid #999;background-repeat:no-repeat;background-position:50% 50%;background-size:100%;text-align:center}.bizcard .avatar i{width:1em;height:1em;line-height:70px;font-size:38px;color:#555}.bizcard .avatar .icon-plus{display:none}.bizcard .label-module-sm{position:absolute;top:10px;left:10px;width:68px;height:68px;padding:13px 0 0 10px;border-radius:6px;font-size:26px}.bizcard .input_upload{position:absolute;top:0;left:0;width:90px;height:90px;opacity:0;z-index:5}.bizcard .card{position:absolute;top:0;bottom:36px;left:0;right:0;padding:10px 42px 0 10px;line-height:2em;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch}.bizcard .card .title{display:block;color:#fff;font-size:1.429rem;line-height:1.2em}.bizcard .card .title.selected-item{color:#999}.bizcard .card label{color:#999;line-height:1;margin-bottom:0}.bizcard .card a{color:#fff}.bizcard .card .row-field{line-height:1.2em;padding-bottom:.857rem}.bizcard .card .row-field .value-label{display:none}.bizcard .card .row-field.bool{overflow:hidden}.bizcard .card .row-field.bool .value-label{float:left;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:80%}.bizcard .card .row-field.textarea .value{display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;white-space:normal}.bizcard .card .row-field .value,.bizcard .more .follow-label i,.bizcard-more .bizcard .card .value-label{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.bizcard .card .row-field .value{display:block}.bizcard .card .row-field .value .value-label{color:#999}.bizcard .card .row-field .value .relate-link{padding:10px 0;color:#fff}.bizcard .card .row-field .value .relate-link.selected-item{color:#999}.bizcard .card .row-field .horizontal-fieldset .row-field,.bizcard .card .row-field .horizontal-fieldset .value{display:inline}.bizcard .card .additionalFields{display:none}.bizcard .favorite-icon{position:absolute;bottom:0;right:3px;padding:10px 8px 12px 10px;font-size:1.286rem;line-height:1em;color:#fff;z-index:10}.bizcard .favorite-icon.icon-star-o{color:#999}.bizcard .followable .favorite-icon{right:82px}.bizcard .more{position:absolute;top:0;bottom:62px;left:0;right:0;color:#999}.bizcard .more .follow-label{position:absolute;bottom:0;right:0;padding:10px 10px 10px 5px;font-size:12px;color:#999;z-index:5}.bizcard .more .follow-label i{max-width:54px;display:block;padding:0 5px;border:2px solid #999;border-radius:4px;font-style:normal;font-weight:400}.bizcard .more .follow-label.followed i{background:#fff;border-color:#fff}.bizcard .more .icon-chevron-right{position:absolute;top:0;right:0;padding:15px 16px 10px;font-size:1.143em;color:#999}.bizcard .more .icon-chevron-right.selected-item{color:#fff}.bizcard .more .show-more{position:absolute;left:0;bottom:-10px;height:40px;line-height:30px;padding:0 15px 2px 10px;color:#999;z-index:2}.bizcard #accountDescription{margin:10px 0 0}.bizcard .record-action{display:-webkit-box;display:-webkit-flex;display:flex;position:absolute;left:0;bottom:0;right:0;text-align:center;background:#2d2d2d;border-top:solid 1px #0f0f0f;border-bottom:solid 1px #0f0f0f;height:60px}.bizcard .record-action a{display:block;-webkit-box-flex:1;-webkit-flex:1;flex:1;border-left:solid 1px #0f0f0f}.bizcard .record-action a:first-child{border-left:none}.bizcard.noactions .more{bottom:0}.bizcard.noactions .record-action{display:none}.bizcard.icon-inside .card{padding-left:90px}.bizcard-more .bizcard{min-height:100%!important}.bizcard-more .bizcard .avatar,.bizcard-more .bizcard .label-module-sm{opacity:.3}.bizcard-more .bizcard .card .row-field{margin-bottom:.2rem}.bizcard-more .bizcard .card .value-label{float:none!important;display:block;font-size:.9rem;line-height:1.2em;font-weight:700}.bizcard-more .bizcard .card .title .value-label{padding-bottom:0}.bizcard-more .bizcard .card .value{white-space:normal}.bizcard-more .bizcard .card .textarea .value{-webkit-line-clamp:initial}.bizcard-more .bizcard .card .horizontal-fieldset .value-label{display:none}.bizcard-more .bizcard .card .horizontal-fieldset .value{display:inline}.bizcard-more .bizcard .card .additionalFields,.edit{display:block}.landscape .bizcard{min-height:190px}.landscape .summary-view .scroll{top:190px}.brand{background:url('+i(161)+') 50% 50% no-repeat;background-size:contain;text-indent:-7000px;overflow:hidden;margin:5px auto 15px;width:220px;height:auto}.edit,.scroll,.textarea .scroll .pad{height:100%}.scroll{position:absolute;width:100%;left:0;top:0;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch}.scroll .pad{padding-bottom:1px;min-height:100%;width:100%;background:#fff}.textarea .scroll .pad>textarea{-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;height:100%;padding:20px}.edit{margin:0}.edit .actionsheet-select,.edit .uneditable-input,.edit input:not([type=checkbox]),.edit select,.edit textarea{float:left;position:relative;height:3.286rem;line-height:1.858rem;width:85%;padding:.714rem 15% .714rem 0;margin:-.714rem 0;z-index:2}.edit .actionsheet-select{height:auto;min-height:20px}.edit .selector .actionsheet-select{width:auto}.edit select{width:100%;-webkit-appearance:none}.edit .parent input,.edit .relate input{padding-right:0;width:75%}.edit textarea{padding-top:5px;height:48px;line-height:17px}.edit .textarea-div{overflow-y:auto;padding-top:.357rem;min-height:48px;max-height:86px;line-height:1.214em;white-space:pre-wrap;color:#000}.edit .input-wrapper input{width:100%;padding-right:0}.edit .enum-list{width:100%;min-height:21px;padding-top:5px;cursor:pointer}.edit .enum-list .label{display:inline-block;position:relative;padding:8px 25px 8px 8px;margin-bottom:6px;background:#ebebeb;color:#696969;font-size:.929rem;line-height:1;white-space:normal}.edit .enum-list .label i{position:absolute;top:0;right:0;height:100%;padding:0 8px 0 10px;font-size:.857rem;color:#828282}.edit .enum-list .label i.selected-item{color:#1c1c1c}.edit .enum-list .label i:before{position:relative;top:8px}.edit .clip{display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.edit .controls-flex{display:-webkit-box;display:-webkit-flex;display:flex}.edit .controls-flex .input-wrapper,.edit .controls-flex .picture-wrap{display:block;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-flex:1;-webkit-flex:1;flex:1}.edit .controls-flex .txt-value{-webkit-box-flex:1;-webkit-flex:1;flex:1;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:1.858rem;line-height:1.858rem}.edit .controls-flex .btn-group{display:-webkit-box}.edit .error .controls-flex{display:block}.edit .email.error .controls-flex{display:-webkit-box;display:-webkit-flex;display:flex}.edit .controls-flex+.controls-flex{margin-top:6px}.edit .email .controls-flex .input-wrapper{display:-webkit-box;display:-webkit-flex;display:flex}.edit .email .controls-flex .input-wrapper .input-email{height:26px;margin-top:0;padding-top:0;margin-bottom:0;padding-bottom:0;line-height:1}.edit .email .controls-flex .input-wrapper .icon-remove-sign{margin-right:5px}.edit .email .controls-flex.error{position:relative}.edit .email .controls-flex.error .input-wrapper{margin-right:15px}.edit .email .controls-flex.error .input-wrapper .input-email{color:red}.edit .email .controls-flex.error .icon-exclamation-sign{top:0;right:40px;color:red}.edit .email .primary-address .input-email,.edit .email .primary-address .txt-value{font-weight:700}.edit .email .invalid-email .input-email,.edit .email.readonly .invalid-email .txt-value{text-decoration:line-through;font-weight:400}.edit .email .opt-out .input-email{color:#58595B;font-weight:400}.edit .email.readonly .opt-out .txt-value{color:#b5b5b5;font-weight:400}.edit .email .btn{min-width:35px}.edit .email .controls>.icon-exclamation-sign{display:none}.edit .email .error-display{color:red}.edit .icon-exclamation-sign{position:absolute;top:10px;right:15px}.edit .uneditable-link{padding-top:4px;height:1.857em;display:block;vertical-align:middle}.edit .avatar{height:32px;width:32px;background-position:50% 50%;background-repeat:no-repeat}.edit .placeholder{display:block;width:100%;position:absolute;top:14px;padding-left:2px;color:#cfcecd}#nomad .edit .control-group.error label,.edit .control-group.error .error-display{color:red}.edit .placeholder.hide{display:none}.edit .control-group{box-sizing:border-box;position:relative;display:block;padding:10px;margin:0;overflow:hidden;border-top:1px solid #f2f2f2}.edit .control-group.selected-item{background-color:#ededed}.edit .control-group.error .icon-exclamation-circle{position:absolute;top:1.1rem;right:15px;line-height:1em}.edit .control-group.error small.error-display{position:relative;z-index:2}#nomad .edit .control-group.readonly .textarea-div,#nomad .edit .control-group.readonly input,#nomad .edit .control-group.readonly label,#nomad .edit .control-group.readonly select{color:#b5b5b5}#nomad .readonly-view.edit .control-group.readonly input,#nomad .readonly-view.edit .control-group.readonly label,#nomad .readonly-view.edit .control-group.readonly select{color:#343433}.edit .control-group .icon-exclamation-sign{line-height:26px}.edit .control-group small{display:block;clear:both;font-size:.786em}.edit .control-group>label{width:30%;margin:0 4% 5px 0;font-weight:700;font-size:.929em;overflow:hidden;text-overflow:ellipsis}.edit .control-group .controls{-webkit-box-sizing:border-box;box-sizing:border-box;margin-left:34%;width:66%}.edit .control-group .controls.clip{width:auto;margin-left:0}.edit .control-group .controls .span2{width:100%;margin:0;line-height:27px}.edit .control-group .controls .span2 .enum-item{display:block}.edit .control-group .controls .span2+.span2{clear:both;margin-top:5px}.edit .control-group .controls .checkbox:first-child{padding-top:0;margin-top:5px}.edit .control-group .controls .checkbox.custom{width:65%;height:34px;margin-top:-5px;margin-bottom:-5px;vertical-align:top}.edit .control-group .controls .checkbox+i.icon-checkbox{margin:4px 0 0 -65%}.edit .control-group.error .controls{padding-right:25px}.edit .control-group .controls.readonly-item{word-wrap:break-word;padding-top:.286rem;color:#b5b5b5}.edit .control-group .readonly-item.color-def{color:inherit}.readonly-view.edit .control-group .controls.readonly-item{color:#111}.edit .control-group.radio .btn{min-height:24px;padding-top:2px;padding-bottom:2px;margin-top:2px;margin-bottom:2px}.edit .control-group .btn.fright{min-width:20px;padding-left:2px;padding-right:2px;margin-left:5px}.edit .control-group .btn.fright:last-child{margin-left:0}.edit .control-group.file .picture-wrap{height:28px;float:left}.edit .control-group.file .picture-wrap img{position:absolute;top:0;left:0;max-width:none}.edit .control-group.file .picture-wrap img.hide{display:none}.edit .control-group.file .picture-wrap .icon-picture{line-height:26px;font-size:24px;color:#ccc}.edit .control-group.file .picture-wrap .input_upload{position:absolute;top:0;bottom:0;left:0;width:100%;padding:0;margin:0;opacity:0}.edit .control-group.file .picture-wrap .value{-webkit-box-flex:1;-webkit-flex:1;flex:1;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:1.858rem;line-height:1.858rem}.edit .control-group.file .picture-wrap .icon-picture.hide+.value{display:block}.edit .control-group.file .file-remove{z-index:2}.edit .control-group.file .icon-remove-sign{float:right;height:28px;padding:.33em 5px 5px;margin:-.33em -5px -5px 0;font-size:23px;line-height:28px;color:#c2c2c2}.edit .control-group.datetime .controls.has-btn-group{padding-right:1.5rem}.edit .control-group.datetime .date{float:left;overflow:hidden;width:6rem;height:2.5rem;margin:-.357rem 0}.edit .control-group.datetime .date input{display:table;padding:0;margin:0;width:100%;height:2.571rem;line-height:2.571rem}.edit .control-group.datetime .time{float:left;overflow:hidden;width:5.88rem;margin:-.357rem 0;border-left:solid 1px #f2f2f2}.edit .control-group.datetime .time input{width:auto;height:2.571rem;padding-left:10px}.edit .control-group.datetime input{float:none;-webkit-appearance:none;background:#fff;opacity:1;white-space:nowrap}.edit .control-group.datetime input.empty{opacity:0}.edit .control-group.datetime input::-webkit-calendar-picker-indicator,.edit .control-group.datetime input::-webkit-clear-button,.edit .control-group.datetime input::-webkit-inner-spin-button,.edit .control-group.datetime input::-webkit-outer-spin-button{display:none;-webkit-appearance:none}.edit .control-group.datetime .btn-group{position:absolute;top:0;right:0;padding:10px;z-index:2}.edit .control-group.datetime.error .btn-group{right:25px}.edit .control-group.date input{-webkit-appearance:listitem;opacity:1;background:0 0}.edit .control-group.date input.empty{opacity:0}.edit .control-group.date input::-webkit-calendar-picker-indicator,.edit .control-group.date input::-webkit-clear-button,.edit .control-group.date input::-webkit-inner-spin-button,.edit .control-group.date input::-webkit-outer-spin-button{display:none;-webkit-appearance:none}.edit .control-group.date .btn-group{position:absolute;top:0;right:0;padding:10px;z-index:3}.edit .horizontal-fieldset{display:-webkit-box}.edit .horizontal-fieldset>span{display:block;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-flex:1;-webkit-flex:1;flex:1}.edit .horizontal-fieldset .control-group{padding:0}.edit .horizontal-fieldset .control-group:first-child{border:none}.edit .horizontal-fieldset .control-group .controls{padding-left:0;padding-right:0;width:auto}.edit .horizontal-fieldset label{display:none}.edit .horizontal-fieldset select+.icon{float:left}.edit .horizontal-fieldset .checkbox{min-width:25px}.edit .horizontal-fieldset .checkbox+.icon-checkbox{width:18px}#nomad .edit.readonly-view .control-group.readonly .textarea-div{color:#111}.input-wrapper{display:-webkit-box;display:-webkit-flex;display:flex}.input-wrapper input{display:block;width:100%;padding-right:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-flex:1;-webkit-flex:1;flex:1;line-height:1}.input-wrapper .icon-remove-sign{display:none;padding:.33em 10px 0;margin:-.33em -10px -5px 0;font-size:1.643em;line-height:28px;cursor:pointer;color:#c2c2c2;z-index:99}.input-wrapper.not-empty input:focus+.icon-remove-sign{display:-webkit-box;display:-webkit-flex;display:flex}.delete{width:86%;line-height:1.575em;background-color:#c72516;color:#fff;font-weight:700}.modal-footer{padding:20px 0 10px;border-top:1px solid #e8e8e8;text-align:center}.currency_edit .wrapper{padding-left:70px}.currency_edit .wrapper .selector{position:relative;float:left;width:65px;margin-left:-70px}.currency_edit .wrapper .selector .icon-caret-down{font-size:1rem;float:left!important;margin-top:4px}.currency_edit .wrapper .selector select{width:100%;position:absolute;top:0;left:0;padding:0 0 0 15px;line-height:1}.view__login{position:relative;min-height:100%;width:100%;overflow:auto;background:#2d2d2d;text-align:center;opacity:0}#alerts,.alert,.alert .message,.android .controls-flex .input-wrapper,.offline-page .listing .emulation-item{overflow:hidden}.view__login .modal,.view__login .modal-body,.view__login .modal-footer,.view__login .modal-header{border:none;padding:0;margin:0;background:0 0}#preloader .hr,.view__login .modal-header{border-top:solid 2px #e61718}.view__login .modal{position:relative;min-height:100%;top:0;left:0;right:0}.view__login .modal-header{padding:5px 0}.view__login .modal-header .brand{margin:15px auto}.view__login .modal-body{width:240px;margin:auto}.view__login .modal-body form{margin:0}.view__login .modal-footer{border:none;padding:0 0 3.286em;text-align:center}.view__login .input-wrapper{margin-bottom:9px;background:#fff;border-radius:3px}.view__login .input-wrapper input{width:240px;padding:12px 10px;margin:0;border:none;border-radius:3px}.view__login .input-wrapper input:focus{border:none;outline:0;box-shadow:none}.view__login .input-wrapper .icon-remove-sign{padding-right:20px;margin:0 -13px 0 0}.view__login .control-ssl{position:relative;padding-top:4px;margin-bottom:10px;font-size:12px;color:#a6a6a6}.view__login .control-ssl .checkbox{margin:0 -32px -8px -12px;width:40px;height:30px}.view__login .control-ssl .icon-checkbox{margin-left:0;padding-bottom:2px;vertical-align:middle}.view__login .btn{display:block;width:220px;padding:10px;margin:0 auto 9px;border:none;color:#fff}.view__login .btn#external_login_btn[disabled],.view__login .btn[disabled]{background-color:#000}.view__login .btn#external_login_btn{background-color:#234b84}.view__login .icon-spinner{display:inline-block;width:16px;height:16px;margin-top:-1px;margin-right:4px;vertical-align:middle}.view__login .control-group.error{position:relative;color:red}.view__login .control-group.error .icon-exclamation-circle{position:absolute;top:50%;right:-1.25em;margin-top:-.5em}.view__login .control-group.error small.error-display{display:none}.view__login .modal-link{position:absolute;bottom:2px;left:0;width:100%;font-size:.786em;text-align:center}.view__login .modal-link .version{opacity:.6}.view__login .modal-link .separator{position:relative;top:-1px;display:inline-block;width:9px;height:9px;border-radius:6px;background:#2d2d2d;font-size:0;line-height:0;vertical-align:middle}.view__login .modal-link a{display:inline-block;min-height:26px;padding:0 5px;color:#555}.about-page .control-group>label{font-size:.857em}.offline-page .bucket-header{border-bottom:solid 1px #e8e8e8}.offline-page .table{table-layout:fixed;margin-bottom:8px}.offline-page .table tr td:first-child{padding-left:12px}.offline-page .offline-row{padding:10px 12px;line-height:19px}.offline-page .offline-row .icon{float:left;margin-right:5px;font-size:10px}.offline-page .text-container{padding:8px 12px 0;margin-bottom:18px}.offline-page .btn-container{padding:0 12px;margin-bottom:18px}.offline-page .listing .content{margin:0 0 10px 12px}.offline-page .listing .content:before{content:\'\';display:block;clear:both}.offline-page .listing h4{margin:8px 0 0 12px;font-weight:700}.offline-page .listing select{width:92%;height:auto;margin:2px 0 10px 12px;padding:4px 10px;border:1px solid #999}.offline-page .listing .emulation-item .error-emulation-check{float:left}.offline-page .listing .emulation-item .error-emulation-select{float:right;width:40%;margin:8px 12px 0 0}.offline-page .error-emulation-check input[type=checkbox]{height:35px;width:35px;margin:8px 10px 8px 0;vertical-align:middle}.offline-page .modal-footer{padding-left:10px;text-align:left}.offline-page .btn-danger,.offline-page .btn-primary{line-height:1.575em}.icon{font-size:16px}.btn .icon{margin-top:3px}.actionsheet-select+.icon,select+.icon{display:inline-block;width:14px;margin:4px 0 0 -18px;font-size:1rem}.navbar .icon{vertical-align:middle}.form-horizontal .sms{position:relative}.form-horizontal .sms>span:after{content:"...";position:absolute;top:1px;color:#fff;font-weight:400;margin-left:-12px;letter-spacing:-1px;height:13px;width:9px}.record-action>a{height:60px;text-align:center;color:#fff}.record-action>a:active{background-color:#222}.record-action>a>i{margin-top:13px;line-height:18px}.record-action>a.disabled{background-color:#000;background-image:-webkit-gradient(linear,0 100%,100% 0,color-stop(.25,rgba(255,255,255,.15)),color-stop(.25,transparent),color-stop(.5,transparent),color-stop(.5,rgba(255,255,255,.15)),color-stop(.75,rgba(255,255,255,.15)),color-stop(.75,transparent),to(transparent));background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);-webkit-background-size:30px 30px;background-size:30px 30px;color:#999}.record-action>a .action-label{display:block;font-size:11px;color:#999}.record-action>a .action-label:first-letter{text-transform:uppercase}.ios .alert{-webkit-transform:translateZ(0)}.alert{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-flex-align:center;-webkit-align-items:center;align-items:center;min-height:42px;padding:0 10px;margin:0;z-index:2002;opacity:.94;font-size:12px;background:#f5f5f5;color:#5b5b5b}.alert.closeable{padding-right:25px}.alert .icon{position:absolute;top:14px;right:10px;font-size:14px;line-height:1;opacity:.8}.alert .icon-spinner{display:inline-block;position:absolute;top:14px;left:10px;right:auto;width:14px;height:14px}.alert .icon-spinner .icon-spinner-path{fill:#c2c2c2}.alert .icon-spinner+.message{padding-left:22px}.alert .message{padding:4px 0;line-height:15px;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:4;-webkit-box-orient:vertical}#alerts{position:absolute;bottom:0;left:0;height:auto;width:100%;z-index:9999}.syncApp #alerts{z-index:999999}#alerts .alert{position:relative}.has-pagination #alerts{bottom:50px}.legal:not(a){color:#696969}#preloader{position:absolute;width:100%;height:100%;top:0;left:0;z-index:9998;background:#2d2d2d}#preloader .modal{top:50%;margin-top:-40px}#preloader .message{color:#fff;font-size:.842em;text-align:center}.tablet #alerts{left:50%;width:400px;margin-left:-200px}.tablet #alerts .alert{margin-bottom:2px;border-top:0;border-radius:2px;font-size:13px}.data-unavailable-label{display:none;position:absolute;top:50%;left:0;right:0;margin-top:-20px;text-align:center}.alert-warning{background:#f6ac32;border-top:#fde4bd;color:#fff}.alert-warning .icon-remove{color:#c98c28}.alert-info{background:#095e94;border-top:1px solid #6a99b3;color:#fff}.alert-info .icon-remove{color:#064267}.alert-success{background:#368f01;border-top:1px solid #447826;color:#fff}.alert-success .icon-remove{color:#256300}.alert-error{background:#cb3a27;border-top:1px solid #efbfb9;color:#fff}.alert-error .icon-remove{color:#a62f1f}.alert-load{background:#f5f5f5;border-top:1px solid #fcfcfc}.alert-load .icon-remove{color:#5b5b5b}.alert[id^=demo-]{display:none}.alert:target{display:inline-block!important}.layout__Error{background:#000}.portrait .tablet #content .menuBtn,.portrait .tablet .layout__list .menuBtn{display:block}.landscape .tablet #content-child .menuBtn,.landscape .tablet #content-child .offline-status,.portrait .tablet #content-child .menuBtn,.portrait .tablet #content-child .offline-status{display:none}.portrait .tablet #content-child{left:340px}.portrait .tablet #content-child .backBtn{left:0}.landscape .tablet #content-child{left:340px}.b-vc,.b-vc-w:before{display:inline-block;vertical-align:middle}.b-vc-w{position:absolute;top:0;right:0;bottom:0;left:0;text-align:center}.b-vc-w:before{content:\'\';height:100%;margin-right:-.25em}.b-vc{width:90%}.error-message{color:red;font-size:18px}.sugar-back-link{color:#000;font-weight:700;padding:30px;text-align:center}.android .background{opacity:0}.bodyScroll,.bodyScroll body{overflow:visible}.bodyScroll body{background:#fff}.bodyScroll.loginView body{min-height:100%;height:auto;background:#2d2d2d}.bodyScroll.loginView body .view__login{position:static;background:0 0}.bodyScroll.loginView body #content,.bodyScroll.loginView body #wrapper{-webkit-transform:none!important}.bodyScroll #menu-left{overflow:hidden;position:absolute}.bodyScroll .navbar .nav-collapse{background:0 0}.bodyScroll #menu-left:not(.hide)+#content{padding-top:50px}.bodyScroll .header-actions{top:50px}.bodyScroll #content,.bodyScroll #content .layout__def,.bodyScroll #content-child,.bodyScroll #content-child .layout__def,.bodyScroll #nomad,.bodyScroll #wrapper,.bodyScroll .easy-scroller-holder,.bodyScroll .easy-scroller-parent,.bodyScroll .navbar,.bodyScroll .scroll{position:static}.bodyScroll .navbar{height:50px}.bodyScroll .scroll{overflow:visible}.bodyScroll #alerts{position:fixed}.bodyScroll .rotate #alerts{position:absolute}.bodyScroll #nomad{-webkit-animation:triggerRepaint .4s 1;animation:triggerRepaint .4s 1}.bodyScroll .dw-modal{position:absolute;top:0;right:0;bottom:0;left:0}.bodyScroll .actionsheet-overlay{position:fixed}.bodyScroll .mobile #wrapper{box-shadow:none}.bodyScroll #smartbanner{position:relative!important}.ellipsis .label-module-sm{margin-right:7px}@media screen and (max-width:767px){.portrait .tablet.show-content-child #content{width:44%}.portrait .tablet #content-child{left:44%}}.portrait .tablet.narrow-tablet-mode #moduleList{width:100%}.portrait .tablet.narrow-tablet-mode #content{right:0}.portrait .tablet.narrow-tablet-mode #content-child .navbar-inner{border-left:none}.portrait .tablet.narrow-tablet-mode #content-child .menuBtn,.portrait .tablet.narrow-tablet-mode #content-child .offline-status{display:block}.portrait .tablet.narrow-tablet-mode #content-child .status-success,.portrait .tablet.narrow-tablet-mode.show-content-child #content{display:none}.portrait .tablet.narrow-tablet-mode.show-content-child #content-child{left:0;display:block}.icon-md:before{vertical-align:top;font-size:20px}.icon-remove:before{content:"\\f00d"}.icon-remove-sign:before{content:"\\f057"}.icon{line-height:inherit}.btn .icon,.nav-tabs .icon{line-height:.9em}.icon-pipeline{width:1em;height:1em;background:url('+i(162)+") 50% 50% no-repeat;background-size:contain}.rotate{opacity:.99}.rotate #moduleList{overflow:hidden}.desktop .taggable{width:100%!important}.layout-detail .tag-item{display:inline-block;padding:2px 13px 1px;margin:5px 4px 5px 0;background-color:#fff;border-radius:11px;font-size:.86rem;color:#222}.setupbuddy__wrapper{background-color:#fff}.setupbuddy__wrapper .sb__text__container{position:absolute;top:10%;left:50%;width:316px}.setupbuddy__wrapper .sb__text__container .sb__text{position:relative;width:100%;left:-50%;padding:10px;margin-left:-12px;text-align:center}.setupbuddy__wrapper .sb__text__container .sb__header{font-size:1.143rem;font-weight:700;margin:10px 0 20px}.setupbuddy__wrapper .sb__text__container .sb__icon{position:relative;text-align:center;left:50%;margin-bottom:40px}.setupbuddy__wrapper .sb__text__container .icon-touch-id{position:relative;width:70px;height:70px;left:-35px;background:url("+i(163)+") no-repeat;background-size:contain}.setupbuddy__wrapper .sb__text__container .sb__description{margin-top:10px}.setupbuddy__wrapper .sb__text__container .sb__controls{padding:40px 10px 0;position:relative}.setupbuddy__wrapper .sb__text__container .sb__controls .sb__control{padding:9px 10px;color:#176de5}.setupbuddy__wrapper .sb__text__container .sb__controls .left{float:left}.pull-right,.setupbuddy__wrapper .sb__text__container .sb__controls .right{float:right}.setupbuddy__wrapper .sb__footer{position:absolute;bottom:30px;left:0;width:100%;text-align:center;font-size:.857rem;padding:5px 10px}.pull-left{float:left}.hide{display:none}.show{display:block}.tcenter{text-align:center!important}.tleft{text-align:left!important}.tright{text-align:right!important}.rotate1{-webkit-animation:rotation1 .15s 1 linear;-webkit-transform:rotate(180deg)}@-webkit-keyframes rotation1{from{-webkit-transform:rotate(0)}to{-webkit-transform:rotate(180deg)}}.rotate2{-webkit-animation:rotation2 .15s 1 linear;-webkit-transform:rotate(0)}@-webkit-keyframes rotation2{from{-webkit-transform:rotate(180deg)}to{-webkit-transform:rotate(0)}}.rotate360{-webkit-animation:spin .7s infinite linear}@-webkit-keyframes spin{from{-webkit-transform:rotate(0)}to{-webkit-transform:rotate(359deg)}}.pull-to-refresh{z-index:-1;position:absolute;top:0;left:0;width:100%;background:#f5f5f5;height:50%;min-height:50%;padding-top:10px;text-align:center}.pull-to-refresh .icon-wrap{display:inline-block;width:1em;height:1em;padding:.1em;border-radius:1.1em;font-size:27px;line-height:1em;background-color:#e0e0e0;background-image:-webkit-gradient(linear,0 0,0 100%,from(#d3d3d3),to(#f4f4f4));background-image:-webkit-linear-gradient(top,#d3d3d3,#f4f4f4);background-image:linear-gradient(top,#d3d3d3,#f4f4f4);background-repeat:repeat-x;border-color:#f4f4f4 #f4f4f4 #cecece;border-color:rgba(0,0,0,.1) rgba(0,0,0,.1) rgba(0,0,0,.25);box-shadow:inset 0 2px 2px 0 #c4c4c4;text-align:center;opacity:.4;-webkit-transition:opacity .6s}.pull-to-refresh .icon-wrap.color{opacity:1}.pull-to-refresh .icon-wrap .icon-refresh{font-size:21px}.pull-to-refresh .spinner{display:block}#pull-to-refresh-div{position:relative!important;height:0;display:block!important}.rtl{direction:rtl}.rtl .backBtn,.rtl .dashHomeBtn,.rtl .menuBtn,.rtl .offline-status{float:right}.rtl .createBtn,.rtl .navbar .save-container,.rtl .navbar .save-container .caretBtn,.rtl .navbar .save-container .saveBtn{float:left}.rtl .backBtn{-webkit-transform:scale(-1);transform:scale(-1)}.rtl .label-module-sm{padding:4px 4px 0 0;text-align:right}.rtl .label-module-sm.icon-inside .label-module-sm_title{right:4px}.rtl .navbar .btn-area-more{float:right}.rtl .navbar .right-menu .icon{margin:0 -2px 0 8px}.rtl .navbar .nav-collapse .nav li a{padding:13px 15px 13px 12%}.rtl .navbar .nav-collapse .nav li .label-module-sm{margin:-6px 0 -4px 7px}.rtl #menu-left .nav-collapse li a .icon-user,.rtl .navbar .nav-collapse .nav .icon-circle{margin-left:5px;margin-right:0}.rtl .navbar .navbar-inner .backBtn+.nomad,.rtl .navbar .navbar-inner .dashHomeBtn+.nomad{right:90px}.rtl .view__search-box .topelbar{padding:5px 5px 5px 121px}.rtl .view__search-box .search-query{padding:4px 32px 4px 35px}.rtl .view__search-box .view__search-box__actions{left:10px;right:auto}.rtl .view__search-box .icon-remove-sign{right:auto;left:5px}.rtl .view__search-box .icon-search{right:14px;left:auto}.rtl .view__search-box .icon-spinner{right:9px;left:auto}.rtl .view__search-box .favoriteable{padding-left:134px}.rtl .view__search-box .favoriteable .search-query{padding-left:95px}.rtl .view__search-box .favoriteable .icon-remove-sign{left:70px;right:auto}.rtl .view__search-box .hidden-my-items{padding-left:74px}.rtl .taggable-dropdown .label-module-sm{margin:0 0 0 10px}.rtl .dropdown.dropdown__filter{left:auto;right:7px}.rtl .dropdown.dropdown__sortBy{left:7px;right:auto}.rtl .box__filter .filter__item{padding-left:0;padding-right:4px}.rtl .box__filter .filter__item:first-child{padding-right:0}.rtl .filters-wrap{padding-right:10px;padding-left:5px}.rtl .filter{padding-right:0;padding-left:20px}.rtl .filter .actionsheet-select,.rtl .filter select{padding-right:0;padding-left:16px}.rtl .listing article.nav{padding:0 14px}.rtl .listing article.nav .loading-holder .icon-spinner{margin-left:5px;margin-right:0}.rtl .listing article{padding:8px 12px 8px 8px}.rtl .listing article.has-grip,.rtl .listing article.item-checkbox{padding-left:32px}.rtl .listing article>input[type=checkbox]{float:left!important}.rtl .listing article>input[type=checkbox]+i{float:left;margin:17px 0 0 -18px}.rtl .menu-container-grip{left:0;right:auto;padding:0 15px 0 0}.rtl .menu-container .grip{right:0;left:auto;padding:0 10px 0 2px}.rtl .menu-container a{padding-right:5%;padding-left:0}.rtl .listing .list-item .module-name,.rtl .listing .list-item .module-name-comma,.rtl .listing .list-view-item .module-name,.rtl .listing .list-view-item .module-name-comma,.rtl .listing .parent-item .module-name,.rtl .listing .parent-item .module-name-comma{float:right}.rtl .listing article.item-checkbox .asscacct,.rtl .listing article.item-checkbox .icon-checkbox{left:22px;right:auto;margin:-.5em 0 0 -.5em}.rtl .picker-list-row .label-module-sm{margin:-2px 0 0 9px}.rtl .bizcard .avatar{left:auto;right:10px}.rtl .bizcard .input_upload{left:auto;right:0}.rtl .bizcard .label-module-sm{left:auto;right:10px;padding:13px 10px 0 0}.rtl .bizcard .card{padding:10px 42px 0 10px}.rtl .bizcard.icon-inside .card{padding:10px 90px 0 44px}.rtl .bizcard .more .icon-chevron-right{left:0;right:auto;-webkit-transform:scale(-1);transform:scale(-1)}.rtl .bizcard .more .show-more{left:auto;right:0}.rtl .bizcard .more .follow-label{left:0;right:auto}.rtl .bizcard .favorite-icon{left:3px;right:auto}.rtl .bizcard .followable .favorite-icon{left:82px}.rtl .bizcard .record-action a:first-child{border-left:solid 1px #0f0f0f}.rtl .bizcard .record-action a:last-child{border-left:none}.rtl ul.actions li{padding-left:0;padding-right:10px}.rtl ul.actions li a{padding-left:44px;padding-right:0}.rtl ul.actions li .label-module-sm{margin-right:0;margin-left:9px}.rtl ul.actions li .records-count{display:inline-block}.rtl ul.actions li .create-related{left:0;right:auto;padding-left:0}.rtl ul.actions li .more{-webkit-transform:scale(-1);transform:scale(-1);left:10px;right:auto}.rtl .edit .control-group.date .btn-group,.rtl .edit .control-group.datetime .btn-group{left:0;right:auto}.rtl .btn-group .btn{float:right;border-radius:0}.rtl .btn-group .btn:first-child{margin-left:-1px;border-top-right-radius:3px;border-bottom-right-radius:3px}.rtl .btn-group .btn:last-child{margin-left:0;border-top-left-radius:3px;border-bottom-left-radius:3px}.rtl .edit .control-group .controls{float:left;margin:0}.rtl .edit .control-group .controls .checkbox+i.icon-checkbox{margin:4px -65% 0 0}.rtl .edit .control-group .control-label{float:right;margin:0 0 5px 4%}.rtl .edit .control-group.datetime .date{float:right;margin-right:0;margin-left:10px;border-right:none}.rtl .edit .control-group.datetime .date input{padding-left:0}.rtl .edit .control-group.datetime .time{float:right;border-right:solid 1px #f2f2f2;border-left:none}.rtl .edit .control-group.datetime .time input{padding-left:0;padding-right:10px}.rtl .edit .control-group.datetime .controls.has-btn-group{padding-left:1.5rem;padding-right:0}.rtl .edit .control-group.file .picture-wrap{float:right}.rtl .edit .control-group.error .controls{padding-left:25px;padding-right:0}.rtl .edit .control-group.error .icon-exclamation-circle{left:15px;right:auto}.rtl .edit .control-group.error.field__address .icon-exclamation-circle+.error-display,.rtl .edit .control-group.error.field__relate .icon-exclamation-circle+.error-display{padding-top:2rem}.rtl .edit .uneditable-input,.rtl .edit input:not([type=checkbox]),.rtl .edit select,.rtl .edit textarea{float:right;padding-right:0;padding-left:15%;text-align:right}.rtl .edit .horizontal-fieldset .control-group .controls{float:none;margin:0}.rtl .currency_edit .wrapper{padding-right:65px;padding-left:0}.rtl .currency_edit .wrapper .selector{float:right;margin-left:0;margin-right:-65px}.rtl .currency_edit .wrapper .selector .icon-caret-down{float:right!important}.rtl .currency_edit .wrapper .selector select{padding:0 15px 0 0}.rtl .dashboard,.rtl .pagination__bar{direction:ltr}.rtl .dashlet__b,.rtl .dashlets__list{direction:rtl}.rtl #tutorial,.rtl .chart{direction:ltr}.rtl .panel__addpost .placeholder{margin-left:10px;margin-right:0}.rtl .panel__addpost .btn{float:left}.rtl .as__detail{padding:8px 46px 8px 32px}.rtl .as__detail .as__icon .icon{margin-right:0}.rtl .as__detail .as__icon,.rtl .as__detail .label-module-sm{float:right;margin:4px -36px 0 0}.rtl .comments-container{margin-left:0;margin-right:46px}.rtl .comment__item{padding:6px 38px 6px 10px}.rtl .comment__item .icon-user{float:right;margin:4px -38px 0 0}.rtl .tb__detail .tb__icon{float:right;padding:2px 0 0 5px}.rtl .learning-resources .resource-list .resource .resource-info{margin-right:44px;margin-left:0}.rtl .alert.closeable{padding:4px 10px 4px 25px}.rtl .alert .icon{right:auto;left:10px}.rtl .alert .icon-spinner{right:10px;left:auto}.rtl .alert .icon-spinner+.message{padding:0 20px 0 0}.rtl .menu-container{left:auto;right:100%}.rtl .menu-container.on{right:0}.rtl .ios .menu-container{right:auto;-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0);-webkit-transition-duration:.15s;transition-duration:.15s}.rtl .ios .menu-container.on{left:0;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.rtl .view__login .input-wrapper .icon-remove-sign{margin-left:0}.rtl .view__login .icon-spinner{margin-right:0;margin-left:2px}.rtl .offline-page .offline-row .icon{float:right;margin-left:5px;margin-right:0}.rtl .mobile .right-menu{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0);left:-3px;right:0}.rtl .tablet .right-menu{left:0;right:auto}.rtl .tablet #menu-left{left:auto;right:0}.rtl .tablet #wrapper{right:56px;left:0;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.rtl .tablet #content .overlay_right-menu,.rtl .tablet .layout__Login,.rtl .tablet .layout__def.no-main-menu{left:0;right:-56px}.rtl.portrait .tablet.narrow-tablet-mode.show-content-child #content-child{right:0}.rtl.portrait .tablet #moduleList{-webkit-transform:translate(100%,0,0);transform:translate(100%,0,0)}.rtl.portrait .tablet #content-child{left:0;right:340px}.rtl.portrait .tablet #content-child .backBtn{left:0;right:0}.rtl.landscape .tablet #content-child{left:0;right:340px}.rtl select+.icon{margin:4px -18px 0 0}.rtl .table td,.rtl .table th{text-align:right}.rtl .pull-right{float:left}.rtl .pull-left{float:right}.rtl .input-wrapper .icon-remove-sign{margin-right:0;margin-left:-10px}@media screen and (max-width:767px){.rtl.portrait .tablet #content-child{right:44%;left:0}}",""]);

},function(e,t,i){e.exports=i.p+"../font/fontawesome-webfont.ttf"},function(e,t,i){e.exports=i.p+"../img/logo-login.svg"},function(e,t,i){e.exports=i.p+"../img/icon-pipeline.svg"},function(e,t,i){e.exports=i.p+"../img/icon-touchid.svg"},function(e,t){var n=SUGAR.App;SUGAR.expressions.AndExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.AndExpression,SUGAR.expressions.BooleanExpression,{className:"AndExpression",evaluate:function(){var e=this.getParameters();if(!(e instanceof Array))e=[e];for(var t=0;t<e.length;t++){if(e[t].evaluate()!=SUGAR.expressions.Expression.TRUE)return SUGAR.expressions.Expression.FALSE}return SUGAR.expressions.Expression.TRUE}});SUGAR.expressions.BinaryDependencyExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.BinaryDependencyExpression,SUGAR.expressions.BooleanExpression,{className:"BinaryDependencyExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate();var i=e[1].evaluate();if(t!=null&&i!=null&&t!=""&&i!="")return SUGAR.expressions.Expression.TRUE;return SUGAR.expressions.Expression.FALSE},getParamCount:function(){return 2},getParameterTypes:function(){return["string","string"]}});SUGAR.expressions.EqualExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.EqualExpression,SUGAR.expressions.BooleanExpression,{className:"EqualExpression",evaluate:function(){var e=SUGAR.expressions.Expression,t=this.getParameters(),i=t[0].evaluate(),n=t[1].evaluate(),a=t[0]instanceof SUGAR.expressions.BooleanExpression||t[1]instanceof SUGAR.expressions.BooleanExpression;if(i==n||a&&(e.isTruthy(i)&&e.isTruthy(n)||!e.isTruthy(i)&&!e.isTruthy(n))){return e.TRUE}return e.FALSE},getParamCount:function(){return 2},getParameterTypes:function(){return["generic","generic"]}});SUGAR.expressions.GreaterThanExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.GreaterThanExpression,SUGAR.expressions.BooleanExpression,{className:"GreaterThanExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate();var i=e[1].evaluate();if(t>i)return SUGAR.expressions.Expression.TRUE;return SUGAR.expressions.Expression.FALSE},getParamCount:function(){return 2},getParameterTypes:function(){return["number","number"]}});SUGAR.expressions.isAfterExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.isAfterExpression,SUGAR.expressions.BooleanExpression,{className:"isAfterExpression",evaluate:function(){var e=this.getParameters();var t=SUGAR.util.DateUtils.parse(e[0].evaluate());var i=SUGAR.util.DateUtils.parse(e[1].evaluate());if(!t||!i||isNaN(t)||isNaN(i)){return SUGAR.expressions.Expression.FALSE}if(t>i)return SUGAR.expressions.Expression.TRUE;return SUGAR.expressions.Expression.FALSE},getParamCount:function(){return 2},getParameterTypes:function(){return["date","date"]}});SUGAR.expressions.IsAlphaExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IsAlphaExpression,SUGAR.expressions.BooleanExpression,{className:"IsAlphaExpression",evaluate:function(){var e=this.getParameters().evaluate();if(/^[a-zA-Z]+$/.test(e))return SUGAR.expressions.Expression.TRUE;return SUGAR.expressions.Expression.FALSE},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.IsAlphaNumericExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IsAlphaNumericExpression,SUGAR.expressions.BooleanExpression,{className:"IsAlphaNumericExpression",evaluate:function(){var e=this.getParameters().evaluate();if(/^[a-zA-Z0-9]+$/.test(e))return SUGAR.expressions.Expression.TRUE;return SUGAR.expressions.Expression.FALSE},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.isBeforeExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.isBeforeExpression,SUGAR.expressions.BooleanExpression,{className:"isBeforeExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate();var i=e[1].evaluate();if(!t||!i||isNaN(t)||isNaN(i)){return SUGAR.expressions.Expression.FALSE}if(t<i)return SUGAR.expressions.Expression.TRUE;return SUGAR.expressions.Expression.FALSE},getParamCount:function(){return 2},getParameterTypes:function(){return["date","date"]}});SUGAR.expressions.IsForecastClosedExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IsForecastClosedExpression,SUGAR.expressions.BooleanExpression,{className:"IsForecastClosedExpression",evaluate:function(){var e=this.getParameters().evaluate();if(n===undefined){return SUGAR.expressions.Expression.FALSE}var t=n.metadata.getModule("Forecasts","config");status=["Closed Won","Closed Lost"];if(!_.isUndefined(t)){status=_.union(t.sales_stage_won,t.sales_stage_lost)}if(status.indexOf(e)===-1){return SUGAR.expressions.Expression.FALSE}return SUGAR.expressions.Expression.TRUE},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.IsForecastClosedLostExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IsForecastClosedLostExpression,SUGAR.expressions.BooleanExpression,{className:"IsForecastClosedLostExpression",evaluate:function(){var e=this.getParameters().evaluate();if(n===undefined){return SUGAR.expressions.Expression.FALSE}var t=n.metadata.getModule("Forecasts","config")||{},i=t.sales_stage_lost||["Closed Lost"];if(i.indexOf(e)===-1){return SUGAR.expressions.Expression.FALSE}return SUGAR.expressions.Expression.TRUE},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.IsForecastClosedWonExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IsForecastClosedWonExpression,SUGAR.expressions.BooleanExpression,{className:"IsForecastClosedWonExpression",evaluate:function(){var e=this.getParameters().evaluate();if(n===undefined){return SUGAR.expressions.Expression.FALSE}var t=n.metadata.getModule("Forecasts","config")||{},i=t.sales_stage_won||["Closed Won"];if(i.indexOf(e)===-1){return SUGAR.expressions.Expression.FALSE}return SUGAR.expressions.Expression.TRUE},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.IsInEnumExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IsInEnumExpression,SUGAR.expressions.BooleanExpression,{className:"IsInEnumExpression",evaluate:function(){var e=this.getParameters();var t=e[1].evaluate();var i=e[0].evaluate();for(var n=0;n<t.length;n++){var a=t[n];if(a instanceof SUGAR.expressions.Expression)a=a.evaluate();if(a==i)return SUGAR.expressions.Expression.TRUE}return SUGAR.expressions.Expression.FALSE},getParamCount:function(){return 2},getParameterTypes:function(){return["generic","enum"]}});SUGAR.expressions.IsInRangeExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IsInRangeExpression,SUGAR.expressions.BooleanExpression,{className:"IsInRangeExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate();var i=e[1].evaluate();var n=e[2].evaluate();if(t>=i&&t<=n)return SUGAR.expressions.Expression.TRUE;return SUGAR.expressions.Expression.FALSE},getParamCount:function(){return 3},getParameterTypes:function(){return["number","number","number"]}});SUGAR.expressions.IsNumericExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IsNumericExpression,SUGAR.expressions.BooleanExpression,{className:"IsNumericExpression",evaluate:function(){var e=this.getParameters().evaluate();if(e===""||e===null){return SUGAR.expressions.Expression.FALSE}if(isFinite(e)&&!isNaN(parseFloat(e))){return SUGAR.expressions.Expression.TRUE}return SUGAR.expressions.Expression.FALSE},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.IsRequiredCollectionExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IsRequiredCollectionExpression,SUGAR.expressions.BooleanExpression,{className:"IsRequiredCollectionExpression",evaluate:function(){var e=this.getParameters().evaluate();table=document.getElementById(e);children=YAHOO.util.Dom.getElementsByClassName("sqsEnabled","input",table);for(id in children){if(trim(children[id].value)!=""){return SUGAR.expressions.Expression.TRUE}}return SUGAR.expressions.Expression.FALSE},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.IsValidDateExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IsValidDateExpression,SUGAR.expressions.BooleanExpression,{className:"IsValidDateExpression",evaluate:function(){var e=this.getParameters().evaluate();if(typeof e!="string"||e=="")return SUGAR.expressions.Expression.FALSE;var t="Y-m-d";if(SUGAR.expressions.userPrefs)t=SUGAR.expressions.userPrefs.datef;var i=SUGAR.util.DateUtils.parse(e,t);if(i!=false&&i!="Invalid Date")return SUGAR.expressions.Expression.TRUE;return SUGAR.expressions.Expression.FALSE},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.IsValidDBNameExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IsValidDBNameExpression,SUGAR.expressions.BooleanExpression,{className:"IsValidDBNameExpression",evaluate:function(){var e=this.getParameters().evaluate();if(e.length==0){return true}if(!/^[a-zA-Z][a-zA-Z\_0-9]+$/.test(e))return SUGAR.expressions.Expression.FALSE;return SUGAR.expressions.Expression.TRUE},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.IsValidEmailExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IsValidEmailExpression,SUGAR.expressions.BooleanExpression,{className:"IsValidEmailExpression",evaluate:function(){var e=this.getParameters().evaluate();if(typeof e!="string")return SUGAR.expressions.Expression.FALSE;if(e=="")return SUGAR.expressions.Expression.TRUE;var t=e.charAt(e.length-1);if(!t.match(/[^\.]/i))return SUGAR.expressions.Expression.FALSE;var i=e.split(/[,;]/);for(var n=0;n<i.length;n++){var a=i[n];a=a.replace(/^\s+|\s+$/g,"");if(a!=""&&!/^.+@.+$/gi.test(a)){return SUGAR.expressions.Expression.FALSE}}return SUGAR.expressions.Expression.TRUE},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.IsValidPhoneExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IsValidPhoneExpression,SUGAR.expressions.BooleanExpression,{className:"IsValidPhoneExpression",evaluate:function(){var e=this.getParameters().evaluate();if(e.length==0)return SUGAR.expressions.Expression.TRUE;if(!/^\+?[0-9\-\(\)\s]+$/.test(e))return SUGAR.expressions.Expression.FALSE;return SUGAR.expressions.Expression.TRUE},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.IsValidTimeExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IsValidTimeExpression,SUGAR.expressions.BooleanExpression,{className:"IsValidTimeExpression",evaluate:function(){var e=this.getParameters().evaluate();var t=/^(\d{1,2}):(\d\d)\s*([ap]m)?$/i;if(e.length==0)return SUGAR.expressions.Expression.TRUE;myregexp=new RegExp(t);if(!myregexp.test(e))return SUGAR.expressions.Expression.FALSE;var i=e.match(t);if(i[1]>23||i[2]>59){return SUGAR.expressions.Expression.FALSE}if(i[3]&&(i[1]>12||i[1]==0)){return SUGAR.expressions.Expression.FALSE}return SUGAR.expressions.Expression.TRUE},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.NotExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.NotExpression,SUGAR.expressions.BooleanExpression,{className:"NotExpression",evaluate:function(){if(this.getParameters().evaluate()==SUGAR.expressions.Expression.FALSE)return SUGAR.expressions.Expression.TRUE;else return SUGAR.expressions.Expression.FALSE},getParamCount:function(){return 1}});SUGAR.expressions.OrExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.OrExpression,SUGAR.expressions.BooleanExpression,{className:"OrExpression",evaluate:function(){var e=this.getParameters();for(var t=0;t<e.length;t++){if(e[t].evaluate()==SUGAR.expressions.Expression.TRUE)return SUGAR.expressions.Expression.TRUE}return SUGAR.expressions.Expression.FALSE}});SUGAR.expressions.AddDaysExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.AddDaysExpression,SUGAR.expressions.DateExpression,{className:"AddDaysExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate();if(!t){return""}var i=parseInt(e[1].evaluate(),10);if(_.isNaN(i)){return""}var a=SUGAR.util.DateUtils.parse(t,"user");var o=new Date(a);o.setDate(o.getDate()+i);if(this.context.view){o=n.date.format(o,"Y-m-d")}return o},getParamCount:function(){return 2},getParameterTypes:function(){return["date","number"]}});SUGAR.expressions.DayOfWeekExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.DayOfWeekExpression,SUGAR.expressions.NumericExpression,{className:"DayOfWeekExpression",evaluate:function(){var e,t=this.getParameters().evaluate();if(_.isString(t)&&_.isEmpty(t)){return""}if(this.context.view){e=n.date(t).format("d").toString()}else{e=new Date(t).getDay()}return e},getParamCount:function(){return 1},getParameterTypes:function(){return["date"]}});SUGAR.expressions.DaysUntilExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.DaysUntilExpression,SUGAR.expressions.NumericExpression,{className:"DaysUntilExpression",evaluate:function(){var e=SUGAR.util.DateUtils.parse(this.getParameters().evaluate(),"user");var t=new Date;e.setHours(0);e.setMinutes(0);e.setSeconds(0);var i=e-t;var n=Math.ceil(i/864e5);return n},getParamCount:function(){return 1},getParameterTypes:function(){return["date"]}});SUGAR.expressions.DefineDateExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.DefineDateExpression,SUGAR.expressions.DateExpression,{className:"DefineDateExpression",evaluate:function(){var e=this.getParameters().evaluate();var t=SUGAR.util.DateUtils.parse(e,"user");if(t==false)throw"Incorrect date format";return t},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.HoursUntilExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.HoursUntilExpression,SUGAR.expressions.NumericExpression,{className:"HoursUntilExpression",evaluate:function(){var e=this.getParameters().evaluate();var t=SUGAR.util.DateUtils.parse(e);if(!t&&t!==0)return false;var i=new Date;if(typeof e=="string"&&e.indexOf(" ")==-1&&e.indexOf("T")==-1){i.setHours(0,0,0,0)}var n=t-i;return~~(n/36e5)},getParamCount:function(){return 1},getParameterTypes:function(){return["date"]}});SUGAR.expressions.MaxRelatedDateExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.MaxRelatedDateExpression,SUGAR.expressions.DateExpression,{className:"MaxRelatedDateExpression",evaluate:function(){},getParameterTypes:function(){return["relate","string"]}});SUGAR.expressions.MonthOfYearExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.MonthOfYearExpression,SUGAR.expressions.NumericExpression,{className:"MonthOfYearExpression",evaluate:function(){var e=this.getParameters().evaluate();return new Date(e).getMonth()+1},getParamCount:function(){return 1},getParameterTypes:function(){return["date"]}});SUGAR.expressions.NowExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.NowExpression,SUGAR.expressions.DateExpression,{className:"NowExpression",evaluate:function(){var e=SUGAR.util.DateUtils.getUserTime();e.setSeconds(0);if(this.context.view){e=n.date.format(e,"Y-m-d H:i:s")}return e},getParamCount:function(){return 0}});SUGAR.expressions.TimestampExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.TimestampExpression,SUGAR.expressions.DateExpression,{className:"TimestampExpression",evaluate:function(){var e=this.getParameters().evaluate(),t,i=[],n=this.context.parseDate(e);return Math.round(+n.getTime()/1e3)},getParamCount:function(){return 1}});SUGAR.expressions.TodayExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.TodayExpression,SUGAR.expressions.DateExpression,{className:"TodayExpression",evaluate:function(){var e=new Date;e.setHours(0);e.setMinutes(0);e.setSeconds(0);if(this.context.view){e=n.date.format(e,"Y-m-d")}return e},getParamCount:function(){return 0}});SUGAR.expressions.DefineEnumExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.DefineEnumExpression,SUGAR.expressions.EnumExpression,{className:"DefineEnumExpression",evaluate:function(){var e=this.getParameters();var t=[];if(typeof e.length!="undefined"){for(var i=0;i<e.length;i++){t[t.length]=e[i].evaluate()}}else{return[e.evaluate()]}return t},getParameterTypes:function(){return"generic"}});SUGAR.expressions.ForecastIncludedCommitStagesExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.ForecastIncludedCommitStagesExpression,SUGAR.expressions.EnumExpression,{className:"ForecastIncludedCommitStagesExpression",evaluate:function(){if(n===undefined){return SUGAR.language.get("app_list_strings","sales_stage_dom")}var e=n.metadata.getModule("Forecasts","config");return e.commit_stages_included},getParamCount:function(){return 0},getParameterTypes:function(){return[]}});SUGAR.expressions.ForecastSalesStageExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.ForecastSalesStageExpression,SUGAR.expressions.EnumExpression,{className:"ForecastSalesStageExpression",evaluate:function(){if(n===undefined){return SUGAR.language.get("app_list_strings","sales_stage_dom")}var e=SUGAR.expressions.Expression,t=n.metadata.getModule("Forecasts","config"),i=this.getParameters(),a=i[0].evaluate(),o=i[1].evaluate(),s=n.lang.getAppListStrings("sales_stage_dom"),r=[];if(!e.isTruthy(a)){r=_.union(r,t.sales_stage_won)}if(!e.isTruthy(o)){r=_.union(r,t.sales_stage_lost)}return _.without(s,r)},getParamCount:function(){return 2},getParameterTypes:function(){return["boolean","boolean"]}});SUGAR.expressions.SugarDropDownExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.SugarDropDownExpression,SUGAR.expressions.EnumExpression,{className:"SugarDropDownExpression",evaluate:function(){var e=this.getParameters().evaluate(),t,i=[];if(n){t=n.lang.getAppListStrings(e)}else{t=SUGAR.language.get("app_list_strings",e)}if(t&&t!="undefined"){for(var a in t){if(typeof a=="string")i[i.length]=a}}return i},getParamCount:function(){return 1},getParameterTypes:function(){return"string"}});SUGAR.expressions.SugarListWhereExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.SugarListWhereExpression,SUGAR.expressions.EnumExpression,{className:"SugarListWhereExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate();var i=e[1].evaluate();var n=[];for(var a=0;a<i.length;a++){if(i[a].length>0){if(i[a][0]==t){n=i[a][1];break}}}return n=="undefined"?[]:n},getParamCount:function(){return 2},getParameterTypes:function(){return["string","enum"]}});SUGAR.expressions.SugarTranslatedDropDownExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.SugarTranslatedDropDownExpression,SUGAR.expressions.EnumExpression,{className:"SugarTranslatedDropDownExpression",evaluate:function(){var e=this.getParameters().evaluate(),t,i=[];if(n){t=n.lang.getAppListStrings(e)}else{t=SUGAR.language.get("app_list_strings",e)}if(t&&t!="undefined"){for(var a in t){if(typeof a=="string")i[i.length]=t[a]}}return i},getParamCount:function(){return 1},getParameterTypes:function(){return"string"}});SUGAR.expressions.ConditionExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.ConditionExpression,SUGAR.expressions.GenericExpression,{className:"ConditionExpression",evaluate:function(){var e=SUGAR.expressions.Expression,t=this.getParameters(),i=t[0].evaluate();if(e.isTruthy(i)){return t[1].evaluate()}else{return t[2].evaluate()}},getParamCount:function(){return 3},getParameterTypes:function(){return["boolean","generic","generic"]}});SUGAR.expressions.CurrencyRateExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.CurrencyRateExpression,SUGAR.expressions.GenericExpression,{className:"CurrencyRateExpression",evaluate:function(){if(n===undefined){return SUGAR.expressions.Expression.FALSE}var e=this.getParameters().evaluate();return n.metadata.getCurrency(e).conversion_rate},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.IndexValueExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IndexValueExpression,SUGAR.expressions.GenericExpression,{className:"IndexValueExpression",evaluate:function(){var e=this.getParameters();var t=e[1].evaluate();var i=e[0].evaluate();if(typeof i=="string"&&!isNaN(i))i=Number(i);if(i>=t.length||i<0)throw"value_at: Attempt to access an index out of bounds";return t[i]},getParamCount:function(){return 2},getParameterTypes:function(){return["number","enum"]}});SUGAR.expressions.RelatedFieldExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.RelatedFieldExpression,SUGAR.expressions.GenericExpression,{className:"RelatedFieldExpression",evaluate:function(){if(this.context.model&&this.context.model.isNew()){return}var e=this.getParameters(),t=e[0].evaluate(),i=e[1].evaluate();if(typeof t=="string"&&t!=""){return this.context.getRelatedField(t,"related",i)}else if(typeof rel=="object"){}return""},getParamCount:function(){return 2},getParameterTypes:function(){return["relate","string"]}});SUGAR.expressions.SugarFieldExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.SugarFieldExpression,SUGAR.expressions.GenericExpression,{className:"SugarFieldExpression",evaluate:function(){var e=this.getParameters().evaluate();return SUGAR.forms.AssignmentHandler.getValue(e)},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.AbsoluteValueExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.AbsoluteValueExpression,SUGAR.expressions.NumericExpression,{className:"AbsoluteValueExpression",evaluate:function(){return Math.abs(this.getParameters().evaluate())},getParamCount:function(){return 1}});SUGAR.expressions.AddExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.AddExpression,SUGAR.expressions.NumericExpression,{className:"AddExpression",evaluate:function(){var e=this.getParameters(),t=0;for(var i=0;i<e.length;i++){t=this.context.add(t,e[i].evaluate())}return t}});SUGAR.expressions.AverageExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.AverageExpression,SUGAR.expressions.NumericExpression,{className:"AverageExpression",evaluate:function(){var e=0;var t=0;var i=this.getParameters();for(var n=0;n<i.length;n++){e=this.context.add(e,i[n].evaluate());t++}return this.context.divide(e,t)}});SUGAR.expressions.AverageRelatedExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.AverageRelatedExpression,SUGAR.expressions.NumericExpression,{className:"AverageRelatedExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate();var i=e[1].evaluate();if(typeof t=="string"&&t!=""){return SUGAR.forms.AssignmentHandler.getRelatedField(t,"rollupAve",i)}else if(typeof rel=="object"){}return""},getParamCount:function(){return 2},getParameterTypes:function(){return["relate","string"]}});SUGAR.expressions.CeilingExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.CeilingExpression,SUGAR.expressions.NumericExpression,{className:"CeilingExpression",evaluate:function(){return Math.ceil(this.getParameters().evaluate())},getParamCount:function(){return 1}});SUGAR.expressions.CountRelatedExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.CountRelatedExpression,SUGAR.expressions.NumericExpression,{className:"CountRelatedExpression",evaluate:function(){var e=this.getParameters().evaluate();if(typeof e=="string"&&e!=""){return this.context.getRelatedField(e,"count")}return""},getParamCount:function(){return 1},getParameterTypes:function(){return["relate"]}});SUGAR.expressions.DivideExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.DivideExpression,SUGAR.expressions.NumericExpression,{className:"DivideExpression",evaluate:function(){var e=this.getParameters(),t=e[0].evaluate();denominator=e[1].evaluate();if(denominator==0){throw"Division by 0 error"}return this.context.divide(t,denominator)},getParamCount:function(){return 2}});SUGAR.expressions.FloorExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.FloorExpression,SUGAR.expressions.NumericExpression,{className:"FloorExpression",evaluate:function(){return Math.floor(this.getParameters().evaluate())},getParamCount:function(){return 1}});SUGAR.expressions.IndexOfExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.IndexOfExpression,SUGAR.expressions.NumericExpression,{className:"IndexOfExpression",evaluate:function(){var e=this.getParameters();var t=e[1].evaluate();var i=e[0].evaluate();for(var n=0;n<t.length;n++){if(t[n]==i){return n}}return-1},getParamCount:function(){return 2},getParameterTypes:function(){return["generic","enum"]}});SUGAR.expressions.LogExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.LogExpression,SUGAR.expressions.NumericExpression,{className:"LogExpression",evaluate:function(){var e=this.getParameters();var t=e[1].evaluate();var i=e[0].evaluate();return this.context.divide(Math.log(i),Math.log(t))},getParamCount:function(){return 2}});SUGAR.expressions.MaximumExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.MaximumExpression,SUGAR.expressions.NumericExpression,{className:"MaximumExpression",evaluate:function(){var e=this.getParameters();var t=null;for(var i=0;i<e.length;i++){var n=e[i].evaluate();if(t==null||n>t)t=n}return t}});SUGAR.expressions.MaxRelatedExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.MaxRelatedExpression,SUGAR.expressions.NumericExpression,{className:"MaxRelatedExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate();var i=e[1].evaluate();if(typeof t=="string"&&t!=""){return this.context.getRelatedField(t,"rollupMax",i)}else if(typeof rel=="object"){}return""},getParamCount:function(){return 2},getParameterTypes:function(){return["relate","string"]}});SUGAR.expressions.MedianExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.MedianExpression,SUGAR.expressions.NumericExpression,{className:"MedianExpression",evaluate:function(){var e=this.getParameters();var t=new Array;for(var i=0;i<e.length;i++)t[t.length]=parseFloat(e[i].evaluate());t.sort(function(e,t){return e-t});if(t.length%2==0){return(t[t.length/2]+t[t.length/2-1])/2}return t[Math.round(t.length/2)-1]}});SUGAR.expressions.MinimumExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.MinimumExpression,SUGAR.expressions.NumericExpression,{className:"MinimumExpression",evaluate:function(){var e=this.getParameters();var t=null;for(var i=0;i<e.length;i++){var n=e[i].evaluate();if(t==null||n<t)t=n}return t}});SUGAR.expressions.MinRelatedExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.MinRelatedExpression,SUGAR.expressions.NumericExpression,{className:"MinRelatedExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate();var i=e[1].evaluate();if(typeof t=="string"&&t!=""){return this.context.getRelatedField(t,"rollupMin",i)}else if(typeof rel=="object"){}return""},getParamCount:function(){return 2},getParameterTypes:function(){return["relate","string"]}});SUGAR.expressions.MultiplyExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.MultiplyExpression,SUGAR.expressions.NumericExpression,{className:"MultiplyExpression",evaluate:function(){var e=this.getParameters(),t="1";for(var i=0;i<e.length;i++){t=this.context.multiply(t,e[i].evaluate())}return t}});SUGAR.expressions.NaturalLogExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.NaturalLogExpression,SUGAR.expressions.NumericExpression,{className:"NaturalLogExpression",evaluate:function(){return Math.log(this.getParameters().evaluate())},getParamCount:function(){return 1}});SUGAR.expressions.NegateExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.NegateExpression,SUGAR.expressions.NumericExpression,{className:"NegateExpression",evaluate:function(){return this.context.multiply("-1",this.getParameters().evaluate())},getParamCount:function(){return 1}});SUGAR.expressions.PowerExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.PowerExpression,SUGAR.expressions.NumericExpression,{className:"PowerExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate();var i=e[1].evaluate();return Math.pow(t,i)},getParamCount:function(){return 2}});SUGAR.expressions.RoundExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.RoundExpression,SUGAR.expressions.NumericExpression,{className:"RoundExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate();var i=e[1].evaluate();return this.context.round(t,i)},getParamCount:function(){return 2}});SUGAR.expressions.StandardDeviationExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.StandardDeviationExpression,SUGAR.expressions.NumericExpression,{className:"StandardDeviationExpression",evaluate:function(){var e=this.getParameters();var t=new Array;var i=0;var n=e.length;for(var a=0;a<e.length;a++){value=e[a].evaluate();t[t.length]=value;i=this.context.add(i,value)}var o=this.context.divide(i,n);var s=0;for(var a=0;a<t.length;a++)s+=Math.pow(this.context.subtract(t[a],o),2);var r=this.context.multiply(this.context.divide(1,n),s);return Math.sqrt(r)}});SUGAR.expressions.StringLengthExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.StringLengthExpression,SUGAR.expressions.NumericExpression,{className:"StringLengthExpression",evaluate:function(){var e=this.getParameters().evaluate()+"";return e.length},getParamCount:function(){return 1},getParameterTypes:function(){return"string"}});SUGAR.expressions.SubtractExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.SubtractExpression,SUGAR.expressions.NumericExpression,{className:"SubtractExpression",evaluate:function(){var e=this.getParameters(),t=e[0].evaluate();for(var i=1;i<e.length;i++){t=this.context.subtract(t,e[i].evaluate())}return t}});SUGAR.expressions.SumRelatedExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.SumRelatedExpression,SUGAR.expressions.NumericExpression,{className:"SumRelatedExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate();var i=e[1].evaluate();

if(typeof t=="string"&&t!=""){return this.context.getRelatedField(t,"rollupSum",i)}else if(typeof rel=="object"){}return""},getParamCount:function(){return 2},getParameterTypes:function(){return["relate","string"]}});SUGAR.expressions.ValueOfExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.ValueOfExpression,SUGAR.expressions.NumericExpression,{className:"ValueOfExpression",evaluate:function(){var e=this.getParameters().evaluate()+"";e=e.replace(/,/g,"");var t=0;if(e.indexOf(".")!=-1)t=parseFloat(e);else t=parseInt(e);if(isNaN(t))throw"Error: '"+e+"' is not a number";return t},getParamCount:function(){return 1},getParameterTypes:function(){return"generic"}});SUGAR.expressions.CharacterAtExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.CharacterAtExpression,SUGAR.expressions.StringExpression,{className:"CharacterAtExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate()+"";var i=e[1].evaluate();return t.charAt(i)},getParamCount:function(){return 2},getParameterTypes:function(){return["string","number"]}});SUGAR.expressions.ConcatenateExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.ConcatenateExpression,SUGAR.expressions.StringExpression,{className:"ConcatenateExpression",evaluate:function(){var e="";var t=this.getParameters();for(var i=0;i<t.length;i++){e+=t[i].evaluate()}return e}});SUGAR.expressions.ContainsExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.ContainsExpression,SUGAR.expressions.BooleanExpression,{className:"ContainsExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate()+"";var i=e[1].evaluate();return t.indexOf(i)>-1?SUGAR.expressions.Expression.TRUE:SUGAR.expressions.Expression.FALSE},getParamCount:function(){return 2},getParameterTypes:function(){return"string"}});SUGAR.expressions.DefineStringExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.DefineStringExpression,SUGAR.expressions.StringExpression,{className:"DefineStringExpression",evaluate:function(){var e=this.getParameters().evaluate(),t;if(e instanceof Date){var i=e.type=="date";t=n.date(e).formatUser(i)}else{t=e+""}return t},getParamCount:function(){return 1},getParameterTypes:function(){return["generic"]}});SUGAR.expressions.ForecastCommitStageExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.ForecastCommitStageExpression,SUGAR.expressions.EnumExpression,{className:"ForecastCommitStageExpression",evaluate:function(){var e=this.getParameters().evaluate();if(n===undefined){return""}var t=n.metadata.getModule("Forecasts","config");if(t.forecast_setup===0){return""}var i=t[t.forecast_ranges+"_ranges"],a="";_.find(i,function(t,i){if(e>=t.min&&e<=t.max){a=i;return true}return false});return a},getParamCount:function(){return 1},getParameterTypes:function(){return["number"]}});SUGAR.expressions.FormatedNameExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.FormatedNameExpression,SUGAR.expressions.StringExpression,{className:"FormatedNameExpression",evaluate:function(){var e=this.getParameters();var t={s:e[0].evaluate(),f:e[1].evaluate(),l:e[2].evaluate(),t:e[3].evaluate()};var n="";for(i=0;i<name_format.length;i++){if(t[name_format.substr(i,1)]!=undefined){n+=t[name_format.substr(i,1)]}else{n+=name_format.substr(i,1)}}return n},getParamCount:function(){return 4}});SUGAR.expressions.StrToLowerExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.StrToLowerExpression,SUGAR.expressions.StringExpression,{className:"StrToLowerExpression",evaluate:function(){var e=this.getParameters().evaluate()+"";return e.toLowerCase()}});SUGAR.expressions.StrToUpperExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.StrToUpperExpression,SUGAR.expressions.StringExpression,{className:"StrToUpperExpression",evaluate:function(){var e=this.getParameters().evaluate()+"";return e.toUpperCase()}});SUGAR.expressions.SubStrExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.SubStrExpression,SUGAR.expressions.StringExpression,{className:"SubStrExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate()+"";var i=e[1].evaluate();var n=e[2].evaluate();return t.substr(i,n)},getParamCount:function(){return 3},getParameterTypes:function(){return["string","number","number"]}});SUGAR.expressions.SugarDropDownValueExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.SugarDropDownValueExpression,SUGAR.expressions.StringExpression,{className:"SugarDropDownValueExpression",evaluate:function(){var e=this.getParameters();var t=e[0].evaluate();var i=e[1].evaluate();var n=this.context.getAppListStrings(t);if(n=="undefined")return"";for(var a in n){if(typeof a=="string"&&a==i)return n[a]}return""},getParamCount:function(){return 2}});SUGAR.expressions.SugarTranslateExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.SugarTranslateExpression,SUGAR.expressions.StringExpression,{className:"SugarTranslateExpression",evaluate:function(){var e=this.getParameters();var t=e[1].evaluate();if(t=="")t="app_strings";var i=e[0].evaluate();return SUGAR.language.get(t,i)},getParamCount:function(){return 2}});SUGAR.expressions.DefineTimeExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.DefineTimeExpression,SUGAR.expressions.TimeExpression,{className:"DefineTimeExpression",evaluate:function(){var e=this.getParameters().evaluate();var t=Date.parse(e);if(isNaN(t))throw"Incorrect time format";return t},getParamCount:function(){return 1},getParameterTypes:function(){return["string"]}});SUGAR.expressions.HourOfDayExpression=function(e,t){this.context=t;this.init(e)};SUGAR.util.extend(SUGAR.expressions.HourOfDayExpression,SUGAR.expressions.TimeExpression,{className:"HourOfDayExpression",evaluate:function(){var e=this.getParameters().evaluate();return new Date(e).getHours()},getParamCount:function(){return 1}});SUGAR.forms.AssignToAction=function(e){if(_.isObject(e)){e=e.value}this.expr=e;this.target="assigned_user_name";if(_.isUndefined(SUGAR.App)){this.dataSource=new YAHOO.util.DataSource("index.php?",{responseType:YAHOO.util.XHRDataSource.TYPE_JSON,responseSchema:{resultsList:"fields",total:"totalCount",metaNode:"fields",metaFields:{total:"totalCount",fields:"fields"}},connMethodPost:true})}};SUGAR.util.extend(SUGAR.forms.AssignToAction,SUGAR.forms.AbstractAction,{exec:function(e){if(typeof e=="undefined"){e=this.context}this.userName=this.evalExpression(this.expr,e);if(e.view){if(_.isEmpty(e.view.fields)){e.view.once("render",function(){this.exec(e)},this);return}e.setAssignedUserName(this.target,this.userName)}else{this.bwcExec(e)}},bwcExec:function(e){if(typeof e=="undefined"){e=this.context}var t=SUGAR.util.paramsToUrl({to_pdf:"true",module:"Home",action:"quicksearchQuery",data:YAHOO.lang.JSON.stringify(sqs_objects["EditView_"+this.target]),query:this.userName});this.sqs=sqs_objects["EditView_"+this.target];this.dataSource.sendRequest(t,{success:function(e,t){if(t.results.length>0){var i=t.results[0];for(var n=0;n<this.sqs.field_list.length;n++){SUGAR.forms.AssignmentHandler.assign(this.sqs.populate_list[n],i[this.sqs.field_list[n]])}}},scope:this})},targetUrl:"index.php?module=Home&action=TaxRate&to_pdf=1"});SUGAR.forms.SetPanelVisibilityAction=function(e,t){this.afterRender=true;if(_.isObject(e)){t=e.value;e=e.target}if(_.isString(e)&&_.isUndefined(SUGAR.App)){var i=$("#"+e).parents("div");if(i.length){e=i.attr("id")}}this.target=e;this.expr="cond("+t+', "", "none")'};SUGAR.util.extend(SUGAR.forms.SetPanelVisibilityAction,SUGAR.forms.AbstractAction,{hideChildren:function(){if(typeof SUGAR.forms.SetPanelVisibilityAction.hiddenFields=="undefined"){this.createFieldBin()}var e=document.getElementById(this.target);var t=e.getElementsByTagName("table")[0];if(t!=null){t.id=this.target+"_tbl";SUGAR.forms.SetPanelVisibilityAction.hiddenFields.appendChild(t)}},showChildren:function(){var e=document.getElementById(this.target);var t=document.getElementById(this.target+"_tbl");if(t!=null)e.appendChild(t)},createFieldBin:function(){var e=document.createElement("div");e.id="panelHiddenFields";e.style.display="none";document.body.appendChild(e);SUGAR.forms.SetPanelVisibilityAction.hiddenFields=e},exec:function(e){if(typeof e=="undefined")e=this.context;if(e.view)return this.sidecarExec(e);try{var t=this.evalExpression(this.expr,e);var i=document.getElementById(this.target);if(i!=null){if(i.style.display!="none")SUGAR.forms.animation.sizes[this.target]=i.clientHeight;if(SUGAR.forms.AssignmentHandler.ANIMATE){if(t=="none"&&i.style.display!="none"){SUGAR.forms.animation.Collapse(this.target,this.hideChildren,this);return}else if(t!="none"&&i.style.display=="none"){this.showChildren();SUGAR.forms.animation.Expand(this.target);return}}if(t=="none")this.hideChildren();else this.showChildren();i.style.display=t}}catch(n){if(console&&console.log)console.log(n)}},sidecarExec:function(e){var t=this.evalExpression(this.expr,e)==="none",i=e.view.$(".tab."+this.target),n=e.view.$("div.record-panel[data-panelname='"+this.target+"']"),a=i&&i.hasClass("active");if(!i||!i.length){if(n.length>0){if(t){n.hide()}else{n.show()}this.triggerFieldsVisibility(e,this.target,t)}else{console.log("unable to find panel "+this.target)}}else{if(t){i.hide();if(a){var o=e.view.$("li.tab:visible");if(o.length>0&&e.view.setActiveTab){e.view.setActiveTab({currentTarget:o[0].children[0]});e.view.handleActiveTab()}}}else{i.show()}this.triggerFieldsVisibility(e,this.target,t)}},triggerFieldsVisibility:function(e,t,i){_.each(this.getPanelFieldNames(e,t),function(t){var n=e.view.getField(t);if(n&&_.isUndefined(n.wasRequired)){n.wasRequired=n.def.required}e.setFieldDisabled(t,i);if(n.wasRequired===true)e.setFieldRequired(t,!i)})},getPanelFieldNames:function(e,t){var i=_.find(e.view.meta.panels,function(e){return e.name===t});return _.pluck(i.fields,"name")}});SUGAR.forms.animation.sizes={};SUGAR.forms.animation.Collapse=function(e,t,i){var n=document.getElementById(e);if(n==null)return;SUGAR.forms.animation.sizes[e]=n.clientHeight;n.style.overflow="hidden";var a=new YAHOO.util.Anim(e,{height:{to:0}},.5,YAHOO.util.Easing.easeBoth);a.onComplete.subscribe(function(){n.style.display="none";t.call(i)});a.animate()};SUGAR.forms.animation.Expand=function(e){var t=document.getElementById(e);if(t==null)return;t.style.overflow="hidden";t.style.height="0px";t.style.display="";var i=new YAHOO.util.Anim(e,{height:{to:SUGAR.forms.animation.sizes[e]}},.5,YAHOO.util.Easing.easeBoth);i.onComplete.subscribe(function(){t.style.height="auto"});i.animate()};SUGAR.forms.ReadOnlyAction=function(e,t){this.afterRender=true;if(_.isObject(e)){t=e.value;e=e.target}this.target=e;this.expr=t};SUGAR.util.extend(SUGAR.forms.ReadOnlyAction,SUGAR.forms.AbstractAction,{exec:function(e){if(typeof e=="undefined")e=this.context;var t=this.evalExpression(this.expr,e),i=t==SUGAR.expressions.Expression.TRUE;if(e.view){if(_.isEmpty(e.view.fields)){e.view.once("render",function(){this.exec(e)},this);return}e.setFieldDisabled(this.target,i)}else{this.bwcExec(e,i)}},bwcExec:function(e,t){var i=SUGAR.forms.AssignmentHandler.getElement(this.target);if(!i){return}this.setReadOnly(i,t);this.setDateField(i,t)},setReadOnly:function(e,t){var i=YAHOO.util.Dom;var n=e.type=="checkbox"||"select"?"disabled":"readonly";e[n]=t;if(t){i.setStyle(e,"background-color","#EEE");if(!SUGAR.isIE)i.setStyle(e,"color","#22")}else{i.setStyle(e,"background-color","");if(!SUGAR.isIE)i.setStyle(e,"color","")}},setDateField:function(e,t){var i=YAHOO.util.Dom,n=e.id,a=i.get(n+"_trigger");if(!a)return;var o=[i.get(n+"_date"),i.get(n+"_minutes"),i.get(n+"_meridiem"),i.get(n+"_hours")];for(var s in o)if(o[s]&&o[s].id)this.setReadOnly(o[s],t);if(t)i.setStyle(a,"display","none");else i.setStyle(a,"display","")}});SUGAR.forms.SetOptionsAction=function(e,t,i){this.afterRender=true;if(_.isObject(e)){i=e.labels;t=e.keys;e=e.target}this.keyExpr=t;this.labelExpr=i;this.target=e};SUGAR.util.extend(SUGAR.forms.SetOptionsAction,SUGAR.forms.AbstractAction,{exec:function(e){if(typeof e=="undefined")e=this.context;var t=this.evalExpression(this.keyExpr,e),i=this.evalExpression(this.labelExpr,e),a,o="";if(e.view){var s=e.getField(this.target);if(!s){return}o=[].concat(s.model.get(this.target));if(!this.canSetValue(e)){t=t.concat(o)}a=(_.size(t)===0||_.size(t)===1)&&(t[0]==undefined||t[0]==="");if(_.isString(i))s.items=_.pick(n.lang.getAppListStrings(i),t);else s.items=_.object(t,i);slContext=e;s.model.fields[this.target].options=s.items;var r=new SUGAR.forms.SetVisibilityAction(this.target,a?"false":"true","");r.setContext(e);r.exec();o=_.filter(o,function(e){return _.contains(t,e)});if((o.length==0||o.length==1&&o[0]=="")&&s.model.fields[s.name].type!="multienum"){o=[a?"":t[0]]}e.setValue(this.target,o)}else{var s=e.getElement(this.target);if(s==null)return null;if(t instanceof Array&&s.options!=null){var l=s.options;o=[];for(var c=0;c<l.length;c++){if(l[c].selected)o=o.concat(l[c].value)}while(l.length>0){s.remove(l[0])}if(typeof i=="string"){var d=SUGAR.language.get("app_list_strings",i);i=[];for(var c in t){i[c]=d[t[c]]}}var u;for(var c in t){if(i instanceof Array){if(typeof t[c]=="string"){if(typeof i[c]=="string"){u=l[l.length]=new Option(i[c],t[c],t[c]==o)}else{u=l[l.length]=new Option(t[c],t[c],t[c]==o)}}}else{if(typeof t[0]=="undefined"){if(typeof t[c]=="string"){u=l[l.length]=new Option(t[c],c)}}else{if(typeof value[c]=="string"){u=l[l.length]=new Option(t[c],t[c])}}}if(_.indexOf(o,t[c])>-1){u.selected=true}}if(!s.multiple&&s.value!=o){SUGAR.forms.AssignmentHandler.assign(this.target,s.value)}var a=s.multiple&&s.options.length==0||!s.multiple&&s.options.length<=1&&s.value=="";var r=new SUGAR.forms.SetVisibilityAction(this.target,a?"false":"true","");r.setContext(e);r.exec();if(SUGAR.forms.AssignmentHandler.ANIMATE&&!a)SUGAR.forms.FlashField(s)}else if(t instanceof Array&&(t.length==0||t.length==1&&t[0]=="")){var f=new SUGAR.forms.SetVisibilityAction(this.target,"false","");f.exec(e)}}}});SUGAR.forms.SetRequiredAction=function(e,t,i){if(_.isObject(e)){t=e.value;i=e.label;e=e.target}this.variable=e;this.expr=t;this.label=i;this._el_lbl=document.getElementById(this.label);if(this._el_lbl)this.msg=this._el_lbl.innerText};SUGAR.util.extend(SUGAR.forms.SetRequiredAction,SUGAR.forms.AbstractAction,{exec:function(e){if(typeof e=="undefined")e=this.context;this.required=this.evalExpression(this.expr,e);if(e.view){if(_.isEmpty(e.view.fields)){e.view.once("render",function(){this.exec(e)},this);return}e.setFieldRequired(this.variable,this.required)}else{this.bwcExec(e,this.required)}},bwcExec:function(e,t){var i=SUGAR.forms.AssignmentHandler.getElement(this.variable);if(typeof SUGAR.forms.FormValidator!="undefined")SUGAR.forms.FormValidator.setRequired(i.form.name,i.name,this.required);if(this._el_lbl!=null&&i!=null){var n=this._el_lbl,a=YAHOO.util.Dom.getElementsBy(function(e){return e.className=="req"},"span",n),o=false,s=i.name;if(a!=null&&a[0]!=null)o=a[0];if(this.required==true||this.required=="true"){if(!o){var r=document.createElement("span");r.innerHTML="<font color='red'>*</font>";r.className="req";this._el_lbl.appendChild(r);var l=this.findInValidate(e.formName,s);if(l>-1)validate[e.formName][l][2]=true;else addToValidate(e.formName,s,"text",true,this.msg)}}else{if(n!=null&&o!=false){o.parentNode.removeChild(o)}var l=this.findInValidate(e.formName,s);if(l>-1)validate[e.formName][l][2]=false}}},findInValidate:function(e,t){if(validate&&validate[e]){for(var i in validate[e]){if(typeof validate[e][i]=="object"&&validate[e][i][0]==t)return i}}return-1}});SUGAR.forms.SetValueAction=function(e,t){if(_.isObject(e)){this.expr=e.value;this.target=e.target;this.errorValue=!_.isUndefined(e.errorValue)?e.errorValue:null}else{this.expr=t;this.target=e}};SUGAR.util.extend(SUGAR.forms.SetValueAction,SUGAR.forms.AbstractAction,{exec:function(e){if(typeof e=="undefined"){e=this.context}try{var t=this.evalExpression(this.expr,e),i=e.getValue(this.target).evaluate();if(!_.isUndefined(t)&&t!==i&&this.canSetValue(e)){e.setValue(this.target,t)}}catch(n){if(!_.isUndefined(this.errorValue)&&!_.isNull(this.errorValue)){e.setValue(this.target,this.errorValue)}}}});SUGAR.forms.StyleAction=function(e,t){this.target=e;this.attrs=t};SUGAR.util.extend(SUGAR.forms.StyleAction,SUGAR.forms.AbstractAction,{exec:function(e){if(SUGAR.App)return;if(typeof e=="undefined")e=this.context;try{var t={};for(var i in this.attrs){t[i]=this.evalExpression(this.attrs[i],e)}e.setStyle(this.target,t)}catch(n){return}}});var n=n||null;SUGAR.forms.SetVisibilityAction=function(e,t,i){this.afterRender=true;if(_.isObject(e)){t=e.value;e=e.target}this.target=e;this.expr="cond("+t+', "", "none")';this.view=i;if(!SUGAR.forms.SetVisibilityAction.initialized){var n=document.getElementsByTagName("head")[0];var a="span.vis_action_hidden, .vis_action_hidden * { visibility:hidden}";var o=document.createElement("style");o.setAttribute("type","text/css");if(o.styleSheet)o.styleSheet.cssText=a;else o.innerHTML=a;n.appendChild(o);SUGAR.forms.SetVisibilityAction.initialized=true}};SUGAR.util.extend(SUGAR.forms.SetVisibilityAction,SUGAR.forms.AbstractAction,{exec:function(e){if(typeof e=="undefined")e=this.context;try{var t=e&&e.getElement&&e.getElement(this.target)||null;if(t==null){return}var i=this.evalExpression(this.expr,e);var n=i=="none"||i=="hidden";if(SUGAR.App){this.sidecarExec(e,t,n)}else{this.legacyExec(e,t,n)}}catch(a){if(console&&console.log)console.log(a)}},sidecarExec:function(e,t,i){var n="vis_action_hidden",a=$(t).hasClass(n),o=e.view.getField(this.target),s=$(t).parents(".panel_body")[0];if(o&&_.isUndefined(o.wasRequired)){o.wasRequired=o.def.required}if(i){e.addClass(this.target,n,true);e.setFieldDisabled(this.target,true);if(o.wasRequired===true){e.setFieldRequired(this.target,false)}}else{e.removeClass(this.target,n,true);if(!o.def.calculated||!o.def.enforced){e.setFieldDisabled(this.target,false)}if(a){SUGAR.forms.FlashField(t,null,this.target)}if(o.wasRequired===true){e.setFieldRequired(this.target,true)}}if(s){this.checkRowSidecar(s,n)}},legacyExec:function(e,t,i){var n=YAHOO.util.Dom,a="vis_action_hidden",o=n.getAncestorByTagName(t,"TD"),s=n.getPreviousSiblingBy(o,function(e){return e.tagName=="TD"});this.wrapContent(s);this.wrapContent(o);var r=n.hasClass(s,a);if(i){n.addClass(s,a);n.addClass(o,a)}else{n.removeClass(s,a);n.removeClass(o,a);if(r&&this.view=="EditView"){SUGAR.forms.FlashField(t)}}this.checkRow(n.getAncestorByTagName(o,"TR"),a)},wrapContent:function(e){if(e&&this.containsPlainText(e)){var t=document.createElement("SPAN");var i=[];for(var n=0;n<e.childNodes.length;n++){i[n]=e.childNodes[n]}for(var n=0;n<i.length;n++){t.appendChild(i[n])}e.appendChild(t)}},containsPlainText:function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(i.nodeName=="#text"&&YAHOO.lang.trim(i.textContent)!=""){return true}}return false},checkRow:function(e,t){var i=true;for(var n=0;n<e.children.length;n++){var a=e.children[n];if(a.tagName.toLowerCase()=="td"&&!YAHOO.util.Dom.hasClass(a,t)){i=false;break}}e.style.display=i?"none":""},checkRowSidecar:function(e,t){if(!e||e.children){return}var i=true;for(var n=0;n<e.children.length;n++){var a=e.children[n];if(a.tagName.toLowerCase()=="div"&&!$(a).hasClass(t)&&$(a).children().length>1){i=false;break}}e.style.display=i?"none":""}});SUGAR.FunctionMap={and:SUGAR.expressions.AndExpression,doBothExist:SUGAR.expressions.BinaryDependencyExpression,equal:SUGAR.expressions.EqualExpression,greaterThan:SUGAR.expressions.GreaterThanExpression,isAfter:SUGAR.expressions.isAfterExpression,isAlpha:SUGAR.expressions.IsAlphaExpression,isAlphaNumeric:SUGAR.expressions.IsAlphaNumericExpression,isBefore:SUGAR.expressions.isBeforeExpression,isForecastClosed:SUGAR.expressions.IsForecastClosedExpression,isForecastClosedLost:SUGAR.expressions.IsForecastClosedLostExpression,isForecastClosedWon:SUGAR.expressions.IsForecastClosedWonExpression,isInList:SUGAR.expressions.IsInEnumExpression,isInEnum:SUGAR.expressions.IsInEnumExpression,isWithinRange:SUGAR.expressions.IsInRangeExpression,isNumeric:SUGAR.expressions.IsNumericExpression,isRequiredCollection:SUGAR.expressions.IsRequiredCollectionExpression,isValidDate:SUGAR.expressions.IsValidDateExpression,isValidDBName:SUGAR.expressions.IsValidDBNameExpression,isValidEmail:SUGAR.expressions.IsValidEmailExpression,isValidPhone:SUGAR.expressions.IsValidPhoneExpression,isValidTime:SUGAR.expressions.IsValidTimeExpression,not:SUGAR.expressions.NotExpression,or:SUGAR.expressions.OrExpression,addDays:SUGAR.expressions.AddDaysExpression,dayofweek:SUGAR.expressions.DayOfWeekExpression,daysUntil:SUGAR.expressions.DaysUntilExpression,date:SUGAR.expressions.DefineDateExpression,hoursUntil:SUGAR.expressions.HoursUntilExpression,maxRelatedDate:SUGAR.expressions.MaxRelatedDateExpression,monthofyear:SUGAR.expressions.MonthOfYearExpression,now:SUGAR.expressions.NowExpression,timestamp:SUGAR.expressions.TimestampExpression,today:SUGAR.expressions.TodayExpression,createList:SUGAR.expressions.DefineEnumExpression,"enum":SUGAR.expressions.DefineEnumExpression,forecastIncludedCommitStages:SUGAR.expressions.ForecastIncludedCommitStagesExpression,forecastSalesStages:SUGAR.expressions.ForecastSalesStageExpression,getDropdownKeySet:SUGAR.expressions.SugarDropDownExpression,getDD:SUGAR.expressions.SugarDropDownExpression,getListWhere:SUGAR.expressions.SugarListWhereExpression,getDropdownValueSet:SUGAR.expressions.SugarTranslatedDropDownExpression,getTransDD:SUGAR.expressions.SugarTranslatedDropDownExpression,ifElse:SUGAR.expressions.ConditionExpression,cond:SUGAR.expressions.ConditionExpression,currencyRate:SUGAR.expressions.CurrencyRateExpression,valueAt:SUGAR.expressions.IndexValueExpression,related:SUGAR.expressions.RelatedFieldExpression,sugarField:SUGAR.expressions.SugarFieldExpression,abs:SUGAR.expressions.AbsoluteValueExpression,add:SUGAR.expressions.AddExpression,currencyAdd:SUGAR.expressions.AddExpression,average:SUGAR.expressions.AverageExpression,avg:SUGAR.expressions.AverageExpression,rollupAve:SUGAR.expressions.AverageRelatedExpression,rollupAvg:SUGAR.expressions.AverageRelatedExpression,ceil:SUGAR.expressions.CeilingExpression,ceiling:SUGAR.expressions.CeilingExpression,countConditional:SUGAR.expressions.CountConditionalRelatedExpression,count:SUGAR.expressions.CountRelatedExpression,divide:SUGAR.expressions.DivideExpression,currencyDivide:SUGAR.expressions.DivideExpression,div:SUGAR.expressions.DivideExpression,floor:SUGAR.expressions.FloorExpression,indexOf:SUGAR.expressions.IndexOfExpression,log:SUGAR.expressions.LogExpression,max:SUGAR.expressions.MaximumExpression,rollupMax:SUGAR.expressions.MaxRelatedExpression,median:SUGAR.expressions.MedianExpression,min:SUGAR.expressions.MinimumExpression,rollupMin:SUGAR.expressions.MinRelatedExpression,multiply:SUGAR.expressions.MultiplyExpression,currencyMultiply:SUGAR.expressions.MultiplyExpression,mul:SUGAR.expressions.MultiplyExpression,ln:SUGAR.expressions.NaturalLogExpression,negate:SUGAR.expressions.NegateExpression,pow:SUGAR.expressions.PowerExpression,round:SUGAR.expressions.RoundExpression,stddev:SUGAR.expressions.StandardDeviationExpression,strlen:SUGAR.expressions.StringLengthExpression,subtract:SUGAR.expressions.SubtractExpression,currencySubtract:SUGAR.expressions.SubtractExpression,sub:SUGAR.expressions.SubtractExpression,rollupConditionalSum:SUGAR.expressions.SumConditionalRelatedExpression,rollupSum:SUGAR.expressions.SumRelatedExpression,rollupCurrencySum:SUGAR.expressions.SumRelatedExpression,number:SUGAR.expressions.ValueOfExpression,charAt:SUGAR.expressions.CharacterAtExpression,concat:SUGAR.expressions.ConcatenateExpression,contains:SUGAR.expressions.ContainsExpression,toString:SUGAR.expressions.DefineStringExpression,string:SUGAR.expressions.DefineStringExpression,forecastCommitStage:SUGAR.expressions.ForecastCommitStageExpression,formatName:SUGAR.expressions.FormatedNameExpression,strToLower:SUGAR.expressions.StrToLowerExpression,strToUpper:SUGAR.expressions.StrToUpperExpression,subStr:SUGAR.expressions.SubStrExpression,getDropdownValue:SUGAR.expressions.SugarDropDownValueExpression,getDDValue:SUGAR.expressions.SugarDropDownValueExpression,translateLabel:SUGAR.expressions.SugarTranslateExpression,translate:SUGAR.expressions.SugarTranslateExpression,time:SUGAR.expressions.DefineTimeExpression,hourOfDay:SUGAR.expressions.HourOfDayExpression};SUGAR.NumericConstants={pi:3.14159265359,e:2.71828182846}},function(e,t){(function(e){e.raven={ravenDataCallback:function(t){t.tags=_.extend(t.tags||{},{"native":e.isNative,osVersion:e.clientInfo?e.clientInfo.device.osVersion:undefined,uuid:e.clientInfo?e.clientInfo.device.uuid:undefined,device:e.clientInfo?e.clientInfo.device.model:undefined,offline:e.config.offline&&e.config.offline.enabled});t.extra=_.extend(t.extra||{},{device:e.clientInfo?e.clientInfo.device.modelName:undefined,serverUrl:e.nomad?e.nomad.getServerUrl():undefined,serverVersion:e.nomad?e.nomad.getServerVersion():undefined,extendedLog:e.enhancedErrorReporter.getLog()});return t},ravenShouldSendCallback:function(){return e.config.raven.enabled},ravenReported:function(t){if(e.error){var i=t.data||{};e.error.logFatalError(i.message,i)}},setUser:function(e){Raven.setUser(e?{id:e}:null)}};if(e.config.raven&&e.config.raven.enabled&&!_.isEmpty(e.config.raven.url)){document.addEventListener("ravenSuccess",e.raven.ravenReported,false);document.addEventListener("ravenFailure",e.raven.ravenReported,false);Raven.config(e.config.raven.url,{tags:{version:e.config.appVersion,build:e.config.appBuild,env:e.config.raven.env},dataCallback:e.raven.ravenDataCallback,shouldSendCallback:e.raven.ravenShouldSendCallback}).install();e.events.on("app:start",function(){e.raven.setUser(e.api.isAuthenticated()?"authenticated":null)}).on("app:login:success",function(){e.raven.setUser("authenticated")}).on("app:logout",function(){e.raven.setUser()})}})(SUGAR.App)},function(e,t){(function(e){var t=window.store;function i(e){this._async=!!e.async;this._bucketName=e.name+":"}_.extend(i.prototype,{version:1,_syncApi:{get:function n(e){return t.get(this._bucketName+e)},getAll:function a(){var e=this._bucketName;var i=e.length;var n={};_.each(t.getAll(),function(t,a){var o=a.indexOf(e);if(o===0){n[a.substr(i)]=t}});return n},has:function o(e){return t.has(this._bucketName+e)},set:function s(e,i){t.set(this._bucketName+e,i)},cut:function r(e){t.cut(this._bucketName+e)},cutAll:function l(){var e=this._bucketName;_.each(_.keys(this._syncApi.getAll.call(this)),function(i){t.cut(e+i)})}},_asyncApi:{get:function c(e,t){t.call(this,null,this._syncApi.get.call(this,e))},getAll:function d(e){e.call(this,null,this._syncApi.getAll.call(this))},has:function u(e,t){t.call(this,null,this._syncApi.has.call(this,e))},set:function f(e,t,i){this._syncApi.set.call(this,e,t);i&&i.call(this,null)},cut:function h(e,t){this._syncApi.cut.call(this,e);t&&t.call(this,null)},cutAll:function p(e){this._syncApi.cutAll.call(this);e&&e.call(this,null)}},init:function m(e){_.extend(this,this._async?this._asyncApi:this._syncApi);e&&e.call(this,null,this)}});e.localStorageKeyValueStore={open:function g(){},initBucket:function v(e,t){var n=new i(e);n.init(t)}}})(SUGAR.App)},function(e,t){(function(e){var t=function(){};var i={db:null,openDb:function a(t){this.db=e.nomad.openDb(t);if(!this.db){throw new Error("Can't open SQL database "+t.name)}},query:function o(e,t,i){var n=this;this.db.transaction(function a(o){o.executeSql(e,t||[],function s(e,t){i&&i.call(n,null,t)},function r(e,t){i&&i.call(n,t)})})},createDataTable:function s(e,t){var i=this;this.query("CREATE TABLE IF NOT EXISTS "+e+" (key STRING PRIMARY KEY, value TEXT)",[],function n(e,a){t&&t.apply(i,arguments)})},get:function r(e,t,i){var n=this;this.query("SELECT value FROM "+e+" WHERE key = ? LIMIT 1",[t],function a(e,t){if(e){i&&i.call(n,e);return}var a;if(t.rows.length){a=t.rows.item(0).value==="undefined"?undefined:JSON.parse(t.rows.item(0).value)}i&&i.call(n,null,a)})},getAll:function l(e,t){var i=this;this.query("SELECT key, value FROM "+e,[],function n(e,a){var o;var s={};var r;if(e){t&&t.call(i,e);return}for(r=a.rows.length,o=0;o<r;o++){var l=a.rows.item(o);s[l.key]=l.value==="undefined"?undefined:JSON.parse(l.value)}t&&t.call(i,null,s)})},has:function c(e,t,i){var n=this;this.query("SELECT key FROM "+e+" WHERE key = ? LIMIT 1",[t],function a(e,t){if(e){i&&i.call(n,e);return}i&&i.call(n,null,!!t.rows.length)})},set:function d(e,t,i,n){var a=this;this.query("REPLACE INTO "+e+" (key, value) values (?, ?)",[t,JSON.stringify(i)],function o(e,t){n&&n.apply(a,arguments)})},cut:function u(e,t,i){var n=this;this.query("DELETE FROM "+e+" WHERE key = ?",[t],function a(e,t){i&&i.apply(n,arguments)})},cutAll:function f(e,t){var i=this;this.query("DELETE FROM "+e,[],function n(e,a){t&&t.apply(i,arguments)})}};function n(e){this._async=!!e.async;if(!this._async){this._cache={}}this._bucketName=e.name}_.extend(n.prototype,{version:1,_syncApi:{get:function h(t){return _.isObject(this._cache[t])?e.utils.deepCopy(this._cache[t]):this._cache[t]},getAll:function p(){return e.utils.deepCopy(this._cache)},has:function m(e){return _.has(this._cache,e)},set:function g(t,n){i.set(this._bucketName,t,n);this._cache[t]=_.isObject(n)?e.utils.deepCopy(n):n},cut:function v(e){i.cut(this._bucketName,e);delete this._cache[e]},cutAll:function b(){i.cutAll(this._bucketName);this._cache={}}},_asyncApi:{get:function y(e,t){i.get(this._bucketName,e,_.bind(t,this))},getAll:function E(e){i.getAll(this._bucketName,_.bind(e,this))},has:function L(e,t){i.has(this._bucketName,e,_.bind(t,this))},set:function w(e,n,a){i.set(this._bucketName,e,n,a?_.bind(a,this):t)},cut:function x(e,n){i.cut(this._bucketName,e,n?_.bind(n,this):t)},cutAll:function S(e){i.cutAll(this._bucketName,e?_.bind(e,this):t)}},init:function A(e){var t=this;i.createDataTable(this._bucketName,function n(a){if(a){e&&e.call(t,a);return}if(t._async){_.extend(t,t._asyncApi);e&&e.call(t,null,t)}else{i.getAll(t._bucketName,function o(i,n){if(i){e&&e.call(t,i);return}t._cache=n;_.extend(t,t._syncApi);e&&e.call(t,null,t)})}})}});e.sqlKeyValueStore={open:function R(e){i.openDb(e)},initBucket:function C(e,t){var i=new n(e);i.init(t)}}})(SUGAR.App)},function(e,t){(function(e){e.view.NomadLayout=e.view.Layout.extend({searchBoxName:"search-box",header:null,initialize:function(e){e.meta=e.meta||{};e.meta.components=e.meta.components||[];if(e.name!=="login"&&!_.find(e.meta.components,function(e){return e.view==="header"})){e.meta.components.unshift({view:"header"})}this._super("initialize",[e]);this.initComponents();this.initializeHeader();var t=this.module?"layout__"+this.module:"";var i=this.meta.type?"layout__"+this.meta.type:"";var n=!_.isEmpty(this.options.link);var a=this.options.def?this.options.def.name:"";this.$el.addClass(t+" "+i+" layout__def"+(n?" related":""));this.$el.attr("layout-name",a)},initializeHeader:function(){this.header=_.find(this._components,function(t){return t instanceof e.view.views.HeaderView});if(this.header){this.header.data=this.getHeaderData();this.header.on("app:header:cancel",this._onHeaderCancel,this)}this.model.on("data:sync:complete",function(){this.header.data.title=this.getHeaderData().title;this.header.$("h1.nomad").text(this.header.data.title)},this)},bindGlobalEvents:function(){_.invoke(this._components,"bindGlobalEvents")},unbindGlobalEvents:function(){_.invoke(this._components,"unbindGlobalEvents")},onDetach:function t(){this.unbindGlobalEvents();_.invoke(this._components,"onDetach")},onAppResume:function(){_.invoke(this._components,"onAppResume")},onAppPause:function(){_.invoke(this._components,"onAppPause");

},render:function(t){var i=this;this._prepareBodyScroll();t=t||{animation:{enabled:false}};this._handleRenderWithAnimation(function(){e.view.Layout.prototype.render.apply(i,arguments)},t)},renderFromCache:function(e){var t=this;this._prepareBodyScroll();this._handleRenderWithAnimation(function(){_.invoke(t._components,"onBeforeRender");_.each(t._components,function(e){_.each(e.fields,function(e){if(e.cacheDisabled===true||e.hasAccess!==e.getAccess()){e.render()}})});_.invoke(t._components,"onAfterRender")},e)},reloadData:function(e){},loadData:function(t){e.view.Layout.prototype.loadData.apply(this,arguments);_.each(this._components,function(e){e.onLoadData()})},loadDataPartial:function(e){_.each(this._components,function(t){var i=t.options.meta&&t.options.meta.partialLoadEnabled;if(i){t.loadData(e)}})},onAfterShow:function(){this.bindGlobalEvents();_.invoke(this._components,"onAfterShow")},_render:function(){this.onBeforeComponentsRender();this._super("_render");this.onAfterComponentsRender();return this},onBeforeComponentsRender:function(){},onAfterComponentsRender:function(){},onAfterLayout:function(){},getHeaderData:function(){var t={};_.each(this._components,function(e){if(e.getHeaderData){t=e.getHeaderData()}});t.layoutOptions=this.options.def;t.offlineEnabled=e.offlineEnabled;return t},isDynamic:function(){return this.options.def&&this.options.def.isDynamic},getDefinition:function(){return this.options.def},getOverlay$El:function(){var e=this.getDefinition().appendTo.el.find(".background");return e.length?e:null},getDataById:function(e){if(this.model.id===e){return this.model.toJSON()}else if(this.collection&&this.collection.get(e)){return this.collection.get(e).toJSON()}else return null},_handleRenderWithAnimation:function(e,t){var i=this.getOverlay$El();if(t.animation.enabled&&i){i.show();e();_.delay(function(){i.animate({opacity:0},{duration:t.animation.animationLength,complete:function(){i.hide();i.css("opacity",1)}})},t.animation.preAnimationDelay)}else{e();i.hide()}},_onHeaderCancel:function(){e.trigger("app:header:cancel")},_prepareBodyScroll:function(){if(e.isBodyScrollRequired){var t=_.find(this._components,function(e){return e._bodyScroll});if(t){$("html").addClass((this.name==="login"?"loginView":"")+" bodyScroll");_.defer(function(){document.body.scrollTop=0})}else{$("html").removeClass("bodyScroll loginView");var i=$("#alerts");i.remove();_.defer(function(){document.body.scrollTop=0;$("#nomad").append(i)})}}},_dispose:function(){if(this.model){this.stopListening(this.model)}if(this.header){this.header.off("app:header:cancel")}e.analytics.detachAnalytics(this.$el);this.$el.off();e.view.Layout.prototype._dispose.call(this)}})})(SUGAR.App)},function(e,t){(function(e){e.view.layouts.ListLayout=e.view.NomadLayout.extend({className:"layout__list",filtersEnabled:true,searchEnabled:true,stateComponents:[],initialize:function(e){var t=[];var i;var n="filters";var a="search-box";this.stateComponents=[];this.filtersEnabled=this._isFiltersAvailable(e);this.searchEnabled=this._isSearchAvailable(e);if(this.searchEnabled){t.push({view:a})}if(this.filtersEnabled){t.push({view:n})}i=this._getListName(e);t=_.union(t,this.getListComponents(e));this.options.meta={type:"list",components:t};this._super("initialize",arguments);this.$el.attr("layout-name",this.options.def.subType||this.options.def.name||"");this._list=this.getComponent(i);this._searchBox=this.getComponent(a);this._filter=this.getComponent(n);if(this._searchBox){this.stateComponents.push(this._searchBox);this.listenTo(this.collection,"data:sync:complete",function(e,t,i){this._searchBox.hideProgress()});this.enableSearch()}if(this._filter){this.stateComponents.push(this._filter);this.listenTo(this._filter,"filter:changed",this.filterChanged);this.listenTo(this._filter,"sort:changed",this.reloadData)}},onAfterShow:function(){this._super("onAfterShow");e.tutorial.show(this.name,this.module)},getListComponents:function t(i){var n=this._getListName(i);var a=[];if(i.listMeta){a.push({view:{name:n,meta:_.extend({},e.metadata.getView(i.module,n),i.listMeta)}})}else{a.push({view:n})}return a},getHeaderData:function(){var e=this._super("getHeaderData");e.search=this.searchEnabled;return e},filterChanged:function i(){this.getCurrentList().collection.once("data:sync:error",this._onFilterListFailed,this);this.getCurrentList().collection.once("sync",this._onFilterListSuccess,this);this.updateSearchPlaceholder();this.reloadData()},reloadData:function(){var e={relate:this.options.subType==="relationships"};this._super("reloadData");this.updateListViewState();this.getCurrentList().refresh(e)},loadData:function(t){var i=this.getCurrentList().collection;var n=e.tutorial.hasStepToShow(this.name,this.module);t=t||{};t.params=t.params||{};if(e.config.alwaysShowMyItems)t.myItems=true;if(i.options){delete i.options.update;i.options.offset=0;i.options.page=0}if(this._filter){_.extend(t.params,this._filter.getPreparedState());this.updateListViewState()}this.context.set("collection",i);this._super("loadData",[t]);if(n){i.on("sync",this._onTutorialShow,this)}},_onTutorialShow:function n(){e.tutorial.show(this.name,this.module)},updateListViewState:function(){var e={};var t=this.getCurrentList();_.each(this.stateComponents,function(t){_.extend(e,t.getPreparedState())},this);t.setCurrentState(e);t.setSortByField()},enableSearch:function(){this.listenTo(this._searchBox,"search:toggle",this.onToggleSearch);this.listenTo(this._searchBox,"search:text",this.search)},onToggleSearch:function a(e){this.searchActivated=e;if(this._filter){this._filter.toggleSearchMode(e,this._searchBox._searchText)}this.updateSearchPlaceholder()},updateSearchPlaceholder:function o(){if(this.searchActivated){var e=this._filter?this._filter.getActiveFilter().name:this.getCurrentList().modulePlural;this._searchBox.setPlaceholder(e)}},toggleFiltersView:function s(e){if(!this._filter){return}this._filter.toggle(e);this.getCurrentList().scrollReflow();this.$el.toggleClass("filters-hidden",!e)},search:function(){this.reloadData();e.analytics.trackEvent("search",this.module,0)},_getListName:function(t){var i;var n={selector:"list-selector",associate:"list-associate",relationships:"list"};if(_.contains(e.config.readonlyModules,t.module)&&!t.editable){i="readonly-list"}else if(t.subType){i=n[t.subType]}else{i=t.name||"list"}return i},_isSearchAvailable:function r(t){return!(_.contains(e.config.readonlyModules,t.module)&&!t.editable||t.module==="Recents"||t.module==="Dashboards"||t.module==="TxLog"||t.subType==="relationships")},_isFiltersAvailable:function l(t){return!_.contains(["Activities","Teams","TxLog"],t.module)&&!_.contains(e.config.readonlyModules,t.module)&&e.metadata.getView(t.module,"list")},_onFilterListSuccess:function c(){this._unbindListCollectionEvents()},_onFilterListFailed:function d(t,i,n){this._unbindListCollectionEvents();if(e.offlineEnabled){if(i.params.skipOfflineRead){e.alert.dismiss("network_error",{animate:false});e.alert.show("network_error",{level:"error",messages:e.lang.get("LBL_MOBILE_FILTER_IS_NOT_AVAILABLE"),autoClose:true,pageHash:n.request.params.pageHash,requestOptions:i});this._filter.resetToPreviousFilter()}}else{this._filter.resetToPreviousFilter()}},_unbindListCollectionEvents:function u(){this.getCurrentList().collection.off("data:sync:error",this._onFilterListFailed);this.getCurrentList().collection.off("sync",this._onFilterListSuccess)},getCurrentList:function f(){return this._list},onDetach:function(){this._super("onDetach");this.getCurrentList().abortActiveRequests()}})})(SUGAR.App)},function(e,t){(function(e){e.view.layouts.DetailLayout=e.view.NomadLayout.extend({initialize:function(t){var i=t.module;var n=e.supportedFeatures.activities&&e.metadata.getModule(i).activityStreamEnabled;var a=this._createDashboards(t);var o=[];if(a){o.push(a)}o.push({title:e.lang.get("LBL_DETAIL_RELATED"),name:"related-records",module:i,modelId:t.modelId,loadDataFn:function(){this.loadData()}});if(n){o.push({title:e.lang.get("LBL_ACTIVITY_STREAM"),name:"activitystream-dashlet",module:"Activities",parentModel:t.context.get("model"),loadDataFn:function(){this.listView.context.resetLoadFlag();this.loadData()}})}t.meta.components=[{view:"detail"},{view:{className:"view__detail-tabs",name:"cards",partialLoadEnabled:true,cards:o}}];this._super("initialize",arguments)},_createDashboards:function(t){var i=e.nomad.dashboards.getDashboards({module:t.module});var n=t.modelId;var a;var o;if(!e.config.dashboards.recordDashboardsEnabled||_.isEmpty(i)||!e.config.dashboards.enabled){return}a=_.map(i,function(i){return{id:i.id,name:"dashboard",module:"Dashboards",title:e.lang.get(i.get("name")),parentModelId:n,parentModule:t.module,model:i}});return{title:e.lang.get("LBL_DASHBOARDS"),name:"cards",meta:{cards:a,switcherType:"dropdown"},loadDataFn:function(){if(!o){this.loadData();o=true}}}}})})(SUGAR.App)},function(e,t){(function(e){e.view.layouts.MobileActivitiesListLayout=e.view.layouts.ListLayout.extend({listName:"activitystream-dashlet",dashlet:null,initialize:function(){this._super("initialize",arguments);this.dashlet=this.getComponent(this.listName)},_getListName:function(){return this.listName},_isSearchAvailable:function(){return null},loadData:function(e){if(this.disposed)return;this.dashlet.loadData(e)},getHeaderData:function(){return{menuButton:true,title:e.lang.getAppString("LBL_ACTIVITY_STREAM"),offlineEnabled:e.offlineEnabled}}})})(SUGAR.App)},function(e,t){(function(e){e.view.layouts.MobileSearchListLayout=e.view.layouts.ListLayout.extend({_listViews:[],DEFAULT_SORTING:{field:"date_modified",direction:"desc"},initialize:function(t){this._super("initialize",[t]);this._listViews=[];this._search=this.createView("Search",true);this._adjustSearchCollectionParams(this._search.collection,null);this._listViews.push(this._search);if(e.supportedFeatures.recents){this._recents=this.createView("Recents");this._recents.collection.limit=e.config.fetchLimit.recents;this._recents.active=true;this._listViews.push(this._recents)}else{this._search.active=true}_.each(this.getListViews(),function(e){this.addComponent(e)},this)},onAfterComponentsRender:function(){var e=this._filter.getPreparedState();this.toggleSearchList(!e.recents)},filterChanged:function t(e){this.toggleSearchList(!e.recents);this._super("filterChanged",[e])},createView:function i(t,n){var a=n?e.data.createMixedBeanCollection():e.data.createBeanCollection(t);return e.view.createView({name:"list",module:t,context:e.context.getContext({module:t,collection:a,model:e.data.createBean(t)})})},toggleSearchList:function n(e){this._search.active=e;if(this._recents){this._recents.active=!e}_.each(this.getListViews(),function(e){if(e.active){e.getViewContainer().show();e.bindGlobalEvents()}else{e.getViewContainer().hide();if(e.collection.getFetchRequest()){e.collection.abortFetchRequest()}e.unbindGlobalEvents()}},this)},search:function a(){var t=this._searchBox.getPreparedState().q;var i=!!t||!this._filter.getPreparedState().recents;if(e.supportedFeatures.recents){this.toggleSearchList(i)}this._adjustSearchCollectionParams(this._search.collection,t);this.listenTo(this._search.collection,"sync",function(e,t,i){this._searchBox.hideProgress()});this._super("search",arguments)},loadData:function o(e){var t=this.getCurrentList().collection;t.dataFetched=false;this._super("loadData",[e])},getFieldNames:function s(t){var i=e.metadata.getModuleNames({filter:"visible",access:"list"});var n=this._super("getFieldNames",[t]);_.each(i,function(t){var i=e.metadata.getModule(t).mergedFields;if(i){n=_.union(n,i)}});return n},_adjustSearchCollectionParams:function r(t,i){t.orderBy=i?null:this.DEFAULT_SORTING;delete t.limit;t.query=i;t.module_list=e.nomad.getFtsEnabledModules()},getHeaderData:function(){return _.defaults({title:e.lang.get("LBL_MOBILE_GLOBAL_SEARCH"),menuButton:true,plus:true},this._super("getHeaderData",arguments))},getListComponents:function l(e){return[]},getListViews:function c(){return this._listViews},getCurrentList:function(){return _.findWhere(this._listViews,{active:true})}})})(SUGAR.App)},function(e,t){(function(e){var t={type:"list",components:[{view:"list-picker"}]};e.view.layouts.PickerlistLayout=e.view.NomadLayout.extend({className:"layout__list list-picker",initialize:function(i){this.options.meta=t;this._super("initialize",arguments);var n=this.getComponent("list-picker");var a=this.context.get("action");var o=this.context.get("parentModule");var s=e.nomad.getSubpanels(o);var r=a==="create"?_.filter(s,function(t){return e.nomad.canCreateRelated(t.module,o,"create",t.context.link)}):_.filter(s,function(t){return t.linkable&&e.acl.hasAccess("list",t.module)});r=_.map(r,function(t){return{value:t.module,label:e.lang.get(t.label,o),module:t.module,context:t.context}});n.setData({items:r});n.on("selection:submit",function(t){var i=e.nomad.buildLinkRoute(o,this.context.get("parentModelId"),t.get("context").link,null,this.context.get("action"));e.controller.navigate(i)},this)}})})(SUGAR.App)},function(e,t){(function(e){e.view.layouts.ListSelectorLayout=e.view.layouts.ListLayout.extend({initialize:function(t){this._super("initialize",[t]);var i=this.getCurrentList();var n=i.collection;var a;a=_.bind(function s(){this.header.setSaveBtnState(i.getSelectedIds())},this);a();this.listenTo(i,"selection:change",function(){var e=i.getSelectedIds();if(!_.isEmpty(e)){this._searchBox&&this._searchBox.hideSearch();this.toggleFiltersView()}a()});if(e.offlineEnabled){var o=e.offline.api.SERVER_READ_STATUS;this.listenTo(e.events,"offline:server:read",function(e){if(!i.isCurrentListUpdated(e.apiOptions)){return}if(e.status===o.finish){if(e.dataUpdated){n.once("sync",function t(){a()},this)}else{a()}}else if(e.status===o.error){a()}})}else{this.listenTo(n,"sync",a)}},onToggleSearch:function t(e){if(e){this.toggleFiltersView(true)}this._super("onToggleSearch",[e])}})})(SUGAR.App)},function(e,t){(function(e){e.view.layouts.MobileDashboardsDetailLayout=e.view.NomadLayout.extend({_isRecordDashboard:false,_prevLayoutContainer:null,initialize:function(t){var i=e.nomad.dashboards.getDashboard(t.dashboardId);var n;var a;this._isRecordDashboard=!!(t.parentModule&&t.parentModelId);if(this._isRecordDashboard){a=e.session.get(t.parentModelId);n=e.data.createBean(t.parentModule,a||{id:t.parentModelId});this.parentModel=t.parentModel=n;if(!a){this.listenTo(n,"sync",function o(){this.header.setTitle(this._getDashboardName())});n.fetch()}}t.context.set({model:i,parentModel:n});this._super("initialize",[t]);this.dashboardView=this.getComponent("dashboard");if(!this._isRecordDashboard){this.listenTo(this.dashboardView,"dashlets:changed",this.onDashletChanged);this.listenTo(this.header,"app:header:dashboard:home",this.onDashboardHomeClick)}},_getDashboardName:function(){var t=this._isRecordDashboard?this.parentModel.get("name"):this.model.get("name");return e.lang.get(t)||null},onDashletChanged:function(e){var t;var i=this.$el.find(".dashHomeBtn");if(!e){i.hide();t=this._getDashboardName()}else{i.show();t=e.view.title;if(e.view.dataTitle){t+=e.view.dataTitle}}this.header.setTitle(t)},onDashboardHomeClick:function(){var t=e.router.buildRoute("Dashboards",this.model.id);e.controller.navigate(t)},loadData:function(){},getFieldNames:function(e){return null},getHeaderData:function(){var t=this._isRecordDashboard;return{subtitle:t&&e.nomad.getSingularModuleName(this.parentModel.module),dashboardHome:!t,back:true,menuButton:true,title:this._getDashboardName()||e.lang.get("LBL_LOADING"),offlineEnabled:e.offlineEnabled}},onAfterLayout:function(){var t=e.controller.layoutManager;var i=e.isTablet&&this===t.getRootLayout();var n=i&&!!t.getRecordLayout();var a=this._isRecordDashboard&&!i;var o=i&&n?"root":"record";this.dashboardView.setPaginatorVisible(o!=="root");this.header.setButtonVisible({back:a});this._prevLayoutContainer=o;this._super("onAfterLayout",arguments)},clean:function(){this.dashboardView.clean()}})})(SUGAR.App)},function(e,t){(function(e){var t=function(){};e.view.layouts.MobileTxLogDetailLayout=e.view.NomadLayout.extend({loadData:function(i){var n=this;this.model.sync=function(i,a,o){var s=o.success;async.waterfall([function(t){o.success=function(e){t(null,e)};e.offline.storage.readTransactions(o,{id:a.id})},function(i,n){if(!i){n(new t)}else{e.offline.storage.fillTxLogData([i],function(){n(null,i)})}}],function(i,r){if(!i){s(a,r,o);n.render()}else if(i instanceof t){e.controller.clean();e.controller.goBack()}})};this.model.fetch(i)}})})(SUGAR.App)},function(e,t){(function(e){e.view.NomadView=e.view.View.extend({initialize:function(t){if(t.globalEvents){this.globalEvents=t.globalEvents}e.view.View.prototype.initialize.call(this,t);this.config=e.config},onAppPause:function(){},onAppResume:function(){},onLoadData:function(){},delegateEvents:function(t){if(!(t||(t=_.result(this,"events"))))return;_.extend(t,{"click a[href]":"handleLinkClick"});e.view.View.prototype.delegateEvents.call(this,t)},_render:function(){this.onBeforeRender();if(e.config.analytics.enabled)e.analytics.detachAnalytics(this.$el);e.view.View.prototype._render.call(this);if(e.config.analytics.enabled)e.analytics.attachAnalytics(this.$el);this.onAfterRender();this._rendered=true;this.trigger("view:after:render");return this},bindGlobalEvents:function(){var t=this._populateGlobalEvents(this);_.each(t,function(t,i){t=_.isFunction(t)?t:this[t];e.events.on(i,t,this)},this);_.each(this.fields,function(t){_.each(t.globalEvents,function(t,i){t=_.isFunction(t)?t:this[t];e.events.on(i,t,this)},t)})},unbindGlobalEvents:function(){var t=this._populateGlobalEvents(this);_.each(t,function(t,i){e.events.off(i,null,this)},this);_.each(this.fields,function(t){_.each(t.globalEvents,function(t,i){e.events.off(i,null,this)},t)})},_populateGlobalEvents:function(e){var t=[];var i={};var n=function(e,t){if(e){t.push(e.constructor.prototype.globalEvents);n(e.constructor.__super__,t)}};if(this.hasOwnProperty("globalEvents")){t.push(this.globalEvents)}n(e,t);_.each(t.reverse(),function(e){i=_.extend(i,e)});return i},initRelationshipFields:function(t,i){var n=e.data.getRelationshipFields(t,i);if(n&&n.length){this.relationshipFields=_.map(n,function(t){return e.metadata.getModule(this.module).fields[t]},this)}return this.relationshipFields},getFieldNames:function(t){if(!this.module)return[];var i=e.metadata.getModule(this.module,"mergedFields")||[];if(this.model instanceof e.Bean){if(this.model.canHaveAttachments()){i.push("attachment_list")}}if(this.relationshipFields){i=_.union(i,_.pluck(this.relationshipFields,"name"))}if(t){i=_.filter(i,function(t){var i=this._getFieldViewDef(t);if(_.isEmpty(i)){return false}return e.acl.hasAccessToModel(this.action,this.model,t)&&i.type!=="fieldset"&&e.nomad.canDisplay(this,i)},this)}return i},_getFieldViewDef:function(e){var t;_.find(this.meta.panels[0].fields,function(i){if(i.name===e){t=i}else if(!_.isEmpty(i.fields)){t=_.find(i.fields,function(t){return t.name===e})}return t});return t},isEditView:function(){return false},onAfterRender:function(){},onAfterShow:function(){if(this.collection){e.syncAlertManager.hideSyncAlert()}},onBeforeRender:function(){},handleLinkClick:function(t){if(t.defaultPrevented)return;var i=t.target.tagName.toLowerCase()==="a"?t.target:t.currentTarget;var n=i.getAttribute("href");var a;if(/^#.*/.test(n)){t.preventDefault();t.stopPropagation();a=$(i).hasClass("append-root")?this._adjustRouteBasedOnRoot(n):n;e.controller.navigate(a)}else if(e.nomad.utils.urlHasProtocolRegExp.test(n)){t.preventDefault();e.nomad.openUrl(n)}},_adjustRouteBasedOnRoot:function(t){var i=e.controller.getScreenContext();var n=e.controller.getScreenContextRoot();var a=new RegExp("#.*"+i.module);var o;if(n){o="#"+n+"/"+i.module}else{o="#"+i.module}return t.replace(a,o)},abortActiveRequests:function(){return false},onDetach:function(){}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.SyncableView=e.view.NomadView.extend({initialize:function(t){e.view.NomadView.prototype.initialize.call(this,t);e.syncableViewsManager.registerView(this);this.bindViewSyncListener()},_dispose:function(){e.syncableViewsManager.unregisterView(this);this.unbindViewSyncListener();e.view.NomadView.prototype._dispose.call(this)},bindViewSyncListener:function(){},unbindViewSyncListener:function(){},publishSyncData:function(t,i,n){e.syncableViewsManager.triggerViewSync(this,t,i,n)},receiveSyncData:function(e,t){}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.RecordView=e.view.views.SyncableView.extend({_statusMessageMap:{403:"LBL_NOT_AUTHORIZED",404:"LBL_RECORD_NOT_FOUND",link:"LBL_RELATED_RECORD_NOT_FOUND"},_modelEvents:{sync:"onDataSyncSuccess","data:sync:error":"onDataSyncError","data:sync:complete":"onDataSyncComplete"},_isModelUpdated:false,initialize:function(){e.view.views.SyncableView.prototype.initialize.apply(this,arguments);this._bindModelEvents()},onBeforeRender:function(){e.view.views.SyncableView.prototype.onBeforeRender.apply(this,arguments);this.model.dataFetched=false},_dispose:function(){e.view.views.SyncableView.prototype._dispose.apply(this,arguments);this._unbindModelEvents()},showRecordOverlay:function(t,i){if(document.activeElement){document.activeElement.blur()}i=t.link&&i===404?"link":i;var n=e.lang.get(this._statusMessageMap[i]);if(n&&!this.$el.find(".overlay-view").length){this.overlayIsShown=true;this.$el.append("<div class='overlay-view'><span class='message'>"+n+"</span></div>")}},hideRecordOverlay:function(){this.overlayIsShown=false;this.$el.find(".overlay-view").remove()},bindViewSyncListener:function(){this.listenTo(this.model,"sync",this.publishModelSyncData)},unbindViewSyncListener:function(){this.stopListening(this.model,"sync",this.publishModelSyncData)},publishModelSyncData:function(e,t,i){this.publishSyncData(e.toJSON(),null,_.extend({},i,{responseData:t}))},receiveSyncData:function(t){var i;var n=false;if(_.isArray(t)){i=_.find(t,function(e){return e.id===this.model.id},this)}else if(t&&t.id===this.model.id){i=t}if(i&&!e.nomad.utils.isModelSynchronized(this.model,i)){this.model.set(i);n=true}this._isModelUpdated=n},onDataSyncSuccess:function(){if(this.overlayIsShown){this.hideRecordOverlay()}},onDataSyncError:function(t,i,n){if(t==="read"){this.showRecordOverlay(this.model,n.status);if(e.error.isAccessError(n)){this.publishSyncData(this.model.toJSON(),n);this._clearModel()}}},onDataSyncComplete:function(){},_clearModel:function(){var e={};_.each(this.model.attributes,function(t,i){if(i!=="id"){e[i]=void 0}});this.model.set(e,{unset:true})},_bindModelEvents:function(){_.each(this._modelEvents,function(e,t){this.listenTo(this.model,t,this[e])},this)},_unbindModelEvents:function(){_.each(this._modelEvents,function(e,t){this.stopListening(this.model,t,this[e])},this)}})})(SUGAR.App)},function(e,t){(function(e){var t;var i;e.view.views.HeaderView=e.view.NomadView.extend({className:"view__header",events:{"click .menuBtn":"onHomeClicked","click .create-entity":"onAddClicked","click .saveBtn":"onSave","click .cancelBtn":"onCancel","click .backBtn":"onBack","click .caretBtn":"onCaret","click .dashHomeBtn":"onDashboardHome","click h1":"onHeaderClicked","click .share-details":"onShareClicked","click .right-menu":function(){this.toggleRightMenu(false)},swipeLeft:function(t){if(e.nomad.utils.isDirectionLTR()){this.onSwipeLeft(t)}else{this.onSwipeRight(t)}},swipeRight:function(t){if(e.nomad.utils.isDirectionLTR()){this.onSwipeRight(t)}else{this.onSwipeLeft(t)}}},plugins:["fast-click-highlight"],buttonSelectorMap:{back:".backBtn",menu:".menuBtn",save:".saveBtn",cancel:".cancelBtn",caret:".caretBtn",dashHome:".dashHomeBtn"},allowCreateMenuInModule:["About","Settings","Recents","Search"],RIGHT_MENU:"right_menu",_isRightMenuOpened:false,_isMainMenuOpened:false,_saveBtnDisabled:false,dataContainer:null,globalEvents:{"app:logout":function(){delete this.avatar},"offline:status:update":function(t){var i=this.$el.find(".offline-icon, .offline-status");i.removeClass("status-success status-warning status-error status-default");i.addClass(e.nomad.utils.getOfflineStatusClass())},"app:orientation:changed":function(){if(!e.isTablet)return;window.scrollTo(0,0);if(e.controller.layoutManager.getRecordLayout()){t.addClass("show-content-child")}},"app:mainmenu:show":function(e){this._isMainMenuOpened=e.show}},offlineStatusIconPartial:"offline-status-icon",offlineStatusClass:function(){return e.nomad.utils.getOfflineStatusClass()},initialize:function(n){var a=this;e.events.register("app:header:save",this);e.events.register("app:header:clicked",this);e.events.register("app:header:add",this);e.view.NomadView.prototype.initialize.call(this,n);this.defaults={title:e.config.productName,menuButton:true,plus:true,back:false,save:false,otherActions:false,cancel:false};t=$(document.body);i=e.$rootEl.find("#content-overlay");this.isAnimationEnabled=e.supportedFeatures.menuAnimation;this._initializeCancelSaveHandlers()},_initializeCancelSaveHandlers:function(){var e=this;if(this.model){this.model.on("data:sync:start",function(t,i,n){e.setButtonsEnabled(false)},this).on("sync",function(t,i,n,a){e.setButtonsEnabled(true,null,n.method)},this).on("data:sync:error",function(t,i,n){e.setButtonsEnabled(true,n,t)},this)}},setButtonsEnabled:function(t,i,n){if(t){if(this.data.otherActions){this._refreshHeaderActions()}this.$(".save-container").toggle(this._hasAccessToSave());if(i&&(i.status===404||i.status===403&&n==="read"||n==="read"&&(!e.offlineEnabled||i instanceof e.offline.Error))){this.$(".save-container").hide();if(i.status===404||i.status===403){this.$(".createBtn").hide()}}else if(!i){this.$(".createBtn").show()}if(!this._saveBtnDisabled){this.$(".saveBtn .btn").removeClass("disabled")}this.$(".cancelBtn .btn").removeClass("disabled")}else{this.$(".saveBtn .btn").addClass("disabled");this.$(".cancelBtn .btn").addClass("disabled")}},_hasAccessToSave:function(){var t=this.model.get("id");return!t||e.acl.hasAccessToModel("edit",this.model)&&!_.contains(e.config.nonEditableModules,this.module)},_refreshHeaderActions:function(){var t=false;_.each(this.data.otherActions,function(i){var n=i.isEnabled(this.model);i.enabled=n&&(!i.needsAccess||e.acl.hasAccessToModel(i.needsAccess.action,this.model,i.needsAccess.field));if(i.enabled)t=true},this);this.$(".caretBtn").toggle(t);this.$(".saveBtn").toggleClass("combined",t)},onBeforeRender:function(){if(this.data.save&&!this.context.get("create")&&!this.layout.isDynamic()&&this.layout.type!=="list"){this.data.saveHidden=true}this.data.UI={hasEditButton:this.data.save||this.data.cancel};this.buildRightMenu();this.data.isMenuButtonSupported=this._isMenuButtonSupported()},onAfterRender:function(){this.$menuContainer=e.$rootEl.find("#menu-left");this.$contentWrapper=e.$rootEl.find("#wrapper")},onHeaderClicked:function(t){t.preventDefault();e.trigger("app:header:clicked",this.layout)},onSave:function(e){if(!this.$(".saveBtn .btn").hasClass("disabled"))this._onButtonClicked(e,"app:header:save")},onCancel:function(e){if(!this.$(".cancelBtn .btn").hasClass("disabled"))this._onButtonClicked(e,"app:header:cancel")},onDashboardHome:function(e){this._onButtonClicked(e,"app:header:dashboard:home")},onBack:function(e){this._onButtonClicked(e,"app:header:cancel")},onHomeClicked:function(t){t.preventDefault();if(!this._isMenuButtonSupported()){return}e.trigger("app:header:home");e.nomad.dismissAlerts()},onSwipeLeft:function(e){if(this._isMainMenuOpened){this.onHomeClicked(e)}else if(!this._isRightMenuOpened&&this.data.plus&&!this.rightMenuData.createOnly){this.onAddClicked(e)}},onSwipeRight:function(t){if(e.nomad.getOrientation()==="landscape"&&e.isTablet)return;if(this._isRightMenuOpened){this.onAddClicked(t);return}this.onHomeClicked(t)},_onButtonClicked:function(t,i){e.nomad.dismissAlerts();if(t)t.preventDefault();this.trigger(i,this.layout)},onAddClicked:function(t){t.preventDefault();t.stopPropagation();e.nomad.dismissAlerts();if(this.rightMenuData.createOnly){var i=e.router.buildRoute(this.rightMenuData.module,null,"create");e.router.navigate(i,{trigger:true})}else{this.toggleRightMenu(!this._isRightMenuOpened);e.tutorial.show("plus-menu")}e.trigger("app:header:add",this._isRightMenuOpened)},toggleRightMenu:function(i,n,a){var o;var s=this;var r=e.nomad.utils.isDirectionLTR()?1:-1;o={show:i,disableAnimation:n,callback:a,view:this};if(i){t.on("touchstart.header"+s.cid,function(e){var t=$(e.target);var i=(t.hasClass("create-entity")||t.hasClass("icon-plus"))&&!_.isEmpty(s.$el.find(t));var n=!_.isEmpty(s.$el.find(".right-menu").find(t));if(!(i||n)){_.delay(function(){s.toggleRightMenu(false)},100)}})}else{t.off("touchstart.header"+s.cid)}if(e.isTablet){this._isRightMenuOpened=i;this.$(".createBtn").toggleClass("active",i);e.$rootEl.find(".overlay_right-menu").toggleClass("show",i);this.$(".right-menu")[i?"fadeIn":"fadeOut"]();e.trigger("app:rightmenu:show",o)}else{e.trigger("app:rightmenu:show",o);var l=n||!this.isAnimationEnabled?0:200;var c=this.$(".right-menu");var d={menuAnimation:{"-webkit-transform":i?"translate3d("+r*100+"%, 0, 0)":"translate3d("+r*100+"%, 0, 0)"},contentAnimation:{"-webkit-transform":i?"translate3d("+r*-86+"%, 0, 0)":"translate3d(0, 0, 0)"},overlayAnimation:{"-webkit-transform":i?"translate3d("+r*-86+"%, 0, 0)":"translate3d("+r*-100+"%, 0, 0)"}};var u=function(){t.toggleClass("show-right-menu",i);s._isRightMenuOpened=i;if(a){a()}};this.animateMenu({isShowing:i,data:d,$menu:c,callback:u,duration:l})}},animateMenu:function(t){var i=t.data;var n=t.isShowing;if(n){t.$menu.animate(i.menuAnimation,0)}this.$contentWrapper.animate(i.contentAnimation,t.duration,"ease-out",function(){if(!n){t.$menu.animate(i.menuAnimation,0)}if(i.overlayAnimation){e.$rootEl.find("#content-overlay").animate(i.overlayAnimation,0)}if(t.callback){t.callback()}})},setTitle:function(e){this.$el.find(".header-title").text(e)},setSubtitle:function(e){this.$el.find(".header-subtitle").text(e)},setButtonVisible:function(e){_.each(e,function(e,t){this.$el.find(this.buttonSelectorMap[t]).toggle(e)},this)},onCaret:function(t){var i=[];var n=[];var a=this;if(t){t.preventDefault();t.stopPropagation()}_.each(this.data.otherActions,function(t){if(t.enabled){i.push(e.lang.get(t.label,null,a));n.push(t.name)}});if(i.length){e.nomad.showActionSheet(e.lang.get("LBL_SELECT_ACTION_LABEL"),i,function o(t,i){e.trigger("app:header:action",n[i])})}},buildRightMenu:function(){var t="";var i=this.data.layoutOptions;if(!this.data||!this.data.plus||!i){return}var n;var a;var o;var s;var r;var l;var c;if(i.subType==="relationships"){o=i.parentModule;s=i.parentModelId;r=i.link;l=e.data.getRelatedModule(o,r);n="menu-right-rel-list";c=e.nomad.getSingularModuleName(l);a={createRelationshipHref:{url:e.nomad.buildLinkRoute(o,s,r,"create"),label:e.lang.get("LBL_CREATE_RELATED",l,c),disabled:!e.nomad.canCreateRelated(l,o,"create",r)},associateRelationshipHref:{url:e.nomad.buildLinkRoute(o,s,r,"associate"),label:e.lang.get("LBL_ASSOC_EXISTING",l,c),disabled:!e.nomad.canLinkRelated(o,r)}};this.data.plus=!(a.createRelationshipHref.disabled&&a.associateRelationshipHref.disabled)}else if(i.name==="detail"){n="menu-right-detail";if(i.link){o=i.parentModule;s=i.parentModelId;r=i.link;l=e.data.getRelatedModule(o,r);a={params:i,duplicateHref:{url:e.nomad.buildLinkRoute(o,s,r,i.modelId,"duplicate"),label:e.lang.get("LBL_DUPLICATE_BUTTON"),disabled:!e.nomad.canCreateModule(l)||_.include(e.config.nonDuplicatableModules,l)||!e.nomad.hasAccessToReqFields(l,"create")},shareRecord:{disabled:false}};this.data.plus=!(a.duplicateHref.disabled&&a.shareRecord.disabled)}else{if(e.controller.getScreenContext().root==="Recents"){t="Recents/"}a={params:i,duplicateHref:{url:t+e.router.buildRoute(i.module,i.modelId,"duplicate"),label:e.lang.get("LBL_DUPLICATE_BUTTON"),disabled:!e.nomad.canCreateModule(i.module)||_.include(e.config.nonDuplicatableModules,i.module)||!e.nomad.hasAccessToReqFields(i.module,"create")},createRelationshipHref:{url:t+e.router.buildRoute(i.module,i.modelId)+"/create-related",label:e.lang.get("LBL_CREATE_RELATED_RECORD"),
disabled:!this.data.hasCreatableRels},associateRelationshipHref:{url:t+e.router.buildRoute(i.module,i.modelId)+"/associate-related",label:e.lang.get("LBL_ASSOC_RELATED_RECORD"),disabled:!this.data.hasRels},shareRecord:{disabled:false}};this.data.plus=!(a.duplicateHref.disabled&&a.createRelationshipHref.disabled&&a.associateRelationshipHref.disabled&&a.shareRecord.disabled)}}else{n="menu-right-list";if(_.contains(this.allowCreateMenuInModule,i.module)){var d=_.reject(e.metadata.getModuleNames({filter:"visible"}),function(t){return!e.nomad.canCreateModule(t)||!e.nomad.hasAccessToReqFields(t,"create")});switch(i.module){case"Recents":t="Recents/";break;case"Search":t="Search/";break}if(d.length>0){a=_.map(d,function(i){return{url:t+i,module:i,label:e.lang.get("LBL_CREATE_MODULE",i,e.nomad.getSingularModuleName(i))}})}else{this.data.plus=false}}else if(i.module==="Dashboards"){}else if(i.module&&(!e.nomad.canCreateModule(i.module)||!e.nomad.hasAccessToReqFields(i.module,"create"))){this.data.plus=false}else{a={createOnly:true,module:i.module}}}this.rightMenuData=a;this.rightMenuTemplate=n},_isMenuButtonSupported:function(){return this.data.menuButton},_getSharedUrl:function(){return e.utils.buildUrl(window.location.hash)},onShareClicked:function(t){t.preventDefault();t.stopPropagation();var i={url:this._getSharedUrl(),appId:e.config.brandName,module:e.nomad.getSingularModuleName(this.model.module),name:this.model.get("name"),shareLabel:e.lang.get("LBL_RECORD_SHARE_BUTTON")};i.subject=e.lang.get("TPL_RECORD_SHARE_SUBJECT",null,i);i.body=e.lang.get("TPL_RECORD_SHARE_BODY",null,i);e.nomad.share(i)},setSaveBtnState:function(e){this._saveBtnDisabled=_.isEmpty(e);this.$(".saveBtn .btn").toggleClass("disabled",this._saveBtnDisabled)},_dispose:function(){e.events.off("app:header:picturechanged",null,this);this._super("_dispose")}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.MainMenuView=e.view.NomadView.extend({events:{"click #desktop":function(t){t.preventDefault();e.nomad.openUrl(t.currentTarget.href)},"click .nav li.disabled a":function(e){e.preventDefault();e.stopPropagation()},'click .nav li:not(.disabled) a:not([target="_blank"])':"onMenuItemClicked",swipe:function(e){e.stopPropagation()}},globalEvents:{"app:settings:changed":function(){this.render()},"offline:status:update":function(t){var i=this.$el.find(".offline-icon");i.removeClass("status-success status-warning status-error status-default");i.addClass(e.nomad.utils.getOfflineStatusClass())},"app:view:change":function(e){if(e.layoutDef&&e.layoutDef.isDynamic){return}this.highlightActiveMenuItem(e);this.toggleMenu(false,true)},"app:orientation:changed":function(){if(!e.isTablet){return}this.toggleMenu(false,true)}},plugins:["fast-click-highlight"],offlineStatusIconPartial:"offline-status-icon",_isOpened:false,initialize:function(t){var i=this;var n=$(document.body);this.$contentWrapper=e.$rootEl.find("#wrapper");e.view.NomadView.prototype.initialize.call(this,t);e.events.register("app:header:picturechanged",this);e.events.register("app:header:home",this);e.events.on("app:header:picturechanged",_.bind(this._loadUserPicture,this),this);e.events.on("app:header:home",function(e,t){this.toggleMenu(!this._isOpened,false,t)},this);n.on("click.menu swipe.menu",function(){if(i._isOpened){i.toggleMenu(false)}});this._isOpened=n.hasClass("show-menu-left")?true:false;e.nomad.mainMenu=this},start:function(){this.render();this._loadUserPicture()},onMenuItemClicked:function(t){var i=$(t.currentTarget);if(!e.isTablet){this.toggleMenu(false)}this.handleLinkClick(t)},onBeforeRender:function(){e.view.NomadView.prototype.onBeforeRender.call(this);this.buildMenu()},onAfterRender:function(){e.view.NomadView.prototype.onAfterRender.call(this);var t=e.controller.getScreenContext();this.highlightActiveMenuItem(t)},toggleMenu:function(t,i,n){var a=this;var o=i||!e.supportedFeatures.menuAnimation?0:200;var s=a.$("#moduleList");var r=$(document.body);var l=e.nomad.utils.isDirectionLTR()?1:-1;var c;n=n||function(){};var d={contentAnimation:{"-webkit-transform":t?"translate3d("+l*244+"px, 0, 0)":"translate3d(0, 0, 0)"},overlayAnimation:{"-webkit-transform":t?"translate3d("+l*244+"px, 0, 0)":"translate3d("+l*-100+"%, 0, 0)"}};var u={menuAnimation:{"-webkit-transform":t?"translate3d(0, 0, 0)":"translate3d("+l*-100+"%, 0, 0)"},contentAnimation:{"-webkit-transform":t?"translate3d("+l*86+"%, 0, 0)":"translate3d(0, 0, 0)"},overlayAnimation:{"-webkit-transform":t?"translate3d("+l*86+"%, 0, 0)":"translate3d("+l*-100+"%, 0, 0)"}};c=e.isTablet?d:u;var f=function(){r.toggleClass("show-menu-left",t);a._isOpened=t;e.trigger("app:mainmenu:show",{show:a._isOpened,disableAnimation:i,callback:n,view:a});if(n){n()}};this.animateMenu({isShowing:t,data:c,$menu:s,callback:f,duration:o})},animateMenu:function(t){var i=t.data;var n=t.isShowing;if(n){$(document.body).addClass("show-menu-left");t.$menu.animate(i.menuAnimation,0)}this.$contentWrapper.animate(i.contentAnimation,t.duration,"ease-out",function(){if(!n){t.$menu.animate(i.menuAnimation,0)}if(i.overlayAnimation){e.$rootEl.find("#content-overlay").animate(i.overlayAnimation,0)}if(t.callback){t.callback()}})},_loadUserPicture:function(t){if(!e.api.isAuthenticated()){return}var i=e.api.buildFileURL({field:"picture",module:"Users",id:e.user.get("id")},e.nomad.getFileOptions());var n=new Image;var a;if(t){i+="&id="+t;a=true}if(!this.avatar){a=true}n.onload=_.bind(this._applyUserPicture,this,{img:n,url:i});if(a){n.src=i}else{this._applyUserPicture(this.avatar)}},_applyUserPicture:function(t){if(this.disposed){return}var i=this.$("#me i");var n={image:t.img,height:i.css("height"),width:i.css("width")};if(t.el){i.replaceWith(t.el);return}e.nomad.utils.sizePicture(n);i.css({backgroundSize:n.sizeProp,backgroundImage:"url("+t.url+")"}).addClass("withPicture");this.avatar={url:t.url,el:i}},highlightActiveMenuItem:function(e){var t=e.root||e.module||e.parentModule;if(t==="TxLog"){t="Offline"}else if(t==="Dashboards"){t+="/"+e.dashboardId}this.$el.find("li").removeClass("current");this.$el.find("a[href='#"+t+"']").parent("li").addClass("current")},buildMenu:function(){var t=[];_.each(e.nomad.dashboards.getDashboards({type:"home"}),function(i){var n=i.get("metadata");if(n&&n.dashlets.length){t.push({id:i.id,label:e.lang.getAppString(i.get("name"))||i.get("name")})}});_.extend(this,{items:_.map(e.metadata.getModuleNames({filter:"display_tab",access:"list"}),function(t){return{url:t,label:e.nomad.getPluralModuleName(t)}}),userName:e.user.get("full_name"),userId:e.user.get("id"),desktopURI:e.nomad.getDesktopUrl(),offlineEnabled:e.offlineEnabled,errorEmulationEnabled:e.nomad.utils.isErrorEmulationEnabled(),offlineStatusIconPartial:this.offlineStatusIconPartial,offlineStatusClass:e.nomad.utils.getOfflineStatusClass(),dashboards:t.length?t:undefined,dashboardsSupported:e.supportedFeatures.dashboards,activitiesSupported:e.supportedFeatures.activities})},_dispose:function(){e.events.off("app:header:picturechanged",null,this);$(document.body).off("click.menu swipe.menu")}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.AboutView=e.view.NomadView.extend({events:{"click .legal a":function(t){t.preventDefault();e.nomad.openUrl(t.target.href)},"click .support_email":function(t){t.preventDefault();var i=e.isNative?"\n\n\nrequest ID: "+e.clientInfo.device.uuid:"";e.nomad.sendConsoleLog(e.config.about.supportEmail,e.config.brandName+" Mobile support request",i)},"click .support_website":function(t){t.preventDefault();e.nomad.openUrl("http://"+e.config.about.support)},"click .server_url a":function(t){t.preventDefault();e.nomad.openUrl(this._getServerUrl())},"swipeRight .support_website":function(e){this._feedBack=(this._feedBack||0)+1;if(this._feedBack>=3){this.getField("support_email").$el.removeClass("hide")}}},onAfterRender:function(){if(!!e.config.about.displaySupportEmail){this.getField("support_email").$el.removeClass("hide")}if(!e.config.about.support){this.getField("support_website").$el.addClass("hide")}},initialize:function(t){var i=e.nomad.getServerVersion();var n;e.view.NomadView.prototype.initialize.call(this,t);_.extend(this,{fallbackFieldTemplate:"readonly",_displayTrademarks:e.config.about.displayTrademarks,_copyrightText:e.config.about.copyrightText||e.lang.getAppString("LBL_COPYRIGHT"),_trademarkText:e.config.about.trademarkText||e.lang.getAppString("LBL_TRADEMARK"),_trademark2Text:e.config.about.trademark2Text||e.lang.getAppString("LBL_TRADEMARK2")});n=this._getServerUrl().replace(/(http:\/\/)|(https:\/\/)|(\/rest\/v10\/)/,"");this.model.set({app_version:e.nomad.getProductVersion(),server_version:i,server_url:n,support_email:e.config.about.supportEmail,support_website:e.config.about.support,privacy:e.config.about.privacy,tos:e.config.about.tos,thirdPartySoftware:e.config.about.thirdPartySoftware})},_getServerUrl:function(){var t;if(e.isNative){if(e.config.hideLoginUrl){t=e.config.defaultServerUrl}else if(e.api.isAuthenticated()){t=e.nomad.getSetting("loginUrl")}}else{t=e.config.siteUrl;if(t.indexOf("..")===0)t=e.nomad.utils.resolveUrl(t,window.location.href)}return t||""},getHeaderData:function(){return{title:e.lang.get("LNK_ABOUT"),menuButton:e.api.isAuthenticated()&&e.isSynced,plus:false,back:true}}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.SettingsView=e.view.NomadView.extend({_bodyScroll:true,_defaultViewSplitter:":",_defaultViewFieldName:"default_view",globalEvents:{"app:header:save":"saveSettings","app:header:cancel":"cancel"},events:{"click #touchid-toggle":"_enableTouchIdClicked"},initialize:function(t){this._modelBackup=null;this._showOfflineButton=e.config.offline.enabled&&(e.config.offlineEnabled||e.config.offline.debug.ignoreEnabled)&&e.supportedFeatures.offline;this._offlineEnabled=e.offlineEnabled;this._configurableFontSize=e.config.configurableFontSize;var i=new Backbone.Model(e.user.get("preferences"));var n=e.logger.levels[e.config.logLevel];if(n){i.set("logging",n.value-1)}var a=e.nomad.getSetting("fontSize")||"normal";if(this._configurableFontSize&&a){i.set("fontSize",a)}this._showTouchIdButton=e.localSecurity.isTouchIdAuthenticationSupported();this._touchIdEnabled=e.localSecurity.isTouchIdForLoginSetup();i.set("touchIdEnabled",this._touchIdEnabled);t.layout.context.set("model",i);t.layout.model=i;this._super("initialize",[t]);if(this._configurableFontSize){var o=this.getFieldMeta("fontSize");o.options={};_.each([["tiny","LBL_FONTSIZE_TINY"],["small","LBL_FONTSIZE_SMALL"],["normal","LBL_FONTSIZE_NORMAL"],["large","LBL_FONTSIZE_LARGE"],["larger","LBL_FONTSIZE_LARGER"],["huge","LBL_FONTSIZE_HUGE"],["extra_huge","LBL_FONTSIZE_EXTRA_HUGE"]],function(t){o.options[t[0]]=e.lang.get(t[1])})}else{this.meta.panels[0].fields=_.filter(this.meta.panels[0].fields,function(e){return e.name!=="fontSize"})}if(e.supportedFeatures.settingsDefaultView){this._defineDefaultViewFields();this._adjustDefaultViewOptions();this.applyDefaultViewOnModel()}this.listenTo(this.model,"change",this.onSettingChange)},isEditView:function(){return true},_canSetValue:function(e,t){if(!t.dependencies.length)return true;return!!_.find(t.dependencies,function(t){var i=this.model.get(t.parentField);return!t.result||_.has(t.result(i),e)},this)},_defineDefaultViewFields:function(){var t=this.meta.panels[0].fields;this._defaultViewFields=[{name:"default_view",label:"LBL_MOBILE_DEFAULT_VIEW",options:{Modules:e.lang.get("LBL_MOBILE_SPECIFIC_MODULE")},view:"edit",type:"enum",dependencies:[]},{name:"default_module",label:"LBL_MOBILE_DEFAULT_MODULE",options:{},view:"edit",type:"enum",dependencies:[{parentField:"default_view",condition:function(e){var t=e.get(this.parentField);return t==="Modules"},result:function(){var t=e.metadata.getModuleNames({filter:"visible"});return _.object(t,_.map(t,e.nomad.getPluralModuleName))}}]},{name:"default_dashboard",label:"LBL_MOBILE_DEFAULT_DASHBOARD",options:{},view:"edit",type:"enum",dependencies:[{parentField:"default_view",condition:function(e){var t=e.get(this.parentField);return t==="Dashboards"},result:function(){var t={};_.each(e.nomad.dashboards.getDashboards({type:"home"}),function(i){t[i.id]=e.lang.get(i.get("name"))});return t}}]},{name:"default_dashlet",label:"LBL_MOBILE_DEFAULT_DASHLET",options:{},view:"edit","default":"-1",type:"enum",dependencies:[{parentField:"default_dashboard",condition:function(e){var t=e.get("default_view");return t==="Dashboards"},result:this._getDashboardDashlets}]}];_.each(this._defaultViewFields,function(e){var i=_.find(t,function(t){return t.name===e.name});if(!i){t.push(e)}},this);this._defaultViewFieldNames=_.pluck(this._defaultViewFields,"name")},resetDefaultView:function(){this.defaultView=e.config.defaultViewScheme;_.each(this._defaultViewFields,function(e){this.model.unset(e.name,{silent:true})},this);this.applyDefaultViewOnModel()},applyDefaultViewOnModel:function(){this.defaultView=this.defaultView||e.nomad.getSetting(this._defaultViewFieldName)||e.config.defaultViewScheme;if(!this.defaultView)return;var t=this.defaultView.split(this._defaultViewSplitter);_.find(this._defaultViewFields,function(e){var i=!_.isEmpty(e.dependencies)&&e.dependencies[0].parentField;var n=this.model.get(i);var a=true;var o;if(n){a=!!_.find(e.dependencies,function(e){return e.condition(this.model)},this)}if(a){o=t.shift();if(!this._canSetValue(o,e)){this.resetDefaultView();return true}this.model.set(e.name,o,{silent:true})}return _.isEmpty(t)},this)},onSettingChange:function(e){var t=_.keys(e.changed);var i=_.intersection(this._defaultViewFieldNames,t);_.each(i,function(e){this._onDefaultViewChange(e)},this)},_adjustDefaultViewOptions:function(){var t=_.find(this.meta.panels[0].fields,function(e){return e.name===this._defaultViewFieldName},this);if(e.supportedFeatures.dashboards){var i=e.nomad.dashboards.getDashboards({type:"home"});t.options.Search=e.lang.get("LBL_MOBILE_GLOBAL_SEARCH");if(!_.isEmpty(i)){t.options.Dashboards=e.lang.get("LBL_MOBILE_SPECIFIC_DASHBOARD")}}if(e.supportedFeatures.activities){t.options.Activities=e.lang.get("LBL_ACTIVITY_STREAM")}},_getDependentFields:function(e){var t=[];_.each(this._defaultViewFields,function(i){if(_.contains(_.pluck(i.dependencies,"parentField"),e)){t.push(i)}});return t},_getDashboardDashlets:function(t){var i=e.nomad.dashboards.getDashboard(t).get("metadata");var n=i.dashlets;var a=_.chain(n).pluck("view").pluck("label").value();var o;a=_.map(a,function(t,i){var a=n[i].view;var o=_.defaults({label:t},a);return e.nomad.dashboards.getDashletTitle(o)});o=_.object(_.pluck(n,"id"),a);o[-1]=e.lang.get("LBL_ALL_DASHLETS");return o},_onDefaultViewChange:function(e,t){var i=this.getField(e);var n=i.getValue();var a=this._getDependentFields(e);_.each(a,function(e){var i=e.name;var a=this.getField(i);var o={};if(!a){return}_.each(e.dependencies,function(e){if(e.condition(this.model)){o=e.result;if(_.isFunction(o)&&!_.isUndefined(n)){o=o(n)}}},this);this._adjustSubviewGrid(a,o,t)},this)},_adjustSubviewGrid:function(e,t,i){if(_.isObject(t)){e.def.options=t;if(!i&&!_.isEmpty(this.model.changed)||_.isUndefined(this.model.get(e.name))){this.model.set(e.name,e.getDefaultValue())}e.render()}},getHeaderData:function(){return{title:e.lang.get("LNK_SETTINGS"),save:true,cancel:true}},onAfterRender:function(){this.backupModel();this.$pad=this.$(".pad");this.$modalFooter=this.$(".modal-footer");this.$touchidItem=this.$el.find("#touchid-toggle");if(!e.config.showLogLevelSetting){this.getField("logging").remove()}_.each(this._defaultViewFieldNames,function(e){this.getField(e).$el.detach().appendTo(this.$pad);this._onDefaultViewChange(e,true)},this);this.$modalFooter.detach().appendTo(this.$pad)},saveSettings:function(){this.setFontSize();var t=this;var i=this.model.get("language");var n=this.$el.find("#offline-toggle").attr("checked");var a=n!==e.offlineEnabled;var o=false;var s=this.$touchidItem.attr("checked");var r=false;var l=false;var c=_.once(function h(){e.controller.clean()});var d=[function(){return t._showOfflineButton&&a},function(){return t.model.get("fontSize")!==t._modelBackup.fontSize},function(){var e=false;_.each(t._defaultViewFieldNames,function(i){if(e){return}var n=t.model.get(i);if(n){e=n!==t._modelBackup[i]}},this);return e},function(){return t.model.get("logging")!==t._modelBackup.logging},function(){var t=i!==e.user.getLanguage();if(t){l=true}return t},function(){var e=t._showOfflineButton&&a;if(e&&n){l=true}return e},function(){r=t._showTouchIdButton&&(s&&e.localSecurity.getTempCredential()||s!==Boolean(t._modelBackup.touchIdEnabled));return r}];var u=[function(i){t._showOfflineToggleConfirm(!e.offlineEnabled,function(e){if(e){o=e}i()})},function(i){var n=t.model?t.model.get("fontSize"):t._modelBackup.fontSize;e.nomad.setSetting("fontSize",n);i(null)},function(i){var n=t._modelBackup.default_view;if(t.model){n=_.reduce(t._defaultViewFieldNames,function(e,i){var n=t.model.get(i);if(i==="default_dashlet"&&parseInt(n,10)===-1){return e}if(n){e.push(t.model.get(i))}return e},[]).join(t._defaultViewSplitter)}e.nomad.setSetting(t._defaultViewFieldName,n);i(null)},function(i){var n=t.getField("logging");e.config.logLevel=n.options.def.options[n.value];e.config.debugSugarApi=n.value<=1;i(null)},function(t){c();e.lang.setLanguage(i,function(e){t(e)})},function(i){if(o){c();t.toggleOffline(!e.offlineEnabled,i)}else{i()}},function(t){if(r){if(s){e.localSecurity.moveTempCredentialsToStorage()}else{e.localSecurity.resetCredentials()}}t()}];var f;f=_.select(u,function(e,i){return d[i].call(t)});if(f.length){if(l){e.overlay.show("app:sync",{template:"preloader-panel",label:"LBL_LOADING"})}async.series(f,function(t){e.overlay.hide("app:sync");if(!t){e.trigger("app:settings:changed");e.controller.goBack()}})}else{e.controller.goBack()}},cancel:function(){e.nomad.setFontSize(e.nomad.getSetting("fontSize"));e.localSecurity.resetTempCredential();this.restoreModel()},backupModel:function(){var e=JSON.stringify(this.model.toJSON());this._modelBackup=JSON.parse(e)},restoreModel:function(){e.user.set("preferences",this._modelBackup)},toggleOffline:function(t,i){var n=this;if(t&&!e.nomad.isOnline()){this.showOfflineConnectionError(i);return false}e.logger.debug("Offline enabled: "+t);this.toggleOfflineUserSetting(t);if(t){e.events.once("offline:enabled",_.bind(this.onOfflineEnabled,this));e.events.once("offline:failure",_.bind(this.onOfflineFailure,this));e.offline.start({callback:function(){e.events.off("offline:enabled",n.onOfflineEnabled);e.events.off("offline:failure",n.onOfflineFailure);i()}})}else{e.nomad.setSetting(e.nomad.recordsPreloaderPromptKey,false);this.stopOffline(i)}},showOfflineConnectionError:function(t){t=t||function(){};var i="offline_enable_error";e.alert.show(i,{level:"error",messages:e.lang.get("ERR_OFFLINE_NO_CONNECTION_ENABLE_ERROR"),autoClose:true});t(i)},onOfflineEnabled:function(){var t=function(){_.delay(function(){e.overlay.hide("app:sync")},300)};e.nomad.startRecordsPreloader(t)},onOfflineFailure:function(t){this.toggleOfflineUserSetting(false);if(!t.err){return}if(t.err.status===0&&_.contains(["error","abort","timeout"],t.err.textStatus)){e.alert.dismiss("offline_error");this.showOfflineConnectionError()}this.stopOffline()},toggleOfflineUserSetting:function(t){e.offline.userEnabled=t;e.nomad.setSetting("offlineEnabled",t)},stopOffline:function(t){t=t||function(){};var i=[_.bind(e.nomad.dashboards.cleanDashletsCache,e.nomad.dashboards),_.bind(e.offline.disable,e.offline)];async.parallel(i,t)},_showOfflineToggleConfirm:function(t,i){var n=t?"LBL_OFFLINE_ENABLE_PROMPT":"LBL_OFFLINE_DISABLE_PROMPT";e.nomad.showConfirm(e.lang.get(n),function(e){i(e===2)})},_enableTouchIdClicked:function(t){if(this.$touchidItem.attr("checked")){var i=this;e.localSecurity.performTouchIdSetup(function(e){if(!e){i.$touchidItem.prop("checked",false)}})}},setFontSize:function(){var t=this.model.get("fontSize");e.nomad.setFontSize(t)}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.SetupBuddyView=e.view.NomadView.extend({_bodyScroll:true,events:{"click .sbSkipBtn":"onTouchIdSkip","click .sbEnableBtn":"onTouchIdEnableClick","click .sbOkBtn":"onTouchIdOkClick"},onAppResume:function(){this.loadData()},loadData:function(t){var i=this;e.localSecurity.isTouchIdEnrolled(function(t){i._isTouchIdEnrolled=t;i.sbHeader=e.lang.get(t?"LBL_ENABLE_TOUCHID":"LBL_SETUP_TOUCHID");i.sbDescription=t?e.lang.get("LBL_TOUCH_ID_DISCLAIMER",null,{brandName:e.config.brandName})+e.lang.get("LBL_SETUPBUDDY_TOUCH_ID_ADDITIONAL_DISCLAIMER"):e.lang.get("LBL_TOUCH_ID_NOT_ENROLLED_MSG",null,{brandName:e.config.brandName});i.render()})},getHeaderData:function(){return{title:e.lang.get("LBL_SETUPBUDDY_HEADER_TITLE"),save:false,cancel:false}},onTouchIdSkip:function(t){e.setupBuddy.performStepAction({action:"skip"})},onTouchIdOkClick:function(t){e.setupBuddy.performStepAction({action:"ok"})},onTouchIdEnableClick:function(t){e.setupBuddy.performStepAction({action:"enable"})}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.OfflineView=e.view.NomadView.extend({_devMode:e.config.offline.debug.render,globalEvents:{"offline:status:update":"onOfflineStatusUpdated"},events:{"click #preload_records_button":"onPreloadRecordsClick","click #preload_relationships_button":"onPreloadRelationshipsClick"},offlineStatusIconPartial:"offline-status-icon",initialize:function(t){e.view.NomadView.prototype.initialize.call(this,t);this.offlineDbEncrypted=e.cache.get("offline:encrypted")},render:function(t){this.offlineStatusClass=e.nomad.utils.getOfflineStatusClass();this.offlineMessage=this.getOfflineMessage();e.view.NomadView.prototype.render.call(this,t)},onOfflineStatusUpdated:function(){var t=this.$el.find(".offline-icon");var i=this.$el.find("#offline-message");t.removeClass("status-success status-warning status-error status-default");t.addClass(e.nomad.utils.getOfflineStatusClass());i.html(this.getOfflineMessage())},onPreloadRecordsClick:function(){e.nomad.promptAndPreloadUserRecords(false)},onPreloadRelationshipsClick:function(){e.nomad.promptAndPreloadUserRecords(false,true)},getHeaderData:function(){return{title:e.lang.get("LNK_OFFLINE_SETTINGS"),menuButton:true,back:true}},getOfflineMessage:function(){var t=e.offline.status;var i="";var n="";var a="LBL_OFFLINE_STATUS_ONLINE";var o="LBL_OFFLINE_STATUS_NO_PENDING_TX";var s="ERR_OFFLINE_OUT_OF_SPACE";if(!t)return"...";if(t.isSyncing){n="LBL_OFFLINE_SYNC_IN_PROGRESS"}else if(t.lastSyncTs&&t.totalTransactions>0){i=e.lang.get("LBL_OFFLINE_LAST_SYNC_TS",null,{ts:t.lastSyncTs.toLocaleString()})}if(!e.offline.isOnline()){a="LBL_OFFLINE_STATUS_OFFLINE"}else if(t.noConnection){a="LBL_OFFLINE_STATUS_BAD_NETWORK"}if(t.state===e.offline.STATE.ERROR){o="LBL_OFFLINE_STATUS_SYNC_FAILED"}else if(t.state===e.offline.STATE.WARNING&&t.totalTransactions>0){o="LBL_OFFLINE_STATUS_PENDING_TX"}return e.lang.get(o)+" "+(t.isOutOfSpace?e.lang.get(s)+" ":"")+e.lang.get(a)+" "+e.lang.get(n)+" "+i}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.OfflineSettingsView=e.view.NomadView.extend({events:{"touchstart .offline-property input":"onPropTouchstart"},onBeforeRender:function(){var t=e.config.offline.debug;this.configProperties={online:t.online,forceMigrate:t.forceMigrate,syncManagerEnabled:t.syncManagerEnabled,monitorStatus:t.monitorStatus,outOfSpace:t.outOfSpace}},getHeaderData:function(){return{title:e.lang.get("LBL_OFFLINE_SETTINGS"),menuButton:true,back:true}},onPropTouchstart:function(t){var i=$(t.target).attr("class");e.config.offline.debug[i]=!e.config.offline.debug[i]}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.OfflineStatsView=e.view.NomadView.extend({events:{"click #compactDbButton":"onCompactDbClick","click #clearDbButton":"onClearDbClick"},initialize:function(t){e.view.NomadView.prototype.initialize.call(this,t);this.getStatsAndRender()},getStatsAndRender:function(){var t=this;e.offline.storage.getStats({success:function(i){var n=[];function a(t){if(e.acl.hasAccess("access",t)){n.push({moduleName:e.nomad.getPluralModuleName(t),module:t,count:i.count[t]})}}var o=e.metadata.getModuleNames({filter:"enabled"});o=_.filter(o,function(t){return!_.contains(e.config.offline.exclude,t)});_.each(o,a);o=_.difference(_.keys(i.count),o);_.each(o,a);i.count=n;i.totalRecordsCount=_.reduce(i.count,function(e,t){if(_.isNumber(t.count))e+=t.count;return e},0);t.dbStats=i;t.render()}})},getHeaderData:function(){return{title:e.lang.get("LBL_OFFLINE_STATS"),menuButton:true,back:true}},onCompactDbClick:function(){var t=this;e.nomad.showConfirm(e.lang.get("LBL_OFFLINE_CLEAN_UP_PROMPT"),function(i){if(i===2){var n="db_cleanup";e.nomad.dismissAlerts();e.overlay.show(n);e.alert.show(n,{level:"info",messages:e.lang.get("LBL_OFFLINE_DB_CLEANING_IN_PROGRESS"),autoClose:false,closable:false});e.offline.compactStorage({callback:function(i){e.overlay.hide(n);e.alert.dismiss(n);if(i){e.alert.show(n,{level:"error",messages:e.lang.get("ERR_OFFLINE_DB_CLEANING_ERROR"),autoClose:true,closable:true})}else{e.alert.show(n,{level:"success",messages:e.lang.get("LBL_OFFLINE_DB_CLEANING_COMPLETED"),autoClose:true,closable:true})}e.controller.clean();t.getStatsAndRender()}})}})},onClearDbClick:function(){var t=this;e.nomad.showConfirm(e.lang.get("LBL_OFFLINE_CLEAR_DB_PROMPT"),function(i){if(i===2){var n="db_cleanup";e.nomad.dismissAlerts();e.overlay.show(n);e.alert.show(n,{level:"info",messages:e.lang.get("LBL_OFFLINE_DB_CLEANING_IN_PROGRESS"),autoClose:false,closable:false});e.offline.clearStorage({callback:function(i){e.overlay.hide(n);e.alert.dismiss(n);if(i){e.alert.show(n,{level:"error",messages:e.lang.get("ERR_OFFLINE_DB_CLEANING_ERROR"),autoClose:true,closable:true})}else{e.alert.show(n,{level:"success",messages:e.lang.get("LBL_OFFLINE_DB_CLEANING_COMPLETED"),autoClose:true,closable:true})}e.controller.clean();t.getStatsAndRender()}})}})}})})(SUGAR.App)},function(e,t){(function(e){var t={};var i={preventAnyAlert:false,init:function(){this.$alerts=$(e.config.alertsEl||"#alerts");this.klass=e.view[e.utils.capitalize(e.config.appId)+"AlertView"]||e.view.views[e.utils.capitalize(e.config.platform)+"AlertView"]||e.view.views.BaseAlertView||e.view[e.utils.capitalize(e.config.platform)+"AlertView"]||e.view.AlertView},show:function(i,n){if(!this.$alerts||this.$alerts.length===0)return null;if(this.preventAnyAlert)return null;n=_.extend({level:"info",autoClose:false},n||{});if(n.level==="confirmation"){this.dismissAll();this.preventAnyAlert=true}if(_.isUndefined(n.closeable)){n.closeable=n.level!=="info"}if(n.messages){n.messages=_.isString(n.messages)?[n.messages]:n.messages}var a=t[i];if(!a){a=this._create(i,n);t[i]=a}a.level=n.level;if(!!n.autoClose)this._setAutoCloseTimer(a,n.onAutoClose,n.autoCloseDelay);a.render(n);if(n.closeable){var o=a.getCloseSelector();o.off("click");o.on("click",_.bind(function(){this.dismiss(i)},this));if(e.accessibility){e.accessibility.run(o,"click")}}return a},_create:function(e,t){var i=new this.klass(t);i.key=e;i.$el.prependTo(this.$alerts);return i},_setAutoCloseTimer:function(t,i,n){if(t.timerId)clearTimeout(t.timerId);t.timerId=setTimeout(_.bind(function(){if(_.isFunction(i)){i(t.key)}this.dismiss(t.key)},this),n||e.config.alertAutoCloseDelay||9e3)},dismiss:function(e,i){this.preventAnyAlert=false;var n=t[e];if(!n)return;if(n.timerId)clearTimeout(n.timerId);n.close(i);delete t[e]},dismissAll:function(e,i){_.each(t,function(t,n){if(!e||t.level===e){this.dismiss(n,i)}},this)},get:function(e){return t[e]},getAll:function(){return t}};e.augment("alert",i,false);e.view.AlertView=e.view.View.extend({className:"alert",tpl:"alert",close:function(){this.getCloseSelector().off("click");this.$el.remove()},getCloseSelector:function(){return this.$(".close")},render:function(t){t=t||{};if(t.closeable){this.$el.addClass("closeable")}this.$el.addClass("alert-"+t.level);var i=e.template.get(t.tpl||this.tpl)||e.template.empty;this.$el.html(i(t))}})})(SUGAR.App)},function(e,t){(function(e){e.view.NomadAlertView=e.view.AlertView.extend({initialize:function(e){},close:function(t){t=t||{};var i=this;var n=!($.os.android&&this.options.level==="load");n=!_.isUndefined(t.animate)?t.animate:n;if(n){this.$el.animate({minHeight:"0",height:"0",borderTop:"0"},500,"ease",function(){e.view.AlertView.prototype.close.call(i)})}else{e.view.AlertView.prototype.close.call(i)}},getCloseSelector:function(){return this.$el}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.DashboardView=e.view.NomadView.extend({DEFAULT_TILE_ICON:"icon-th-large",subtitle:null,events:{"click .dashlets__list .dashlet__item":"_onDashletItemClick"},globalEvents:{"app:orientation:changed":"_onOrientationChange"},plugins:["swiper","fast-click-highlight"],_dashlets:[],_dashletTabs:{},_activeDashletId:null,_activeDashletData:null,_isRecordDashboard:false,_$dashboard:null,swiperSelector:".dashlets__slider-area",swiperSettings:{wrapperClass:"dashlets__slider",slideClass:"dashlet__b",spaceBetween:2},_dashletTypeMap:{"tabbed-dashlet":"tabbed-list-container-dashlet",dashablelist:"list-container-dashlet",casessummary:"cases-summary"},initialize:function(e){this._super("initialize",[e]);this._isRecordDashboard=this.model.get("dashboard_module")!=="Home"&&this.model.get("view_name")==="record";this.listenTo(this,"swiper:change:by_plugin",this.navigateToDashletIndex);this.startDashboard()},startDashboard:function(){if(this.model&&this.model.get("metadata")){this.start()}},isCurrentDashboardUpdated:function(e){return this.model.id===e},_dispose:function(){this._super("_dispose",arguments);_.each(this._dashlets,function(e){if(e.view){e.view.dispose()}},this);this._dashlets=this._$dashboard=null},start:function(){var t=this;var i=this.model.get("metadata");this._dashlets=[];i=i||{};_.each(i.dashlets,function(i,n){var a=i.view;t._dashlets.push({index:n,meta:i,title:e.nomad.dashboards.getDashletTitle(a),icon:t._getDashletIconClass(a)})})},_initDashletView:function(t,i){var n=t.view.type;var a=e.metadata.getView(null,n);var o=this.options.parentModel||this.context.get("parentModel");var s;var r;if(a&&a.tabs){n="tabbed-dashlet"}n=this._dashletTypeMap[n]||n;s={dashletId:i,name:n,meta:t,module:t.view.module,layout:this.layout,dashboardId:this.model.id,parentModel:o};return e.view.createView(s)},onAfterRender:function(){this._super("onAfterRender",arguments);this.trigger("swiper:update");this._$dashboard=this.$el.parent(".layout__Dashboards");var t=this.layout.options.def.dashletId||null;if(t&&!e.nomad.dashboards.isDashletAvailable(this.model.id,t)){var i=e.router.buildRoute("Dashboards",this.model.id);e.routing.replaceRoute(i);return}else if(!t){this.home()}else if(this._activeDashletId!==t){this._activeDashletId=t;this.layOutDashlets()}else if(this._activeDashletId===t){this.layOutDashlets(true)}},home:function(){this.trigger("dashlets:changed");this.setDashletsVisible(false);this.setSubtitleVisible(false);this._withActiveDashlet(function(e){e.view.onBeforeHide()});this._activeDashletId=null;this._activeDashletData=null},bindGlobalEvents:function(){this._super("bindGlobalEvents",arguments);this._withActiveDashlet(function(e){e.view.bindGlobalEvents()})},unbindGlobalEvents:function(){this._super("unbindGlobalEvents",arguments);this._withActiveDashlet(function(e){e.view.unbindGlobalEvents()})},_onDashletItemClick:function(e){var t=this._getDashletId(e);var i=this.getDashletData(t);if(i&&i.meta.view){_.extend(i.meta.view,{invokedFromDashboard:true})}this.navigateToDashlet(t)},_getDashletId:function(e){return $(e.currentTarget).data("dashlet-id")},getIndexOfActiveDashlet:function(){return _.indexOf(this.getDashletIds(),this._activeDashletId)},navigateToDashletIndex:function(e){if(e!==this.getIndexOfActiveDashlet()){this.navigateToDashlet(this.getDashletIds()[e])}},navigateToDashlet:function(t){var i=this.model;var n=e.controller.getScreenContext();var a;var o;var s;t=""+t;if(this._isRecordDashboard){if(n.link){o=[n.parentModule,n.parentModelId,"link",n.link,n.modelId,"Dashboards",i.id,t]}else{a=this.options.parentModelId||this.context.get("parentModelId");o=[i.get("dashboard_module"),a,"Dashboards",i.id,t];if(n.root){
o.splice(0,0,e.controller.getScreenContextRoot())}}s=o.join("/")}else{s=e.router.buildRoute(this.module,i.id,t)}e.controller.navigate(s,{trigger:true})},layOutDashlets:function(e){e=e||{};this.manageDashlets();if(!e.skipVisibilityChange){this.setDashletsVisible(true);if(this._isRecordDashboard){this.setSubtitle(this._activeDashletData.title);this.setSubtitleVisible(true)}}this.trigger("swiper:change:by_view",this.getIndexOfActiveDashlet(),e.disableAnimation);this.trigger("dashlets:changed",this._activeDashletData,e.disableAnimation)},manageDashlets:function t(){var e;_.each(this._dashlets,function(t){var i=t.meta.id;var n=i===this._activeDashletId;if(n){e=t}else if(t.view){t.view.onBeforeHide()}},this);if(e){if(!e.view){e.view=this._initDashletView(e.meta,e.meta.id);e.view.render();this._appendDashlet(e)}e.view.bindGlobalEvents();e.view.loadData();this._activeDashletData=this.getDashletData(this._activeDashletId);if(this._activeDashletData.meta.view.invokedFromDashboard){this._activeDashletData.view.onInvokedFromDashboard();this._activeDashletData.meta.view.invokedFromDashboard=false}}},_appendDashlet:function(e){var t=e.view;var i=this.$(".dashlets__slider").find(".dashlet__b[data-dashlet-id='"+e.meta.id+"']");var n=t.getViewContainer();i.append(n);t.appended=true},_onOrientationChange:function(){if(this._activeDashletId){this.layOutDashlets({disableAnimation:true,skipVisibilityChange:true})}},getDashletData:function(e){return _.find(this._dashlets,function(t){return+t.meta.id===+e})},getDashletIds:function(){return _.pluck(this.model.get("metadata").dashlets,"id")},getCurrentDashlet:function(){return _.find(this._dashlets,function(e){return e.meta.id===this._activeDashletId},this)},_getDashletIconClass:function(t){var i=t.template==="tabbed-dashlet"?e.config.dashboards.dashlets["tabbed-dashlet"].icon:e.config.dashboards.dashlets;return i[t.type]&&i[t.type].icon||this.DEFAULT_TILE_ICON},_withActiveDashlet:function(e){if(this._activeDashletData){e.call(this,this._activeDashletData)}},onDetach:function(){this.unbindGlobalEvents();this._withActiveDashlet(function(e){e.view.onDetach()});this._super("onDetach")},refreshData:function(){this._withActiveDashlet(function(e){e.view.refreshData()})},clean:function(){_.each(this._dashlets,function(e){var t=e.meta.id===this._activeDashletId;if(!t&&e.view){e.view.dispose();e.view=null}},this)},setSubtitle:function(e){this.$el.find(".dashlets__title").text(e)},setSubtitleVisible:function(e){this.$el.find(".dashlets__title").toggleClass("show",e)},setPaginatorVisible:function(e){if(!this._activeDashletId){e=false}this._$dashboard.toggleClass("show-paginator",e)},setDashletsVisible:function(e){this._$dashboard.toggleClass("show-dashlets",e);this.setPaginatorVisible(e)}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.LoginView=e.view.NomadView.extend({className:"view__login",privacyLink:e.config.about.privacy,tosLink:e.config.about.tos,useHttps:e.config.useHttps,_bodyScroll:true,events:{"click .about-link":function(){var t=e.context.getContext({module:"About",create:true,skipFetch:true}).prepare();e.controller.loadDynamic({layoutDef:{className:"no-main-menu",module:"About",name:"about",appendTo:"root",gaTrack:"about",meta:{components:[{view:"header"},{view:"about"}]},context:t}});$(document.body).removeClass("show-content-child")},"click #login_btn":"login","click #external_login_btn":"externalLogin","click .legal-link":function(t){t.preventDefault();e.nomad.openUrl(t.target.href)},"keypress input":function(e){if(e.which===13){e.srcElement.blur();this.login()}},"keyup input":"_updateBtnsState","focusout input":"_updateBtnsState","change input":"_updateBtnsState"},plugins:["clear-field","hide-alerts-onfocus"],initialize:function(){this._super("initialize",arguments);this.productVersion=e.clientInfo.app.productVersion},onAppResume:function(t){if(e.localSecurity.isTouchIdForLoginSetup()&&_.isEmpty(this.model.get("password"))){this.login()}},onAfterShow:function(){_.delay(_.bind(function(){e.overlay.hideAll();if(!this.disposed){this.$el.animate({opacity:"1"},500,"ease");if(e.localSecurity.isTouchIdEnabledOnLogin()&&_.isEmpty(this.model.get("password"))){this.login()}e.localSecurity.toggleTouchIdOnLogin(true)}},this),100)},login:function(){var t=this;var i=function(){t.reEnableLogin("#login_btn","LBL_LOGIN_BUTTON_TITLE")};var n={password:t.model.get("password"),username:t.model.get("username")};async.series([function(i){if(e.localSecurity.isTouchIdForLoginSetup()&&_.isEmpty(t.model.get("password"))){e.localSecurity.performTouchId(n.username,function(e,a){if(e){t.$el.find("#password").val(a);n.password=a;t.model.set("password",a);t._updateBtnsState()}i(!e)})}else{i()}},function(e){if(!t.updateButtonAndInfo("#login_btn",n.username)){e(true);return}var a=t.model.fields;if(_.isEmpty(t.$("input[type=url]"))){a={username:t.model.fields.username,password:t.model.fields.password}}t.model.doValidate(a,function(t){if(!t){i()}e(!t)})},function(a){e.alert.dismiss("field_validation_error");e.logger.debug("Username: "+n.username);e.api.setExternalLogin(false);e.login(n,e.clientInfo,{error:function(e){if(t.disposed){return}if(e&&e.status>=400&&e.status<=403){t.model.unset("password")}i()},success:function(){if(e.localSecurity.isTouchIdAuthenticationSupported()&&e.setupBuddy.isSetupBuddySupported()&&!e.setupBuddy.isSetupBuddyDone()){e.localSecurity.setTempCredential(n.password)}_.delay(function(){i()},500)},complete:function(){a()}})}])},externalLogin:function(){if(!this.updateButtonAndInfo("#external_login_btn"))return;var t=this;e.api.setExternalLogin(true);e.api.ping(null,{complete:function(){t.reEnableLogin("#external_login_btn","LBL_EXTERNAL_LOGIN_BUTTON_TITLE")},error:function(t){if(t.status===401){e.error.handleExternalLoginNotAvailable()}else{e.error.handleHttpError(t)}}})},updateButtonAndInfo:function(t,i){var n=this.$(t);n.focus();if(n.is("[disabled=disabled]"))return false;e.alert.dismissAll();var a=this.model.get("url");var o=this.$el.find(".checkbox");var s=o.length?o.attr("checked"):e.config.useHttps;this.$el.find(".btn").attr("disabled","disabled");n.html(Handlebars.templates.spinner()+" "+e.lang.get("LBL_LOADING"));e.overlay.show("login",{spinner:false});if(e.isNative){e.config.siteUrl=e.view.views.LoginView.normalizeUrl(a,s);e.api.serverUrl=e.nomad.getServerUrl();e.logger.debug("Site URL: "+e.config.siteUrl)}e.nomad.setSetting({loginName:i,loginUrl:a,siteUrl:e.config.siteUrl,useHttps:s});return true},reEnableLogin:function(t,i){e.overlay.hide("login");if(this.disposed)return;this.$(t).text(e.lang.get(i));this._updateBtnsState()},render:function(){var t=e.nomad.getSetting("loginUrl")||e.config.defaultServerUrl;this.model.set({username:e.api.isExternalLogin()?"":e.nomad.getSetting("loginName"),url:t===""?null:t},{silent:true});var i=e.nomad.getSetting("useHttps");if(!_.isUndefined(i)){this.useHttps=i}this._super("render",arguments);if(!e.isNative||e.config.hideLoginUrl){this.getField("url").remove();this.$el.find(".control-ssl").remove()}this._updateBtnsState();return this},_updateBtnsState:function(){if(e.config.externalLoginEnabled)this._setSsoBtnState();this._setLoginBtnState()},_setLoginBtnState:function(){var e=["username","password"];var t=0;if(!_.isEmpty(this.$("input[type=url]"))){e.push("url")}_.each(e,function(e){if($("input[name="+e+"]").val()){++t}});if(e.length===t){this.$("#login_btn").removeAttr("disabled")}else{this.$("#login_btn").attr("disabled","disabled")}},_setSsoBtnState:function(){var t=$("input[name=url]");if(!e.isNative||t&&t.val()){this.$("#external_login_btn").removeAttr("disabled")}else{this.$("#external_login_btn").attr("disabled","disabled")}}},{normalizeUrl:function(e,t){e=e.trim();var i=/^no-ssl:\/\//.test(e);if(!i&&!/^https?:\/\//.test(e)){e="http://"+e}if(t&&!i&&e.indexOf("http://")===0){e="https:"+e.substr(5)}if(e.indexOf("no-ssl://")===0){e="http://"+e.substr(9)}return e.replace(/\/+$/,"")}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.FiltersView=e.view.NomadView.extend({className:"view__filters",isFilterDDOpened:false,customFilters:null,sortable:true,_cacheKey:"filters",_customFiltersSynced:false,isSortingDDOpened:false,SORT_DEFAULT:"date_modified",SORT_CHANGED_EVENT:"sort:changed",FILTER_CHANGED_EVENT:"filter:changed",events:{"click .filter__item-main a":"onFilterBtnClick","click .dropdown__filter [data-filter-id]":"onFilterClick","click .dropdown__filter .filters-reload":"onFiltersReloadClick","click .filter__item-by a":"onSortingBtnClick","click .filter__item-sort a":"onSortDirectionBtnClick","click .dropdown__sortBy [data-fieldname]":"onSortableFieldClick"},plugins:["fast-click-highlight"],modulesCustomSortConfig:{Meetings:[{field:"date_start",direction:"asc",isDefault:true}]},initialize:function t(){this._super("initialize",arguments);this.template=e.template.get("filters");this.$body=$(document.body);this.cacheStore=e.nomad.stores.filters;this._persistLastState=!this._isOnStatelessLayout();this._searchMode=this._isOnSearchLayout();this._initFilters();this._initSorting()},_isOnSearchLayout:function i(){return this.options.module==="Search"},_isOnStatelessLayout:function n(){return _.contains(["associate","selector"],this.layout.options.subType)},_initFilters:function a(){if(e.supportedFeatures.filters&&!this._searchMode){this.customFilters=e.data.createBeanCollection("Filters");this.listenTo(this.customFilters,"data:sync:start",this.onCustomFiltersSyncStart);this.listenTo(this.customFilters,"data:sync:error",this.onCustomFiltersSyncError);this.listenTo(this.customFilters,"sync",this.onCustomFiltersSync)}this.standardFilters=this._getStandardFilters();if(this._isFiltersAvailable()){this.filters=this._getAvailableFilters()}this._addRecentsFilter(false)},_getAvailableFilters:function o(){return _.union(this.standardFilters,this._getFiltersFromCache())},_getCompatibleFilters:function s(){var t=!this._isOnSearchLayout()?e.nomad.getPluralModuleName(this.options.module):e.lang.get("LBL_RECORDS");var i={id:"favorites",name:e.lang.get("LBL_FAVORITES_FILTER"),params:{favorites:true}};var n={id:"assigned_to_me",name:e.lang.get("LBL_ASSIGNED_TO_ME",null,{module:t}),params:{my_items:true}};var a;a=[{id:"all_records",name:e.lang.get("LBL_LISTVIEW_FILTER_ALL",null,{module:t})},i,n];return a},_getStandardFilters:function(){var t;if(e.supportedFeatures.filters&&!this._searchMode){t=this._getFiltersFromMetadata()}else{t=this._getCompatibleFilters()}return t},_getFiltersFromMetadata:function r(){var t=e.nomad.getPluralModuleName(this.options.module);var i=e.metadata.getModule(this.options.module,"filters");var n;var a;if(_.isEmpty(i)||!i.basic||!i.basic.meta){return}n=e.utils.deepCopy(i.basic.meta.filters);a=i.default?i.default.meta.default_filter:"all_records";_.each(n,function(i){if(i.id==="favorites"){i.name="LBL_FAVORITES_FILTER"}if(i.id===a){i.active=true}i.name=e.lang.get(i.name,this.options.module,{module:t});if(!_.isArray(i.filter_definition)){i.filter_definition=[i.filter_definition]}},this);return n},_getCustomFilters:function l(){var t={limit:e.config.fetchLimit.filters,params:{filter:[{created_by:e.user.get("id"),module_name:this.options.module}]}};this.customFilters.fetch(t)},_addRecentsFilter:function c(t){if(!this._isFiltersAvailable()||!e.supportedFeatures.filters||!this._isOnSearchLayout()||t){return}this.filters.push({id:"recently_viewed",name:e.lang.get("LBL_RECENTLY_VIEWED"),params:{recents:true}})},_isFiltersAvailable:function d(){return!_.isEmpty(this.standardFilters)},_initSorting:function(){var t=this.module;var i=e.metadata.getView(t,"list").panels[0].fields;var n=e.metadata.getModule(t,"fields");var a=this.modulesCustomSortConfig[t];var o;this.sortableFields=_.chain(i).filter(function(i){return e.utils.isSortable(t,i)}).map(function(i){return{label:e.lang.get(i.label,t),name:i.name}}).value();o=[this.SORT_DEFAULT];if(a){o=_.union(o,_.pluck(a,"field"))}_.each(o,function(i){if(n[i]&&!_.findWhere(this.sortableFields,{name:i})){this.sortableFields.unshift({name:i,label:e.lang.get(n[i].vname,t)})}},this);if(!this._isSortAvailable()){this.sortable=false}else{this._setDefaultSortState()}},_isSortAvailable:function u(){return!_.isEmpty(this.sortableFields)},_setDefaultSortState:function f(){var t=e.metadata.getModule(this.module);var i=this._persistLastState&&this._getLastState().sorting;var n=t.views.list.meta.orderBy;var a=_.findWhere(this.modulesCustomSortConfig[this.module],{isDefault:true});var o=e.metadata.getModule(this.module,"fields");var s={direction:"desc"};var r=[i,n,a&&_.pick(a,"field","direction"),o[this.SORT_DEFAULT]&&{field:this.SORT_DEFAULT},{field:this.sortableFields[0].name}];_.each(r,function(e){if(e&&!s.field&&_.findWhere(this.sortableFields,{name:e.field})){_.extend(s,e)}},this);this.sortState=s},onCustomFiltersSyncStart:function h(){this.$filters.preloader.addClass("show");this.$filters.fetchingErr.removeClass("show")},onCustomFiltersSyncError:function p(){this.$filters.preloader.removeClass("show");this.$filters.fetchingErr.addClass("show")},onCustomFiltersSync:function m(t,i){var n=this.getActiveFilter();var a=[];_.each(i,function(e){if(_.isEmpty(e.filter_definition)){return}a.push({id:e.id,name:e.name,filter_definition:e.filter_definition,custom:true})});this._setFiltersToCache(a);this.filters=_.union(this.standardFilters,a);_.each(this.filters,function(e){e.active=e.id===n.id});this._customFiltersSynced=true;this.render();e.analytics.trackEvent("app","custom-filter",this.customFilters.length)},onAfterRender:function g(){this._super("onAfterRender");this.$overlay=this.$(".overlay-dropdown");if(this._isFiltersAvailable()){this.$filters={DD:this.$(".dropdown__filter"),DDItems:this.$(".dropdown__filter a"),btn:this.$(".filter__item-main a"),preloader:this.$(".filters-preloader"),fetchingErr:this.$(".filters-fetching-error")};this._setActiveFilter(this.getActiveFilter());if(this.isFilterDDOpened){this.activeUI=this.$filters}}if(this.sortable){this.$sorting={DD:this.$(".dropdown__sortBy"),DDItems:this.$(".dropdown__sortBy a"),btn:this.$(".filter__item-by a"),btnLbl:this.$(".filter__item-by .field-name"),directionBtn:this.$(".filter__item-sort .icon")};this._setActiveSortState();if(this.isSortingDDOpened){this.activeUI=this.$sorting}}},_setActiveSortState:function v(){this._setSortField(this.sortState.field);this._setSortDirection(this.sortState.direction)},_setSortDirection:function b(e){var t="icon-long-arrow-down";var i="icon-long-arrow-up";this.sortState.direction=e;if(e==="desc"){t=i;i="icon-long-arrow-down"}this.$sorting.directionBtn.removeClass(i).addClass(t).attr("data-direction",e);this._setLastState()},_setSortField:function y(e){this.sortState.field=e;this.$sorting.DDItems.removeClass("active");this.$sorting.DDItems.filter("[data-fieldname="+e+"]").addClass("active");this.$sorting.btnLbl.text(_.findWhere(this.sortableFields,{name:e}).label);this._setLastState()},onFilterBtnClick:function E(e){this.toggleDD(this.$filters);e.stopPropagation();e.preventDefault()},onSortingBtnClick:function L(e){this.toggleDD(this.$sorting);e.stopPropagation();e.preventDefault()},onSortDirectionBtnClick:function w(){var e=this.$sorting.directionBtn.attr("data-direction")==="asc"?"desc":"asc";this._setSortDirection(e);this.trigger(this.SORT_CHANGED_EVENT,this.getPreparedState())},toggleDD:function x(t){var i=this.activeUI&&this.activeUI!==t;var n=this;var a;var o;if(i){this._closeActiveDD()}this.activeUI=t;a=this.activeUI===this.$filters;o=a?!this.isFilterDDOpened:!this.isSortingDDOpened;this.activeUI.DD.toggleClass("show",o);this.activeUI.btn.toggleClass("active",o);this.$overlay.toggleClass("show",o);if(o){if(a&&e.supportedFeatures.filters&&!this._customFiltersSynced&&!this._searchMode&&!this._isOnSearchLayout()){this._getCustomFilters();this.$filters.fetchingErr.removeClass("show")}this.$body.on("click.filters",function(e){if(_.isEmpty($(e.target).closest(n.activeUI.DD))){n._closeActiveDD();e.stopPropagation();e.preventDefault()}})}else{this._removeOutsideClickHandling()}if(a){this.isFilterDDOpened=!this.isFilterDDOpened}else{this.isSortingDDOpened=!this.isSortingDDOpened}},onFilterClick:function S(t){var i=$(t.currentTarget);var n=i.attr("data-filter-id");var a=this.getFilter(n);var o=this.getActiveFilter();this._closeActiveDD();if(a.id!==o.id){this._setActiveFilter(a);this.trigger(this.FILTER_CHANGED_EVENT,this.getPreparedState())}var s=a.custom?"custom":a.id;e.analytics.trackEvent("filter",s);t.preventDefault();t.stopPropagation()},onSortableFieldClick:function A(t){var i=$(t.currentTarget);var n=i.attr("data-fieldname");this._closeActiveDD();if(n!==this.sortState.field){this._setSortField(n);this.trigger(this.SORT_CHANGED_EVENT,this.getPreparedState())}e.analytics.trackEvent("sort",n);t.preventDefault();t.stopPropagation()},onFiltersReloadClick:function(e){this._getCustomFilters();e.preventDefault();e.stopPropagation()},getFilter:function R(e){return _.findWhere(this.filters,{id:e})},getActiveFilter:function C(){if(!this._isFiltersAvailable())return;var e=this._persistLastState&&this._getLastState();var t=e?e.filter:null;var i=[{id:t},{active:true},this._isOnSearchLayout()&&{id:"recently_viewed"},{id:"all_records"}];var n;_.each(i,function(e){n=n||_.findWhere(this.filters,e)},this);if(!n){n=this.filters[0]}return n},resetToPreviousFilter:function T(){var e=_.findWhere(this.filters,{previouslyActive:true});if(e){this._setActiveFilter(e)}},toggleSearchMode:function I(e,t){if(!this._isFiltersAvailable()){return}var i=e?"_getCompatibleFilters":"_getAvailableFilters";var n=this.getActiveFilter();this._searchMode=e;this.filters=this[i]();this._addRecentsFilter(e);this._persistLastState=e?false:!this._isOnStatelessLayout();this.sortable=e?false:this._isSortAvailable();this.render();if(e&&_.findWhere(this.filters,{id:n.id})){this._setActiveFilter(n)}if(!e&&!t&&this.getActiveFilter().id!==n.id){this.trigger(this.FILTER_CHANGED_EVENT,this.getPreparedState())}},getPreparedState:function k(){var e=this.getActiveFilter()||{};var t=e.params||{};var i=e.filter_definition;if(!_.isEmpty(i)){_.extend(t,{filter:i})}if(this.sortable){_.extend(t,{order_by:this.sortState.field+":"+this.sortState.direction})}return t},toggle:function D(e){this.$el.toggleClass("filters-hidden",!e)},_closeActiveDD:function O(){if(!this.activeUI){return}this.activeUI.DD.removeClass("show");this.activeUI.btn.removeClass("active");this.$overlay.removeClass("show");this._removeOutsideClickHandling();if(this.activeUI===this.$filters){this._abortPendingRequests();this.isFilterDDOpened=false}else{this.isSortingDDOpened=false}this.activeUI=null},_setActiveFilter:function B(e){this.$filters.DDItems.removeClass("active");_.each(this.filters,function(t,i){if(t.id!==e.id){t.previouslyActive=false;if(t.active){t.previouslyActive=true;t.active=false}}else{this.$filters.DDItems[i].classList.add("active");this.$filters.btn.text(t.name);this.$filters.btn.data("active-filter-id",t.id);t.active=true;this._setLastState(t.id)}},this)},_removeOutsideClickHandling:function F(){this.$body.off("click.filters")},_getStoreCacheKey:function(){return this.options.module},_getLastStateKey:function(){return["filters",this.options.module,this.layout.options.link||""].join(":")},_setLastState:function N(t){if(!this._persistLastState){return}var i=this._getLastState()||{};if(t){i.filter=t}if(this.sortState){i.sorting=this.sortState}e.nomad.setLastState(this._getLastStateKey(),i)},_getLastState:function U(){return e.nomad.getLastState(this._getLastStateKey())||{}},_setFiltersToCache:function M(e){e=e||[];this.cacheStore.set(this._getStoreCacheKey(),JSON.stringify(e))},_getFiltersFromCache:function P(){var e=this.cacheStore.get(this._getStoreCacheKey());e=e?JSON.parse(e):[];return e},onDetach:function G(){this._abortPendingRequests();this._super("onDetach")},_abortPendingRequests:function V(){if(this.customFilters&&this.customFilters.getFetchRequest()){this.customFilters.abortFetchRequest()}},_dispose:function z(){this.$body.off("click.filters");this._super("_dispose")}})})(SUGAR.App)},function(e,t){(function(e){var t=2;var i=30;var n=8;var a=100;var o=50;var s=e.config.searchDelay;var r="@";var l="#";var c=["name","first_name","last_name"].join();e.view.views.TaggableView=e.view.NomadView.extend({className:"view__taggable",tagListOptionTemplate:Handlebars.compile('<li{{#if noAccess}} class="disabled"{{/if}}><a class="taggable-listItem">{{#if noAccess}}<span class="taggable-status">{{str "LBL_NO_ACCESS_LOWER"}}</span>{{/if}}<div class="label label-module-sm label-{{module}}" {{debug-attributes "attribute" "record_id" id}}>{{moduleIconLabel module}}</div>{{{htmlName}}}</a></li>'),tagShadowTemplate:Handlebars.compile('<span class="sugar_tag {{class}} label-{{module}}">{{text}}</span>'),tagTextTemplate:Handlebars.compile("@[{{module}}:{{id}}:{{name}}]"),_taggableEnabled:false,_taggableListOpen:false,_taggableModuleName:null,_taggableModuleList:null,_taggableModelId:null,_searchForTagsTimerId:null,_lastSearch:null,_prevValue:"",_tags:null,_textareaSelector:".taggable",_shadowSelector:".taggable-shadow",_dropdownSelector:".taggable-dropdown",$textarea:null,textarea:null,$shadow:null,$dropdown:null,globalEvents:{"app:header:save":"save"},events:{"input .taggable":"onInput","click .taggable-dropdown li":"onSearchResultClick","click .sugar_tag":function(){this.$textarea.focus()}},initialize:function d(){this._super("initialize",arguments);this._tags={};this._taggableModuleList=_.filter(e.metadata.getModuleNames({filter:"visible"}),function(e){return e!=="Employees"&&e!=="Users"});if(this.model.link){this._taggableModuleName=this.model.link.bean.get("parent_type");this._taggableModelId=this.model.link.bean.get("parent_id")}else{this._taggableModuleName=this.model.module;this._taggableModelId=this.model.id}this._resetLastSearch()},_dispose:function u(){this._abortRequests(true);this._super("_dispose",arguments)},getHeaderData:function f(){return{save:!this.options.isReadOnly,saveLabel:"LBL_COMMENT",cancel:true,btnsLong:true}},getPost:function h(){var e={};var t=this.textarea.value;var i=0;var n=t.length;var a;var o={};var s;e.value="";while(i<n){a=this._tags[i];if(a){s={id:a.model.get("id"),module:a.model.get("_module"),name:a.model.get("name")};o[s.id]=s;e.value+=this.tagTextTemplate(s);i+=a.text.length}else{e.value+=t[i];++i}}e.tags=_.values(o);return e},save:function p(){var t=this.getPost();var i=e.nomad.utils.stripLastEmptyStrings(t.value);this.model.set("tags",t.tags,{silent:true});this.model.set("value",i);this.model.trigger("save")},onAfterRender:function m(){this.$shadow=this.$el.find(this._shadowSelector);this.$dropdown=this.$el.find(this._dropdownSelector);this.$textarea=this.$el.find(this._textareaSelector);this.textarea=this.$textarea[0];this.$textarea.focus().scroll(_.bind(this.onScroll,this))},onScroll:_.throttle(function g(){var e=this.$textarea.scrollTop();this.$shadow.scrollTop(e)},o),onInput:function v(){_.defer(_.bind(function e(){if(this.disposed)return;var e;var t;if(this.textarea.value!==this._prevValue){this._fixTags();this._refreshShadow();e=this._findSearchTerm();t=e.offset!==-1;if(!t&&this._taggableEnabled){this._closeDropdown();this._resetLastSearch()}this._taggableEnabled=t;this._abortRequests(!this._taggableEnabled);this._taggableEnabled&&this._searchForTags(e);this._prevValue=this.textarea.value}},this))},onSearchResultClick:function b(e){var t=$(e.target).closest("li");var i=t.closest("ul").children("li").index(t);var n=this._lastSearch.results.models[i];n.get("has_access")===false||this._insertSearchResult(n,this._lastSearch.searchTerm)},onDataFetch:function y(e,t){if(this._taggableEnabled&&_.isEqual(this._findSearchTerm(),e)){this._lastSearch.searchTerm=e;this._lastSearch.results=t;this._populateTagList(t,e)}},_isReferenceOrMention:function(e){return e===r||e===l},_refreshShadow:_.throttle(function E(){if(this.disposed)return;var t;var i=this.textarea.value;var n=0;var a=i.length;var o="";var s=e.nomad.utils.charHtmlEntity;while(n<a){t=this._tags[n];if(t){o+=t.html;n+=t.text.length}else{o+=s(i[n]);++n}}this.$shadow.html(o).trigger("scroll")},a),_findSearchTerm:function L(){var e={offset:-1,action:"",term:""};var n="";var a=0;var o=this.textarea.selectionEnd-1;var s=i;var r=this.textarea.value;if(this.textarea.selectionEnd&&this.textarea.selectionStart===this.textarea.selectionEnd){while(o>=0&&s){if(this._isReferenceOrMention(r[o])){if(a>=t){e.offset=o;e.action=r[o];e.term=n}break}else if(r[o]==="\n"){break}else if(r[o]!==" "){++a;--s}n=r[o]+n;--o}}return e},_abortRequests:function w(t){var i=false;if(this._searchForTagsTimerId){window.clearTimeout(this._searchForTagsTimerId);this._searchForTagsTimerId=null}if(this._lastSearch.referenceCollection.getFetchRequest()){this._lastSearch.referenceCollection.abortFetchRequest();i=true}if(this._lastSearch.mentionCollection.getFetchRequest()){this._lastSearch.mentionCollection.abortFetchRequest();i=true}t&&i&&e.alert.dismiss("data_syncing")},_resetLastSearch:function x(){var t={offset:-1,action:"",term:""};if(this._lastSearch){this._lastSearch.searchTerm=t;this._lastSearch.results=[]}else{this._lastSearch={searchTerm:t,results:[],referenceCollection:e.data.createMixedBeanCollection(),mentionCollection:e.data.createBeanCollection("Users")}}},_matchLastSearch:function S(e){var t=this._lastSearch.searchTerm;var i=false;if(t.action===e.action){if(t.action===e.action&&t.offset===e.offset&&(t.term.trim()===e.term.trim()||!e.term.trim().indexOf(t.term.trim())&&!this._lastSearch.results.length)){i=true}}return i},_getUserFilter:function A(e){var t=e.term.trim();var i=null;var n;var a;var o;n=t.match(/([^\s]+)(\s?)(.*)/);if(n){a=n[1].trim();o=n[3].trim();i=[{$and:[{status:{$not_equals:"Inactive"}},{$or:[{first_name:{$starts:t}},{last_name:{$starts:t}}]}]}];if(o){i[0].$and[1].$or.push({$and:[{first_name:{$starts:a}},{last_name:{$starts:o}}]});i[0].$and[1].$or.push({$and:[{first_name:{$starts:o}},{last_name:{$starts:a}}]})}}return i},_searchForTags:function R(t){this._searchForTagsTimerId=window.setTimeout(_.bind(function i(t){this._searchForTagsTimerId=null;if(this.disposed||this._matchLastSearch(t)||!e.nomad.isOnline()){return}var i=_.bind(this.onDataFetch,this,t);if(t.action===r){var a=this._getUserFilter(t);if(a){this._lastSearch.mentionCollection.offlineReadDisabled=e.offlineEnabled;this.listenTo(this._lastSearch.mentionCollection,"sync",i);this._lastSearch.mentionCollection.fetch({limit:n,filter:a,params:{has_access_module:this._taggableModuleName,has_access_record:this._taggableModelId}})}}else if(t.action===l){this._lastSearch.referenceCollection.offlineReadDisabled=e.offlineEnabled;this.listenTo(this._lastSearch.referenceCollection,"sync",i);this._lastSearch.referenceCollection.fetch({limit:n,fields:["name"],module_list:this._taggableModuleList,params:{search_fields:c,q:t.term}})}},this,t),s)},_populateTagList:function(t,i){if(!t.length){this._closeDropdown();return}this.$dropdown.empty();t.each(function(t){var n=e.nomad.utils.escapeRegExp(e.nomad.utils.stringHtmlEntity(i.term));var a=Handlebars.Utils.escapeExpression(t.get("name")).replace(new RegExp("("+n+")","ig"),function(e,t){return"<strong>"+t+"</strong>"});var o={module:t.get("_module"),id:t.get("id"),name:t.get("name"),htmlName:a,noAccess:t.get("has_access")===false};var s=$(this.tagListOptionTemplate(o));this.$dropdown.append(s)},this);if(!this._taggableListOpen){this._taggableListOpen=true;this.$el.addClass("show-dropdown");document.activeElement.blur();this.textarea.focus();this.$dropdown.show()}},_closeDropdown:function C(){if(this._taggableListOpen){this.$el.removeClass("show-dropdown");this.$dropdown.empty().hide();this._taggableListOpen=false}},_insertSearchResult:function T(e,t){var i=this.textarea.value||"";var n=i.slice(t.offset,t.offset+t.term.length+1);var a;var o=e.get("name");var s=this.textarea.selectionStart;var r=this.textarea.selectionEnd;var l;var c;var d;var u;if(n===t.action+t.term){a=i.slice(0,t.offset)+o+i.slice(t.offset+n.length);this.textarea.value=a;this._fixTags();this._prevValue=a;this.textarea.focus();if(this.textarea.setSelectionRange){l=Math.min(s,r);c=Math.max(s,r);if(l>t.offset&&l<t.offset+n.length||c>t.offset&&c<t.offset+n.length||l<=t.offset&&c>=t.offset+n.length){d=t.offset+o.length;u=d}else if(c>=t.offset+n.length){d=s-n.length+o.length;u=r-n.length+o.length}else{d=s;u=r}this.textarea.setSelectionRange(d,u)}this._addTag({model:e,offset:t.offset,text:o});this._refreshShadow()}this._closeDropdown()},_addTag:function I(e){var t={text:e.text,module:e.model.get("_module")};t.class=t.module==="Users"?"mention":"reference";this._tags[e.offset]=e;this._tags[e.offset].html=this.tagShadowTemplate(t)},_fixTags:function k(){var e=this.textarea.value;var t=e.length-this._prevValue.length;var i;var n={};if(t===-1){i=_.find(this._tags,function(t){return t.text.length>1&&e.slice(t.offset,t.offset+t.text.length)!==t.text&&e.slice(t.offset,t.offset+t.text.length-1)===t.text.slice(0,-1)});if(i){e=e.slice(0,i.offset)+e.slice(i.offset+i.text.length-1);this.textarea.value=e;this.textarea.setSelectionRange(i.offset,i.offset);t=-i.text.length}}_.each(this._tags,function(i){if(e.slice(i.offset,i.offset+i.text.length)===i.text){}else if(e.slice(i.offset+t,i.offset+i.text.length+t)===i.text){i.offset+=t}else{return}n[i.offset]=i});this._tags=n}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.SearchBoxView=e.view.NomadView.extend({plugins:["clear-field","android-keyboard-tracker"],className:"view__search-box",touchOutsideEventName:"touchstart.outside",_toggleSearchEventName:"search:toggle",ITEM_TYPE_DELAY:e.config.searchDelay,events:{"textInput .search-query":"onKeyUp","keyup .search-query":"onKeyUp","cut   .search-query":"onCutOrPaste","paste .search-query":"onCutOrPaste","focusin .search-query":"onFocusIn","click .searchCancelBtn":"onCancelSearch"},initialize:function(e){this._super("initialize",[e]);this.timerId=null;this._searchText="";this.$searchBox=null;if($.os.ios){this.$el.find(".search-query").on("textInput",this.onKeyUp,this)}},showSearch:function(){this.$(".view__search").addClass("show-search").animate({opacity:1},200);this.$searchBox.focus();this.trigger(this._toggleSearchEventName,true)},onCancelSearch:function(){this.onSearchClearClick();this.$searchBox.val("");this.hideSearch()},hideSearch:function(){this.$(".view__search").animate({opacity:0},200,function(){$(this).removeClass("show-search")});this.trigger(this._toggleSearchEventName,false)},onAfterRender:function(){this._super("onAfterRender");this.$searchBox=this.$(".search-query");if(!this.$searchBtn){this.$searchBtn=this.$el.closest(".layout__list").find(".searchBtn");this.$searchBtn.on("click.search",_.bind(this.showSearch,this))}},onAfterShow:function(){this.hideProgress()},onKeyUp:function(e){this._clearTimer();var t=this;var i=t.$searchBox.val();this.timerId=window.setTimeout(function(){t.search(i);if(i===""){t.focusSearchBox()}},this.ITEM_TYPE_DELAY)},onCutOrPaste:function(e){var t=this;window.setTimeout(function(){t.onKeyUp(e)},200)},onFocusIn:function(){this._bindTouchOutside()},resetSearch:function(){this._clearTimer()},loadData:function(){},focusSearchBox:function(){this.$searchBox.get(0).focus()},search:function(e){if(this._searchText===e){return}this._searchText=e;this.trigger("search:text");this.showProgress()},getPreparedState:function t(){var e={};if(this._searchText){e.q=this._searchText}return e},showProgress:function(){this.$el.addClass("in-progress")},hideProgress:function(){this.$el.removeClass("in-progress")},getFieldNames:function(){return[]},_clearTimer:function(){if(this.timerId){window.clearTimeout(this.timerId)}},_dispose:function(){this._clearTimer();if(this.$searchBtn){this.$searchBtn.off("click.search")}this._super("_dispose")},onSearchClearClick:function(){var e=this;this.timerId=window.setTimeout(function(){e.search("")},e.ITEM_TYPE_DELAY)},setPlaceholder:function i(t){var i=e.lang.get("LBL_MOBILE_SEARCH_PLACEHOLDER",null,{searchCriteria:t});this.$searchBox.attr("placeholder",i)},_bindTouchOutside:function(){var e=this;

var t=this.$searchBox.get(0);$(document).bind(this.touchOutsideEventName,function(i){if(i.target!==t){document.activeElement.blur();e._unbindTouchOutside()}})},_unbindTouchOutside:function(){$(document).unbind(this.touchOutsideEventName)},onDetach:function n(){if(this.$searchBtn){this.$searchBtn.off("click.search");this.$searchBtn=null}}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.ErrorView=e.view.NomadView.extend({className:"list-layout",events:{"click #sugar_url":function(t){t.preventDefault();e.nomad.openUrl(t.target.href)}},errors:{403:"ERR_MOBILE_NOT_AUTHORIZED"},defaultErrorLabel:"ERR_GENERIC_TITLE",onBeforeRender:function(){if(this.context.get("backToSugar")){this.showSugarBackLink=true;this.sugarLink=e.nomad.getDesktopUrl()+"#"+this.context.get("sugarRoute")}this.errorCode=this.context.get("code");this.errorLabel=this.errors[this.errorCode]||this.defaultErrorLabel},getHeaderData:function(){return{title:e.lang.get("ERR_GENERIC_TITLE"),menuButton:true}}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.CardsView=e.view.NomadView.extend({activeIndex:0,switcherType:"tabs",lazyInit:true,lazyLoad:true,loadCardOnActivate:false,activeTabStorageKey:"",_cards:null,_currentCard:null,_deferLoadArgs:null,constructor:function(t){var i=t.meta?t.meta.className:t.className;if(i!==undefined){this.className=i}e.view.NomadView.apply(this,arguments)},plugins:["fast-click-highlight"],initialize:function(e){var t=e.meta||e;this._super("initialize",arguments);_.each(["cards","activeIndex","switcherType","lazyInit","lazyLoad","loadCardOnActivate","activeTabStorageKey"],function(e){if(t[e]!==undefined){this[e]=t[e]}},this);if(!this.lazyLoad&&this.lazyInit){this.lazyInit=false}if(this.activeTabStorageKey){this._restoreState()}this._initSwitcher();this._initCards()},loadData:function(e){if(!this._rendered){this._deferLoadArgs=arguments;return}this._eachCardView(function(e){e._dataObsolete=true});if(this._currentCard){this._loadCardData(this._currentCard,e)}else if(_.isNumber(this.activeIndex)){this.switchCard({index:this.activeIndex,loadParams:e})}if(!this.lazyLoad){this._eachCardView(function(t){if(t!==this._currentCard){this._loadCardData(t,e)}})}this._super("loadData",this._deferLoadArgs||arguments);this._deferLoadArgs=null},onAfterRender:function(){this._super("onAfterRender",arguments);this.$tabsContainer=this.$el.find(".tabs__container").first();if(!this.lazyInit){_.each(this._cards,this._renderCard,this)}if(this._deferLoadArgs){this.loadData()}},_initSwitcher:function(){var e=this.cards;if(e.length<=1){return}if(this.switcherType==="tabs"){this._createTabSwitcher()}else if(this.switcherType==="dropdown"){this._createDropDownSwitcher()}},_createTabSwitcher:function(){var e=_.map(this.cards,function(e,t){return{title:e.title,index:t}});this.tabSwitcher={items:e};this.events=_.extend({"click .tab":"_onTabClick"},this.events)},_createDropDownSwitcher:function(){var t={};var i=new e.Bean({tab_index:this.activeIndex+""});i.on("change:tab_index",this._onDropdownClick,this);_.each(this.cards,function(e,i){t[i]=e.title});this.ddSwitcher={name:"tab_index",view:"edit",type:"enum",options:t,model:i,optional:false,dependencies:[]}},_onTabClick:function(e){var t=$(e.target).closest(".tab").data("tab-index");this.switchCard({index:t})},_onDropdownClick:function(e,t){this.switchCard({index:t})},_initCards:function(){this._cards=_.map(this.cards,function(e){return e});if(!this.lazyInit){_.each(this._cards,this._createCard,this)}},switchCard:function(t){var i=t.index;var n=this._currentCard;var a=this._cards[i]||this._cards[0];if(!a){return}this._syncSwitcher(i);if(!(a instanceof e.view.NomadView)){a=this._createCard(i);this._renderCard(a)}if(n){this._getCardEl(n).addClass("hide-tab");n.unbindGlobalEvents();if(n.abortActiveRequests()){n._dataObsolete=true}}this._currentCard=a;this.activeIndex=i;this._getCardEl(a).removeClass("hide-tab");a.bindGlobalEvents();if(a._dataObsolete||this.loadCardOnActivate){this._loadCardData(a,t.loadParams)}if(this.activeTabStorageKey){this._storeState()}this.trigger("cards:switch",a,i)},abortActiveRequests:function(){var e=false;this._eachCardView(function(t){e=t.abortActiveRequests()||e});return e},bindGlobalEvents:function(){this._super("bindGlobalEvents",arguments);if(this._currentCard){this._currentCard.bindGlobalEvents()}},unbindGlobalEvents:function(){this._super("unbindGlobalEvents",arguments);if(this._currentCard){this._currentCard.unbindGlobalEvents()}},getCards:function(){var e=[];this._eachCardView(function(t){e.push(t)});return e},getCardIndexByView:function(e){return _.indexOf(this._cards,e)},updateSwitcherSubtitle:function(e,t){if(this.tabSwitcher){this._updateTabSwitcherSubtext(e,t)}},_updateTabSwitcherSubtext:function(e,t){var i=this._cards[e].options;var n=i.subtitleCssClass||"count";this.$(".tab").eq(e).find(".subtitle").removeClass("hide").addClass(n).text(t)},_syncSwitcher:function(e){if(this.tabSwitcher){this._syncTabsSwitcher(e)}else if(this.ddSwitcher){this._syncDropDownSwitcher(e)}},_syncTabsSwitcher:function(e){var t=this.$(".tab");t.removeClass("active-tab");$(t[e]).addClass("active-tab")},_syncDropDownSwitcher:function(e){this.getField("tab_index").model.set({tab_index:e+""})},_createCard:function(t){var i=_.isObject(t);var n=i?t:this._cards[t];var a=i?_.indexOf(this._cards,t):t;var o={name:n.view,module:this.module,layout:this.layout,context:this.context};var s=e.view.createView(_.extend(o,n));s._dataObsolete=true;this._cards[a]=s;this.trigger("cards:create",s,a);return s},_renderCard:function(e){var t;e.render();t=this._getCardEl(e);t.addClass("hide-tab");this.$tabsContainer.append(t);return e},_loadCardData:function(e,t){var i=e.options;if(i.loadDataFn){if(i.getLoadParams){t=i.getLoadParams.call(e)}i.loadDataFn.call(e,t)}e._dataObsolete=false},_eachCardView:function(t,i){_.each(this._cards,function(n){if(n instanceof e.view.NomadView){t.call(i||this,n)}},this)},_dispose:function(){this._super("_dispose",arguments);this._eachCardView(function(e){e.dispose()});this._cards=this._currentCard=this.$tabsContainer=null},_storeState:function(){return e.nomad.setLastState(this.activeTabStorageKey,this.activeIndex)},_restoreState:function(){var t=e.nomad.getLastState(this.activeTabStorageKey);if(t!==undefined){this.activeIndex=+t}},_getCardEl:function(e){return e.options.getViewContainer?e.options.getViewContainer.call(e):e.$el}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.RelatedRecordsView=e.view.NomadView.extend({className:"scroll",initialize:function(t){var i;this._super("initialize",arguments);this._requestsInProgress={};i=e.nomad.getContextMeta("detail",this.module);this.relatedList=_.chain(i.subpanels).filter(function(t){return e.acl.hasAccess("list",t.module)}).map(function(t){return _.extend({canCreate:e.nomad.canCreateRelated(t.module,this.module,"create",t.context.link)},t)},this).value()},loadData:function(){if(e.supportedFeatures.bulkApi&&e.nomad.isOnline()){this.getRelationshipData(function(e,t){if(!e){this._prepareListData(t);this.render()}})}},getRelationshipData:function(t,i){var n=this;var a;var o;var s;i=i||this;a=_.map(this.relatedList,function(t){return e.nomad.buildBulkRequest({module:this.module,attributes:{id:this.model.id,link:t.context.link},params:{max_num:e.config.fetchLimit.bulkQueryRelatedRecords,fields:"id"}})},this);if(_.isEmpty(a)){return}o={success:function(e){t.call(i,null,e)},error:function(a){e.logger.debug("Get related records error "+n.module+" : "+a);t.call(i,a)},complete:function(){if(s){n._requestsInProgress[s.uid]=null}}};s=e.api.bulk({requests:a},o);if(s){this._requestsInProgress[s.uid]=s.uid}},_prepareListData:function(t){this.relatedList=_.map(this.relatedList,function(i,n){var a=t[n];i.recordsCount=undefined;if(a.status===200){var o=a.contents;if(_.isArray(o.records)){var s=o.records.length;var r=e.config.fetchLimit.bulkQueryRelatedRecords;i.recordsCount=s;if(o.next_offset!==-1){i.recordsCount=r+"+"}i.isEmpty=!s}}else{i.recordsCount="!";if(e.error.isAccessError(a)){e.events.trigger("app:access:error",_.extend(a,{module:i.module}))}}i.showCount=!_.isUndefined(i.recordsCount);return i})},_dispose:function(){_.each(this._requestsInProgress,function(t,i){e.api.abortRequest(i)});this._super("_dispose",arguments)}})})(SUGAR.App)},function(e,t){(function(e){var t={"list~Step1":{updatedVersion:2.7,content:[{selector:".logo",text:"LBL_MOBILE_TUTORIAL_HOME_MENU"},{selector:".createBtn",text:"LBL_MOBILE_TUTORIAL_HOME_PLUS"}]},list:{updatedVersion:2.7,content:[{show:"native",selector:".list-item.has-menu:nth-child(1)",text:"LBL_MOBILE_TUTORIAL_HOME_SWIPE",fromRight:true,vertAdj:5,horizAdj:-50,customMarker:"tutorial-swipe"}]},"detail~TxLog~Dashboards":{updatedVersion:2.7,content:[{selector:".bizcard .icon-chevron-right",text:"LBL_MOBILE_TUTORIAL_DETAIL_EDIT_ACTION",vertAdj:2,horizAdj:-2}]}};e.tutorial=e.tutorial||{};e.tutorial.config=t})(SUGAR.App)},function(e,t){(function(e){var t=20;var i=2;var n=_.extend({instance:null,show:function(t,i){if(e.config.skipTutorial){return}else if(e.tutorial.data){this.doTutorial(t,i)}else{e.tutorial.data=this.prepareData(e.tutorial.config);this.doTutorial(t,i)}},prepareData:function(t){var i={};_.each(t,function(t,n){var a=_.filter(t.content,function(t){var i;if(t.show){i=t.show==="native"&&e.isNative||t.show==="web"&&!e.isNative}else{i=true}return i});if(a.length){i[n]=t;i[n].content=a}});return i},doTutorial:function(t,i){var n=this.getStepName(t,i);var a=e.tutorial.data[n];var o=this.getPrefs();if(a&&!e.tutorial.instance){this.createInstance(a,n,o)}},getStepName:function(t,i){var n=this.getPrefs();var a=new RegExp("^"+t+"([~:].*)?$","i");var o=_.chain(e.tutorial.data).keys().select(function(e){return a.test(e)}).value().sort(function(e,t){return e.indexOf(":")>-1?1:e.indexOf("~")>-1&&t.indexOf(":")<0?1:-1});var s=this;var r;_.each(o,function(e){if(e.indexOf(":")>-1&&_.contains(e.split(":"),i)&&s.isNewStep(e)){r=e}else if(e.indexOf("~")>-1&&!_.contains(e.split("~"),i)&&s.isNewStep(e)){r=e}else if(e===t&&s.isNewStep(e)){r=e}});return r},isNewStep:function(t){var i=e.tutorial.getPrefs();var n=e.tutorial.data[t];var a=n?n.updatedVersion||0:0;var o=i.viewed[t]||0;return!i.viewed[t]||e.utils.versionCompare(o,a,"<")},createInstance:function(e,t,i){var n=this;var o=_.any(e.content,function(e){return n.getItem(e.selector).length});if(!o){return}this.instance=new a(_.extend(e,{tutorialName:t}));this.instance.show()},getPrefs:function(){var t=e.nomad.getSetting("tutorialPrefs")||{};t.viewed=t.viewed||{};return t},resetPrefs:function(t){t=t||{};t.viewed={};e.nomad.setSetting("tutorialPrefs",t)},hasStepToShow:function(t,i){if(e.config.skipTutorial){return}else if(!e.tutorial.data){return true}else{return!!this.getStepName(t,i)}},getItem:function(t){var i=e.controller.layoutManager.getRootLayout();var n=e.controller.layoutManager.getRecordLayout();var a;if(n){a=n.$el.find(t)}else{a=i.$el.find(t)}if(!e.nomad.utils.isElVisible(a)){a=[]}return a}});var a=Backbone.View.extend({events:{click:"onClose",swipe:"onClose"},TUTORIAL:"tutorial",initialize:function(t){this.content=t.content;this.tutorialName=t.tutorialName;this.tplContext={brandName:e.config.brandName};e.events.on("app:orientation:changed",this._onOrientationChange,this)},_onOrientationChange:function(){var e=this;this.removeHighlight();_.each(this.content,function(t){e.highlightItem(t)})},onClose:function(e){var t=this;if(e&&!_.isString(e)){e.preventDefault();e.stopPropagation()}this.setStepViewed();$(this.$el).animate({opacity:0},300,"ease",function(){t.remove()})},show:function(){var t=this;this.render();_.each(t.content,function(e){t.highlightItem(e)});$(this.$el).css({opacity:"1"});e.events.trigger("tutorial:show",true,this)},setStepViewed:function(){var t=e.tutorial.getPrefs();t.viewed[this.tutorialName]=e.config.nomadVersion;e.nomad.setSetting("tutorialPrefs",t)},highlightItem:function(t){var i=e.tutorial.getItem(t.selector);var n=this;if(_.isEmpty(i)){return}var a=document.createElementNS("http://www.w3.org/2000/svg","use");a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.customMarker?"#"+t.customMarker:"#marker");this.$marker=$(a);this.$svg.append(a);var o=t.horizAdj||0;var s=i.offset().left;var r=i.offset().top+(t.vertAdj||0);var l=i.offset().width;var c=this.$marker.width();var d;if(e.nomad.utils.isDirectionLTR()){d=s+o+(t.fromRight?l-c:0);s=d}else{d=-(s-o+(t.fromRight?c:l));s=-d-c;a.setAttributeNS(null,"transform","scale(-1, 1)")}a.setAttributeNS(null,"x",d);a.setAttributeNS(null,"y",r);this.appendItemGlow(t,s,r);this.showHighlightText(t,s,r)},appendItemMarker:function(e,t,i){var n=document.createElementNS("http://www.w3.org/2000/svg","use");n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.customMarker?"#"+e.customMarker:"#marker");this.$marker=$(n);this.$svg.append(n)},appendItemGlow:function(n,a,o){var s=e.nomad.utils.isDirectionLTR()?i:-i;if(n.customMarker){return}this.glow=document.createElementNS("http://www.w3.org/2000/svg","circle");this.glow.setAttributeNS(null,"cx",a+t+s);this.glow.setAttributeNS(null,"cy",o+t+i);this.glow.setAttributeNS(null,"r",t);this.glow.setAttributeNS(null,"fill","black");this.glow.setAttributeNS(null,"class","marker-glow");this.$glowWrap.append(this.glow)},showHighlightText:function(i,n,a){var o=e.lang.get(i.text,null,this.tplContext);var s=$('<div class="text">'+o+"</div>").appendTo(this.$textWrap);var r=this.$marker;var l=n;var c=a;var d=r.width();var u=r.height();var f=s.width();var h=s.height();var p=$(window).width();var m=$(window).height();if(l-f>0){s.css("left",n-f+d);s.css("text-align","right")}else if(l+d+f<p){s.css("left",l);s.css("text-align","left")}else{s.css("left","50%");s.css("marginLeft",-f/2);s.css("text-align","center")}if(c+u+h<m){s.css("top",c+u)}else{s.css("top",c-h-t*1.5)}},render:function(){var t=e.template.get("tutorial");$("body").append(t());this.$el=$("#tutorial__view");this.$svg=this.$el.find("#tutorial");this.$glowWrap=this.$el.find("#marker-glow");this.$textWrap=this.$el.find("#tutorial-content");this.delegateEvents();this.$el.show();return this},remove:function(){delete this.$marker;delete this.$svg;delete this.$textWrap;Backbone.View.prototype.remove.call(this);e.events.trigger("tutorial:show",false,this);e.events.off("app:orientation:changed",this._onOrientationChange,this);e.tutorial.instance=null},removeHighlight:function(){this.$textWrap.empty();this.$glowWrap.find(".marker-glow").remove();this.$svg.find("use").remove()}});e.tutorial=e.tutorial||{};e.tutorial=_.extend(e.tutorial,n)})(SUGAR.App)},function(e,t){(function(e){e.view.views.ListView=e.view.views.SyncableView.extend({events:{"click article .grip":"onClickGrip","click .list-item":"onClickItem"},plugins:["fast-click-highlight","pagination","ptr","current-record","context-menu","item-actions"],listItemDataProvider:"list-item",listItemTpl:"list-item",multiselect:false,_offlineDisabled:false,_currentState:null,globalEvents:{"offline:data:updated":"_offlineRefetch"},_offlineRefetch:function(t,i){var n=this.getCurrentState();var a={};_.extend(a,n,{skipServerSync:true,serverNextOffset:t.serverNextOffset});if(this.collection.query){return}if(this.isCurrentListUpdated(t)){i=_.extend({add:true,params:a,offset:t.requestParams&&t.requestParams.offset?t.requestParams.offset:0,limit:t.requestParams&&t.requestParams.max_num?t.requestParams.max_num:e.config.maxQueryResult},i);this.collection.fetch(i)}},initialize:function(t){this._super("initialize",arguments);this._currentState={};this.listViewId=t.listViewId||"listing-"+this.module;this.activeListItem=null;this.relationshipFields=null;this.unlinkVisible=false;this.disableListItemClick=false;var i=this.context.get("link");if(i){var n=this.context.get("parentModule");var a=e.metadata.getModule(n,"fields")[i];this.relationship=e.metadata.getRelationship(a.relationship);this.relateFields=e.data.getRelateFields(n,i);this.unlinkVisible=e.nomad.canUnlinkRelated(n,i)&&_.reduce(this.relateFields,function(e,t){return e&&!t.required},true);this.initRelationshipFields(n,i)}this.modContextData=e.nomad.getContextMeta("list");this.listenTo(this.collection,"data:sync:start",function(e,t){this.onDataSyncStart(e,this.collection,t)});this.listenTo(this.collection,"sync",this.onDataSyncSuccess);this.listenTo(this.collection,"data:sync:error",this.onDataSyncError);if(this.layout){var o=this.layout.getComponent("header");if(o){this.listenTo(o,"app:header:cancel",this.onHeaderCancel)}}this.initLabels();this._initNoRecFoundLabelBehavior();this._createItemsConfig(t)},_createItemsConfig:function(e){if(e.itemsConfig){this.itemsConfig=_.extend(this.itemsConfig||{},e.itemsConfig)}this.setListItemDataProvider(e.listItemDataProvider);this.setListItemTpl(e.listItemTpl||(e.meta?e.meta.listItemTpl:null))},setListItemTpl:function(e){if(e){this.listItemTpl=e}},getListItemTpl:function(){return this.listItemTpl},setListItemDataProvider:function(e){if(e){this.listItemDataProvider=e}},getListItemDataProvider:function(){return this.listItemDataProvider},initLabels:function(){this.labelLoading=e.lang.get("LBL_LOADING");this.labelNoRecords=e.lang.get("LBL_MOBILE_NO_RECORDS");this.labelShowMoreTop=e.lang.get("LBL_MOBILE_SHOW_MORE_TOP");this.labelShowMoreBottom=e.lang.get("LBL_MOBILE_SHOW_MORE")},isActionAvailable:function(t,i){var n=e.acl.hasAccessToModel(t.access||t.name,i);var a=n&&(t.isEnabled&&t.isEnabled.call(this,i));return a},onBeforeRender:function(){},getViewContainer:function(){return this.$easyScrollerParent},setCurrentState:function(e){this._currentState=e},getCurrentState:function(){if(this._currentState.q){this._currentState.filter=null;this._currentState.order_by=null}return this._currentState},_applyCurrentStateParams:function(e){e=e||{};e.params=e.params||{};_.extend(e.params,this.getCurrentState());return e},refresh:function(e){e=this._applyCurrentStateParams(e);if(e.paginate){this.collection.setOption({update:true,remove:false});delete e.paginate;this.collection.paginate(e)}else{this.collection.setOption({update:false,remove:true});if(_.isUndefined(e.relate)){e.relate=!!this.context.get("link")}this.collection.fetch(e)}},ptrRefresh:function(){var t=this;var i={complete:function(){t.trigger("ptr:data:load:complete")}};e.analytics.trackEvent("app","ptr");if(e.offlineEnabled&&!this.collection.query){i.params={forceServerSync:true}}this.refresh(i)},getHeaderData:function(){var t=this.modulePlural;var i=false;if(this.context.get("link")){t=e.lang.get("LBL_RELATED_MODULE_PLURAL",this.module,this.modulePlural);i=true}return{title:t,menuButton:true,back:i,plus:true}},onItemAdded:function(t,i,n){this.$el.find(".no-records-found").hide();var a=e.view.getFieldId();var o=Handlebars.helpers.listItems([t],this,{hash:{}});if(n.addTop){this.$(".items").prepend(o.toString())}else{this.$(".items").append(o.toString())}for(var s=a+1;s<=e.view.getFieldId();++s){this._renderField(this.fields[s])}},onItemRemoved:function(e){this.getListItemEl(e).remove()},bindDataChange:function(){if(this.collection){this.collection.on("reset",this.render,this);this.collection.on("add",this.onItemAdded,this);this.collection.on("remove",this.onItemRemoved,this)}},getMaxPageSize:function(){return Math.max(e.config.fetchLimit.maxPageSize||20,e.config.maxQueryResult)},onDataSyncStart:function(e,t,i){},onDataSyncSuccess:function(e,t,i){this.onDataSyncComplete(i.method,i,null,e)},onDataSyncError:function(e,t,i){this.onDataSyncComplete(e,t,i)},onDataSyncComplete:function(t,i,n){if(this.activeListItem){this.hideContextMenu()}if(t==="update"){return}if(n&&n.status===403){var a=e.template.get("list-not-authorized");this.$el.html(a(n))}},onClickGrip:function(e){e.preventDefault();e.stopPropagation()},onClickItem:function(e){var t;var i;var n;var a;if(this.disableListItemClick){this.disableListItemClick=false;return false}this.trigger("list:item:clicked");a=$(e.currentTarget).closest("article");if(this.activeListItem&&this.activeListItem[0]!==a[0]&&this.activeListItem.find(".menu-container").hasClass("on")){this.hideContextMenu(null,true);e.preventDefault()}if(!e.defaultPrevented&&!e.cancelBubble&&!$(e.currentTarget).hasClass("active-list-item")){t=$(e.target).closest("article");i=t.attr("module")||this.module;n=this.getModel($(e.currentTarget).attr("data-id"),i);this.onClickItemNavigate(e,n);this.activeListItem=null}},onClickItemNavigate:function(t,i){var n;if(i&&e.acl.hasAccessToModel("view",i)){n=this._buildRecordRoute({model:i,hash:{link:this.context.get("link"),appendRoot:true}});n&&e.controller.navigate("#"+n)}},getModel:function(e){return this.collection.get(e)},loadData:function(e){this.collection.dataFetched=false;this._super("loadData",arguments)},bindViewSyncListener:function(){this.listenTo(this.collection,"sync",this.publishCollectionSyncData)},unbindViewSyncListener:function(){this.stopListening(this.collection,"sync",this.publishCollectionSyncData)},publishCollectionSyncData:function(e,t,i){this.publishSyncData(e.toJSON(),null,i)},getAllSyncableCollections:function(){return[this.collection]},receiveSyncData:function(e,t,i){if(e&&e.id){_.each(this.getAllSyncableCollections(),function(n){this.processCollection(n,e,t,i)},this)}},processCollection:function(t,i,n,a){var o=t.get(i.id);if(o){if(n&&n.status===404||!n&&a.method==="delete"){t.remove(o)}else if(!n&&!e.nomad.utils.isModelSynchronized(o,i)){o.set(i);if(!e.acl.hasAccessToModel("list",o)){t.remove(o)}}}},_dispose:function(){var t=this.getViewContainer();this.activeListItem=null;this.disableListItemClick=false;this.stopListening(this.collection,"data:sync:start");this.stopListening(this.collection,"sync");this.stopListening(this.collection,"data:sync:error");this.stopListening(e.events,"offline:server:read");if(this.layout){var i=this.layout.getComponent("header");if(i){this.stopListening(i,"app:header:cancel",this.onHeaderCancel)}}if(t){t.remove()}this._super("_dispose",arguments)},isCurrentListUpdated:function(t){var i=this.context.get("parentModule");var n=this.context.get("link");if(!(this.collection instanceof e.BeanCollection)){return false}return this.collection.cid===t.cid},setOfflineEnabled:function(e){this.collection.offlineReadDisabled=!e},_initNoRecFoundLabelBehavior:function(){if(e.offlineEnabled){this.listenTo(e.events,"offline:server:read",function(t){var i=this.$(".no-records-found");var n=e.offline.api.SERVER_READ_STATUS;var a;a=_.bind(function o(){i.toggle(!this.collection.length)},this);if(!this.isCurrentListUpdated(t.apiOptions)){return}switch(t.status){case n.start:i.hide();break;case n.finish:if(t.dataUpdated){this.collection.once("sync",function s(){a()},this)}else{a()}break;case n.error:a();break}},this)}else{this.listenTo(this.collection,"data:sync:start",function(){this.$(".no-records-found").hide()});this.listenTo(this.collection,"sync",function(e,t,i){if(i.method!=="update"&&this.collection.length===0){this.$(".no-records-found").show()}})}},setSortByField:function(){var t=this.getCurrentState();var i=t.order_by?t.order_by.split(":")[0]:null;this.sortBy=null;if(i&&i!=="name"&&i!=="date_modified"){var n=this.modContextData[this.module].additionalListFields;if(_.isEmpty(_.findWhere(n,{name:i}))){var a=e.metadata.getModule(this.module).fields[i];this.sortBy={name:i,type:a.type,label:a.vname}}}},abortActiveRequests:function(){var e=this.collection;var t=false;if(e.getFetchRequest()){this.context.resetLoadFlag();e.abortFetchRequest();t=true}return t},_buildRecordRoute:function(e){return Handlebars.helpers.buildRoute(e.model,{hash:e.hash})},getListItemEl:function(t){var i;var n;if(!_.isObject(t)){t=this.collection.get(t)}if(t){i=e.utils.listItemDataProviders[this.listItemDataProvider].buildId(t);n=e.utils.formatString('article[data-id="{0}"]',[i])}return $(this.$(n))}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.MobileSearchListView=e.view.views.ListView.extend({initialize:function(t){this.itemsConfig={showModule:true};this._super("initialize",arguments);this.modContextData=e.nomad.getContextMeta("list");this.template=e.template.get("list");this.listViewId="listing-home"},loadData:function t(){}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.ListSelectorView=e.view.views.ListView.extend({globalEvents:{"app:header:save":"submitSelection","offline:data:updated":function(e){this._offlineRefetch(e,{relate:false})}},disabledPlugins:["fast-click-highlight"],listItemDataProvider:"list-item-associate",multiselect:true,clearOnSubmit:true,allowEmptySelection:false,contextMenuDisabled:true,_selections:null,_headerData:null,initialize:function(t){var i=t.meta||{};if(i.multiselect!==undefined){this.multiselect=i.multiselect}if(i.listItemTpl){this.listItemTpl=i.listItemTpl}if(i.listItemDataProvider){this.listItemDataProvider=i.listItemDataProvider}this._super("initialize",arguments);this.template=e.template.get(i.template||"list");this.meta=e.metadata.getView(this.module,"list");this.fallbackFieldTemplate="list";this._setHeaderData(t.headerData||i.headerData);this.setSelectedIds(t.selections)},onAfterRender:function(){this._super("onAfterRender",arguments);this._syncSelectionUI()},setSelectedIds:function(e,t){this._selections=(t?_.union(this.getSelectedIds(),e):e)||[];this._syncSelectionUI()},getSelectedIds:function(){return this._selections},getSelectedModels:function(){var e=this.getSelectedIds();var t=[];_.each(e,function(e){var i=this.collection.get(e);if(i){t.push(i)}},this);return t},toggleItemSelected:function(e,t){var i=this.getSelectedIds();var n=_.indexOf(i,e);var a=n!==-1;if(t===undefined){t=!a}if(t&&!a){if(!this.multiselect&&i[0]!==e){i.pop()}i.push(e)}else if(!t&&a){i.splice(n,1)}this._syncSelectionUI()},getHeaderData:function(){return this._headerData},onClickItem:function(e){if(e.defaultPrevented||e.cancelBubble){return}var t=$(e.currentTarget).closest("article");var i=t.attr("data-id");this.toggleItemSelected(i);if(!this.multiselect){this.submitSelection()}else{this.trigger("selection:change")}},validateSelection:function(){var t=true;if(_.isEmpty(this.getSelectedIds())&&!this.allowEmptySelection){e.nomad.showAlert(e.lang.get("ERR_NO_RECORDS_SELECTED"),function(){});t=false}return t},submitSelection:function(){if(!this.validateSelection()){return}var e=this.getSelectedModels();if(this.clearOnSubmit){this.clearSelection()}this.trigger("selection:submit",this.multiselect?e:e[0])},clearSelection:function(){this._selections=[];this._syncSelectionUI()},_setHeaderData:function(e){var t={save:true,cancel:true,plus:false,saveLabel:"LBL_DONE_BUTTON_LABEL"};this._headerData=_.extend(t,this._headerData,e)},_syncSelectionUI:function(){if(!this.multiselect){return}var e=[];this.$(".selected-item").removeClass("selected-item");_.each(this.getSelectedModels(),function(t){var i=this.getListItemEl(t);i.addClass("selected-item");e.push(t.id||t.cid)},this);this._selections=e},onDetach:function t(){this._super("onDetach");this.clearSelection()}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.ListAssociateView=e.view.views.ListSelectorView.extend({initialize:function(t){this._headerData={save:true};this._super("initialize",arguments);if(!this._headerData.title){this._headerData.title=e.lang.get("LBL_ASSOC",this.module,this.moduleSingular)}this.parentModule=this.context.get("parentModule");this.parentModelId=this.context.get("parentModelId");this.link=this.context.get("link");this.parentModel=this.context.get("parentModel")||e.data.createBean(this.parentModule,{id:this.parentModelId});this.multiselect=e.data.canHaveMany(this.parentModule,this.link);this.initRelationshipFields(this.parentModule,this.link);e.logger.debug("Record(s) are to be associated with "+this.parentModel+" via link "+this.link);e.logger.debug("Multiselect: "+this.multiselect)},onBeforeRender:function(){var e=this.collection.get(this.parentModelId);if(e){this.collection.remove(e,{silent:true})}this._super("onBeforeRender",arguments)},refresh:function(e){e=e||{};e.relate=false;this._super("refresh",arguments)},loadData:function(){this.collection.fetch({relate:false})},submitSelection:function(){if(!this.validateSelection()){return}var t=this;var i;e.syncAlertManager.pause("update",this.model);var n=async.queue(function(a,o){a.relateBean.save(null,{relate:true,fields:["id"],success:function(){o()},error:function(e){i=e;o(e)}});n.drain=function(){e.syncAlertManager.resume("update",t.model,i);if(i){return}t._super("submitSelection",arguments);e.trigger("associate:view:save",{model:{module:t.module},parentModel:{id:t.parentModel.get("id"),module:t.parentModule},isCreate:true})}},1);_.each(this.getSelectedIds(),function(i){n.push({relateBean:e.data.createRelatedBean(t.parentModel,i,t.link)})})}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.ListPickerView=e.view.views.ListSelectorView.extend({plugins:["fast-click-highlight"],listItemDataProvider:"list-item-picker",listItemTpl:"list-item-picker",multiselect:false,initialize:function(t){this._headerData={title:e.lang.get("LBL_CHOOSE_LINK"),save:false};this._super("initialize",arguments);_.extend(this.events,{"click .picker-list-row":"onClickItem"});this.template=e.template.get("list-picker");this.options.templateOptions={}},setData:function(e){this.collection.reset(e.items)}})})(SUGAR.App)},function(e,t){(function(e){var t=e.view.NomadView;e.view.views.MobileCommentsListView=t.extend({events:{"click .comments-more-btn":"_showMoreComments"},plugins:["refresh-timeago","create-post"],globalEvents:{"offline:data:updated":function(e){if(this.isCurrentCommentsUpdated(e)){this.collection.fetch({add:true,params:{skipServerSync:true,serverNextOffset:e.serverNextOffset}})}}},_moreCommentsCount:0,initialize:function(i){t.prototype.initialize.call(this,i);var n=this.options.parentModel;var a=[];if(n.get("last_comment").id){a.push(n.get("last_comment"))}this.collection=e.data.createRelatedCollection(n,"comments",a);this.listenTo(this.collection,"sync",this.onDataSyncSuccess);this.listenTo(this.collection,"data:sync:error",this.onDataSyncError);this._updateMoreCommentsCount(this.collection.length);this.template=e.template.get("list-item-comment")},_updateMoreCommentsCount:function(e){this._moreCommentsCount=this.options.parentModel.get("comment_count")-e;if(this._moreCommentsCount<0){this._moreCommentsCount=0}},_showMoreComments:function(e){e.preventDefault();this.collection.paginate({relate:true,add:true})},onDataSyncSuccess:function(){this._updateMoreCommentsCount(this.collection.length);this.render()},onCreateCommentItem:function(t,i){var n=e.data.createRelatedBean(i,e.data.createBean("Comments"),"comments",{parent_id:i.get("id")});var a=this;this.createPost(n,{appendTo:"root",savePost:function(e){n.save(null,{relate:true,fields:["parent_id","data"],params:{skipOfflineRead:true},success:function(t){a.collection.unshift(t);a.render();e(null,t)},error:e})}})},isCurrentCommentsUpdated:function(e){return e.relationsData&&e.relationsData.relatedModule==="Comments"&&this.options.parentModel.id===e.relationsData.id},onDataSyncError:function(e){}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.MobileReadonlyListView=e.view.views.MobileTeamsListView=e.view.views.ListView.extend({basicMenuActions:[],events:{},fallbackFieldTemplate:"list",contextMenuDisabled:true,initialize:function(t){t.meta=e.metadata.getView(t.module,"list");this._super("initialize",arguments);this.template=e.template.get("list");this.modContextData=e.nomad.getContextMeta("list")},getHeaderData:function(){var e=this._super("getHeaderData",arguments);e.plus=e.save=false;return e}})})(SUGAR.App)},function(e,t){(function(e){var t=e.utils.listItemDataProviders={};var i=t["list-item"]={prepareItemData:function(t,i){var n=this.prepareFields(t,i);var a=i.itemsConfig;var o=!!i.collection.query;var s=(e.acl.hasAccessToModel("view",t)?"has-access":"")+" "+(o?"search":"");var r={model:t,view:i,showMenu:!i.contextMenuDisabled,showMenuGrip:!i.isListItemSwippable&&!i.contextMenuDisabled,moduleName:t.module,itemId:this.buildId(t),hasSearch:o,detailsCss:s,showMyFavorite:true,showModule:false};return _.extend(r,n,a)},buildId:function(e){
return e.id},prepareFields:function(e,t){var i=e.module;var n=t.modContextData[i]||{};var a=n.additionalListFields;var o=t.relationshipFields?t.relationshipFields[0]:null;if(t.collection.query){var s=e.searchInfo&&e.searchInfo.highlighted;if(s){a=_.filter(a,function(e){return!s[e.name]})}}return{titleField:n.listItemTitleField,relationshipField:o,additionalFields:_.isEmpty(a)?null:a,showLabel:t.config.displayListFieldLabel}}};t["list-item-associate"]=_.extend({},i,{prepareFields:function(){var e=i.prepareFields.apply(this,arguments);if(e.additionalFields){e.additionalFields=[e.additionalFields[0]]}return e}});t["list-item-picker"]=_.extend({},i,{prepareItemData:function(e,t){return{view:t,model:e,label:e.get("label"),value:e.get("value"),module:e.get("module"),itemId:this.buildId(e)}},buildId:function(e){return e.cid}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.MobileRecentsListView=e.view.views.ListView.extend({onBeforeRender:function(){this.collection.each(function(t){var i=t.attributes._module;t.module=i;t.fields=e.metadata.getModule(i,"fields")});this._super("onBeforeRender",arguments)},initialize:function(){this.itemsConfig={showModule:true};this._super("initialize",arguments)},loadData:function t(){}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.MobileTxLogListView=e.view.views.ListView.extend({basicMenuActions:[{name:"delete",label:"LBL_ROLLBACK_BUTTON",icon:"icon-trash-o",action:"onRollbackClick",isEnabled:function(){return true}}],globalEvents:{"offline:tx:delete":"onTxDeleted"},listItemTpl:"list-item-tx-log",onAfterRender:function(){e.view.views.ListView.prototype.onAfterRender.apply(this,arguments);this.toggleNoRecLbl()},getHeaderData:function(){return{title:e.lang.get("LBL_TX_LOG"),menuButton:true,back:true}},onRollbackClick:function(t,i){if(e.offline.syncManager.isSyncing()){e.nomad.showAlert(e.lang.get("LBL_OFFLINE_SYNC_IN_PROGRESS"))}else{this._rollbackTx(i)}},_rollbackTx:function(t){var i=this;e.nomad.showConfirm(e.lang.get("LBL_OFFLINE_ROLLBACK_PROMPT"),function(n){if(n===2){e.offline.storage.rollbackTransaction(t.attributes,{},function(n){if(!n){i.collection.remove(i.collection.get(t.id));e.alert.show("rollback_success",{level:"success",messages:e.lang.get("LBL_OFFLINE_ROLLBACK_SUCCESS"),closeable:true,autoClose:true});e.controller.clean();if(e.controller.getScreenContext().modelId){e.controller.goBack()}i.toggleNoRecLbl()}else{e.alert.show("rollback_success",{level:"error",messages:e.lang.get("LBL_OFFLINE_ROLLBACK_FAILED"),closeable:true,autoClose:true});e.logger.error(""+n)}})}})},onTxDeleted:function(e){var t=this.collection.where({_tx_uid:e.txOptions.txId})[0];this.collection.remove(t);this.toggleNoRecLbl();this.scroll.reflow()},toggleNoRecLbl:function(){if(!this.collection.length){this.$(".no-records-found").show()}}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.DetailView=e.view.views.RecordView.extend({className:"summary-view",events:{"click .record-action .phone:not(.disabled)":function(){var t=this.model.getAccessibleFields(this.phoneFields);var i=this.model.getFieldsDataArray(t);e.nomad.callPhone(i,this.model)},"click .record-action .email:not(.disabled)":function(){var t=this.model.getAccessibleFields(this.emailFields);var i=this.model.getFieldsDataArray(t);var n=e.nomad.utils.extractAndSortEmails(i);if(!_.isEmpty(n))e.nomad.sendEmail(n)},"click .record-action .message:not(.disabled)":function(){var t=this.model.getAccessibleFields(this.phoneFields);var i=this.model.getFieldsDataArray(t);e.nomad.sendSms(i)},"click .record-action .link:not(.disabled)":function(){var t=this.model.getAccessibleFields(this.urlFields);var i=this.model.getFieldsDataArray(t,e.view.fields.UrlField.prototype.regexp);e.nomad.openUrl(i,true)},"click .record-action .map:not(.disabled)":function(){var t=this.model.getAccessibleFieldsGroups(this.addressFieldsGroups);var i=this.model.getAddresses(t);e.nomad.openAddress(i)},"click .record-action .doc:not(.disabled)":function(){if(!_.isEmpty(this.docData)){e.nomad.openDoc(this.docData)}else{e.nomad.showAlert(e.lang.get("ERR_NO_DOCS"))}},"click .record-action .emailbody:not(.disabled)":function(){e.nomad.showEmailBody(this.emailbodyFields,this.model)},"click .show-more":"toggleSummaryView"},plugins:["fast-click-highlight"],globalEvents:{"field:image:filechanged":"_onImageFieldFilechanged","offline:data:updated":function(e){if(e.id!==this.model.id)return;if(e.action==="delete"){this.showRecordOverlay(e.data,e.status);return}this.model.fetch({params:{skipServerSync:true}})}},_afterRenderTasks:{},_docsRequestTimestamp:null,initialize:function(t){this._super("initialize",arguments);this.initLabels();var i;var n=this.meta.panels[0].fields||[];var a=this.context.get("link");var o=999;if(a){var s=this.initRelationshipFields(this.context.get("parentModule"),a);if(s){n=_.union(s,n)}}if(n.length>o){n.length=o}i=e.nomad.getContextMeta("detail",this.model.module);this.headerField=i.headerField;this.avatarField=i.avatarField;this.hasLinkableSubpanels=i.hasLinkableSubpanels;this.hasCreatableSubpanels=i.hasCreatableSubpanels;this.phoneFields=i.phoneFields;this.emailFields=i.emailFields;this.urlFields=i.urlFields;this.docFields=i.docFields;this.emailbodyFields=i.emailbodyFields;this.displayFields=_.reject(n,function(e){return e===this.headerField||e===this.avatarField||_.has(this.docFields,e.name)},this);this.addressFieldsGroups={};_.each(i.addressFieldsGroups,function(e,t){this.addressFieldsGroups[t]=e[0].fields},this);this.actions=i.actions;this.followable=e.nomad.canFollow(this.model);this.model.on("docs:ready",function(e){this.docData=e;this._setDocLoading(false)},this)},getAddressFields:function(e){return _.map(e||[],function(e,t){return{name:t,type:"address",fields:e,label:"LBL_"+t.toUpperCase().replace(/_C$/,"")}},this)},onDataSyncComplete:function(t,i,n){this._super("onDataSyncComplete",arguments);e.session.set(this.model.id,this.model.attributes);this._renderActionButtons();this._requestDocuments()},receiveSyncData:function(t,i,n){var a=this.layout===e.controller.layoutManager.getRecordLayout();var o;var s;var r;e.view.views.RecordView.prototype.receiveSyncData.call(this,t);n=n||{};o=n.responseData||{};s=o[n.fileFieldName];if(this._isModelUpdated){if(s){r={};r[n.fileFieldName]=s;this._afterRenderTasks.file=_.bind(this._requestDocuments,this,r)}if(a){this._renderActionButtons();this._requestDocuments()}}},initLabels:function(){this.labelShowMore=e.lang.get("LBL_MOBILE_DETAIL_SHOW_MORE");this.labelShowLess=e.lang.get("LBL_MOBILE_DETAIL_SHOW_LESS")},_renderHtml:function(){this._calculateActionButtons();e.view.views.RecordView.prototype._renderHtml.call(this)},_renderActionButtons:function(){var t=e.template.get("record-actions");var i=this.$(".record-action");this._calculateActionButtons();if(e.config.analytics.enabled){e.analytics.detachAnalytics(i)}i.html(t(this.buttons));this.$el.find(".bizcard").toggleClass("noactions",!this.buttons.available);if(e.config.analytics.enabled){e.analytics.attachAnalytics(i)}},_calculateActionButtons:function(){var e=this._getActionsMap();this.buttons={};_.each(this.actions,function(t,i){this.buttons[i]=e[i]},this);this.buttons.available=_.any(this.buttons)},_getActionsMap:function t(){var t=this.model.getAccessibleFields(this.phoneFields);var i=this.model.getAccessibleFields(this.emailFields);var n=this.model.getAccessibleFields(this.urlFields);var a=this.model.getAccessibleFieldsGroups(this.addressFieldsGroups);var o=this.model._canHaveFiles(this.model.getAccessibleFields(this.docFields))||this.model._canHavePDFs()||this.model.canHaveAttachments();var s;s={phone:{cssClass:"phone",iconCssClass:"icon-phone",action:"phone",label:"LBL_CALL_BUTTON",state:!!this.model.isDataDefined(t)},message:{cssClass:"message sms",iconCssClass:"icon-comment",action:"sms",label:"LBL_SMS_BUTTON",state:!!this.model.isDataDefined(t)},email:{cssClass:"email",iconCssClass:"icon-envelope",action:"email",label:"LBL_EMAIL_BUTTON",state:this.model.hasActiveEmail(i)},url:{cssClass:"link",iconCssClass:"icon-external-link",action:"url",label:"LBL_URL_BUTTON",state:!!this.model.isDataDefined(n,e.view.fields.UrlField.prototype.regexp)},map:{cssClass:"map",iconCssClass:"icon-map-marker",action:"map",label:"LBL_MAP_BUTTON",state:_.any(this.model.getAddresses(a))},emailbody:{cssClass:"emailbody",iconCssClass:"icon-font",action:"emailbody",state:!!this.emailbodyFields}};if(o){s.doc={cssClass:"doc",iconCssClass:"icon-file",action:"doc",label:"LBL_FILE_BUTTON",state:o&&e.nomad.utils.docIsAvailable(this.docData)}}return s},_setDocLoading:function(e){if(!this.actions.doc)return;this.actions.doc.loading=e;this._renderActionButtons()},getHeaderData:function(){var t=this.context.get("link")?e.lang.get("LBL_RELATED_MODULE",this.module,this.moduleSingular):this.moduleSingular;var i=!!this.context.get("link");var n=!e.isTablet||e.isTablet&&!i;return{title:t,menuButton:true,plus:true,back:n,hasRels:this.hasLinkableSubpanels,hasCreatableRels:this.hasCreatableSubpanels,isRecordView:true}},onBeforeRender:function(){this._super("onBeforeRender",arguments);this.expanded=false;this.$el.removeClass("bizcard-more");this.$el.find(".show-more").text(this.labelShowMore)},onAfterRender:function(){this._super("onAfterRender",arguments);if($.os.ios&&window.ScrollFix){var t=new ScrollFix(this.$el.find(".card").get(0));var i=new ScrollFix(this.$el.find(".scroll").get(0))}this._renderActionButtons();this._performActionsAfterViewRendered();e.tutorial.show(this.name,this.module)},toggleSummaryView:function(){var e=this.$el.find(".show-more");if(this.expanded){this.$el.removeClass("bizcard-more");e.text(this.labelShowMore)}else{this.$el.addClass("bizcard-more");e.text(this.labelShowLess)}this._redrawScrollFix();this.expanded=!this.expanded;return false},_redrawScrollFix:function(){this.el.querySelector(".card").style.display="none";this.el.querySelector(".card").offsetHeight;this.el.querySelector(".card").style.display="block"},_onImageFieldFilechanged:function(t,i,n){if(n==="fileselected"){t.prepareFile()}else if(n==="preparing"){this._showOverlay()}else if(n==="prepared"){this._postFile(t,i)}else if(n==="error"){this._hideOverlay();e.alert.show("file_upload_error",{level:"error",messages:arguments[1],autoClose:true,closeable:true});this.render()}},_showOverlay:function(){e.overlay.show("uploading_image",{spinner:false});e.alert.show("upload_mask",{level:"info",messages:e.lang.get("LBL_MOBILE_UPLOAD_IN_PROGRESS"),autoClose:false,closeable:false})},_hideOverlay:function(){e.overlay.hide("uploading_image");e.alert.dismiss("upload_mask")},_postFile:function(t,i){var n={success:_.bind(function(i){e.alert.show("file_upload_success",{level:"success",messages:e.lang.get("LBL_MOBILE_UPLOAD_SUCCESS"),autoClose:true,closeable:true});this.model.set(t.name,i[t.name].name);this._requestDocuments();this._hideOverlay()},this),error:_.bind(function(i){e.error.handleHttpError(i);t.render();this._hideOverlay()},this)};this.model.uploadFile(t.name,i,n,{htmlJsonFormat:false})},_performActionsAfterViewRendered:function(){_.each(this._afterRenderTasks,function(e,t){e.call(this);delete this._afterRenderTasks[t]},this)},_requestDocuments:function(e){var t=this.model.get("date_modified");this._setDocLoading(false);if(e||!this._docsRequestTimestamp||this.model._docsUpdated||this._docsRequestTimestamp<t){this._docsRequestTimestamp=t;this.model._docsUpdated=false;this._setDocLoading(true);this.model.getDocuments(this.docFields,e)}}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.MobileTxLogDetailView=e.view.NomadView.extend({events:{"click .delete:not(.disabled)":"rollbackRecord"},globalEvents:{"offline:tx:delete":"onTxDeleted"},getHeaderData:function(){var t=e.lang.get("LBL_TX_LOG_DETAIL");return{title:t,cancel:true}},_render:function(){if(!this.model.get("_tx_action"))return;e.view.NomadView.prototype._render.apply(this,arguments)},onBeforeRender:function(){var t=this.model.get("_tx_bean_module");var i=parseInt(this.model.get("_tx_action"),10);var n=e.metadata.getModule(t);var a=n||{fields:{}};this.updatedFields=e.utils.deepCopy(this.model.get("_tx_updated_fields"));if(this.updatedFields){var o=this.updatedFields.currency_id;var s=this.updatedFields.parent_type;if(s){s=_.clone(s)}else if(this.updatedFields.parent_id){this.model.attributes.parent_type=this.model.attributes.bean.parent_type}switch(i){case e.offline.SYNC_ACTIONS.CREATE:case e.offline.SYNC_ACTIONS.UPDATE:var r=this._getViewableFields(t);this.updatedFields=r?_.pick(this.updatedFields,this._getViewableFields(t)):this.updatedFields}if(e.offline.SYNC_ACTIONS.LINK===i||e.offline.SYNC_ACTIONS.UNLINK===i){this.updatedFields.link=true}else{_.each(this.updatedFields,function(i,r){if(r==="my_favorite"){i.vname="LBL_ACTION_FAVORITE";delete i.before;i.after=""+i.after}else if(r==="following"){if(e.nomad.canFollow(this.model)){i.vname="LBL_ACTION_FOLLOW";delete i.before;i.after=""+i.after}else{delete this.updatedFields.following}}else{var l=_.contains(["assigned_user_id","deleted","currency_id"],r)||i.type==="id";if(n&&(!a.fields[r]||!e.config.offline.debug.render&&l)){delete this.updatedFields[r];return}i.vname=a.fields[r]||r;_.extend(i,a.fields[r]);var c={def:a.fields[r]||{type:"varchar",name:r},view:this,model:this.model,module:t};if(c.def.type==="email"){c.def=_.defaults({type:"varchar"},c.def);i.before=_.pluck(i.before,"email_address").join(", ");i.after=_.pluck(i.after,"email_address").join(", ")}var d=e.view.createField(c);var u=e.view.createField(c);if(i.before||i.before===0){d.model.set(r,i.before,{silent:true});if(i.type==="currency"&&o){d.model.set("currency_id",o.before,{silent:true})}else if(i.type==="parent"&&s){d.model.set("parent_type",s.before,{silent:true})}i.before=d.render()}u.model.set(r,i.after,{silent:true});if(i.type==="currency"&&o){u.model.set("currency_id",o.after,{silent:true})}else if(i.type==="parent"&&s){u.model.set("parent_type",s.after,{silent:true})}i.after=u.render()}},this)}}this.fields={};e.view.NomadView.prototype.onBeforeRender.apply(this,arguments)},_getViewableFields:function(t){var i=e.metadata.getView(t,"edit");if(i){return _.reduce(i.panels,function(e,t){var i=[];_.each(t.fields,function(e){if(e.fields){i.push.apply(i,_.pluck(e.fields,"name"))}else{i.push(e.name)}});return _.union(e,i)},[])}else return null},onAfterRender:function(){e.view.NomadView.prototype.onAfterRender.apply(this,arguments);_.each(this.updatedFields,function(e,t){if(t==="my_favorite"||t==="following"||!e){return}if(e.before){e.before.dispose();e.before=null}if(e.after){e.after.dispose();e.after=null}},this)},_rollbackTx:function(){var t=this;e.nomad.showConfirm(e.lang.get("LBL_OFFLINE_ROLLBACK_PROMPT"),function(i){if(i===2){e.offline.storage.rollbackTransaction(t.model.attributes,{},function(i){if(!i){t.collection.remove(t.collection.get(t.model.id));e.alert.show("rollback_success",{level:"success",messages:e.lang.get("LBL_OFFLINE_ROLLBACK_SUCCESS"),closeable:true,autoClose:true});e.controller.clean();e.controller.goBack()}else{e.alert.show("rollback_success",{level:"error",messages:e.lang.get("LBL_OFFLINE_ROLLBACK_FAILED"),closeable:true,autoClose:true});e.logger.error(""+i)}})}})},rollbackRecord:function(t,i){if(e.offline.syncManager.isSyncing()){e.nomad.showAlert(e.lang.get("LBL_OFFLINE_SYNC_IN_PROGRESS"))}else{this._rollbackTx()}},onTxDeleted:function(t){if(t.txOptions.txId===this.model.get("_tx_uid")){this.$el.find(".btn.delete").addClass("disabled").html(e.lang.get("LBL_OFFLINE_TRANSACTION_SYNCED"))}}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.AddressEditView=e.view.NomadView.extend({_bodyScroll:true,globalEvents:{"app:header:save":"save"},plugins:["clear-field","hide-alerts-onfocus","focus-on-input"],initialize:function(e){this._super("initialize",arguments);this.action="edit";this.fallbackFieldTemplate="edit";this.addressFields=this.context.get("addressFields");this.addressFieldsNames=_.pluck(this.addressFields,"name");this.model=this.context.get("model")},getHeaderData:function(){var e=this.context.get("editedFieldName");return{title:e,save:true,saveLabel:"LBL_DONE_BUTTON_LABEL",cancel:true}},save:function(){var t=this;e.syncAlertManager.showOverlay();this.model.doValidate(this.addressFieldsNames,function(i){e.syncAlertManager.hideOverlay();if(i){_.each(t.addressFields,function(e){t.context.get("parentModel").set(e.name,t.model.get(e.name))});e.controller.goBack()}})}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.TextareaEditView=e.view.NomadView.extend({editElTag:"textarea",globalEvents:{"app:header:save":"save"},getHeaderData:function(){var e=this.options.editedFieldName;return{title:e,save:!this.options.isReadOnly,saveLabel:"LBL_DONE_BUTTON_LABEL",cancel:true}},setValue:function(e){var t=this.$(this.editElTag);var i=this.context.get("isReadOnly");t.val(e);if(i){t.attr("readOnly",i)}if(e||i)return;t.attr("tabindex",1e5).attr("name","somename").get(0).focus()},getValue:function(){return this.$(this.editElTag).val()},save:function(){var t=this.getValue();var i=e.nomad.utils.stripLastEmptyStrings(t);this.context.get("parentModel").set(this.context.get("fieldName"),i);e.controller.goBack()}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.EmailbodyEditView=e.view.views.TextareaEditView.extend({events:{"click .email-body-content a":function(t){t.preventDefault();t.stopPropagation();var i=t.target.getAttribute("href");e.nomad.openUrl(i)}},getHeaderData:function(){var e=this.options.editedFieldName;return{title:e,save:false,cancel:true}}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.EditView=e.view.views.RecordView.extend({NOTHING_CHANGED_ERR:"nothing_changed",VALIDATION_ERR:"validation_error",_bodyScroll:true,events:{"click .delete":"deleteRecord"},plugins:["fast-click-highlight","clear-field","hide-alerts-onfocus","focus-on-input","item-actions"],globalEvents:{"app:header:save":function(e){this.saveRecord()},"app:header:action":"onHeaderAction","field:image:filechanged":"_onImageFieldFilechanged","field:image:fileclear":"_onImageFieldFileclear","offline:data:updated":function(t){if(t.isCollection||t.id!==this.model.id)return;if(t.action==="delete"){this.showRecordOverlay(t.data,t.status);return}if(!this._modelBackup||t.date_modified===this._modelBackup.date_modified)return;var i=e.lang.get("LBL_OFFLINE_MERGE_DATA_CONFIRM");var n=_.pick(this.model.attributes,this._getChangedFields());var a=t.complete;if(!_.isEmpty(n)){e.nomad.showConfirm(i,_.bind(function(e){if(e===2){var i=this.model;t.complete=function(){i.set(n);if(a){a.apply(this,arguments)}}}this.model.fetch(_.extend(t,{params:{skipServerSync:true}}))},this))}else{this.model.fetch({params:{skipServerSync:true}})}}},initialize:function(t){e.view.views.RecordView.prototype.initialize.call(this,t);this._fileUploads={};this._modelBackup=null;this.relateFields=null;this.selectedItem=null;var i=this.context.get("link");if(i){var n=this.context.get("parentModule");var a=e.data.getRelateFields(n,i);this.relateFields=_.isEmpty(a)?null:_.pluck(a,"name");this.initRelationshipFields(n,i)}if(this.context.isCreate()){var o=e.metadata.getModule(this.module).fields.assigned_user_name;if(o&&o.type==="relate"){var s={};s[o.id_name]=e.user.get("id");s[o.name]=e.user.get("full_name");this.model.set(s)}var r=e.metadata.getModule(this.module).fields.team_name;if(r){var l=this.model.get(r.name)||e.user.getPreference("default_teams")||[];if(!l.length){l.push({id:1,name:"Global",primary:true})}this.model.set(r.name,l)}}this._updateReadOnlyStatus()},isEditView:function(){return true},_render:function(){this.action=this.context.isCreate()?"create":"edit";if(this.action==="edit"){this._updateReadOnlyStatus();this.action=this.name=this.isReadOnly?"view":"edit"}e.view.views.RecordView.prototype._render.call(this)},onBeforeRender:function(){e.view.views.RecordView.prototype.onBeforeRender.apply(this,arguments);this.model.off("error:validation");this.model.on("error:validation",function(){e.alert.show("validation_error",{level:"error",messages:e.lang.get("ERR_MOBILE_VALIDATION"),autoClose:true})},this)},onAfterRender:function(){e.view.views.RecordView.prototype.onAfterRender.apply(this,arguments);var t=e.metadata.getStrings("mod_strings")[this.module];var i=t?t.LBL_RELATED_RECORD_DEFAULT_NAME:null;var n=this.context.isCreate();var a=this.context.get("link");var o=this.context.get("parentModule");var s=this.context.get("parentModel");var r=false;var l=this;var c=s&&e.session.get(s.id);var d=i&&n&&a&&!this.context.get("dupe")&&this.model&&_.isEmpty(this.model.get("name"));var u=n&&a&&e.nomad.isStandardModule(o)&&!s.parentInfoPopulated;if(s&&!c){c=s.dataFetched?s.toJSON():null}function f(t){if(t){i=e.lang.get("LBL_RELATED_RECORD_DEFAULT_NAME",l.module,t);var n=e.metadata.getModule(l.module);var a=n?n.fields.name:null;var o=a?a.len:null;if(o&&o<i.length){i=i.substr(0,o-3)+"..."}l.model.set("name",i)}}if(d){if(c){f(c.full_name||c.name)}else{r=true}}if(u){if(c){this._populateParentInfo(c,o,a)}else{r=true}}if(r){if(s&&!c){s.fetch({success:function(){if(!l.model)return;if(d&&_.isEmpty(l.model.get("name"))){f(s.get("full_name")||s.get("name"))}if(u){l._populateParentInfo(s.toJSON(),o,a);s.parentInfoPopulated=true}}})}}},getField:function(e,t){var i=this._super("getField",arguments);if(!i){_.each(this.fields,function(t){if(!i&&t.getSubfield){i=t.getSubfield(e)}})}return i},_parsePopulateList:function(t,i){var n=_.isArray(t);_.each(t,function(t,a){a=n?t:a;if(!_.isUndefined(i[a])&&_.isEmpty(this.model.get(t))&&e.acl.hasAccessToModel("edit",this.model,t)){this.model.set(t,i[a])}},this)},_populateParentInfo:function(t,i){var n=this.model.fields;var a=this.context.get("link");var o=e.data.getRelateFields(i,a);var s=e.metadata.getModule(i).fields[a];if(e.supportedFeatures.populateList){if(s&&s.populate_list){this._parsePopulateList(s.populate_list,t)}if(!_.isEmpty(o)){_.each(o,function(e){this.model.set(e.name,t[e.rname]);this.model.set(e.id_name,t.id);if(e.populate_list){this._parsePopulateList(e.populate_list,t)}},this)}}else{var r=(i==="Accounts"||t.account_id)&&!(i==="Opportunities"&&this.module==="Contacts")&&n.account_id&&n.account_name&&!(this.model.get("account_id")||this.model.get("account_name"))&&e.acl.hasAccessToModel("edit",this.model,"account_name");if(r){this.model.set({account_id:t.account_id||t.id,account_name:t.account_name||t.name})}}},_updateReadOnlyStatus:function(){this.isReadOnly=!e.acl.hasAccessToModel("edit",this.model)||e.config.nonEditableModules.indexOf(this.model.module)>=0},getHeaderData:function(){var t=this.onlyRelationshipEdit;var i=this.context.get("link");var n=this.context.get("create");var a;var o;o={save:true,cancel:true,menuButton:false,otherActions:this.getOtherActions(n)};if(t){a=e.lang.get("LBL_MOBILE_EDIT_REL")}else{if(n){var s=this.context.get("layoutOptions")&&this.context.get("layoutOptions").isLoggingCall;a=i&&!s?e.lang.get("LBL_CREATE_RELATED",this.module,this.moduleSingular):e.lang.get("LBL_CREATE_MODULE",this.module,this.moduleSingular)}else if(this.isReadOnly){a=i?e.lang.get("LBL_RELATED_MODULE",this.module,this.moduleSingular):this.moduleSingular}else{a=i?e.lang.get("LBL_EDIT_RELATED",this.module,this.moduleSingular):e.lang.get("LBL_EDIT",this.module,this.moduleSingular)}}o.title=a;return o},onDataSyncSuccess:function(e,t,i){this._super("onDataSyncSuccess",arguments);this._onDataSyncComplete(i.method,e,i)},onDataSyncError:function(t,i,n){e.view.views.RecordView.prototype.onDataSyncError.apply(this,arguments);var a=this;this._onDataSyncComplete(t,this.model,i,n);if(n.status===409){e.nomad.showConfirm(e.lang.get("ERR_MOBILE_CONFLICT"),function(t){var i={};var o=a.model;var s=n.payload.record;if(s){if(t===2){_.each(a._getChangedFields(),function(e){i[e]=o.get(e)});a.backupModel(s);s=e.data.beanModel.merge(s,i,a.module)}else{a.backupModel(s)}o.set(s)}})}},_onDataSyncComplete:function(t,i,n,a){if(!this.context.isCreate()&&this.context.isDataFetched()){if(t==="read"){this.backupModel()}if(e.config.nonEditableModules.indexOf(this.model.module)===-1&&this.action!==(e.acl.hasAccessToModel("edit",this.model)?"edit":"view")){this.render()}this.$(".btn.delete").toggleClass("hide",!(this.model.hasDeleteAccess()&&!(a&&t==="read")))}},deleteRecord:function(){var t=this;e.nomad.showConfirm(e.lang.get("LBL_MOBILE_DELETE_CONFIRM"),function(e){if(e===2){t.model.destroy({wait:true})}})},saveRecord:function(t){var i=this.context.get("create");this._removeErrorMessages();var n=this.model.get("email");if(n){n=_.filter(n,function(e){return!_.isEmpty(e.email_address)});this.model.set("email",n)}var a=this;var o=this._getSavingTasks(t);async.series(o,function(t){e.syncAlertManager.hideOverlay();if(t===a.VALIDATION_ERR){return}if(t===a.NOTHING_CHANGED_ERR){return e.controller.goBack()}if(!t){e.trigger("edit:view:save",{model:a.model,parentModel:{id:a.context.get("parentModelId"),module:a.context.get("parentModule")},isCreate:i})}else{a._handleSaveError(t)}e.syncAlertManager.resume("update",a.model,t)})},_handleSaveError:function(t){if(t.isFileUploadError){e.error.handleHttpError(t)}},_getSavingTasks:function(t){var i;var n=this.getFieldNames(true);var a=this.context.get("dupe")?_.keys(this.model.attributes):this._getChangedFields(n);var o=this;t=t||[];if(this._sendParentId||_.include(a,"parent_id")){t.push("parent_id","parent_type","parent_name")}a=_.isEmpty(a)?null:_.union(a,t);i=[function s(e){o._validateRecord(e,a,n)},function r(t){e.syncAlertManager.pause("update",o.model);t()},function l(e){o._saveRecord(e,o._omitFileFields(a))}];_.each(this._fileUploads,function(e){i.push(_.bind(e,this))},this);return i},_beforeValidateAndSave:function(){e.syncAlertManager.showOverlay()},_validateRecord:function(t,i,n){var a={};var o=e.metadata.getModule(this.module).fields;var s=_.filter(n,function(e){var t={};_.each(this.fields,function(i){if(i.name===e){t=i}},this);return!!o[e]&&(!_.isEmpty(t)&&t.action!=="disabled")},this);this._beforeValidateAndSave();_.each(s,function(e){var t=o[e];var i=this.getField(e);if(i){t=i.def}if(t.type==="address"){_.each(t.fieldNames,function(e){a[e]=o[e]})}else if(t.required||!(t.calculated&&t.enforced)){a[t.name]=t}},this);if(this.context.get("dupe")){_.each(a,function(t,i){if(!e.acl.hasAccessToModel("edit",this.model,i)){delete a[i]}},this)}var r=this;this.model.doValidate(a,function(e){if(e){if(!_.isEmpty(i)){t(null)}else{t(r.NOTHING_CHANGED_ERR)}}else{t(r.VALIDATION_ERR)}})},_shouldUpdateNameAndFullname:function(t){var i=e.metadata.getModule(this.model.module).fields;var n=i.name;var a=i.full_name;var o="last_name";if(_.intersection(t,["first_name","last_name","salutation","title"]).length===0){return false}return n&&a&&n.group===o&&a.group===o},_saveRecord:function(t,i){if(!this.model){return}var n=e.metadata.getModule(this.module).fields.name;if(e.offlineEnabled&&_.intersection(i,n.fields).length!==0){if(this._shouldUpdateNameAndFullname(i)){var a=e.utils.formatNameModel(this.model.module,this.model.attributes);this.model.set("full_name",a);this.model.set("name",a);i.push("full_name");i.push("name")}else{var o=n.fields[0];this.model.set("name",this.model.get(o));i.push("name")}}if(!_.isEmpty(i)){this.model.save(null,{relate:!this._viaParent&&!!this.context.get("link"),fields:i,modelBackup:this._modelBackup,viewed:true,success:function(){t()},error:function(e){t(e)}})}else{t()}},onHeaderAction:function(e){if(this.headerActions&&this.headerActions[e])this.headerActions[e].fn.call(this)},getOtherActions:function(e){var t=[];if(this.headerActions&&!this.isReadOnly){_.each(this.headerActions,function(i,n){var a=i.isEnabled(this.model);if(a&&(!e||i.showOnCreate)){i.name=n;t.push(i)}},this)}return t.length?t:false},_removeErrorMessages:function(){this.$(".controls").find(".error-display").remove();this.$(".control-group").removeClass("error")},backupModel:function(t){this._modelBackup=e.utils.deepCopy(t||this.model.attributes);this.context.set("_modelBackup",this._modelBackup)},restoreModel:function(){this.model.set(this.model.getChangeDiff(this._modelBackup))},receiveSyncData:function(e){},_getChangedFields:function(){return _.keys(this.model.getChangeDiff(this._modelBackup))||[]},_omitFileFields:function(t){var i=_.filter(e.metadata.getModule(this.module).fields,function(e){return e.type==="image"||e.type==="file"}).map(function(e){return e.name});return _.difference(t,i)},_onImageFieldFilechanged:function(t,i,n){var a=this;if(n==="fileselected"){this._showOverlay(t.type);t.prepareFile()}else if(n==="prepared"){this._hideOverlay();this._enqueueFileHandler("create",t,i);var o=i.fileData.name;this._setFileFieldValue(t,o);a.model.doValidate([t.name],function(e){if(e){t.handleValidationError()}})}else if(n==="error"){this._hideOverlay();e.alert.show("file_upload_error",{level:"error",messages:arguments[1],autoClose:true,closeable:true});this.render()}},_setFileFieldValue:function(e,t){this.model.set(e.name,t,{silent:true});if(!_.isEmpty(e.def.fields)){_.each(e.def.fields,function(e){this.model.set(e,t,{silent:true})},this)}},_onImageFieldFileclear:function(e){this._enqueueFileHandler("delete",e);this._setFileFieldValue(e,"")},_enqueueFileHandler:function(e,t,i){var n;var a=this;n=function(n){var o=a.model.get(t.name);var s=i&&i.fileData.name||"";var r={success:function(e){a.model.trigger("change:attachment_list");a.model.trigger("sync",a.model,e,{fileFieldName:t.name});n()},error:function(e){delete a._fileUploads[t.name];a.model.set(t.name,o);n(e)}};a.model.set(t.name,s);if(e==="create"){_.defer(function(){a.model.uploadFile(t.name,i,r,{htmlJsonFormat:false,isCreate:a.context.get("create")})})}else{a.model.deleteFile(t.name,i,r,{htmlJsonFormat:false})}};this._fileUploads[t.name]=n},_showOverlay:function(t){var i=t==="image"?"LBL_MOBILE_PROCESSING_IMAGE":"LBL_MOBILE_PROCESSING_FILE";e.overlay.show("preparing_image",{spinner:false});e.alert.show("upload_mask",{level:"info",messages:e.lang.get(i),autoClose:false,closeable:false})},_hideOverlay:function(){e.alert.dismiss("upload_mask");e.overlay.hide("preparing_image")}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.EditRelationshipView=e.view.views.EditView.extend({initialize:function(t){e.view.views.EditView.prototype.initialize.call(this,t);this.template=e.template.get("edit");this.meta=e.metadata.getView(this.module,"edit");this.fallbackFieldTemplate="edit";this.onlyRelationshipEdit=true},saveRecord:function(){e.trigger("edit:view:save")}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.ActivityEditView=e.view.views.EditView.extend({_populateParentInfo:function(t,i,n){var a=e.acl.hasAccessToModel("edit",this.model,"parent_name");var o=e.acl.hasAccessToModel("edit",this.model,"contact_name");var s=e.metadata.getRelationship(e.metadata.getModule(i,"fields")[n].relationship)||{};if(s.via_parent_id)this._viaParent=true;if(i==="Contacts"){if(o){this.model.set({contact_id:t.id,contact_name:t.full_name||t.name});this._sendContactId=true}if(a){this.model.set({parent_id:t.account_id,parent_type:"Accounts",parent_name:t.account_name});this._sendParentId=true}}else if(a){this.model.set({parent_name:t.name,parent_id:t.id,parent_type:i});this._sendParentId=true}},saveRecord:function(t){t=t||[];if(this._sendContactId)t.push("contact_id");e.view.views.EditView.prototype.saveRecord.call(this,t)}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.MeetingCallEditView=e.view.views.ActivityEditView.extend({_isDateRangeMode:false,initialize:function(e){this._super("initialize",[e]);this._initDateRangeProperty();if(this._isDateRangeMode){this.model.addValidationTask("date_range_validation",_.bind(this._validateRange,this))}},_initDateRangeProperty:function(){var e=["date_start","date_end"];this._isDateRangeMode=_.some(this.options.meta.panels[0].fields,function(t){return t.type==="fieldset"&&_.intersection(t.related_fields,e).length===e.length})},onAfterRender:function(){if(this.context.isCreate()){this.model.set({send_invites:false})}else{var e=this.getField("invitees");if(e)e.$el.hide()}this._super("onAfterRender");this._setDefaultDateValues()},setCallData:function(e){
this.model.set(e);if(this._isDateRangeMode){this._populateEndDateByDuration(e)}this._skipSetDefaults=true},saveRecord:function(t){t=t||[];t.push("send_invites");if(this._isDateRangeMode){if(_.intersection(this._getChangedFields(),["date_start","date_end"]).length){t.push("duration_hours","duration_minutes")}}else{this.model.unset("date_end")}this.sendInvites=this.model.get("send_invites");e.view.views.ActivityEditView.prototype.saveRecord.call(this,t)},_saveRecord:function(e,t){t=_.without(t,"invitees");this._populateDurationValues();this._super("_saveRecord",[e,t])},_validateRange:function(t,i,n){var a=this.model.get("date_start");var o=this.model.get("date_end");var s;var r;var l;if(a&&o){l=e.date.compare(a,o)<1;if(!l){s=this.getField("date_start");r=this.getField("date_end");i.date_start={isBefore:r.label};i.date_end={isAfter:s.label}}}n(null,t,i||{})},_setDefaultDateValues:function(){var t=e.date().seconds(0);if(this._skipSetDefaults||!this.context.isCreate()){return}if(t.minutes()>30){t.add("h",1).minutes(0)}else if(t.minutes()>0){t.minutes(30)}this.model.set({date_start:t.formatServer(),duration_hours:0,duration_minutes:30});if(this._isDateRangeMode){this._populateEndDateByDuration()}this._skipSetDefaults=true},_populateEndDateByDuration:function(t){var i=this.model;var n=i.get("date_start");var a;var o;var s;if(!n){return}o=t?t.duration_hours:i.get("duration_hours");s=t?t.duration_minutes:i.get("duration_minutes");a=e.date(n).add("h",o).add("m",s).formatServer();i.set("date_end",a)},_populateDurationValues:function(){var t;var i;if(!this._isDateRangeMode){return}i=this.model;t=e.date(i.get("date_end")).diff(i.get("date_start"));i.set("duration_hours",Math.floor(e.date.duration(t).asHours()));i.set("duration_minutes",e.date.duration(t).minutes())},_getSavingTasks:function(t){var i=e.view.views.EditView.prototype._getSavingTasks.call(this,t);var n=this;var a=this.model.get("invitees");if(a){_.each(a,function(t){i.push(function(i){var a=e.data.createRelatedBean(n.model,t.id,t.link);a.save(null,{relate:true,fields:["id"],success:function(){i()},error:function(e){i(e)}})})})}if(this.sendInvites&&this.context.isCreate()){i.push(function(e){n.model.set({send_invites:true},{silent:true});n._saveRecord(e,["send_invites"])})}return i},_beforeValidateAndSave:function(){if(this.context.isCreate()){this.model.unset("send_invites",{silent:true})}},_handleSaveError:function(t){e.view.views.EditView.prototype._handleSaveError.call(this,t);if(!t.isFileUploadError){if(this.model){this.model.set({send_invites:this.sendInvites},{silent:true})}}}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.MobileCallsEditView=e.view.views.MeetingCallEditView.extend({})})(SUGAR.App)},function(e,t){(function(e){e.view.views.MobileMeetingsEditView=e.view.views.MeetingCallEditView.extend({})})(SUGAR.App)},function(e,t){(function(e){e.view.views.MobileNotesEditView=e.view.views.ActivityEditView.extend({})})(SUGAR.App)},function(e,t){(function(e){e.view.views.MobileTasksEditView=e.view.views.ActivityEditView.extend({})})(SUGAR.App)},function(e,t){(function(e){e.view.views.MobileRevenueLineItemsEditView=e.view.views.EditView.extend({onAfterRender:function(){e.view.views.EditView.prototype.onAfterRender.call(this);var t;if(this.model.link){t=this.model.link.bean.id}if(this.context.isCreate()&&_.isEmpty(this.model.get("opportunity_id"))){this.model.set("opportunity_id",t)}}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.MobileUsersEditView=e.view.views.EditView.extend({initialize:function(t){e.view.views.EditView.prototype.initialize.apply(this,arguments);this.model.on("change:attachment_list",_.bind(this._onChangeAttachmentList,this))},_onChangeAttachmentList:function(){if(this.model.hasChanged("picture")){e.trigger("app:header:picturechanged",this.model.get("picture"))}}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.ConfigurableListView=e.view.views.ListView.extend({plugins:_.union(e.view.views.ListView.prototype.plugins,["refresh-timeago"]),initialize:function(t){this.listParams=t.listParams;var i=this.getCollection(t.listParams);t=_.extend({},t,{meta:this.calculateListMeta(t.listParams),collection:i,context:this.getContext(t,i),template:e.template.getView("list")});this._super("initialize",arguments)},getContext:function(t,i){var n=this.listParams;var a=n.parentModel;var o={fields:e.metadata.getModule(n.module).mergedFields,model:e.data.createBean("Filters"),collection:i,module:n.module,limit:n.limit,link:a&&n.link,parentModule:a&&a.module};return e.context.getContext(o)},getCollection:function(t){var i={limit:t.limit};var n=t.parentModel&&t.link?e.data.createRelatedCollection(t.parentModel,t.link):e.data.createBeanCollection(t.module,null,i);this.setFilter(n,t);n.options=i;n.limit=i.limit;return n},setFilter:function(t,i){var n=i.filter;var a=i.filter_id||"assigned_to_me";if(!n){var o=e.metadata.getModule(i.module,"filters");if(o&&o.basic){n=_.find(o.basic.meta.filters,function(e){return e.id===a})}}if(n){t.filterDef=n.filter_definition||n}else{t.filterId=a}},calculateListMeta:function(t){var i=e.metadata.getModule(t.module,"fields");var n=[];_.each(t.display_columns,function(e){n.push(i[e])});return{panels:[{fields:n}]}},refresh:function(e){this.collection.resetOptions();this._super("refresh",arguments)},getFieldNames:function(){return this.listParams.display_columns},loadData:function(e){var t=this;this.loadUserFilter(function i(n){if(n){return}t._super("loadData",[e,false])})},loadUserFilter:function t(i){var n=e.data.createBean("Filters",{id:this.collection.filterId});var a=this;if(!this.collection.filterDef&&this.collection.filterId){n.fetch({success:function o(e,t){a.collection.filterDef=t.filter_definition;i()},error:function s(t){e.nomad.showAlert(e.lang.get("ERR_MOBILE_CONNECTION_FAILED"));i(t)}})}else{i()}},onClickItem:function(e){if(!$(e.target).closest("a").length){this._super("onClickItem",arguments)}return true}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.BaseDashletView=e.view.NomadView.extend({initialize:function(t){this._super("initialize",[t]);var i=this.meta.view.type;var n=this._getDefaultSettings(i);this.meta=e.utils.deepCopy(t.meta);if(n){this.meta.view=_.defaults(this.meta.view,n)}if(e.offlineEnabled){this.cacheStorage=e.nomad.dashboards.cacheDashletStore}this.dashletParams=e.metadata.getView("Home",i);var a=_.defaults({type:this.name,module:this.module},this.meta.view);this.title=e.nomad.dashboards.getDashletTitle(a);this.activeRequests=[];this.initDashletOptions()},_getDefaultSettings:function t(e){var t={"active-tasks":{visibility:"user"},"inactive-tasks":{visibility:"user"},history:{filter:7,visibility:"user"},"planned-activities":{date:"today",visibility:"user"}};return t[e]},dismissNetworkAlerts:function(){e.alert.dismiss("network_error",{animate:false})},applyViewState:function(e){if(!_.isEmpty(e.filters)){this.viewState.filters.set(e.filters,{silent:true})}if(e.visibility){this.viewState.visibility=e.visibility;this.viewState.myItemsOnly=e.visibility==="user";this.previousVisibilityState=this.viewState.visibility}this.viewState.filtersDef=e.filtersDef;this.render()},initDashletOptions:function(){var t=this.getState(this.options.dashboardId,this.meta.id)||{};this.viewState={visibility:t.visibility||this.meta.view.visibility};this.viewState.myItemsOnly=this.viewState.visibility==="user";this.dashletOptionsTemplate=e.template.get("dashlet-options");this.initFilters(t);this.enableOptionsToolbar()},enableOptionsToolbar:function(){if(this.dashletOptionsEnabled()){this.$el.addClass("has-dashlet-options")}},abortActiveRequests:function(){if(_.isEmpty(this.activeRequests)){return false}_.each(this.activeRequests,function(t){e.api.abortRequest(t.uid)});this.activeRequests=[];this.loaded=false;return true},onBeforeHide:function(){this.unbindGlobalEvents();this.abortActiveRequests();e.alert.dismissAll()},onInvokedFromDashboard:function(){},onAfterRender:function(){if(this.dashletOptionsEnabled()){this.$el.prepend(this.dashletOptionsTemplate(this));this.$switcher=this.$(".visibility-switcher");this.$switcherBtns=this.$switcher.find(".btn");this.listenTo(this.$switcher,"click",_.bind(this.changeVisibility,this));if(e.config.analytics.enabled){e.analytics.attachAnalytics(this.$(".dashlet-options"))}if(!_.isEmpty(this.fields)){this._renderFields()}}},_dispose:function(){var t=this.getViewContainer();if(t){t.remove()}if(e.config.analytics.enabled){e.analytics.detachAnalytics(this.$(".dashlet-options"))}this._super("_dispose",arguments)},changeVisibility:function(e){e.preventDefault();e.stopPropagation();var t=$(e.target);var i=t.data("value");var n="active";if(i!==this.viewState.visibility){this.$switcherBtns.removeClass(n);t.addClass(n);this.viewState.visibility=i;this.refreshData()}},initFilters:function(t){this.viewState.filtersDef={};this.viewState.filters=e.data.createBean("Filters");this.updateFiltersViewState(t);this.listenTo(this.viewState.filters,"change",function(){this.refreshData()})},updateFiltersViewState:function(){},dashletOptionsEnabled:function(){return this.viewState&&(this.viewState.visibility||!_.isEmpty(this.viewState.filtersDef))},loadData:function(){},refreshData:function(e){this.saveState();this.abortActiveRequests();this.loadData(e)},saveState:function(){var t=this.getSettingName();var i=e.nomad.getSetting(t)?JSON.parse(e.nomad.getSetting(t)):[];var n={visibility:this.viewState.visibility,filters:this.viewState.filters.toJSON(),dashboardId:this.options.dashboardId,dashletId:this.meta.id};var a;_.each(i,function(e,t){if(n.dashboardId===e.dashboardId&&n.dashletId===e.dashletId){i[t]=a=n}});if(!a){i.push(n)}e.nomad.setSetting(t,JSON.stringify(i))},getState:function(t,i){var n=this.getSettingName();var a=e.nomad.getSetting(n);var o=a&&JSON.parse(a);if(_.isEmpty(o)){return}return _.find(o,function(e){return e.dashboardId===t&&e.dashletId===i})},getSettingName:function(){return"dashlet_states"},apiCall:function(){this.activeRequests.push(e.api.call.apply(e.api,arguments))},isSwipable:function(){return true},toggleDashletSwipe:function(){this.$el.toggleClass("no-swiping",!this.isSwipable())},onDetach:function(){this.onBeforeHide();this._super("onDetach")},getViewContainer:function i(){return this.$el}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.BaseChartView=e.view.views.BaseDashletView.extend({className:"chart-wrapper",chart:null,chartData:null,isManager:false,showManagerData:false,loaded:false,responseDataAttr:"data",LATEST_AVAILABLE_WARN_KEY:"LATEST_AVAILABLE_DATA",_chartElSize:null,ERR_NO_DATA_AVAILABLE:"NO_DATA_AVAILABLE",globalEvents:{"app:orientation:changed":function(){this._updateChartElSize();this._onOrientationChange()}},plugins:["ptr"],initialize:function(t){this._super("initialize",[t]);this.isManager=e.user.get("is_manager")},_updateChartElSize:function(){if(this.$el){this._chartElSize={width:this.$el.width(),height:this.$el.height()}}this._maxLegendRows=e.nomad.getOrientation()==="landscape"&&!e.isTablet?1:4},_onOrientationChange:function(){if(this.chart){if(this.chart.legend){this.chart.legend.rowsCount(this._maxLegendRows)}this.dispatchChartMethod("tooltipHide");this.rerenderChart()}},onBeforeRender:function(){this.enableOptionsToolbar();this._updateChartElSize();this._super("onBeforeRender",arguments)},renderChart:function(){this.$(".nv-chart svg").remove();nv.tooltip.cleanup();return this.chartData.data.length},onAfterRender:function(){this._super("onAfterRender",arguments);this.$chartEl=this.$(".nv-chart");this.$dataUnavailableLbl=this.$(".data-unavailable-label");this.listenTo(this.$(".nv-chart"),"click",_.bind(function(e){this.dispatchChartMethod("chartClick")},this))},loadData:function(){if(this.loaded){if(this.chart){this.dispatchChartMethod("tooltipHide");this.updateChart()}return}this.showPreloader();var t=this;var i=[_.bind(this.loadChartData,this)];if(!this._isInitialized&&this.loadInitData){i.unshift(_.bind(this.loadInitData,this))}async.series(i,function n(i,a){t.activeRequests=[];t.trigger("ptr:data:load:complete");if(i){if(!i.request.aborted){t.loadDataError(i)}return}var o=_.last(a);if(t.isDataEmpty(o,a)){t.loadDataError(t.ERR_NO_DATA_AVAILABLE);return}t.loadDataSuccess(o,function s(t){t&&e.logger.error(t+" Couldn't cache chart data")})})},showLatestAvailableDataWarn:function(t){var i=e.date(t.last_fetched).fromNow();e.alert.show(this.LATEST_AVAILABLE_WARN_KEY,{level:"warning",messages:e.lang.get("LBL_SHOWING_CACHED_DATA",null,{lastFetched:i}),autoClose:false,closable:true})},isDataEmpty:function(e,t){return _.isEmpty(e)||(this.responseDataAttr?_.isEmpty(e[this.responseDataAttr]):false)},showPreloader:function(){e.alert.show("chart-loading",{level:"load",messages:e.lang.get("LBL_LOADING"),autoClose:false,closeable:false});this.$dataUnavailableLbl.hide()},hidePreloader:function(){e.alert.dismiss("chart-loading")},refreshData:function(e){this.loaded=false;if(!e){this.showPreloader()}this._super("refreshData",arguments)},loadDataSuccess:function(t,i){if(t.title){this.dataTitle=t.title;this.layout.dashboardView.trigger("dashlets:changed",{meta:this.meta,view:this})}this.dispatchCacheStorageMethod("set",this.options.dashletId,{chartData:t,filters:this.viewState.filters,filtersDef:this.viewState.filtersDef,visibility:this.viewState.visibility,last_fetched:e.utils.getTimestamp()},i);this.loaded=true;this.hidePreloader();this.$chartEl.show();this.$dataUnavailableLbl.hide();this.processData(t)},loadDataError:function(t){this.hidePreloader();var i=this;if(t===this.ERR_NO_DATA_AVAILABLE){this.$chartEl.hide();this.$dataUnavailableLbl.show();return}e.error.handleHttpError(t,this.model);if(t.status===412){return}this.dismissNetworkAlerts();this.dispatchCacheStorageMethod("get",this.options.dashletId,function n(e,t){var n=Boolean(!e&&t);i.$chartEl.toggle(n);if(!n){i.$dataUnavailableLbl.show();return}i.showLatestAvailableDataWarn(t);i.applyViewState(t);i.hidePreloader();i.processData(t.chartData)})},dispatchCacheStorageMethod:function(e){if(!this.cacheStorage){if(e==="get"){this.$chartEl.hide();this.$dataUnavailableLbl.show()}return false}var t=_.toArray(arguments).slice(1);this.cacheStorage[e].apply(this.cacheStorage,t)},processData:function(e){this.prepareChartObject();this.renderChart();this.toggleDashletSwipe()},applyViewState:function(e){this._super("applyViewState",arguments);if(!_.isUndefined(this._isInitialized)){this._isInitialized=true}},setFilters:function(e){var t=this.getState(this.options.dashboardId,this.meta.id)||{};var i=_.isEmpty(t.filters)?e:t.filters;this.viewState.filters.set(i,{silent:true})},ptrRefresh:function(){this.refreshData(true)},getViewContainer:function(){return this.$easyScrollerParent},isSwipable:function(){return _.isEmpty(this.$chartEl.find(".nv-scroll-wrap").attr("clip-path"))},dispatchChartMethod:function(e){this.chart&&this.chart.dispatch[e]()},updateChart:function(){if(_.isFunction(this.chart.update)){this.chart.update()}else{this.renderChart()}this.toggleDashletSwipe()},rerenderChart:function(){if(_.isFunction(this.chart.render)){this.chart.render()}else if(_.isFunction(this.chart.update)){this.chart.update()}else{this.renderChart()}this.toggleDashletSwipe()},getUserCurrencyFormatter:function(){var t=e.user.getPreference("currency_id");var i=e.currency.getBaseCurrencyId();return function(n){var a=e.currency.convertAmount(n,i,t);return e.currency.formatAmountLocale(a,t,0)}},getUserCurrencyFormatterSi:function(){var t=e.currency.getBaseCurrencyId();var i=e.user.getPreference("currency_id");var n=e.currency.getCurrencySymbol(i);var a=e.user.getPreference("decimal_separator");return function(o,s){var r=s||2;var l=parseFloat(e.currency.convertAmount(o,t,i));var c=d3.format(",."+r+"s")(l);return n+c.replace(".",a)}}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.ListContainerDashletView=e.view.views.BaseDashletView.extend({contextMenuOnSwipeDisabled:true,isManager:true,initialize:function(e){this._super("initialize",arguments);this.initLists(e)},initLists:function(e){this.listView=this.createList(this.meta.view,e);this.listView.setOfflineEnabled(false)},onAfterRender:function(){this._super("onAfterRender",arguments);_.each(this.getChildViews(),function(e){this.appendListView(e)},this)},appendListView:function(e){this.$el.append(e.getViewContainer())},createList:function(t,i){var n=e.view.createView(this.getListDef(t,i));this.overrideListView(n);n.render();return n},getListDef:function(e,t){var i=["planned-activities","active-tasks","inactive-tasks","history"];var n=_.contains(i,this.meta.view.type)?"user-activity-list-item":null;var a=_.extend({parentModel:t.parentModel},e,t.listParams);return{name:"configurable-list",module:e.module,layout:t.layout,listParams:a,contextMenuOnSwipeDisabled:this.contextMenuOnSwipeDisabled,listItemTpl:n}},getChildViews:function(){return[this.listView]},overrideListView:function(e){_.extend(e,{name:"list",action:"list",_buildRecordRoute:_.bind(this._buildRecordRoute,this)})},abortActiveRequests:function(){var e=this.getChildViews();var t=false;_.each(e,function(e){t=e.abortActiveRequests()||t},this);return t},bindGlobalEvents:function(){this._super("bindGlobalEvents",arguments);_.each(this.getChildViews(),function(e){e.bindGlobalEvents()})},unbindGlobalEvents:function(){this._super("unbindGlobalEvents",arguments);_.each(this.getChildViews(),function(e){e.unbindGlobalEvents()})},loadData:function(t){t=t||{};this.listView.loadData(_.extend(t,{myItems:this.viewState.myItemsOnly,fields:e.metadata.getModule(this.listView.module).mergedFields}))},updateFiltersViewState:function(t){this._super("updateFiltersViewState",arguments);var i=this.dashletParams.filter||[];if(this.meta.view.date){i.push({name:"date",type:"radioenum",options:{today:e.utils.capitalize(e.lang.get("LBL_TODAY")),future:e.utils.capitalize(e.lang.get("LBL_FUTURE"))},gaTrack:{today:"click:today",future:"click:future"}})}_.each(i,function(i){var n=this.meta.view[i.name];if(t.filters&&t.filters[i.name]){n=t.filters[i.name]}if(_.isEmpty(i.options)){i.options=e.lang.getAppListStrings(i.options)}_.extend(i,{view:"edit"});this.viewState.filters.set(i.name,n);this.viewState.filtersDef[i.name]=i},this)},refreshData:function(){var e=this.viewState;var t=this.getFilters();var i=_.map(this.getChildViews(),function(i,n){return function(){var a={myItems:e.visibility==="user",params:{forceServerSync:true}};t&&t[n]&&(a.filter=t[n]);i.refresh(a)}});this.saveState();async.parallel(i,function(e){})},getFilters:function(){},_dispose:function(){this._super("_dispose",arguments);_.each(this.getChildViews(),function(e){e.dispose()})},_buildRecordRoute:function(t){var i=this.options;var n=t.model;var a=i.parentModel;var o=e.controller.getScreenContext();var s=e.controller.layoutManager.getRootLayout()===this.layout;var r;if(o.parentDashboardId&&s){r=[e.controller.getScreenContextRoot(),n.module,n.id].join("/")}else if(i.parentModel){r=[a.module,a.id,"Dashboards",i.dashboardId,i.dashletId,n.module,n.id];if(t.hash.action){r.push(t.hash.action)}r=r.join("/")}else{r=e.view.views.ListView.prototype._buildRecordRoute.apply(this.listView,arguments)}return r}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.TabbedListContainerDashletView=e.view.views.ListContainerDashletView.extend({className:"tabbed__dashlet",dashletParams:null,_cards:null,_defaultTabStorageKey:"dashboards:{0}:dashlets:{1}:default_tab_id",_extraFields:{"planned-activities":["assigned_user_id","assigned_user_name"],"inactive-tasks":["assigned_user_id","assigned_user_name"]},globalEvents:{"app:view:change":function(e){if(e.dashletId===this.meta.id.toString()){this._gaHandler()}}},plugins:["fast-click-highlight"],initialize:function(){this._super("initialize",arguments);this._createCardsView()},initLists:function(){this.dashletParams.tabs=_.select(this.dashletParams.tabs,function(t){return e.nomad.utils.isAccessibleModule(t.module,"list")});this._cards=_.map(this.dashletParams.tabs,function(t){var i=_.pluck(e.metadata.getModule(t.module,"views").list.meta.panels[0].fields,"name");var n=this._extraFields[this.meta.view.type]||[];t.display_columns=_.union(i,n);t.filters=this.adjustFilters(t.filters);return this.getListDef(t,{layout:this.layout,contextMenuOnSwipeDisabled:this.contextMenuOnSwipeDisabled,parentModel:this.options.parentModel,listParams:{limit:this.meta.view.limit}})},this)},getListDef:function(t,i){var n=this._super("getListDef",arguments);n.listViewId=[this.options.dashboardId,this.options.dashletId,_.indexOf(this.dashletParams.tabs,t)].join("_");n.title=e.lang.get(t.label)||e.nomad.getPluralModuleName(t.module);n.loadDataFn=this._getLoadListFn(t,n);n.getViewContainer=function(){return this.getViewContainer()};return n},onAfterRender:function(){this.cardsView.render();this.$el.append(this.cardsView.$el);this._super("onAfterRender",arguments)},loadData:function(e){this.cardsView.loadData(e)},refreshData:function(){this.saveState();this.loadData({forceServerSync:true,refresh:true})},_getLoadListFn:function(t){var i=_.indexOf(this.dashletParams.tabs,t);var n=e.metadata.getModule(t.module).mergedFields;var a=this;return function(e){var o;var s;var r=a.getFilters();e=e||{};if(t.order_by){o=t.order_by.split(":");this.collection.orderBy={field:o[0],direction:o[1]}}this.collection.filterDef=r[i];s=_.extend({},e,{myItems:a.viewState.visibility==="user",fields:n,limit:a.meta.view.limit});if(e.refresh){delete s.refresh;this.refresh(s)}else{this.loadData(s)}}},_createCardsView:function(){this.cardsView=e.view.createView({name:"cards",lazyLoad:false,activeTabStorageKey:this._getDefaultTabStorageKey(),cards:this._cards});_.each(this.cardsView.getCards(),function(e){e.setOfflineEnabled(false);this._initListEvents(e);this.overrideListView(e)},this);this.cardsView.on("cards:switch",this._onTabClick,this)},_initListEvents:function(e){e.listenTo(e.collection,"sync",_.bind(this._updateTabInfo,this,e));e.listenTo(e.collection,"remove",_.bind(this._updateTabInfo,this,e))},_updateTabInfo:function(e){var t=e.collection;var i=e.collection.length;var n=this.cardsView.getCardIndexByView(e);if(!(t.next_offset===-1||_.isUndefined(t.next_offset))){i+="+"}this.cardsView.updateSwitcherSubtitle(n,i)},_onTabClick:function(){this.saveState();this._gaHandler()},adjustFilters:function(e){var t=new Date;t.setHours(23,59,59);t.toISOString();if(e.date_due){_.each(e.date_due,function(i,n){if(i==="today"){e.date_due[n]=t}})}return e},getFilters:function(){this._super("getFilters",arguments);var t=[];_.each(this.dashletParams.tabs,function(i,n){var a=t[n]=[];Array.prototype.push.apply(a,this._getCollectionFilters(i));_.each(this.viewState.filters.attributes,function(t,i){var o={};var s;var r=parseInt(t,10);if(isNaN(r)){r=0}s=e.date().subtract("days",r).format("YYYY-MM-DD");o[this.dashletParams.tabs[n].filter_applied_to]=i==="date"&&t==="today"?{$lte:s}:{$gt:s};a.push(o)},this)},this);return t},_getCollectionFilters:function(t){var i=[];_.each(t.filters,function(e,t){var n={};n[t]=e;i.push(n)});if((t.module==="Meetings"||t.module==="Calls")&&this.viewState.visibility==="user"){i.push({$or:[{assigned_user_id:e.user.id},{"users.id":e.user.id}]})}return i},_getDefaultTabStorageKey:function(){return e.utils.formatString(this._defaultTabStorageKey,[this.options.dashboardId,this.meta.view.type])},getChildViews:function(){return[this.cardsView]},appendListView:function(){},_gaHandler:function(){if(!e.config.analytics.enabled){return}var t=this.cardsView.activeIndex;var i=this.meta.view.type;var n;var a=this.options&&this.options.parentModel?this.options.parentModel.module:null;var o=a?["record-dashlet",a,i]:["dashlet",i];switch(i){case"casessummary":case"inactive-tasks":case"active-tasks":n=t;break;default:n=this.dashletParams.tabs[t].module;break}o.push(n);e.analytics.setActiveView(o.join("/"))}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.ForecastChartView=e.view.views.BaseChartView.extend({forecastBy:"Opportunities",initialize:function(){if(e.nomad.utils.isModuleVisible("RevenueLineItems")){this.forecastBy="RevenueLineItems"}this._super("initialize",arguments)}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.ForecastParetoView=e.view.views.ForecastChartView.extend({_isInitialized:false,isForecastSetup:false,isForecastConfigValid:false,forecastsNotSetUpMsg:"",$groupByFilter:null,events:function(){var t=e.view.views.BaseChartView.prototype.events;return _.extend({},t,{"click .lnk-non-forecast":function(t){t.preventDefault();e.nomad.openUrl(t.target.href)}})},initialize:function(t){this._super("initialize",[t]);this.forecastConfig=e.metadata.getModule("Forecasts","config");this.isForecastSetup=this.forecastConfig.is_setup;this.isForecastsConfigValid=e.nomad.utils.isForecastConfigValid();this.showManagerData=false;if(this.isForecastSetup){this.dashletConfig=e.metadata.getView(null,"forecast-pareto");if(_.isString(this.dashletConfig.dataset.options)&&_.isString(this.dashletConfig.group_by.options)){var i=e.lang.getAppListStrings(this.dashletConfig.dataset.options);this.dashletConfig.group_by.options=e.lang.getAppListStrings(this.dashletConfig.group_by.options);this.dashletConfig.dataset.options={};if(this.forecastConfig.show_worksheet_worst&&e.acl.hasAccess("read",this.forecastBy,e.user.get("id"),"worst_case")){this.dashletConfig.dataset.options.worst=i.worst}if(this.forecastConfig.show_worksheet_likely&&e.acl.hasAccess("read",this.forecastBy,e.user.get("id"),"likely_case")){this.dashletConfig.dataset.options.likely=i.likely}if(this.forecastConfig.show_worksheet_best&&e.acl.hasAccess("read",this.forecastBy,e.user.get("id"),"best_case")){this.dashletConfig.dataset.options.best=i.best}}}else{var n=_.isUndefined(e.user.getAcls().Forecasts.admin);this.forecastsNotSetUpMsg=e.nomad.utils.getForecastNotSetUpMessage(n)}},refreshData:function(e){if(this.previousVisibilityState!==this.viewState.visibility){this.previousVisibilityState=this.viewState.visibility;this._super("refreshData");if(this.$groupByFilter){this.$groupByFilter.toggle()}}else if(e){this._super("refreshData",arguments)}else if(this._serverData){this.saveState();this.renderChart()}},loadData:function t(){if(this.isForecastSetup){this._super("loadData",arguments)}else{this.hidePreloader()}},processData:function(e){this._serverData=e;if(this._serverData){this._super("processData",arguments)}},loadInitData:function i(t){var i=this;function n(e){i.initForecast(e);t(null,e)}this.apiCall("GET",e.api.buildURL("Forecasts/init"),null,{success:function a(e){var t=i.options.parentModel;if(t){t.once("sync",function(){n(e)}).fetch()}else{n(e)}},error:t})},loadChartData:function n(t){var i={};var n;i.no_data=this.viewState.filters.get("no_data")===true;if(this.isManager){i.target_quota=this.viewState.filters.get("show_target_quota")?1:0}n=e.api.buildURL(this.buildChartUrl(),null,null,i);this.apiCall("read",n,{},e.nomad.utils.wrapAsyncCallback(t))},initForecast:function(t){var i={user_id:e.user.get("id"),show_target_quota:false,selectedTimePeriod:t.defaultSelections.timeperiod_id.id,timeperiod_id:t.defaultSelections.timeperiod_id.id,timeperiod_label:t.defaultSelections.timeperiod_id.label,dataset:t.defaultSelections.dataset,group_by:t.defaultSelections.group_by,ranges:_.keys(e.lang.getAppListStrings(this.forecastConfig.buckets_dom))};this._isInitialized=true;this.viewState.filtersDef={group_by:this.dashletConfig.group_by,dataset:this.dashletConfig.dataset};this.previousVisibilityState=this.viewState.visibility;this.setFilters(i);this.render()},prepareChartObject:function(){var t=this.getUserCurrencyFormatter();var i=this.getUserCurrencyFormatterSi();this.chartId=this.cid+"_chart";this.chart=nv.models.paretoChart().margin({top:0,right:10,bottom:0,left:10}).showTitle(false).tooltips(true).tooltipQuota(function(e,i,n,a,o){return"<p><b>"+a.key+": <b>"+t(a.val)+"</b></p>"}).tooltipLine(function(i,n,a,o,s){return"<p><b>"+e.lang.get("LBL_CUMULATIVE_TOTAL","Forecasts")+"</b></p><p>"+i+": <b>"+t(o.point.y)+"</b></p>"}).tooltipBar(_.bind(function(i,n,a,o,s){var r=e.lang.get("LBL_SALES_STAGE","Forecasts");if(this.viewState.filters.get("group_by")==="probability"){r=e.lang.get("LBL_OW_PROBABILITY","Forecasts")+" (%)"}return"<p>"+r+": <b>"+i+"</b></p>"+"<p>"+e.lang.get("LBL_AMOUNT","Forecasts")+": <b>"+t(o.value)+"</b></p>"+"<p>"+e.lang.get("LBL_PERCENT","Forecasts")+": <b>"+n+"%</b></p>"},this)).colorData("default").colorFill("default").yAxisTickFormat(function(e){return i(e,2)}).quotaTickFormat(function(e){return i(e,3)}).barClick(function(e,t,i,n){return}).id(this.chartId).strings({legend:{close:e.lang.getAppString("LBL_CHART_LEGEND_CLOSE"),open:e.lang.getAppString("LBL_CHART_LEGEND_OPEN")},noData:e.lang.getAppString("LBL_CHART_NO_DATA")})},renderChart:function(){if(this.isManager&&this.viewState.visibility==="group"){this.showManagerData=true;this.convertManagerDataToChartData()}else{this.showManagerData=false;this.convertUserDataToChartData()}this.generateD3Chart()},convertUserDataToChartData:function(){_.each(this._serverData.data,function(e){if(_.has(e,"likely")&&isNaN(e.likely)){e.likely=0}if(_.has(e,"best")&&isNaN(e.best)){e.best=0}if(_.has(e,"worst")&&isNaN(e.worst)){e.worst=0}});var t=this.viewState.filters.get("group_by");var i=this.viewState.filters.get("dataset");var n=this.viewState.filters.get("ranges");var a=0;var o=[];var s=this._serverData["x-axis"].map(function(e,t){return{series:a,x:t+1,y:0}});var r={key:this._serverData.labels.dataset[i],type:"line",series:a,values:[],valuesOrig:[]};var l={properties:{name:this._serverData.title,quota:parseFloat(this._serverData.quota),quotaLabel:e.lang.get("LBL_QUOTA","Forecasts"),groupData:this._serverData["x-axis"].map(function(e,t){return{group:t,l:e.label,t:0}})},data:[]};var c=this._serverData.data;var d=!_.isEmpty(n)?c.filter(function(e){return _.contains(n,e.forecast)}):c;_.each(this._serverData.labels[t],function(n,r){var c=d.filter(function(e){return e[t]==r});if(!_.isEmpty(c)){var u=this._serverData["x-axis"].map(function(e,t){return{series:a,x:t+1,y:0,y0:0}});var f=this._serverData["x-axis"];_.each(c,function(e){for(var t=0;t<f.length;t++){if(e.date_closed_timestamp>=f[t].start_timestamp&&e.date_closed_timestamp<=f[t].end_timestamp){var n=parseFloat(e[i]);u[t].y+=n;l.properties.groupData[t].t+=n;s[t].y+=n;break}}},this);o.push({key:n,series:a,type:"bar",values:u,valuesOrig:e.utils.deepCopy(u)});a++}},this);if(!_.isEmpty(o)){var u=0;_.each(s,function(e,t,i){i[t].y+=u;u=i[t].y});r.values=s;r.valuesOrig=e.utils.deepCopy(s);o.push(r);l.data=o}this.chartData=l},convertManagerDataToChartData:function(){var t=this.viewState.filters.get("dataset");var i=this._serverData.data;var n={properties:{name:this._serverData.title,quota:parseFloat(this._serverData.quota),quotaLabel:e.lang.get(this.viewState.filters.get("show_target_quota")?"LBL_QUOTA_ADJUSTED":"LBL_QUOTA","Forecasts"),groupData:i.map(function(e,i){return{group:i,l:e.name,t:parseFloat(e[t])+parseFloat(e[t+"_adjusted"])}})},data:[]};var a=[t,t+"_adjusted"].map(function(e,t){var n=i.map(function(i,n){return{series:t,x:n+1,y:parseFloat(i[e]),y0:0}});return{key:this._serverData.labels.dataset[e],series:t,type:"bar",values:n,valuesOrig:n}},this);var o=[t,t+"_adjusted"].map(function(e,t){var n=i.map(function(i,n){return{series:t,x:n+1,y:parseFloat(i[e])}});var a=0;_.each(n,function(e,t,i){i[t].y+=a;a=i[t].y});return{key:this._serverData.labels.dataset[e],series:t,type:"line",values:n,valuesOrig:n}},this);if(this.viewState.filters.get("show_target_quota")){n.properties.targetQuota=+this._serverData.target_quota;n.properties.targetQuotaLabel=e.lang.get("LBL_QUOTA","Forecasts")}n.data=a.concat(o);this.chartData=n},generateD3Chart:function(){if(!this._super("renderChart"))return;this.chart.barLegend.rowsCount(this._maxLegendRows);this.chart.lineLegend.rowsCount(this._maxLegendRows);this.chart.stacked(!this.showManagerData);d3.select(this.el).select(".nv-pareto").append("svg").datum(this.chartData).call(this.chart)},_onOrientationChange:function(){if(this.chart){if(this.chart.barLegend){this.chart.barLegend.rowsCount(this._maxLegendRows);

}if(this.chart.lineLegend){this.chart.lineLegend.rowsCount(this._maxLegendRows)}this.dispatchChartMethod("tooltipHide");this.rerenderChart()}},buildChartUrl:function(){var e=this.options.parentModel;var t=e&&e.get("date_closed_timestamp");var i=t||this.viewState.filters.get("timeperiod_id");var n=[this.viewState.visibility==="group"?"ForecastManagerWorksheets":"ForecastWorksheets","chart",i,this.viewState.filters.get("user_id")];return n.join("/")},onAfterRender:function(){this._super("onAfterRender",arguments);this.$groupByFilter=this.$(".filter.group_by");if(this.viewState.visibility==="group"){this.$groupByFilter.hide()}}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.BubblechartView=e.view.views.ForecastChartView.extend({params:null,likelyField:"",filterDuration:null,responseDataAttr:"records",initialize:function(t){this._super("initialize",[t]);var i=["id","name","account_name","base_rate","currency_id","assigned_user_name","date_closed","probability","account_id","sales_stage","commit_stage"];var n;this.dashletConfig=e.metadata.getView(null,"bubblechart");this.filterDuration=this.dashletConfig.filter_duration[0];this.setFilterDurationOptions();this.viewState.filtersDef.filter_duration=this.filterDuration;this.likelyField=this.forecastBy==="Opportunities"?"amount":"likely_case";i.push(this.likelyField);n=this.likelyField+":desc";this.params={fields:i.join(","),max_num:10,order_by:n};this.tooltiptemplate=e.template.getView("bubblechart-tooltip");this.setFilters({filter_duration:_.keys(this.viewState.filtersDef.filter_duration.options)[0]})},setFilterDurationOptions:function(){if(!_.isString(this.filterDuration.options)){return false}this.filterDuration.options=e.lang.getAppListStrings(this.filterDuration.options);if(_.isEmpty(this.filterDuration.options)){this.filterDuration.options=e.lang.getAppListStrings("generic_timeperiod_options")}},loadChartData:function t(i){this.setDateRange();var n=[{date_closed:{$gte:this.dateRange.begin}},{date_closed:{$lte:this.dateRange.end}}];if(!this.isManager||this.viewState.visibility==="user"){n.push({$owner:""})}var a=_.extend({filter:n},this.params);var o=e.api.buildURL(this.forecastBy,null,null,a,this.params);this.apiCall("read",o,null,e.nomad.utils.wrapAsyncCallback(i))},processData:function(e){this.evaluateResult(e);if(!_.isEmpty(e.records)){this._super("processData",arguments)}this.$chartEl.toggle(!_.isEmpty(e.records));this.$dataUnavailableLbl.toggle(_.isEmpty(e.records))},prepareChartObject:function(){var t=this;this.chart=nv.models.bubbleChart().x(function(e){return d3.time.format("%Y-%m-%d").parse(e.x)}).y(function(e){return e.y}).tooltipContent(function(e,i,n,a,o){a.point.close_date=d3.time.format("%x")(d3.time.format("%Y-%m-%d").parse(a.point.x));a.point.amount=a.point.currency_symbol+d3.format(",.2d")(a.point.base_amount);return t.tooltiptemplate(a.point).replace(/(\r\n|\n|\r)/gm,"")}).showTitle(false).tooltips(true).showLegend(true).bubbleClick(function(i){e.router.navigate(e.router.buildRoute(t.forecastBy,i.point.id),{trigger:true})}).colorData("class",{step:2}).groupBy(function(e){return t.isManager&&t.viewState.visibility==="user"?e.sales_stage_short:e.assigned_user_name}).filterBy(function(e){return e.probability}).strings({legend:{close:e.lang.getAppString("LBL_CHART_LEGEND_CLOSE"),open:e.lang.getAppString("LBL_CHART_LEGEND_OPEN")},noData:e.lang.getAppString("LBL_CHART_NO_DATA")})},renderChart:function(){if(!this._super("renderChart"))return;this.chart.legend.rowsCount(this._maxLegendRows);d3.select(this.el).select(".nv-chart-bubble").append("svg").datum(this.chartData).transition().duration(500).call(this.chart)},evaluateResult:function(t){this.total=t.records.length;var i="sales_stage_dom";var n=e.metadata.getModule(this.forecastBy,"fields");if(n){i=n.sales_stage.options||i}this.chartData={data:t.records.map(function(t){var n=e.lang.getAppListStrings(i)[t.sales_stage]||t.sales_stage;return{id:t.id,x:t.date_closed,y:Math.round(parseInt(t[this.likelyField],10)/parseFloat(t.base_rate)),shape:"circle",account_name:t.account_name,assigned_user_name:t.assigned_user_name,sales_stage:n,sales_stage_short:n,probability:parseInt(t.probability,10),base_amount:parseInt(t[this.likelyField],10),currency_symbol:e.currency.getCurrencySymbol(t.currency_id)}},this),properties:{title:e.lang.getAppString("LBL_DASHLET_TOP10_SALES_OPPORTUNITIES_NAME"),value:t.records.length}}},setDateRange:function(){var t=e.date();var i=this.getDateRangeDuration();var n;var a;var o;if(i===12){n=e.date().startOf("year");a=e.date().endOf("year")}else{o=Math.floor(t.month()/3)*3;n=e.date(new Date(t.year(),o+i,1));a=e.date(new Date(n.year(),n.month()+3,0))}this.dateRange={begin:n.format("YYYY-MM-DD"),end:a.format("YYYY-MM-DD")}},getDateRangeDuration:function(){var e=parseInt(this.viewState.filters.get("filter_duration"),10);var t={current:0,next:3,year:12};if(isNaN(e)){e=t[this.viewState.filters.get("filter_duration")]}return e}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.ForecastPipelineView=e.view.views.ForecastChartView.extend({_isInitialized:false,forecastAdmin:false,forecastConfig:null,isForecastSetup:false,isForecastsConfigValid:false,forecastsNotSetUpMsg:null,initialize:function(t){this._super("initialize",[t]);this.forecastConfig=e.metadata.getModule("Forecasts","config");this.isForecastSetup=this.forecastConfig.is_setup;this.isForecastsConfigValid=e.nomad.utils.isForecastConfigValid();this.forecastAdmin=_.isUndefined(e.user.getAcls().Forecasts.admin);this.salesStageLabels=e.lang.getAppListStrings("sales_stage_dom");if(!this.isForecastSetup){if(_.isEmpty(e.metadata.getModule("Forecasts").views)){this.forecastsNotSetUpMsg=e.nomad.utils.getForecastNotSetUpMessage(this.forecastAdmin)}else{this.viewState.filtersDef.timeperiod=e.utils.deepCopy(e.metadata.getModule("Forecasts").views["forecast-pipeline"].meta.timeperiod[0]);this.viewState.filtersDef.timeperiod.options=e.lang.getAppListStrings("generic_timeperiod_options");this.setFilters({selectedTimePeriod:this.viewState.filtersDef.timeperiod.options[0]});this._isInitialized=true}}},loadData:function t(){var t=!e.acl.hasAccess("view","Opportunities");var i=!_.contains(e.metadata.getModuleNames({filter:"visible"}),"RevenueLineItems");if(t&&i){this.loadDataError(this.ERR_NO_DATA_AVAILABLE)}else if(this.forecastsNotSetUpMsg){this.hidePreloader()}else{this._super("loadData",arguments)}},loadInitData:function i(t){var i=this;async.parallel({loadTimeperiodOptions:function n(t){i.apiCall("read",e.api.buildURL("Forecasts/enum/selectedTimePeriod"),null,e.nomad.utils.wrapAsyncCallback(t))},loadCurrentTimeperiod:function a(t){i.apiCall("GET",e.api.buildURL("TimePeriods/current"),null,e.nomad.utils.wrapAsyncCallback(t))}},function o(n,a){if(n){t.apply(this,arguments);return}i.viewState.filtersDef.timeperiod=e.utils.deepCopy(e.metadata.getModule("Forecasts").views["forecast-pipeline"].meta.timeperiod[0]);i.viewState.filtersDef.timeperiod.options=a.loadTimeperiodOptions;i.setFilters({selectedTimePeriod:a.loadCurrentTimeperiod.id});i._isInitialized=true;i.render();t(null,a)})},loadChartData:function n(t){var i=[this.forecastBy,"chart","pipeline"];var n;i.push(this.viewState.filters.get("selectedTimePeriod"));i.push(this.viewState.visibility);n=e.api.buildURL(i.join("/"));this.apiCall("GET",n,null,e.nomad.utils.wrapAsyncCallback(t))},processData:function(e){if(e&&e.data&&this.salesStageLabels){_.each(e.data,function(e){if(e&&e.key&&this.salesStageLabels[e.key]){e.key=this.salesStageLabels[e.key]}},this)}this.chartData=e;this._super("processData",arguments)},prepareChartObject:function(){var t=this;var i=this.getUserCurrencyFormatter();this.chart=nv.models.funnelChart().showTitle(false).tooltips(true).wrapLabels(false).tooltipContent(function(e,t,n,a,o){return"<p>"+SUGAR.App.lang.get("LBL_SALES_STAGE","Forecasts")+": <b>"+e+"</b></p>"+"<p>"+SUGAR.App.lang.get("LBL_AMOUNT","Forecasts")+": <b>"+i(n)+"</b></p>"+"<p>"+SUGAR.App.lang.get("LBL_PERCENT","Forecasts")+": <b>"+t+"%</b></p>"}).colorData("class",{step:2}).fmtValueLabel(function(e){var t=e.value||(isNaN(e)?0:e);return i(t)}).strings({legend:{close:e.lang.getAppString("LBL_CHART_LEGEND_CLOSE"),open:e.lang.getAppString("LBL_CHART_LEGEND_OPEN")},noData:e.lang.getAppString("LBL_CHART_NO_DATA")})},renderChart:function(){if(!this._super("renderChart"))return;this.chart.legend.rowsCount(this._maxLegendRows);d3.select(this.el).select(".nv-funnelChart").append("svg").datum(this.chartData).transition().duration(500).call(this.chart)}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.ActivitystreamDashletView=e.view.views.ListContainerDashletView.extend({events:{"click .panel__addpost":"onAddPost"},plugins:["refresh-timeago","create-post"],basicMenuActions:[{name:"comment",label:"LBL_COMMENT",icon:"icon-comment",isEnabled:function(){return true},action:"onCreateCommentItem"}],createList:function(e,t){if(t.parentModel){t.listParams=_.extend({link:"activities"},t.listParams)}return this._super("createList",arguments)},_getFilterDefFromMeta:function(t){var i;if(t){var n=e.metadata.getModule("Activities");if(_.isObject(n)){_.isObject(n.filters)&&_.each(n.filters,function(e){_.isObject(e.meta)&&_.each(e.meta.filters,function(e){if(e.id===t){i=e}})})}}return i},overrideListView:function(t){this._super("overrideListView",arguments);var i=this;t.template=e.template.get("activity-list");t.contextMenuActions=this.basicMenuActions;t.onCreateCommentItem=function(n,a){if(e.routing.emulateBackButton){t.hideContextMenu(t.activeListItem,true)}_.defer(function(){var e=_.find(i._commentsViews,function(e){return e.options.parentModel.id===a.id});e.onCreateCommentItem(n,a)})};t.getListItemTpl=function(e){var t=e.get("activity_type");return t==="post"?"activity-"+t:"activity-item"};t.listenTo(t.collection,"add",_.bind(this.onItemAdded,this));t.listenTo(t.collection,"data:sync:start",_.bind(this.removeTimeago,this));t.listenTo(t.collection,"data:sync:complete",_.bind(this.onCollectionSync,this));var n=this._getFilterDefFromMeta(this.meta.view.currentFilterId);if(n){t.collection.filterDef=n.filter_definition}},onItemAdded:function(e,t){var i;t.each(function(t,n){if(t.id===e.id){i=n;return}});this.createCommentsView(e,i)},onCollectionSync:function(){this.refreshTimeago();this.initComments()},initComments:function(){this.resetCommentsViews();this.listView.collection.each(_.bind(this.createCommentsView,this));_.each(this._commentsViews,function(e){this.listenTo(e,"view:after:render",this.listReflowScroll,this)},this);this.listView.scrollReflow()},listReflowScroll:function(){this.listView.scrollReflow()},createCommentsView:function(t,i){this.$(".activitystream-item").eq(i).append('<div class="clip comments-container"></div>');var n=this.$(".comments-container").eq(i);var a=e.view.createView({name:"list",module:"Comments",parentModel:t,el:n,layout:this.layout});a.render();a.bindGlobalEvents();this._commentsViews.push(a)},resetCommentsViews:function(){_.each(this._commentsViews,function(e){this.stopListening(e,"view:after:render",this.listReflowScroll);delete this._listeners[e._listenerId];e.dispose()},this);this._commentsViews=[]},onAddPost:function(){var t=e.data.createBean("Activities");var i=this.listView.context.get("parentModule");var n=["activity_type","data"];var a=this;var o;if(i){o=this.listView.options.listParams.parentModel;t.set({parent_id:o.id,parent_type:i});n.push("parent_id","parent_type")}this.createPost(t,{appendTo:"root",savePost:function(e){t.save(null,{fields:n,params:{skipOfflineRead:true},success:function(t){a.listView.collection.unshift(t);a.listView.render();e(null,t)},error:e})}})},_dispose:function(){this.resetCommentsViews();this._super("_dispose",arguments)}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.SavedReportsChartView=e.view.views.BaseChartView.extend({responseDataAttr:"chartData",initialize:function(e){this._super("initialize",arguments);this.chartId=Math.floor(Math.random()*1e4)},loadChartData:function t(i){var n=this.meta.view.saved_report_id;this.apiCall("create",e.api.buildURL("Reports/chart/"+n),null,e.nomad.utils.wrapAsyncCallback(i))},isDataEmpty:function(e){if(this._super("isDataEmpty",arguments)){return true}var t=e.chartData.properties[0].type;var i=this.getChartConfig(t);var n=this._getDataAttribute(i);return _.isEmpty(e.chartData[n])},processData:function(e){if(e&&e.chartData){this.rawChartData=e.chartData}this._super("processData",arguments)},prepareChartObject:function(){var t=this.rawChartData;var i={minColumnWidth:120,show_title:true,show_legend:true,show_controls:false,show_tooltips:true,show_y_label:false,y_axis_label:"",show_x_label:false,x_axis_label:"",wrapTicks:true,staggerTicks:true,rotateTicks:true,reduceXTicks:false,overflowHandler:false,allowScroll:false,vertical:true,showValues:false,hideEmptyGroups:true,stacked:true,colorData:"default",margin:{top:10,right:10,bottom:10,left:10}};var n=t.properties[0].type;if(e.supportedFeatures.configurableSavedReportsChart){_.extend(i,this.meta.view);n=this.meta.view.chart_type}var a=this.getChartConfig(n);this.chartData=this.translateDataToD3(t,i,a);this.chart=this.getChartModel(i,a);this.chart.id(this.chartId).margin(i.margin).showTitle(i.show_title).showLegend(i.show_legend).tooltips(i.show_tooltips).tooltipContent(function(e,t,i,n,a){return"<h3>"+e+"</h3>"+"<p>"+i+"</p>"}).colorData(i.colorData).strings({legend:{close:e.lang.get("LBL_CHART_LEGEND_CLOSE"),open:e.lang.get("LBL_CHART_LEGEND_OPEN")},noData:e.lang.get("LBL_CHART_NO_DATA")});if(a.ReportModule){this.chart.legend.showAll(true)}},renderChart:function(){if(!this._super("renderChart"))return;this.chart.legend.rowsCount(this._maxLegendRows);d3.select(this.el).select(".nv-chart-reports").append("svg").datum(this.chartData).transition().duration(500).call(this.chart);this.$el.on("touchcancel",function(e){var t=d3.select(window);_.each(_.keys(window),function(e){var i=e.match(/^__on((?:touch|drag|select).+)$/);i&&t.on(i[1],null)})})},getChartModel:function(e,t){var i;switch(t.chartType){case"pieChart":i=nv.models.pieChart();break;case"funnelChart":i=nv.models.funnelChart();break;case"lineChart":i=nv.models.lineChart();i.useVoronoi(true).clipEdge(false).wrapTicks(e.wrapTicks).staggerTicks(e.staggerTicks).rotateTicks(e.rotateTicks);if(e.show_x_label){i.xAxis.axisLabel(e.x_axis_label)}if(e.show_y_label){i.yAxis.axisLabel(e.y_axis_label)}var n=[];var a=function(e){return e};var o=function(e){return e[0]};var s=function(e){return e[1]};if(this.chartData.data.length){if(this.chartData.properties.labels){n=this.chartData.properties.labels.map(function(e){return e.l||e})}if(this.chartData.data[0].values.length&&this.chartData.data[0].values[0]instanceof Array){if(nv.utils.isValidDate(this.chartData.data[0].values[0][0])){a=function(e){return d3.time.format("%x")(new Date(e))}}else if(n.length>0){a=function(e){return n[e]||" "}}}else{o=function(e){return e.x};s=function(e){return e.y};if(n.length>0){a=function(e){return n[e-1]||" "}}}}i.x(o).y(s);i.xAxis.tickFormat(a).highlightZero(false).reduceXTicks(false);break;case"barChart":i=nv.models.multiBarChart().vertical(t.orientation==="vertical"?true:false).stacked(t.barType==="stacked"?true:true).showControls(e.show_controls).showValues(e.showValues).wrapTicks(e.wrapTicks).staggerTicks(e.staggerTicks).rotateTicks(e.rotateTicks).reduceXTicks(e.reduceXTicks);i.yAxis.tickSize(0);if(e.show_x_label){i.xAxis.axisLabel(e.x_axis_label)}if(e.show_y_label){i.yAxis.axisLabel(e.y_axis_label)}break;default:i=nv.models.multiBarChart();break}return i},getChartConfig:function(e){var t;switch(e){case"pie chart":t={pieType:"basic",tip:"name",chartType:"pieChart"};break;case"line chart":t={lineType:"basic",tip:"name",chartType:"lineChart"};break;case"funnel chart 3D":t={lineType:"basic",tip:"name",chartType:"funnelChart"};break;case"stacked group by chart":t={orientation:"vertical",barType:"stacked",tip:"title",chartType:"barChart"};break;case"group by chart":t={orientation:"vertical",barType:"grouped",tip:"name",chartType:"barChart"};break;case"bar chart":t={orientation:"vertical",barType:"basic",tip:"label",chartType:"barChart"};break;case"horizontal group by chart":t={orientation:"horizontal",barType:"stacked",tip:"name",chartType:"barChart"};break;case"horizontal bar chart":case"horizontal":t={orientation:"horizontal",barType:"basic",tip:"label",chartType:"barChart"};break;default:t={orientation:"vertical",barType:"stacked",tip:"name",chartType:"barChart"};break}this.chartType=t.chartType;return t},translateDataToD3:function(t,i,n){var a=[];var o=0;var s=e.lang.get("LBL_CHART_UNDEFINED");var r=this._getDataAttribute(n);var l=t[r];var c;function d(e){return e.reduce(function(e,t){return parseFloat(e)+parseFloat(t)},0)}function u(e){var t=[].concat(e)[0];return t?t:s}if(t.values.filter(function(e){return e.values&&e.values.length}).length){switch(n.chartType){case"barChart":c=n.barType==="stacked"||n.barType==="grouped"?function(e,i){return{key:u(e),type:"bar",values:t.values.map(function(e,t){return{series:i,x:t+1,y:parseFloat(e.values[i])||0,y0:0}})}}:function(e,i){return{key:e.values.length>1?e.label:u(e.label),type:"bar",values:t.values.map(function(e,t){return{series:i,x:t+1,y:i===t?d(e.values):0,y0:0}})}};break;case"pieChart":c=function(e,t){return{key:u(e.label),value:d(e.values)}};break;case"funnelChart":l=t[r].reverse();c=function(e,t){return{key:u(e.label),values:[{series:t,label:e.valuelabels[0]?e.valuelabels[0]:e.values[0],x:0,y:d(e.values),y0:0}]}};break;case"lineChart":var f=d3.max(t.values,function(e){return e.values.length})===1;c=function(e,t){return{key:u(e.label),values:f?e.values.map(function(e,i){return[t,parseFloat(e)]}):e.values.map(function(e,t){return[t,parseFloat(e)]})}};break}}if(c){a=l.map(c)}return{properties:{title:this.meta.view.report_title,labels:n.chartType==="lineChart"&&t.label?t.label.map(function(e,t){return{group:t+1,l:u(e)}}):t.values.filter(function(e){return e.values.length}).length?t.values.map(function(e,t){return{group:t+1,l:u(e.label)}}):[],values:n.chartType==="gaugeChart"?[{group:1,t:o}]:t.values.filter(function(e){return e.values.length}).length?t.values.map(function(e,t){return{group:t+1,t:d(e.values)}}):[]},data:a}},_getDataAttribute:function(e){var t;switch(e.chartType){case"barChart":t=e.barType==="stacked"||e.barType==="grouped"?"label":"values";break;default:t="values";break}return t}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.ForecastdetailsView=e.view.views.ForecastChartView.extend({className:"chart-wrapper has-scroll",forecastConfig:null,isForecastSetup:false,isForecastsConfigValid:false,forecastsNotSetUpMsg:false,isAdmin:false,isTopLevelManager:false,showTargetQuota:false,spanCSS:"",detailsDataSet:null,responseDataAttr:null,initialize:function(t){this._super("initialize",[t]);this.forecastConfig=e.metadata.getModule("Forecasts","config");this.isForecastSetup=this.forecastConfig.is_setup;this.isForecastsConfigValid=e.nomad.utils.isForecastConfigValid();this.isAdmin=_.isUndefined(e.user.getAcls().Forecasts.admin);if(this.isForecastSetup){this.serverData=e.data.createBean("Forecasts");this.model=e.data.createBean("Forecasts");var i=this.forecastBy==="RevenueLineItems"?"likely_case":"amount";this.fieldDataAccess={likely:e.acl.hasAccess("read",this.forecastBy,e.user.get("id"),i),best:e.acl.hasAccess("read",this.forecastBy,e.user.get("id"),"best_case"),worst:e.acl.hasAccess("read",this.forecastBy,e.user.get("id"),"worst_case")};this.spanCSS=_.compact([this.forecastConfig.show_worksheet_likely,this.forecastConfig.show_worksheet_best,this.forecastConfig.show_worksheet_worst]).length;this.spanCSS=_.compact([this.forecastConfig.show_worksheet_likely,this.forecastConfig.show_worksheet_best,this.forecastConfig.show_worksheet_worst]).length;this.model.set({opportunities:0,spanCSS:this.spanCSS,isForecastSetup:this.isForecastSetup,isForecastAdmin:this.isForecastAdmin});this.isTopLevelManager=e.user.get("is_top_level_manager");this.showTargetQuota=this.isManager&&!this.isTopLevelManager;this.detailsDataSet=this.getDetailsDataSet()}else{this.forecastsNotSetUpMsg=e.nomad.utils.getForecastNotSetUpMessage(this.isAdmin)}},onAfterRender:function(){this._super("onAfterRender",arguments);this.$chartEl=this.$(".fd__wrapper")},loadData:function t(e){if(this.isForecastSetup){this._super("loadData",arguments)}else{this.hidePreloader()}if(!this.loaded&&!e){this.$chartEl.hide()}},loadInitData:function i(t){var i=this;var n=this.options.parentModel;var a;if(n&&!n.inSync){n.once("sync",function(){i.loadInitData(t)}).fetch();return}a=n&&n.get("date_closed")||"current";async.parallel({loadTimeperiodOptions:function o(t){i.apiCall("read",e.api.buildURL("Forecasts/enum/selectedTimePeriod"),null,e.nomad.utils.wrapAsyncCallback(t))},loadCurrentTimeperiod:function s(t){i.apiCall("GET",e.api.buildURL("TimePeriods/"+a),null,e.nomad.utils.wrapAsyncCallback(t))}},function r(n,a){if(n){t.apply(this,arguments);return}i.viewState.filtersDef.timeperiod=e.metadata.getView(null,"forecastdetails").timeperiod[0];i.viewState.filtersDef.timeperiod.options=a.loadTimeperiodOptions;i.setFilters({timePeriods:a.loadCurrentTimeperiod.id,selectedTimePeriod:a.loadCurrentTimeperiod.id});i._isInitialized=true;t(null,a)})},loadChartData:function(t){var i=this.buildChartUrl();this.apiCall("read",i,null,e.nomad.utils.wrapAsyncCallback(t))},processData:function(e){e=this.adjustDashletData(e);this.calculateData(e);this.render();this.renderCSSChanges();this.hidePreloader();this.$chartEl.show()},getDetailsDataSet:function(){var t=e.metadata.getStrings("app_list_strings").forecasts_options_dataset||[];var i={};_.each(t,function(e,t){if(this.forecastConfig["show_worksheet_"+t]===1){i[t]=e}},this);return i},buildChartUrl:function(){var t=this.isManager?"progressManager":"progressRep";var i=["Forecasts",this.viewState.filters.get("selectedTimePeriod"),t,e.user.get("id")];var n={};if(this.isManager){n={target_quota:this.showTargetQuota?1:0}}return e.api.buildURL(i.join("/"),"create",null,n)},adjustDashletData:function(e){if(this.isManager){e.likely=e.likely_adjusted||e.likely_case;e.best=e.best_adjusted||e.best_case;e.worst=e.worst_adjusted||e.worst_case}else{e.likely=e.amount;e.best=e.best_case;e.worst=e.worst_case;e.closed_amount=e.won_amount;if(_.isUndefined(e.closed_amount)){delete e.closed_amount}}return e},calculateData:function(t){this.serverData.set(t);var i=_.extend({},t,this.serverData.toJSON());var n=this.forecastConfig;var a=e.user.getPreference("currency_id");this.likelyTotal=i.likely;this.bestTotal=i.best;this.worstTotal=i.worst;i.quota_amount_str=e.currency.formatAmountLocale(i.quota_amount,a);i.closed_amount_str=e.currency.formatAmountLocale(i.closed_amount,a);if(this.showTargetQuota){i.target_quota_amount_str=e.currency.formatAmountLocale(i.target_quota_amount,a)}else{this.serverData.unset("target_quota_amount_str")}i.showTargetQuota=this.showTargetQuota;i.deficit_amount=Math.abs(e.math.sub(i.quota_amount,i.closed_amount));i.deficit_amount_str=e.currency.formatAmountLocale(i.deficit_amount,a);i.is_deficit=parseFloat(i.quota_amount)>parseFloat(i.closed_amount);var o=i.is_deficit?"LBL_FORECAST_DETAILS_DEFICIT":"LBL_FORECAST_DETAILS_SURPLUS";i.deficit_label=e.lang.get(o,"Forecasts");i.detailsOpts=[];if(n.show_worksheet_worst){i.detailsOpts.push(this.getDetailsForCase("worst",this.worstTotal,i.quota_amount,i.closed_amount))}if(n.show_worksheet_likely){i.detailsOpts.push(this.getDetailsForCase("likely",this.likelyTotal,i.quota_amount,i.closed_amount))}if(n.show_worksheet_best){i.detailsOpts.push(this.getDetailsForCase("best",this.bestTotal,i.quota_amount,i.closed_amount))}if(this.isManager&&!_.isEmpty(e.user.get("reports_to_id"))){i.quota_label=e.lang.get("LBL_QUOTA_ADJUSTED","Forecasts")}else{i.quota_label=e.lang.get("LBL_QUOTA","Forecasts")}this.model.set(i,{silent:true})},getDetailsForCase:function(t,i,n,a){var o={};var s=e.math.add(i,a);var r=parseFloat(n);var l=0;var c=e.user.getPreference("currency_id");o.label=e.lang.get("LBL_"+t.toUpperCase(),"Forecasts");o.spanCSS=this.spanCSS;o.case=t;o.shortOrExceed="&nbsp;";o.openPipeline="&nbsp;";o.feedbackLn1="";o.feedbackLn2="";o.hasAccess=true;if(!this.isManager&&!this.fieldDataAccess[t]){o.hasAccess=false}if(o.hasAccess){if(i){o.amount=e.currency.formatAmountLocale(i,c);o.labelAmount=o.label+": "+o.amount.toString()}if(s===0&&r===0){o.amount=e.lang.get("LBL_FORECAST_DETAILS_NO_DATA","Forecasts")}else if(s!==0&&r!==0&&s===r){o.shortOrExceed=e.lang.get("LBL_FORECAST_DETAILS_MEETING_QUOTA","Forecasts")}else{if(s>r){o.shortOrExceed=e.lang.get("LBL_FORECAST_DETAILS_EXCEED","Forecasts");l=e.math.sub(s,r)}else{o.shortOrExceed=e.lang.get("LBL_FORECAST_DETAILS_SHORT","Forecasts");l=e.math.sub(r,s)}o.percent=this.getPercent(l,r);o.openPipeline="("+e.currency.formatAmountLocale(l,c)+")"}o.feedbackLn1=o.shortOrExceed;if(o.percent){o.feedbackLn1+=" "+o.percent}o.feedbackLn2=o.openPipeline}return o},renderCSSChanges:function(){this.checkPropertySetCSS("worst");this.checkPropertySetCSS("likely");this.checkPropertySetCSS("best");var e=this.model.get("is_deficit");var t="";if(e){t=this.getClassBasedOnAmount(0,1,"color")}else{t=this.getClassBasedOnAmount(1,0,"color")}if(t!==""){this.$el.find(".deficitRow").addClass(t)}},checkPropertySetCSS:function(t){if(this.forecastConfig["show_worksheet_"+t]&&(this.isManager||!this.isManager&&this.fieldDataAccess[t])){var i=this.getClassBasedOnAmount(e.math.add(this.serverData.get(t),this.serverData.get("closed_amount")),this.model.get("quota_amount"),"background-color");if(i!==""){this.$el.find(".forecast_details_"+t+"_feedback").addClass(i)}}},getClassBasedOnAmount:function(e,t,i){var n="";e=parseFloat(e);t=parseFloat(t);if(i==="color"){if(e===t){}else if(e>t){n="font-green"}else{n="font-red"}}else if(i==="background-color"){if(e===t&&e!==0){n="grayLight"}else if(e>t){n="green"}else if(e<t){n="red"}}return n},getPercent:function(e,t){var i=0;if(t>0&&e>0){i=e/t*100;if(i>1){i=Math.round(i)}else{i=Math.round(i*100)/100}}return Math.abs(i)+"%"}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.TwitterView=e.view.views.ListContainerDashletView.extend({className:"twitter-wrapper",initialize:function(e){e.listParams=_.extend({module:"Twitter"},e.listParams);this._super("initialize",arguments)},createList:function(t,i){var n=_.extend({parentModel:i.parentModel},t,i.listParams);var a=e.view.createView({name:"twitter-list",module:"Twitter",layout:i.layout,listParams:n,skipFetch:true,contextMenuOnSwipeDisabled:true,listItemTpl:"twitter-list-item"});a.render();return a},loadData:function(e){_.each(this.getChildViews(),function(t){t.loadTwitterData(e)},this)}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.TwitterListView=e.view.views.ConfigurableListView.extend({plugins:_.without(_.union(e.view.views.ConfigurableListView.prototype.plugins,["connector"]),"pagination"),basicMenuActions:[{name:"reply",label:"LBL_TWITTER_REPLY",icon:"icon-reply",isEnabled:function(){return true},action:"onTweetReplyAction"},{name:"retweet",label:"LBL_TWITTER_RETWEET",icon:"icon-retweet",isEnabled:function(){return true},action:"onRetweetAction"},{name:"favorite",label:"LBL_TWITTER_FAVORITE",icon:"icon-star",isEnabled:function(){return true},action:"onTweetFavoriteAction"}],_urlTweetReply:"https://twitter.com/intent/tweet?in_reply_to={0}",_urlRetweet:"https://twitter.com/intent/retweet?tweet_id={0}",_urlTweetFavorite:"https://twitter.com/intent/favorite?tweet_id={0}",_urlTweetOpen:"https://twitter.com/{0}/status/{1}",_urlTwitterProfile:"https://twitter.com/{0}",initialize:function(e){this.connectorCriteria=["eapm_bean","test_passed"];this._super("initialize",arguments)},onTweetReplyAction:function(t,i){var n=e.utils.formatString(this._urlTweetReply,[i.id]);e.nomad.openUrl(n)},onRetweetAction:function(t,i){var n=e.utils.formatString(this._urlRetweet,[i.id]);e.nomad.openUrl(n)},onTweetFavoriteAction:function(t,i){var n=e.utils.formatString(this._urlTweetFavorite,[i.id]);e.nomad.openUrl(n)},onClickItemNavigate:function(t,i){var n=e.utils.formatString(this._urlTweetOpen,[i.screen_name,i.id]);e.nomad.openUrl(n)},refresh:function(e){this.loaded=false;this.collection.resetOptions();this.loadTwitterData(e)},loadTwitterData:function(e){if(this.loaded){return}this.tried=false;this._checkConnector(e)},loadDataWithValidConnector:function(t,i){var n=this;i=i||{};var a=function(i,a,o,s){if(!n.getTwitterName()){return}var r=parseInt(n.listParams.limit||e.config.maxQueryResult);var l=e.api.buildURL("connector/twitter","",{id:n.twitter},{count:r,connectorHash:t.connectorHash});var c=s.success;var d=s.error;s.success=function(e,t){if(_.isArray(e)){_.each(e,function(e){e=_.extend(e,n.processRawTweet(e))},this)}else{e=[]}if(c)c({next_offset:-1,records:e},t)};s.error=function(e){if(c)c({next_offset:-1,records:[]},e.request);if(e.code){if(!n.tried){n.tried=true;n.getConnectors("ext_rest_twitter",_.bind(n._checkConnector,n))}else{n.handleLoadError(null)}}else{d(e)}};return e.api.call("read",l,null,s)};this.collection.fetch({endpoint:a,complete:function(){n.loaded=true;if(_.isFunction(i.complete)){i.complete()}}})},_checkConnector:function(e){this.checkConnector({name:"ext_rest_twitter",criteria:this.connectorCriteria,success:function(t){this.loadDataWithValidConnector(t,e)},error:function(t){this.handleLoadError(t);if(e&&e.complete){e.complete()}}})},processRawTweet:function(t){var i=new Date(t.created_at.replace(/^\w+ (\w+) (\d+) ([\d:]+) \+0000 (\d+)$/,"$1 $2 $4 $3 UTC"));var n=e.date.format(i,"Y/m/d H:i:s");var a=t.retweeted_status?"RT @"+t.retweeted_status.user.screen_name+": "+t.retweeted_status.text:t.text;var o=t.source;var s=t.id_str;var r=t.user.name;var l=a.split(" ");var c=t.user.screen_name;var d=e.utils.formatString(this._urlTwitterProfile,[t.user.screen_name]);var u=t.user.profile_image_url_https;var f;var h=new Date;var p=(h.getTime()-i.getTime())/(1e3*60*60*24);var m=p>1;for(f=0;f<l.length;f++){if(l[f].charAt(0)==="h"&&l[f].charAt(1)==="t"){l[f]="<a class='tw__as_content_url' href="+'"'+l[f]+'"'+" target='_blank'>"+l[f]+"</a>"}}a=l.join(" ");return{id:s,name:r,screen_name:c,tw_profile_url:d,tw_profile_image_url:u,text:a,source:o,date:n,useAbsTime:m}},handleLoadError:function(t){var i=e.lang.get("LBL_CONFIGURE_TWITTER");if(!t&&this.twitter){i=e.lang.get("LBL_ERROR_CANNOT_FIND_TWITTER")+this.twitter}else if(t&&!t.test_passed&&t.testing_enabled){i=e.lang.get("LBL_CONNECT_TEST_FAIL")}this.$(".no-records-found").show();e.alert.show("twitter_error",{level:"error",messages:i,autoClose:true})},getTwitterName:function(){var e=this.listParams;var t=e.parentModel;var i;var n;if(e.twitter){i=e.twitter}else if(t){n=this.getConnectorModuleFieldMapping("ext_rest_twitter",t.module)||{};i=t.get("twitter")||t.get(n.name)||t.get("name")||t.get("account_name")||t.get("full_name")}if(i){i=i.replace(/ /g,"");this.twitter=i}return i}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.WebpageView=e.view.views.BaseDashletView.extend({className:"dashlet-webpage",events:{"click .wp__container":function(t){t.preventDefault();e.nomad.openWebPage(this.url)}},initialize:function(t){this.url=e.nomad._normalizeUrl(t.meta.view.url);this.title=t.meta.view.title;this._super("initialize",arguments)},onInvokedFromDashboard:function(){e.nomad.openWebPage(this.url)}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.DonutchartView=e.view.views.BaseChartView.extend({initialize:function(e){this.metricsCollection=null;this.total=0;this._super("initialize",[e]);this._prepareChartObject()},render:function(){this._super("render",arguments);if(this.hasChartData()){this.renderChart();this.toggleDashletSwipe()}else{this.displayNoData(true)}},hasChartData:function(){return this.total!==0},displayNoData:function(e){if(e){this.$chartEl.hide();this.$dataUnavailableLbl.show()}else{this.$chartEl.show();this.$dataUnavailableLbl.hide()}},processData:function(e){this.evaluateResult(e);this.render()},_prepareChartObject:function(){this.chart=nv.models.pieChart().x(function(e){return e.key}).y(function(e){
return e.value}).margin({top:0,right:0,bottom:5,left:0}).donut(true).donutLabelsOutside(true).donutRatio(.447).rotateDegrees(0).arcDegrees(360).maxRadius(110).hole(this.total).showTitle(false).tooltips(true).showLegend(false).colorData("data").direction(e.lang.direction).tooltipContent(function(e,t,i,n,a){return"<p><b>"+e+" "+(n.point.valueLabel?n.point.valueLabel:parseInt(i,10))+"</b></p>"}).strings({noData:e.lang.get("LBL_CHART_NO_DATA")})},renderChart:function(){if(!this._super("renderChart")){this.displayNoData(true);return}this.chart.hole(this.total);d3.select(this.el).select(".nv-chart-donut").append("svg").datum(this.chartData).transition().duration(500).call(this.chart)}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.OpportunityMetricsView=e.view.views.DonutchartView.extend({className:"opportunity-metrics-wrapper",initialize:function(t){this._super("initialize",arguments);this.template=e.template.get("donutchart");this.parentModel=t.parentModel||{}},loadChartData:function t(i){var n=e.api.buildURL(this.parentModel.module,"opportunity_stats",{id:this.parentModel.get("id")});this.apiCall("read",n,null,e.nomad.utils.wrapAsyncCallback(i))},evaluateResult:function(t){var i=0;_.each(t,function(n,a){t[a].formattedAmount=e.currency.formatAmountLocale(n.amount_usdollar,null,0);t[a].cssClass=a==="won"?"won":a==="lost"?"lost":"active";t[a].dealLabel=a;t[a].stageLabel=e.lang.getAppListStrings("opportunity_metrics_dom")[a];i+=n.count});this.total=i;this.metricsCollection=t;this.chartData={data:_.map(this.metricsCollection,function(e,t){return{key:e.stageLabel,value:e.count,classes:t}})}},isDataEmpty:function(e,t){var i=_.isEmpty(e);var n=0;e=e||{};_.each(e,function(e,t){n+=e.count});return n===0}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.CasesSummaryView=e.view.views.TabbedListContainerDashletView.extend({getListDef:function(t,i){var n=this._super("getListDef",arguments);var a=e.metadata.getModule("Cases","fields").status.options;var o=e.lang.getAppListStrings(a);n.title=o[t.status];return n}})})(SUGAR.App)},function(e,t){(function(e){e.view.NomadField=e.view.Field.extend({delegateEvents:function(e){Backbone.View.prototype.delegateEvents.call(this,e)},initialize:function(t){if(t.view.name==="view")t.viewName="readonly";e.view.Field.prototype.initialize.call(this,t);if(t.view.name==="edit"&&(Boolean(this.def.calculated)&&Boolean(this.def.enforced)||Boolean(this.def.readonly))){t.viewName="readonly"}},handleValidationError:function(e){this._displayValidationMessage(e)},_displayValidationMessage:function(t){var i;var n=[];this.$(".controls").children(".error-display").remove();this.$(".control-group").removeClass("error");if(t){this.$(".control-group").addClass("error");_.each(t,function(t,i){n.push(e.error.getErrorString(i,t))});i=e.template.get("edit-field-error");this.$(".controls").append(i(n))}e.analytics.trackEvent("validation",this.name)},_render:function(){this.onBeforeRender();if(e.config.analytics.enabled)e.analytics.detachAnalytics(this.$el);e.view.Field.prototype._render.call(this);this.onAfterRender();if(e.config.analytics.enabled)e.analytics.attachAnalytics(this.$el);this.hasAccess=this.getAccess();return this},_getFallbackTemplate:function(t){if(t==="disabled"){return"readonly"}else{return e.view.Field.prototype._getFallbackTemplate.apply(this,arguments)}},getAccess:function(){var t=this.options.def.view||this.options.viewName||(this.view.meta&&this.view.meta.type?this.view.meta.type:this.view.name);var i=t!==this.view.action?this.view.action:t;return e.acl.hasAccessToModel(i,this.model,this.name)},onBeforeRender:function(){if(this.view.name==="edit"&&this.getAccess()&&!this.isDisabled()){this.action="edit"}},onAfterRender:function(){},unformat:function(e){return _.isString(e)?e.trim():e},isReadOnly:function(){return this.tplName==="readonly"},bindDomChange:function(){if(!(this.model instanceof Backbone.Model))return;var e=this.$el.find(this.fieldTag);e.on("change",_.bind(this.onFieldChange,this));this._$fieldEl=e},onFieldChange:function(){this.model.set(this.name,this.unformat(this._$fieldEl.val()))},bindDataChange:function(){if(this.model){this.model.on("change:"+this.name,function(e,t,i){if(i&&i.disableRenderForContext===this.view){return false}this.render()},this)}},setRequired:function(t){this.def=e.utils.deepCopy(this.def);this.def.required=t;this.render()},isRequired:function(){return this.def.required},_loadTemplate:function(){this.action=void 0;this._super("_loadTemplate")}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.BoolField=e.view.NomadField.extend({events:{"touchstart .checkbox":"touchCheckbox"},format:function(e){return e=="1"},onBeforeRender:function(){e.view.NomadField.prototype.onBeforeRender.call(this);if(this.model&&this.view.isEditView()&&!this.model.has(this.name)){this.model.set(this.name,false,{silent:true})}},unformat:function(){return!!this.$(this.fieldTag)[0].checked},touchCheckbox:function(e){e.stopPropagation()}})})(SUGAR.App)},function(e,t){(function(e){e.view.NumericField=e.view.NomadField.extend({isFloat:false,fieldType:"text",initialize:function(){this._super("initialize",arguments);if($.os.ios){this.fieldType="number";this.events=_.extend({"keypress ._numeric":"onNumericKeyPress"},this.events);this.events=_.extend({"paste ._numeric":"onItemPaste"},this.events)}else if($.os.android){this.fieldType="tel"}},onItemPaste:function(e){var t=e.target;var i=$(t).val();_.delay(function(){var e=$(t).val();if(_.isEmpty(e)){$(t).val(i)}},1)},onNumericKeyPress:function(e){var t=e.keyCode||e.which;if(t===46&&this.isFloat){var i=$(e.target).val();if(i===""){$(e.target).val("0")}else if(i.indexOf(".")>-1){e.preventDefault();return false}}else if(t<48||t>57){e.preventDefault();return false}},format:function(t){if(!t&&t!==0||_.isString(t)&&t.trim().length===0)return"";if(!isNaN(t)){var i="";if(this.action!=="edit"&&this.action!=="create"||this.tplName==="readonly"){i=this.def.disable_num_format?"":this.def.number_group_seperator||e.user.getPreference("number_grouping_separator")}t=e.utils.formatNumber(t,null,this.isFloat?this.def.precision||e.user.getPreference("decimal_precision"):0,i,this.def.decimal_seperator||e.user.getPreference("decimal_separator"));if(this.isFloat){this.model.set(this.name,this.unformat(t),{silent:true})}}return t},unformat:function(t){var i=e.utils.unformatNumberStringLocale(t.toString(),this.isFloat);return i===""||isNaN(i)?t:i}});e.view.fields.IntField=e.view.NumericField})(SUGAR.App)},function(e,t){(function(e){e.view.fields.CurrencyField=e.view.NumericField.extend({events:{"change select":"onCurrencySelection"},isFloat:true,initialize:function(){e.view.NumericField.prototype.initialize.apply(this,arguments);if(this.context.isCreate()&&e.metadata.getCurrency(e.user.getPreference("currency_id")).status==="Active"){this.model.set("currency_id",e.user.getPreference("currency_id"),{silent:true})}},onBeforeRender:function(){e.view.NumericField.prototype.onBeforeRender.call(this);if(_.isEmpty(this.model.get("currency_id"))){this.model.set("currency_id",e.user.getPreference("currency_id")||"-99",{silent:true})}this.availableCurrencies=this._getCurrencies()},_getCurrencies:function(){var t=this.model;var i=t.get("currency_id");var n=e.user.getPreference("currency_id");var a={};var o=e.metadata.getCurrencies();var s;_.each(o,function(e,t){var n=_.clone(e);n.id=t;if(n.status==="Active"){a[t]=n;s=n}else if(n.id===i){n.disabled=true;a[t]=n}});var r="-99";if(i&&_.has(a,i)){r=i}else if(_.has(a,n)){r=n}var l=a[r]||s;if(l){l.selected="selected"}return a},onAfterRender:function(){var t=this;e.view.NumericField.prototype.onAfterRender.call(this);if(e.supportedFeatures.enumViaActionSheet){var i=[];_.each(this.availableCurrencies,function(e){i.push(e.iso4217)});this.$ct=this.$el.find(".actionsheet-select");this.$ct.bind("click",function(){e.nomad.showActionSheet(t.label,i,function n(e){var i=null;_.each(t.availableCurrencies,function(t,n){if(t.iso4217===e){i=n}});t.$ct.attr("value",i);t.$ct.text(e);t.onCurrencySelection()})})}else{this.$ct=$("select",this.$el)}if(!this.model.get("currency_id")&&this.context.isCreate()){this.model.changeCurrencyId(this.$ct.val()||this.$ct.attr("value"),{silent:true})}},format:function(t){if(!t&&t!==0||_.isString(t)&&t.trim().length===0)return"";var i=t;if(!isNaN(parseFloat(e.currency.unformatAmountLocale(t)))){var n=this.model.get("currency_id");var a=e.user.getPreference("currency_id");if(_.contains(["list","list-associate"],this.action)&&n!==a){i=e.currency.formatAmountLocale(t,n)}else if((this.action==="edit"||this.action==="create")&&this.tplName!=="readonly"){var o=e.user.getPreference("decimal_separator");var s=e.user.getPreference("decimal_precision");var r=e.currency.formatAmount(t,n,s,"",o);var l=e.currency.getCurrencySymbol(n);i=r.replace(l,"")}else{i=e.currency.formatAmountLocale(t,n)}}return i},onCurrencySelection:function(){this.model.changeCurrencyId(this.$ct.val()||this.$ct.attr("value"));var e=this.format(this.model.get(this.name));this.$("input").val(e)},onFieldChange:function(){this.model.set(this.name,this.unformat(this._$fieldEl.val()),{disableRenderForContext:this.view})}})})(SUGAR.App)},function(e,t){(function(e){var t;e.view.fields.DateField=t=e.view.NomadField.extend({events:function(){var i={"focusout input":"onBlur"};if(e.isNative&&!t.nativeSupport){i["click input"]="onClick"}var n=$.os.desktop?"click":"touchstart";i[n+" .clear-button"]="onClear";return i},validDateRE:/^\d{4}-\d{2}-\d{2}$/,ONCLICK_BLOCKER_TIMEOUT:2e3,initialize:function(i){e.view.NomadField.prototype.initialize.call(this,i);if(!t._dateFormat){t.initFormat()}this.setFormatting()},onBeforeRender:function(){e.view.NomadField.prototype.onBeforeRender.call(this);this.setDefaultValue();this.setClearButtonVisibility()},onAfterRender:function(){e.view.NomadField.prototype.onAfterRender.call(this);this.setControls();this.toggleControls()},bindDomChange:function(){if(!this.model)return;this.setInputs();if(t.nativeSupport){this.dateInput.on($.browser.chromeWeb?"change":"blur",_.bind(this.handleValueChange,this))}},format:function(i){if(_.isEmpty(i)||this.isFormView()&&t.nativeSupport&&!this.isReadOnly()){if(i&&!this.validDateRE.test(i)){var n=new Date(i);i=e.date.format(n,"Y-m-d")}return i}var a=new Date(i);if(isNaN(a.getDate())){a=e.date.parse(i,"Y-m-d")}var o=$.os.android&&$.os.version&&e.utils.versionCompare("4.1",$.os.version,">=");var s=e.isNative&&o?0:a.getTimezoneOffset()*6e4;var r=new Date(a.getTime()+s);return e.date.format(r,t._dateFormat)},unformat:function(i){var n=_.isEmpty(i);var a;if(n||t.nativeSupport&&this.isFormView()){return i}a=e.date.parse(i,t._dateFormat);return a?e.date.format(a,"Y-m-d"):null},setInputs:function(){this.dateInput=this.$el.find("input");this.inputs=this.dateInput},onClick:function(e){if(this.isOnClickLocked())return;this.setOnClickBlocker();this.showDatePicker(e)},onBlur:function(){this.toggleControls()},onClear:function(e){this.setChanged();if(!t.nativeSupport&&$.os.android){this.setOnClickBlocker(500)}this.model.set(this.name,"");return false},setFormatting:function(){this.shouldFormatValues=!t.nativeSupport&&this.isFormView()},setDefaultValue:function(){if(this.context.isCreate()&&!this.getValue()&&this.def.display_default&&!this._changed){var t=e.date.parseDisplayDefault(this.def.display_default);this.model.set(this.name,this._adjustDefaultValue(t),{silent:true})}},_adjustDefaultValue:function(t){return e.date.format(t,"Y-m-d")},getDateInputValue:function(){var i=this.dateInput.val();if(i&&this.shouldFormatValues){var n=e.date.parse(i,t._dateFormat);i=e.date.format(n,"Y-m-d")}return i},setDateInputValue:function(i){if(i&&this.shouldFormatValues){var n=e.date.parse(i,"Y-m-d");i=e.date.format(n,t._dateFormat)}this.dateInput.val(i)},setClearButtonVisibility:function(){this.showClearButton=!this.def.required&&!_.isEmpty(this.getValue())},setControls:function(){this.input=this.$el.find("input");this.clearButton=this.$el.find(".clear-button")},toggleControls:function(){var e=_.isEmpty(this.getValue());this.input.toggleClass("empty",!this.def.required&&e);this.clearButton.toggle(!this.def.required&&!e)},setChanged:function(){this._changed=true},getValue:function(){return this.model.get(this.name)},handleValueChange:function(e){this.setChanged();this.model.set(this.name,this.unformat(this.getDateInputValue()),{disableRenderForContext:this.view});this.toggleControls()},showDatePicker:function(i){var n=this.unformat(this.value)||"";if(t.ios7){var a=new Date;if(n){var o=e.date.parse(n,"Y-m-d");if(e.nomad.utils.isValidDate(o)){a=o}}var s={date:a,mode:"date"};this._setPopoverCoordinates(s,i);var r=e.date.format(s.date,"Y-m-d");this.setDateInputValue(r);this.model.set(this.name,r);this.toggleControls();window.datePicker.show(s,_.bind(function l(t){this.clearOnClickBlocker();if(!t)return;var i=e.date.format(t,"Y-m-d");this.model.set(this.name,i)},this));return}e.nomad.showDateTimePicker(n,"showDatePicker",_.bind(function(e){this.clearOnClickBlocker();this.model.set(this.name,e)},this))},_setPopoverCoordinates:function(e,t){var i=t.screenX;var n=t.screenY;var a=document.body.scrollTop;if(n-a<250){n+=30}n-=a;e.x=String(i);e.y=String(n)},isFormView:function(){return _.contains(["create","edit"],this.view.action)},isOnClickLocked:function(){return t._onClickBlocker},setOnClickBlocker:function(e){t._onClickBlocker=window.setTimeout(_.bind(this.clearOnClickBlocker,this),e||this.ONCLICK_BLOCKER_TIMEOUT)},clearOnClickBlocker:function(){window.clearTimeout(t._onClickBlocker);t._onClickBlocker=false},_dispose:function(){this.clearOnClickBlocker();this.clearButton&&this.clearButton.off();e.view.NomadField.prototype._dispose.call(this)}},{initFormat:function(){t._dateFormat=e.user.getPreference("datepref")},setNativeSupport:function(){this.nativeSupport=$.os.ios||$.browser.chromeWeb||!$.os.ios&&!$.os.android&&$.browser.webkit||false;this.ios7=$.os.ios&&$.os.version&&($.os.version[0]==="7"||e.utils.versionCompare($.os.version,"8",">=")&&$.os.tablet);if(this.ios7&&e.isNative&&this.iosDatePickerPlugin){this.nativeSupport=false}},iosDatePickerPlugin:true});e.events.on("app:sync:complete",function(){t.initFormat()}).on("app:init",function(){t.setNativeSupport()})})(SUGAR.App)},function(e,t){(function(e){var t;e.view.fields.DatetimecomboField=t=e.view.fields.DateField.extend({initialize:function(i){e.view.fields.DateField.prototype.initialize.call(this,i);if(!t._tsFormat){t.initFormat()}},onBeforeRender:function(){e.view.NomadField.prototype.onBeforeRender.call(this);this.setDefaultValue();this.calculateAndBackupInputValues();this.setClearButtonVisibility()},bindDomChange:function(){this.setInputs();if(t.nativeSupport){this.inputs.on($.browser.chromeWeb?"change":"blur",_.bind(this.handleValueChange,this))}},format:function(i){var n=_.isEmpty(i);if(n||this.view.name==="edit"&&t.nativeSupport&&!this.isReadOnly()){return i}return e.date.format(new Date(i),t._tsFormat)},unformat:function(e){return e},setInputs:function(){this.dateInput=this.$("input[data-type=date]");this.timeInput=this.$("input[data-type=time]");this.inputs=this.dateInput.add(this.timeInput)},calculateAndBackupInputValues:function(){var i="";var n="";var a=this.getValue();var o;if(a){o=new Date(a);i=e.date.format(o,"Y-m-d");n=e.date.format(o,"H:i"+":00")}this.values={date:i,time:n};this.formattedValues=null;if(a&&this.shouldFormatValues){o=new Date(a);this.formattedValues={date:e.date.format(o,t._dateFormat),time:e.date.format(o,t._timeFormat)}}this._prevValues=this.values},handleValueChange:function(e){this.setChanged();this.setDefaultInputValues();this.setModelValue(this.getDateInputValue(),this.getTimeInputValue());this.calculateAndBackupInputValues();this.toggleControls()},setDefaultInputValues:function(){var t=this.getDateInputValue();var i=this.getTimeInputValue();var n=this._prevValues.date&&!t;var a=this._prevValues.time&&!i;if(t&&!i&&!a){var o=this.def.default_current_time?e.date.format(new Date,"H:i"):"00:00";this.setTimeInputValue(o)}else if(i&&!t&&!n){var s=e.date.format(new Date,"Y-m-d");this.setDateInputValue(s)}else if(n){this.setTimeInputValue("")}else if(a){this.setDateInputValue("")}},onClick:function(e){if(this.isOnClickLocked())return false;var t=e.target.getAttribute("data-type");this.setOnClickBlocker();this.showDateTimePicker(t,e)},onBlur:function(){this.toggleControls()},getTimeInputValue:function(){var i=this.timeInput.val();if(i&&this.shouldFormatValues){var n=e.date.parse(i,t._timeFormat);i=e.date.format(n,"H:i")+":00"}return i},setTimeInputValue:function(i){if(i&&this.shouldFormatValues){var n=e.date.parse(i,"H:i");i=e.date.format(n,t._timeFormat)}this.timeInput.val(i)},setModelValue:function(e,i){var n="";var a=new Date(this.getValue());var o;var s;if(t.nativeSupport){s={disableRenderForContext:this.view}}if(e&&i){o=this._getDate(e+" "+i+":00",true);n=o.toISOString()}if(!(o&&o.getTime()===a.getTime())){this.model.set(this.name,n,s)}},showDateTimePicker:function(i,n){var a=i==="date";var o=this.getDateInputValue()||e.date.format(new Date,"Y-m-d");var s=this.getTimeInputValue()||(this.def.default_current_time?e.date.format(new Date,"H:i"):"00:00");if(t.ios7){var r=this._getDate(o+" "+s+":00",true);if(!e.nomad.utils.isValidDate(r)){r=new Date}var l={date:r,mode:a?"date":"time"};this._setPopoverCoordinates(l,n);this.setDateInputValue(o);this.setTimeInputValue(s);this.setModelValue(o,s);this.toggleControls();window.datePicker.show(l,_.bind(function(t){this.clearOnClickBlocker();if(!t)return;if(a){var i=e.date.format(t,"Y-m-d H:i")+":00";this.setDateInputValue(i)}else{this.setTimeInputValue(t)}this.setDefaultInputValues();this.setModelValue(this.getDateInputValue(),this.getTimeInputValue());this.toggleControls()},this));return}e.nomad.showDateTimePicker(a?o:s,a?"showDatePicker":"showTimePicker",_.bind(function(e){this.clearOnClickBlocker();if(a){this.setDateInputValue(e)}else{this.setTimeInputValue(e)}this.setDefaultInputValues();this.setModelValue(this.getDateInputValue(),this.getTimeInputValue());this.toggleControls()},this))},_adjustDefaultValue:function(e){return e.toISOString()},_getDate:function(e,t){var i=e.split(/[^0-9]/);var n=new Date(i[0],i[1]-1,i[2],i[3],i[4],i[5]);var a=t?0:n.getTimezoneOffset()*6e4;return new Date(n.getTime()-a)},_dispose:function(){e.view.fields.DateField.prototype._dispose.call(this);this.inputs&&this.inputs.off()}},{initFormat:function(){t._tsFormat=e.user.getPreference("datepref")+" "+e.user.getPreference("timepref");t._dateFormat=e.user.getPreference("datepref")||"Y-m-d";t._timeFormat=e.user.getPreference("timepref")}});e.events.on("app:sync:complete",function(){t.initFormat()}).on("app:init",function(){t.setNativeSupport()})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.InviteesField=e.view.NomadField.extend({cacheDisabled:true,events:{"touchstart .checkbox":"touchCheckbox","click .secondary-btn":"onSecondaryClick","click .invitees":"onClick"},fieldTag:"invitees",touchCheckbox:function(e){e.stopPropagation()},onClick:function(t){if(t.defaultPrevented)return false;var i=e.context.getContext({layout:"picker-list",module:this.module,model:this.model,collection:new e.BeanCollection,skipFetch:true});i.prepare();var n=e.controller.loadDynamic({layoutDef:{className:"layout__list",gaTrack:"invitees-picker-list",meta:{components:[{view:"list-picker"}]},context:i}});var a=n.getComponent("list-picker");var o=e.metadata.getModuleNames({filter:"visible",access:"list"});if(e.acl.hasAccess("list","Users"))o.push("Users");var s=_.intersection(["Contacts","Leads","Users"],o);var r=_.map(s,function(t){return{value:t,label:e.nomad.getPluralModuleName(t),module:t}}).sort(function(e,t){return e.label>t.label?1:-1});a.setData({items:r});a.on("selection:submit",function(e){this.createListLayout(e.get("value"),this.model)},this);a.render()},createListLayout:function(t){var i=e.context.getContext({module:t});i.prepare();var n=i.get("module");var a=e.lang.get("LBL_ASSOC",n,e.lang.getAppListStrings("moduleListSingular")[n]);var o=e.controller.loadDynamic({layoutDef:{gaTrack:"invitees-list",name:"list-selector",subType:"selector",editable:true,context:i,listMeta:{multiselect:true,headerData:{title:a,save:true}}}});var s=o.getComponent("list-selector");s.on("selection:submit",function(i){i=_.map(i,function(e){var i=_.pick(e.attributes,"id","name");i.link=t.toLowerCase();return i},this);var n=_.compact(this.model.get("invitees"));var a=_.pluck(n,"id");a=_.map(a,function(e){return e.toString()});i=_.chain(i).reject(function(e){return _.include(a,e.id.toString())}).union(n).value();this.model.set("invitees",i);e.controller.disposeDynamic({disposeAll:true})},this)},onSecondaryClick:function(e){var t=this.model.get("invitees");var i=$(e.currentTarget).attr("uid");var n=_.reject(t,function(e){return e.id==i});this.model.set("invitees",n);return false}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.FileField=e.view.NomadField.extend({events:{"click .input_upload":"_onInputClick","click .file-remove":"_onClearClick","change .input_upload":"_onFileSelected"},globalEvents:{"app:header:cancel":"_onHeaderCancelClick"},supportedTypes:$.os.android?["*/*"]:["image/*","video/*"],_fileType:null,_fileIsTooBigMessage:"9f2e903a-5bd9-4c8f-a822-83c125c43e5f",_fileErrorCodesToStrings:{1:"ERR_MOBILE_FILE_NOT_SUPPORTED",2:"ERR_MOBILE_FILE_NOT_READABLE",3:"ERR_MOBILE_FILE_ABORTED",4:"ERR_MOBILE_FILE_SECURITY"},initialize:function(){this.inputAccept=this.supportedTypes.join(",");e.view.NomadField.prototype.initialize.apply(this,arguments)},onAfterRender:function(){e.view.NomadField.prototype.onAfterRender.apply(this,arguments);this._dirty=false;this.$fileInput=this.$el.find(".input_upload");this.$fileRemoveBtn=this.$el.find(".file-remove");if(this.def.required){this.$fileRemoveBtn.addClass("hide")}var t=this.value=this.model.get(this.name);this.$el.attr("file-id",t||"")},bindDomChange:function(){return},_onInputClick:function(t){if(!e.acl.hasAccessToModel("edit",this.model,this.name)){t.preventDefault();t.stopPropagation()}},_onFileSelected:function(){if(this.$fileInput[0].files.length===0){return}var t=this.$fileInput[0].files[0].type;this._fileType=this._getFileType(t);if(t&&!this._fileType){e.trigger("field:image:filechanged",this,e.lang.get("ERR_MOBILE_FILE_NOT_SUPPORTED"),"error");return}this._dirty=true;e.trigger("field:image:filechanged",this,this.$fileInput,"fileselected")},_onClearClick:function(){this._changeFieldState();this._dirty=true;e.trigger("field:image:fileclear",this)},_onHeaderCancelClick:function(){if(this._dirty&&this.context.get("action")==="edit"){this.render()}},prepareFile:function(){e.trigger("field:image:filechanged",this,this.$fileInput,"preparing");var t=[_.bind(this._readFileData,this)];if(this._fileType==="image"){t.push(_.bind(this._resizeImage,this))}async.series(t,_.bind(function i(t){if(!t){this.$fileInput.fieldName=this.name;this._changeFieldState(true);e.trigger("field:image:filechanged",this,this.$fileInput,"prepared")}else{e.trigger("field:image:filechanged",this,t.message||e.lang.get("ERR_MOBILE_FILE_PROCESSING"),"error")}},this))},_changeFieldState:function(e){if(e){if(!this.def.required){this.$fileRemoveBtn.removeClass("hide")}this.$el.find("i.icon-picture").addClass("hide");this.$el.find(".value").text(this.$fileInput.fileData.name);this.$el.find(".placeholder").hide()}else{if(!this.def.required){this.$fileRemoveBtn.addClass("hide")}this.$el.find("i.icon-picture").removeClass("hide");this.$el.find(".value").text("");this.$el.find(".placeholder").show();this._resetField()}},_readFileData:function(t){var i=this.$fileInput[0].files[0];if(i){var n=this;var a=new FileReader;var o=this._binaryToDataUri;a.onload=function(e){n.$fileInput.fileData={name:i.name,size:i.size,type:i.type,binary:e.target.result,dataURI:o(e.target.result,i.type)};if($.os.ios){n.$fileInput.fileData.name=n._getUniqFileName(i.name)}try{n._setImageOrientation(e.target.result,i.name)}catch(a){}finally{t()}};a.onerror=function(i){var a=i.target.error;t({message:e.lang.get(n._fileErrorCodesToStrings[a.code]||"ERR_MOBILE_FILE_READ")});e.logger.error("Failed to read file: ["+a.code+"]")};if(i.size>e.config.fileSizeLimit*1024*1024||i.name===n._fileIsTooBigMessage){return t({message:e.lang.get("ERR_MOBILE_FILE_SIZE_LIMIT_EXCEEDED",null,{size:e.nomad.utils.humanFileSize(e.config.fileSizeLimit*1024*1024,true)})})}a.readAsBinaryString(i)}else{t({message:"No file selected"})}},_resizeImage:function(t){var i=new Image;var n=this;var a=false;i.onload=function(){a=true;var i=n._resizeWithCanvas(this);if(i.split(",")[1].length===0){t({message:"Image resizing failed (Failed to render to canvas)"});return}function o(){n.$fileInput.fileData.type=i.split(",")[0].split(";")[0].split(":")[1];n.$fileInput.fileData.dataURI=i;n.$fileInput.fileData.binary=n._dataUriToBinary(i);t()}if(e.config.canvasTestModeOnUpload){$(n._canvas).css({position:"fixed",top:200,left:0,border:"2px red solid",zIndex:999999999}).appendTo("body").on("click",function(){$(n._canvas).remove();o()})}else{o()}};i.src=this.$fileInput.fileData.dataURI;_.delay(function o(){if(!a){t({message:"Image resizing failed (Failed to load file as image)"})}},e.config.imageResizeTimeout)},_resizeWithCanvas:function(e){var t=$.os.ios?this._iosRenderWithCanvas:this._commonRenderWithCanvas;var i=document.createElement("canvas");i.width=e.naturalWidth;i.height=e.naturalHeight;return t.call(this,e,i,{width:e.naturalWidth,height:e.naturalHeight,orientation:this.$fileInput.fileData?this.$fileInput.fileData.orientation:1})},_iosRenderWithCanvas:function t(i,n,a){var o=new MegaPixImage(i);var s={maxWidth:a.width,maxHeight:a.height,orientation:a.orientation};if(a.width*a.height>e.config.iosCanvasSizeLimit*1024*1024){_.extend(s,this._scaleImage(a))}o.render(n,s);return n.toDataURL("image/jpeg")},_scaleImage:function(t){var i=t.width/t.height;var n=e.config.iosCanvasSizeLimit*1024*1024;var a;var o;a=Math.sqrt(n/i);o=a*i;return{maxHeight:Math.floor(a),maxWidth:Math.floor(o)}},_commonRenderWithCanvas:function i(e,t,n){var a=t.getContext("2d");a.clearRect(0,0,n.width,n.height);function o(e,t,i,n){switch(n){case 5:case 6:case 7:case 8:e.width=i;e.height=t;break;default:e.width=t;e.height=i}var a=e.getContext("2d");switch(n){case 2:a.translate(t,0);a.scale(-1,1);break;case 3:a.translate(t,i);a.rotate(Math.PI);break;case 4:a.translate(0,i);a.scale(1,-1);break;case 5:a.rotate(.5*Math.PI);a.scale(1,-1);break;case 6:a.rotate(.5*Math.PI);a.translate(0,-i);break;case 7:a.rotate(.5*Math.PI);a.translate(t,-i);a.scale(-1,1);break;case 8:a.rotate(-.5*Math.PI);a.translate(-t,0);break;default:break}}if(n.orientation){o(t,n.width,n.height,n.orientation)}a.drawImage(e,0,0,n.width,n.height);return this._getJpegImage(t)},_getJpegImage:function(t){var i;if(!e.supportedFeatures.canvasJpegEncoding){var n=new JPEGEncoder;var a=t.getContext("2d");var o=a.getImageData(0,0,t.width,t.height);i=n.encode(o,e.config.jpegEncoderQuality)}else{i=t.toDataURL("image/jpeg",e.config.jpegEncoderQuality/100)}return i},_setImageOrientation:function(t,i){var n=new JpegMeta.JpegFile(t,i);var a;var o=this;if(!("tiff"in n)){a="No TIFF tags in image"}else if(!("Orientation"in n.tiff)){a='No "Orientation" tag in image'}else{o.$fileInput.fileData.orientation=parseInt(n.tiff.Orientation,10);a="Orientation tag: "+n.tiff.Orientation}if(e.config.canvasTestModeOnUpload){e.alert.show("orientation info",{level:"info",messages:a,closeable:true,autoClose:true})}},_binaryToDataUri:function(e,t){return"data:"+t+";base64,"+window.btoa(e)},_dataUriToBinary:function(e){return window.atob(e.split(",")[1])},_getFileType:function(e){var t=e.split("/");var i=_.find(this.supportedTypes,function(e){var i=e.split("/");return _.every(i,function(e,i){return e==="*"||e===t[i]})});if(i){return i.split("/")[0]}},_getUniqFileName:function(e){var t=e.match(/.*(\..+)$/i)[1];var i=e.match(/^(.+)\./i)[1];return i+"_"+ +new Date+t},_resetField:function(){this.$fileInput.replaceWith(this.$fileInput.clone());this.$fileInput=this.$(".input_upload")}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.ImageField=e.view.fields.FileField.extend({supportedTypes:["image/jpeg","image/png","image/gif"],initialize:function(){e.view.fields.FileField.prototype.initialize.apply(this,arguments);this._canvas=document.createElement("canvas")},onAfterRender:function(){this._super("onAfterRender",arguments);if(this.value){this._showAndPositionImage()}},_setForcedRefresh:function(e){this.cacheDisabled=e},_showAndPositionImage:function(t){var i=this;var n=new Image;var a=this.$el;var o=a.find("div.avatar");var s=t||e.api.buildFileURL({field:this.name,module:this.module,id:this.model.id},e.nomad.getFileOptions())+"&_id="+this.model.get(this.name);var r;n.onload=function(){i._setForcedRefresh(false);var a={image:n,height:o.css("height"),width:o.css("width")};e.nomad.utils.sizePicture(a);r=t||i._resizeWithCanvas(n);o.css({backgroundSize:a.sizeProp,backgroundImage:"url("+r+")"})};n.onerror=function(){i._setForcedRefresh(true);var t=i.context.get("name");var n=e.utils.formatString("url(img/offline-{0}.svg)",[t]);o.css({backgroundImage:n})};n.src=s},prepareFile:function(){e.trigger("field:image:filechanged",this,this.$fileInput,"preparing");async.series([_.bind(this._readFileData,this),_.bind(this._resizeImage,this),_.bind(this._applyPreview,this)],_.bind(function t(i){if(!i){this.$fileInput.fieldName=this.name;this._changeFieldState(true);e.trigger("field:image:filechanged",this,this.$fileInput,"prepared")}else{e.trigger("field:image:filechanged",this,i.message||e.lang.get("ERR_MOBILE_FILE_PROCESSING"),"error")}},this))},_changeFieldState:function(e){if(e){if(!this.def.required){this.$fileRemoveBtn.removeClass("hide")}this.$el.find("i.icon-picture").hide();this.$el.find(".placeholder").hide()}else{if(!this.def.required){this.$fileRemoveBtn.addClass("hide")}this.$el.find("i.icon-picture").show();this.$el.find("div.avatar").css({backgroundImage:"none"});this.$el.find(".placeholder").show()}},_readFileData:function(t){var i=this.$fileInput[0].files[0];if(i){var n=this;var a=new FileReader;var o=this._binaryToDataUri;a.onload=function(e){n.$fileInput.fileData={name:i.name,size:i.size,type:i.type,binary:e.target.result,dataURI:o(e.target.result,i.type)};try{n._setImageOrientation(e.target.result,i.name)}catch(a){}finally{t()}};a.onerror=function(i){var a=i.target.error;t({message:e.lang.get(n._fileErrorCodesToStrings[a.code]||"ERR_MOBILE_FILE_READ")});e.logger.error("Failed to read file: ["+a.code+"]")};a.readAsBinaryString(i)}else{t({message:"No file selected"})}},_applyPreview:function(e){this.$el.find(".icon-user").hide();this._showAndPositionImage(this.$fileInput.fileData.dataURI);e()},_resizeWithCanvas:function(t){var i=this._canvas;var n=e.config.resizeImagesOnUpload;var a=t.naturalWidth;var o=t.naturalHeight;var s=Math.max(a,o);var r=$.os.ios?this._iosRenderWithCanvas:this._commonRenderWithCanvas;if(!n)n=s;var l=s<n?1:n/s;var c=Math.round(a*l);var d=Math.round(o*l);i.width=c;i.height=d;return r.call(this,t,i,{width:c,height:d,orientation:this.$fileInput.fileData?this.$fileInput.fileData.orientation:1})}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.FloatField=e.view.NumericField.extend({isFloat:true})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.FollowField=e.view.NomadField.extend({events:{"click .follow-label":"onClick"},onClick:function(e){e.preventDefault();e.stopPropagation();this.model.follow(!this.model.get("following"),{error:_.bind(this.onError,this)})},onError:function(){this.model.set("following",!this.model.get("following"))}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.EnumField=e.view.NomadField.extend({cacheDisabled:true,initialize:function(){if(e.supportedFeatures.enumViaActionSheet){_.extend(this,{_viaActionSheet:true,fieldTag:".actionsheet-select",events:{"click .actionsheet-select":"onFocus"}})}else{_.extend(this,{_viaActionSheet:false,fieldTag:"select",events:{"focusin select":"onFocus","focusout select":"onBlur"}})}this._super("initialize",arguments);

},_sortResults:function t(e){if(this.def.sort_alpha){return _.sortBy(e,function(e){return e[1]})}if(!_.isEmpty(this.items)||this.def.visibility_grid){return e}return this._getSortedItems(e)},_getSortedItems:function i(e){var t;var i;var n=this._getOrderedKeys();var a=this._getFilteredKeys();t=_.map(e,function(e){return e[0]});i=a||n||t;return _.map(i,function(t){return _.find(e,function(e){return e[0]===t})})},_getOrderedKeys:function(){var t=e.lang.getAppListKeys(this.def.options);if(!_.isEmpty(t)){return _.map(t,function(e){return e.toString()})}},_getFilteredKeys:function(){var t=e.metadata.getEditableDropdownFilter(this.def.options);var i=this.getValue();if(!_.isEmpty(t)){return _.chain(t).filter(function(e){return e[1]||i===e[0].toString()}).map(function(e){return e[0].toString()}).value()}},_getItemByValue:function n(e){return _.find(this.renderItems,function(t){return t[1]===e})},_getItemByKey:function a(e){return _.find(this.renderItems,function(t){return t[0]===e})},getItems:function o(){var t=this.def.options;if(!_.isEmpty(this.items)){t=this.items}else if(_.isString(this.def.options)){t=e.lang.getAppListStrings(this.def.options)}if(_.isEmpty(t)){return[]}if(!_.isArray(t)){t=_.pairs(t)}else{t=_.map(t,function(e,t){return[t.toString(),e]})}return t},setRenderItems:function(){var e=this.getItems();this.renderItems=[];if(!_.isEmpty(e)){this.renderItems=this._sortResults(e)}},onBeforeRender:function(){this._super("onBeforeRender");var e=this.getValue();this.setRenderItems();if(this.view.isEditView()||this.def.view==="edit"){if(_.isEmpty(this.renderItems)){return}if(this.model&&_.isUndefined(e)){e=this.getDefaultValue();if(e!==""){this.model.set(this.name,e,{silent:true})}}else if(e===""&&!this.hasEmptyOption()){this.renderItems.unshift(["",""])}if(this._viaActionSheet){var t=this._getItemByKey(e);this.valueText=t?t[1]:e}}},onAfterRender:function(){e.view.NomadField.prototype.onAfterRender.call(this);this.placeholder=this.$el.find(".placeholder").eq(0);this.placeholder.toggle(e.nomad.isEmptyValue(this.getValue()));this.$el.toggle(!_.isEmpty(this.renderItems))},onFocus:function(){this.placeholder.hide();if(this._viaActionSheet){var t=this;e.nomad.showActionSheet("",this.getValues(this.renderItems),function i(e){var i=t._getItemByValue(e)[0];t._$fieldEl.attr("value",i);t._$fieldEl.text(e);t.onFieldChange()})}},onBlur:function(){this.placeholder.toggle(e.nomad.isEmptyValue(this.getValue()));document.activeElement.blur()},onFieldChange:function(){var e=this.unformat(this._$fieldEl.val()||this._$fieldEl.attr("value"));this.value=e;this.model.set(this.name,e,{disableRenderForContext:this.view});this.onBlur()},getValue:function(){var e=this.model.get(this.name);return _.isNumber(e)?e.toString():e},getDefaultValue:function(){var e=this.def["default"];var t=this._getFilteredKeys()||this.getKeys();if(_.isNumber(e))e=e.toString(10);if(!_.contains(t,e)&&!_.isEmpty(t)){e=t[0]}return _.isNumber(e)?e.toString():e},hasEmptyOption:function(){var e=this.getKeys();return _.contains(e,"")},getKeys:function(){var t=[];if(_.isString(this.def.options)){t=e.lang.getAppListKeys(this.def.options)}else if(_.isObject(this.def.options)){t=_.keys(this.def.options)}return t},getValues:function(e){return _.map(e,function(e){return e[1]})},format:function(e){return _.isNumber(e)?e.toString():e}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.EmailField=e.view.NomadField.extend({events:{"click .actions-btn":"showActions","click .value a":"sendEmail",'keyup [email-id="-1"] input':"onNewEmailFieldKeyUp"},_getValue:function(){return this.model.get(this.name)},_getPrimaryEmail:function(){return _.findWhere(this._getValue(),{primary_address:true})},_render:function(){var t=this._getValue();if(t&&t.length){_.each(t,function(e){_.each(["primary_address","opt_out","invalid_email"],function(t){e[t]=!!Number(e[t])})});t=_.sortBy(t,function(e){return-Number(e.primary_address)});this.model.set(this.name,t,{silent:true})}e.view.NomadField.prototype._render.apply(this,arguments)},onAfterRender:function(){var t=this._getPrimaryEmail();if(!this.model.get("email1")&&t){this._setEmail1Value(t.email_address)}e.view.NomadField.prototype.onAfterRender.apply(this,arguments)},_moduleHasEmail1:function(){return!!this.model.fields.email1},_setEmail1Value:function(e){if(this._moduleHasEmail1()){this.model.set("email1",e,{silent:true})}},_getEmailObject:function(e){var t=e.closest("[email-id]").attr("email-id");return t!=-1&&this._getValue()[t]||null},setPrimaryEmail:function(e){var t=this._getValue();var i=this._getPrimaryEmail();if(i){i.primary_address=false}this.$el.find(".primary-address").removeClass("primary-address");i=t[e];i.primary_address=true;this._setEmail1Value(i.email_address);this.$el.find('[email-id="'+e+'"]').addClass("primary-address")},_toggleAttr:function(e,t){var i=this._getValue()[e];var n=t.replace("_","-");var a=i[t]=!i[t];this._getEmailFieldRow(e)[a?"addClass":"removeClass"](n)},toggleOptOut:function(e){this._toggleAttr(e,"opt_out")},toggleInvalid:function(e){this._toggleAttr(e,"invalid_email")},_getEmailFieldRow:function(e){return this.$el.find('.controls-flex[email-id="'+e+'"]')},removeEmail:function(e){var t=this._getValue();var i=t.splice(e,1)[0];if(i.primary_address){var n="";if(t.length){t[0].primary_address=true;n=t[0].email_address}this._setEmail1Value(n)}this.model.trigger("change:email")},_makeEmail:function(e){var t=!this._getValue().length;if(_.isUndefined(e))e="";if(t)this._setEmail1Value(e);return{email_address:e,primary_address:t,invalid_email:false,opt_out:false}},onFieldChange:function(e){var t=$(e.currentTarget);var i=this._getEmailObject(t);var n=this.unformat(t.val());var a;if(i){i.email_address=n}else if(n){a=this._getValue();if(!a){a=[];this.model.set(this.name,a,{silent:true})}a.push(this._makeEmail(n))}this.model.trigger("change:email")},onNewEmailFieldKeyUp:function(e){var t=$(e.currentTarget);var i=this.unformat(t.val());this.$el.find(".add-btn").css({visibility:i?"visible":"hidden"})},_displayValidationMessage:function(t){var i;var n=[];this.$(".controls").children(".error-display").remove();this.$(".control-group").removeClass("error");this.$("[email-address]").removeClass("error").remove(".icon-exclamation-sign");if(t){var a=[];this.$(".control-group").addClass("error");_.each(this._getValue(),function(e,i){if(_.contains(t.email,e.email_address))a.push(i)});_.each(a,function(e){this.$('[email-id="'+e+'"]').addClass("error").append('<span class="icon icon-exclamation-sign"></span>')});_.each(t,function(t,i){n.push(e.error.getErrorString(i,t))});i=e.template.get("edit-field-error");this.$(".controls").append(i(n))}e.analytics.trackEvent("validation",this.name)},showActions:function(t){var i=$(t.currentTarget);i.addClass("active");var n=i.closest("[email-id]").attr("email-id");var a=this._getValue()[n];var o=[this.toggleOptOut,this.toggleInvalid,this.removeEmail];var s=[a.opt_out?"LBL_EMAIL_ACTION_SET_OPT_IN":"LBL_EMAIL_ACTION_SET_OPT_OUT",a.invalid_email?"LBL_EMAIL_ACTION_SET_VALID":"LBL_EMAIL_ACTION_SET_INVALID","LBL_REMOVE"];if(!a.primary_address){s.unshift("LBL_EMAIL_ACTION_SET_PRIMARY");o.unshift(this.setPrimaryEmail)}o=_.map(o,function(e){return _.bind(e,this,n)},this);s=_.map(s,function(t){return e.lang.get(t)});function r(){i.removeClass("active")}e.nomad.showActionSheet(null,s,function(e,t){o[t]();r()},r);return false},sendEmail:function(t){var i=$(t.target).data("index");if(i){var n=this._getValue();if(_.isObject(n[i])){e.nomad.sendEmail([n[i].email_address])}}}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.PhoneField=e.view.NomadField.extend({events:{"click .value a":"callPhone"},onFieldChange:function(){var e=this.format(this.unformat(this._$fieldEl.val()))||"";var t=this.model.get(this.name);this.model.set(this.name,e);if(t===e){this.model.trigger("change:"+this.name,this.model,e)}},callPhone:function(){e.nomad.callPhone(this.value,this.model)}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.TextareaField=e.view.NomadField.extend({fieldTag:"textarea",events:{"click .textarea":"onClick"},onClick:function(e){var t=this.isReadOnly();if(_.isEmpty(this.value)&&t){return}var i=this.getContext();var n=this.getLayoutDef(i);this.show(n)},getContext:function(){var t=e.context.getContext({create:true,parentModel:this.model,fieldName:this.def.name,isReadOnly:this.isReadOnly()});t.prepare();return t},getLayoutDef:function(e){return{className:"textarea",gaTrack:"textarea",meta:{components:[{view:"textarea-edit",editedFieldName:this.label}]},context:e}},show:function(t){var i=e.controller.loadDynamic({layoutDef:t});var n=i.getComponent("textarea-edit");n.setValue(this.model.get(this.name)||"")}})})(SUGAR.App)},function(e,t){(function(e){var t;e.view.fields.EmailbodyField=t=e.view.fields.TextareaField.extend({fieldTag:"textarea",events:{"click textarea":"onClick"},onClick:function(t){if(_.isEmpty(this.value)&&this.isReadOnly())return;e.nomad.showEmailBody(this.def,this.model)},format:function(e){if(_.isEmpty(e))e=t.getPlainTextValue(this.name,this.model);return e}},{getPlainTextValue:function(e,t){var i=e.replace(/_html$/,"");var n=t.get(i)||"";return $.trim(n)}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.RadioenumField=e.view.NomadField.extend({events:{"click .btn-group .btn":"onClick"},onClick:function(e){this.model.set(this.name,$(e.currentTarget).val())}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.RelateField=e.view.NomadField.extend({events:{"click .secondary-btn":"onSecondaryClick","click .relate":"onClick"},onBeforeRender:function(){e.view.NomadField.prototype.onBeforeRender.call(this);var t=this.def.module;this.hasAccess=e.acl.hasAccess("read",t)&&!_.isEmpty(e.metadata.getModule(t));var i=this.model.get(this.def.id_name);this.link=!_.contains(e.config.readonlyModules,t)&&i&&e.acl.hasAccess("view",t)?e.router.buildRoute(t,i):null;if(!this.hasAccess&&this.view.name==="edit"){this.options.viewName="readonly"}},onClick:function(t){if(t.defaultPrevented)return false;var i=e.metadata.getModule(this.module).fields[this.name];var n=i.module;var a=e.context.getContext({module:n}).prepare();var o=e.controller.loadDynamic({layoutDef:{gaTrack:"relate",name:"list",subType:"selector",editable:true,context:a,listMeta:{multiselect:false,headerData:{title:e.lang.get("LBL_ASSIGN",a.get("module"),e.lang.getAppListStrings("moduleListSingular")[a.get("module")]),save:false}}}});var s=o.getComponent("list-selector");s.on("selection:submit",function(t){this.onRelatedItemSelected(t);e.controller.goBack()},this)},onRelatedItemSelected:function(t){var i={};var n=e.metadata.getModule(this.view.module).fields[this.name];i[n.id_name]=t.get("id");i[n.name]=t.get("name");if(n.populate_list&&n.auto_populate){_.each(n.populate_list,function(n,a){a=_.isNumber(a)?n:a;var o=t.get(a);if(!_.isUndefined(o)&&e.acl.hasAccessToModel("edit",this.model,n)){i[n]=o;if(this.view.module==="RevenueLineItems"&&a==="discount_price"){_.each(["likely_case","best_case","worst_case"],function(e){i[e]=o})}}if(a==="currency_id"&&this.model.get("currency_id")!==o){this.model.changeCurrencyId(o)}},this)}this.model.set(i)},onSecondaryClick:function(e){this.model.set(this.name,"");this.model.set(this.def.id_name,"");return false}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.MultienumField=e.view.NomadField.extend({events:{"touchstart .remove":"highlightRemoveClick","click .remove":"onRemoveClick","click .multiselect":"onClick"},onBeforeRender:function(){e.view.NomadField.prototype.onBeforeRender.call(this);var t=this.model.get(this.name);if(this.view.isEditView()&&_.isArray(t)&&!this.def.required&&t.length===1&&t[0]===""){this.model.set(this.name,[],{silent:true})}},onClick:function(t){if(t.defaultPrevented||this.isReadOnly()){return false}var i=e.context.getContext({create:true});i.prepare();var n=e.controller.loadDynamic({layoutDef:{className:"layout__list",gaTrack:"multienum",meta:{components:[{view:{name:"list-picker",meta:{multiselect:true,headerData:{title:e.lang.get("LBL_CHOOSE_ITEMS"),saveLabel:"LBL_DONE_BUTTON_LABEL",save:true}}}}]},context:i}});var a=n.getComponent("list-picker");a.setData({items:this._getItemsToShow()});a.on("selection:submit",this.onSelectionEnd,this);a.render();t.preventDefault()},_getItemsToShow:function t(){var t=this.model.fields[this.name].options;var i=e.lang.getAppListStrings(this.def.options);var n=[];if(_.isObject(t)&&!_.isEmpty(t)){i=_.pick(i,_.keys(t))}_.each(i,function(e,t){if(!_.contains(this.value,t)&&t!==""){n.push({label:e,value:t})}},this);return n},onSelectionEnd:function(t){var i=_.map(t,function(e){return e.get("value")});var n=_.compact(this.model.get(this.name));this.model.set(this.name,_.union(n,i));e.controller.disposeDynamic()},highlightRemoveClick:function(e){$(e.target).addClass("selected-item")},onRemoveClick:function(e){var t=this.model.get(this.name);var i=$(e.target).is("[item-id]")?$(e.target):$(e.target).closest("[item-id]");var n=i.attr("item-id");var a=_.without(t,n);this.model.set(this.name,a);return false}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.FavoriteField=e.view.NomadField.extend({events:{"click .favorite-icon":"onClick"},onClick:function(t){t.preventDefault();t.stopPropagation();e.alert.dismissAll();var i=$(t.currentTarget);var n=i.hasClass("icon-star");var a=this.model;var o=function(){a.set("my_favorite",n)};a.favorite(!n,{error:o});return false}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.FieldsetField=e.view.NomadField.extend({fields:null,subfields:"",initialize:function(t){var i=this;e.view.NomadField.prototype.initialize.call(this,t);_.each(this.def.fields,function(e){if(e.type==="label"){var t=e.css_class.match(/label_[^\s]+/);if(t.length>0){var n=t[0].substring(6);i.model.on("change:"+n,function(){var e=i.model.get(n);if(e||e===0||e==="")i.$el.find(".label_"+n).removeClass("hide");else i.$el.find(".label_"+n).addClass("hide")},i)}}})},_render:function(){if(this.template===e.template.empty){e.view.NomadField.prototype._render.apply(this,arguments)}},getPlaceholder:function(){var t="";var i=this;if(!this.fields){this.fields=[];_.each(this.def.fields,function(n){var a=e.view.createField({def:n,view:i.view,model:i.model});i.fields.push(a);t+=a.getPlaceholder()})}if(this.def.orientation==="horizontal"){this.subfields=new Handlebars.SafeString(t);return e.view.NomadField.prototype.getPlaceholder.call(this)}else{return new Handlebars.SafeString(t)}}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.TeamsetField=e.view.NomadField.extend({cacheDisabled:true,events:{"click .primary-btn":"onPrimaryClick","click .secondary-btn":"onSecondaryClick","click .teamset":"onClick"},initialize:function(e){this._super("initialize",arguments);this.model.on("change:team_name",function(){this.$el.find("[team-id]").removeClass("active")},this)},_render:function(){var e=this.model.get(this.name);if(_.isArray(e)){e=_.sortBy(e,function(e){return e.primary!==true});this.model.set(this.name,e,{silent:true})}this._super("_render",arguments)},onClick:function(t){if(t.defaultPrevented||this.isReadOnly()){return false}var i="Teams";var n=e.context.getContext({module:i}).prepare();var a=e.controller.loadDynamic({layoutDef:{name:"list-selector",subType:"selector",editable:true,gaTrack:"teamset",context:n,listMeta:{listItemTpl:"list-item-teamset",headerData:{title:e.lang.get("LBL_MOBILE_SELECT_TEAMS"),saveLabel:"LBL_DONE_BUTTON_LABEL"}}}});a.getComponent("list-selector").on("selection:submit",this.onSave,this)},onSave:function(t){t=_.map(t,function(e){return _.pick(e.attributes,"id","name","name_2")});var i=_.compact(this.model.get("team_name"));var n=_.pluck(i,"id");n=_.map(n,function(e){return e.toString()});var a=_.chain(t).reject(function(e){return _.include(n,e.id.toString())}).union(i).value();this.model.set("team_name",a);e.controller.goBack()},onPrimaryClick:function(e){var t=this.$el.find("[team-id].active").removeClass("active").attr("team-id");var i=$(e.currentTarget);i.addClass("active");var n=_.find(this.model.get("team_name"),function(e){return e.id==t});if(n){n.primary=false}var a=$(e.currentTarget).attr("team-id");var o=_.find(this.model.get("team_name"),function(e){return e.id==a});o.primary=true;return false},onSecondaryClick:function(e){var t=this.model.get("team_name");var i=$(e.target).is("[team-id]")?$(e.target):$(e.target).closest("[team-id]");var n=i.attr("team-id");var a=_.reject(t,function(e){return e.id==n});this.model.set("team_name",a);return false}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.ParentField=e.view.NomadField.extend({events:{"click .secondary-btn":"onSecondaryClick","click .parent":"onClick"},onBeforeRender:function(){this._super("onBeforeRender",arguments);var t=this.model.get("parent_type");this.hasAccess=e.acl.hasAccess("read",t)&&!_.isEmpty(e.metadata.getModule(t));var i=this.model.get(this.def.id_name);this.link=!_.contains(e.config.readonlyModules,t)&&i&&e.acl.hasAccess("view",t)?e.router.buildRoute(t,i):null},onClick:function(t){if(t.defaultPrevented)return false;var i=e.context.getContext({model:this.model,collection:new e.BeanCollection,skipFetch:true});i.prepare();var n=e.controller.loadDynamic({layoutDef:{className:"layout__list list-picker",gaTrack:"parent-picker-list",meta:{components:[{view:{name:"list-picker",meta:{headerData:{title:e.lang.get("LBL_CHOOSE_PARENT_TYPE")}}}}]},context:i}});var a=n.getComponent("list-picker");var o=e.lang.getAppListStrings(this.def.options)||{};var s=e.metadata.getModuleNames({filter:"visible"});var r=_.intersection(_.keys(o),s);if(_.contains(["Notes","Tasks"],this.module)){r=_.without(r,"Contacts")}r=_.filter(r,function(t){return e.acl.hasAccess("read",t)},this);var l=_.map(r,function(e){return{value:e,label:o[e],module:e}}).sort(function(e,t){return e.label>t.label?1:-1});a.setData({items:l});a.on("selection:submit",function(e){this.createParentListLayout(e.get("value"),this.model)},this);a.render()},createParentListLayout:function(t,i){var n=e.context.getContext({module:t}).prepare();var a=n.get("module");var o=e.controller.loadDynamic({layoutDef:{gaTrack:"parent-list",name:"list",subType:"selector",editable:true,context:n,listMeta:{multiselect:false,headerData:{title:e.lang.get("LBL_ASSIGN",a,e.lang.getAppListStrings("moduleListSingular")[a]),save:false}}}});var s=o.getComponent("list-selector");s.on("selection:submit",function(n){i.set({parent_name:n.get("name"),parent_id:n.get("id"),parent_type:t});e.controller.disposeDynamic({disposeAll:true})},this)},onSecondaryClick:function(e){this.model.set({parent_name:"",parent_id:"",parent_type:""});return false}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.UrlField=e.view.NomadField.extend({regexp:/^(https?:\/\/)?[\w-]+(\.[\w-]+)+([\w\s.,@?^=%&amp;:\/~+#-]*)?$/,events:{"click .value a":"openUrl"},unformat:function(e){var t="://";var i=e;e=$.trim(e);if(e.indexOf(t)>-1){i=e.split(t)[1];if(!i)return""}return e},openUrl:function(){e.nomad.openUrl(this.model.get(this.name),true)}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.LabelField=e.view.NomadField.extend({onAfterRender:function(){e.view.NomadField.prototype.onAfterRender.call(this);if(this.el){var t=this.el.className.match(/label_[^\s]+/);if(t.length>0){var i=this.model.get(t[0].substring(6));if(i||i===0||i==="")$(this.el).removeClass("hide");else $(this.el).addClass("hide")}}}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.AddressField=e.view.NomadField.extend({cacheDisabled:true,events:{"click .control-group":"onClick","click .value a":"openAddress"},initialize:function(e){this._super("initialize",arguments);this._subfieldStub={};this.model.on("error:validation",this._handleValidationError,this);this.model.on("acl:change:"+this.def.fields[0].name,this.handleAclChange,this);this.fieldNames=_.pluck(this.def.fields,"name");this.required=this.isRequired()},onClick:function(){if(this.isReadOnly())return;var t=this;var i=new e.NomadBean;i.module=this.model.module;i.fields={};i.attributes=e.utils.deepCopy(this.model.attributes);_.each(this.def.fields,function(n){i.fields[n.name]=e.utils.deepCopy(t.model.fields[n.name]);i.attributes[n.name]=t.model.attributes[n.name]});var n=e.context.getContext({editedFieldName:this.label,addressFields:this._prepareAddressFieldDefs(),parentModel:this.model,model:i,collection:new e.BeanCollection,skipFetch:true});n.prepare();e.controller.loadDynamic({layoutDef:{className:"edit-address",gaTrack:"address",meta:{components:[{view:"address-edit"}]},context:n}})},bindDataChange:function(){if(this.model){_.each(this.def.fields,function(e){this.model.on("change:"+e.name,this.render,this)},this)}},onBeforeRender:function(){this._super("onBeforeRender");var t=[];var i=[];var n=/street/;_.each(this.def.fields,function(a){var o=this.model.get(a.name);if(o){var s=a.name;if(n.exec(s)){if(e.serverInfo.isSevenUp){o=e.nomad.utils.nl2br(o)}else{o=o.replace(/(\n(\r)?)/g," ").replace(/\s{2,}/g," ");this.model.set(s,o)}t.push(o)}else{i.push(o)}}},this);this.addressValue=(t.length>0?t.join()+"<br>":"")+i.join(" ")},_checkAccessToAction:function(t){return e.acl.hasAccessToModel(t,this.model,this.def.fields[0].name)},_handleValidationError:function(t){var i;var n={};var a=[];var o=this.$(".controls");var s=this.model.module;_.each(t,function(e,t){if(_.contains(this.fieldNames,t)){n[t]=e}},this);o.children(".error-display").remove();if(_.isEmpty(n))return;this.$(".control-group").addClass("error");_.each(n,function(t,i){var n=_.find(this.def.fields,function(e){return e.name===i});var o=n?e.lang.get(n.label,s):i;_.each(t,function(t,i){a.push(o+" : "+e.error.getErrorString(i,t))})},this);i=e.template.get("edit-field-error");o.append(i(a))},openAddress:function(){var t={};t[this.name]=this.def.fields;var i=this.model.getAddresses(t);e.nomad.openAddress(i)},getSubfield:function(t){var i=_.findWhere(this.def.fields,{name:t});var n=this;if(!i){return}if(!this._subfieldStub[t]){this._subfieldStub[t]=e.view.createField({def:i,view:this.view,model:this.model});this._subfieldStub[t].setRequired=function(t){var i=n.required;e.view.NomadField.prototype.setRequired.call(this,t);n.required=n.isRequired();if(i!==n.required){n.render()}}}return this._subfieldStub[t]},isRequired:function(){var t=this._subfieldStub||{};return _.any(this.def.fields,function(i){return t[i.name]?t[i.name].isRequired():i.required||e.metadata.getModule(this.module).fields[i.name].required},this)},_prepareAddressFieldDefs:function(){return _.map(this.def.fields,function(e){var t=this._subfieldStub[e.name];var i=e;if(t){i=_.extend({},e,{view:t.isDisabled()||t.isReadOnly()?"readonly":undefined,required:t.isRequired()})}return i},this)},_dispose:function(){this._super("_dispose",arguments);this._subfieldStub=null}})})(SUGAR.App)},function(e,t){(function(e){e.view.fields.TagField=e.view.NomadField.extend({initialize:function(e){if(e.view.name==="edit"){e.viewName="readonly"}this._super("initialize",[e])}})})(SUGAR.App)},function(e,t){(function(e){var t;var i=document.getElementById("viewport-meta");var n={"default":i?i.getAttribute("content"):null};e.lang.DIRECTION_RTL="rtl";e.lang.DIRECTION_LTR="ltr";e.augment("nomad",{timePaused:0,globalEvents:["app:access:error","app:orientation:changed","app:header:save","app:header:cancel","app:header:clicked","app:header:home","app:header:add","app:header:picturechanged","app:header:action","app:settings:changed","app:rightmenu:show","app:mainmenu:show","edit:view:save","associate:view:save","actionsheet:show","acl:change","field:image:filechanged","field:image:fileclear","app:keyboard:hide","app:dashboards:changed","nativeMessage"],SETTINGS_CACHE_KEY:"settings",LAST_STATE_CACHE_KEY:"lastState",DEFAULT_ROUTE:"Search",_syncedAppStart:function(){e.nomad.setHTMLDirection();if(e.supportedFeatures.dashboards&&!e.nomad.dashboards.isStarted()){e.nomad.dashboards.start();e.nomad.dashboards.fetchDashboards({notifyIfChanged:true})}e.setupBuddy.show(function(){e.nomad.startApp()})},startApp:function(){var t=e.nomad.utils.getHash().replace("#","");var i=e.controller.getScreenContext();var n=i&&!e.controller.canLoadModuleScreen(i);if(e.supportedFeatures.settingsDefaultView&&!t||n){e.nomad.navigateToDefaultView()}if(!e.started){e.start()}else{e.router.start()}e.nomad.disposeAllAdditionalComponents();e.controller.loadAdditionalComponents(e.config.additionalComponents);_.each(e.additionalComponents,function(e){e.bindGlobalEvents()});e.nomad.mainMenu.start()},navigateToDefaultView:function(){if(e.supportedFeatures.dashboards){e.nomad.dashboards.verifyDefaultView()}var t=e.nomad.getSetting("default_view")||e.config.defaultViewScheme;var i=this.getDefaultRoute(t);e.routing.replaceRoute(i)},getDefaultRoute:function(t){var i=t.split(":");if(i[0]==="Modules"){if(_.contains(e.metadata.getModuleNames(),i[1])){i.shift();return i.join("/")}else{i=[this.DEFAULT_ROUTE]}}return i.join("/")},deviceReady:function(){var t=this;window.App=SUGAR.App;e.isNative=!_.isUndefined(window.cordova);e.isTouchCapable="ontouchstart"in window;e.nomad.utils.augmentZeptoDetect(e.isNative);if(!this._isPlatformSupported()){e.error.handleNotSupportedPlatform();return}if(e.config.nativeRedirectEnabled){this.redirectToNativeApp()}this._computeMode();e.clientInfo={app:{name:e.config.appId,rebrandName:e.config.appName,version:e.config.nomadVersion,build:e.config.nomadBuild,isNative:e.isNative},device:null,browser:_.extend($.browser,{userAgent:navigator.userAgent})};e.nomad.initSupportedFeatures();e.events.on("nomad:sync:complete",this._syncedAppStart);async.waterfall([function(t){var i={name:"store-"+e.config.appId+"-"+e.config.env,"native":e.isNative,encrypt:e.config.keyValueStoreEncryptionEnabled,forceEncryption:e.config.keyValueStoreEncryptionEnabled};var n={name:"ac",async:false};var a=e.config.keyValueStore==="sqlKeyValueStore"?"localStorageKeyValueStore":"sqlKeyValueStore";e.nomad.stores={};e.keyValueStore=e[e.config.keyValueStore];e.keyValueStore.open(i);e[a].open(i);async.parallel([function o(t){async.parallel({oldBucket:function i(t){e[a].initBucket(n,t)},newBucket:function o(t){e.keyValueStore.initBucket(n,t)}},function(i,n){if(!i){e.nomad.utils.migrateKeyValueStore(n.newBucket,n.oldBucket);e.cache.store=n.newBucket}t(i)})},function s(t){e.keyValueStore.initBucket({name:"dashlet_data",async:true},function(i,n){if(!i){e.nomad.stores.dashlets=n}t(i)})},function r(t){e.keyValueStore.initBucket({name:"filters",async:false},function i(n,a){if(!n){e.nomad.stores.filters=a}t(n)})}],function(e){t(e)})},function(i){t.preInit(e.clientInfo,i)},function(e){t.start()}],function(t){if(t){e.logger.fatal("Failed to init the app: "+t);e.nomad.showAlert(e.lang.get("ERR_INTERNAL_ERR_MSG"),null,e.lang.get("ERR_GENERIC_TITLE"))}});if(!e.isNative&&$.os.android&&$.smartbanner){$.smartbanner({layer:true})}},_computeMode:function(){e.isTablet=e.config.deviceMode.type==="tablet"||e.config.deviceMode.type==="auto"&&(document.body.clientWidth>=768||document.body.clientHeight>=768);e.isNarrowTabletMode=e.isTablet&&(document.body.clientWidth<601||document.body.clientHeight<601);if(e.isTablet){$(document.body).removeClass("mobile");$(document.body).addClass("tablet");if(e.isNarrowTabletMode)$(document.body).addClass("narrow-tablet-mode")}else{$(document.body).removeClass("tablet narrow-tablet-mode");$(document.body).addClass("mobile")}if($.os.desktop){$(document.body).addClass("desktop")}},disposeAllAdditionalComponents:function(){_.each(e.additionalComponents,function(e){if(e){e.unbindGlobalEvents();e.dispose();if(e.$el){e.$el.html("");e.unbind()}e.unbindData();e.stopListening();e.model=null;e.collection=null;e.context=null;e.$el=null;e.el=null}});e.additionalComponents={}},start:function(){this.computeOrientation();e.logger.debug("Client: "+JSON.stringify(e.clientInfo));e.nomad._initializeRemoteWebInspector();$.__swipeHelper.init();if(e.config.keyValueStore==="localStorageKeyValueStore"){try{var t=e.config.env+":"+e.config.appId+":settings";var i=window.localStorage.getItem(t);if(i&&i[1]==="'"){window.localStorage.setItem(t,i.replace(/'/g,'"'))}}catch(n){}}e.init({el:"#nomad"});e.nomad.handleAuthTokens();e.api.debug=e.config.debugSugarApi;e.api.setRefreshTokenSuccessCallback(function(e){e()});e.api.handleExternalLogin=_.bind(e.nomad.handleExternalLogin,this);e.telephony.clearCallLog();this.setFontSize(e.nomad.getSetting("fontSize"));_.each(this.globalEvents,function(t){e.events.register(t,e)});e.logger.debug("App started in "+(e.isNative?"native shell":"browser"));document.addEventListener("pause",_.bind(this.onPause,this),false);document.addEventListener("resume",_.bind(this.onResume,this),false);document.addEventListener("memoryWarning",_.bind(this.onMemoryWarning,this),false);document.addEventListener("backbutton",_.bind(this.onBackButtonClicked,this),false);window.addEventListener("orientationchange",_.bind(this.onOrientationChange,this),false);if(e.isSynced){this._syncedAppStart()}else{e.start()}},initSupportedFeatures:function(){e.supportedFeatures={fileUpload:function t(){var t=$.os.version;if($.os&&$.os.version){if($.os.ios){return e.utils.versionCompare(t,"6",">=")}else if($.os.android){return e.utils.versionCompare(t,"4.0.3",">=")}}return true}(),menuAnimation:function i(){if($.os&&$.os.version){return!($.os.android&&e.utils.versionCompare($.os.version,"4.0.3","<"))}return true}(),canvasJpegEncoding:function n(){var e=document.createElement("canvas");var t=e.toDataURL("image/jpeg");return t.indexOf("image/jpeg")!==-1}(),bulkApi:false,recents:false,offline:false,fileUploadForDocs:false,fts:false,followingPreloaderFilter:false,productsModule:false,dashboards:false,configurableSavedReportsChart:false,settingsDefaultView:false,enumViaActionSheet:false,filters:false,populateList:false,localSecurityServerSupport:false}},updateSupportedFeatures:function(t){var i=!_.isEmpty(e.metadata.getServerInfo())?e.metadata.getServerInfo():t?t.server_info:{};e.supportedFeatures.offline=e.offline&&e.offline.isSupported(i);e.supportedFeatures.fts=i.fts&&i.fts.enabled;e.supportedFeatures.productsModule=e.nomad.isSevenUp(i);e.supportedFeatures.dashboards=e.config.dashboards.enabled&&e.utils.versionCompare(i.version,e.config.dashboards.minServerVersion,">=");var n=e.config.dashboards.dashlets["activitystream-dashlet"];e.supportedFeatures.activities=!!n&&n.enabled&&e.utils.versionCompare(i.version,n.minServerVersion,">=");if(e.utils.versionCompare(i.version,"7.1.5",">=")){e.supportedFeatures.settingsDefaultView=true}if(e.utils.versionCompare(i.version,"7.2",">=")){e.supportedFeatures.recents=true;e.supportedFeatures.followingPreloaderFilter=true;e.supportedFeatures.filters=true;e.supportedFeatures.populateList=true}if(e.utils.versionCompare(i.version,"7.2.1",">=")){e.supportedFeatures.bulkApi=true;e.supportedFeatures.fileUploadForDocs=true}if(e.utils.versionCompare(i.version,"7.6.0.0RC1",">=")){e.supportedFeatures.configurableSavedReportsChart=true}if(e.isNative&&$.os.tablet&&($.os.ipad&&e.utils.versionCompare($.os.version,"8",">="))){e.supportedFeatures.enumViaActionSheet=true}if(e.utils.versionCompare(i.version,e.config.localSecurity.minServerVersion,">=")){e.supportedFeatures.localSecurityServerSupport=true}this._patchConfig()},updateServerInfo:function(){e.serverInfo=e.metadata.getServerInfo();this.updateSupportedFeatures()},_patchConfig:function(){if(e.supportedFeatures.productsModule){e.config.unsupportedModules=_.without(e.config.unsupportedModules,"Products")}else if(!_.contains(e.config.unsupportedModules,"Products")){e.config.unsupportedModules.push("Products")}if(e.supportedFeatures.fileUploadForDocs){e.config.nonCreatableModules=_.without(e.config.nonCreatableModules,"Documents")}else if(!_.contains(e.config.nonCreatableModules,"Documents")){e.config.nonCreatableModules.push("Documents")}},isSevenUp:function(t){return t?e.utils.versionCompare(t.version,"7.0RC",">="):false},resetMeta:function(t,i){var n=e.cache.get("app:build")!==e.config.appBuild;var a=t||!e.config.cacheMeta||n;var o=e.metadata.getHash();if(a){e.logger.debug("Resetting meta");
e.metadata.clearCache();e.cache.cut("user");var s=JSON.parse(JSON.stringify(e.baseMetadata));if(!t&&o&&!n)s._hash=o;e.metadata.set(s,false,true);e.cache.set("app:build",e.config.appBuild);e.setupBuddy.setSetupBuddyDone(false)}if(a||i){e.cache.set("app:synced","0")}e.isSynced=!i&&!a&&e.config.cacheMeta&&e.cache.get("app:synced")==="1";e.logger.debug("App is synced: "+e.isSynced)},resetAuth:function(){e[e.config.authStore].cut("AuthAccessToken");e[e.config.authStore].cut("AuthRefreshToken")},saveUser:function(){e.cache.set("user",e.user.toJSON())},restoreUser:function(){e.user.set(e.cache.get("user")||{})},resetUserSettings:function(){var t=this._fetchCacheItem(this.SETTINGS_CACHE_KEY);var i=t.loginName;if(t.prevUsername!==i){e.localSecurity.resetCredentials();this.removeLastState();var n=["loginName","loginUrl","siteUrl","useHttps"];_.each(t,function(e,i){if(!_.contains(n,i)){delete t[i]}});t.prevUsername=i;this._saveCacheItem(this.SETTINGS_CACHE_KEY,t);e.cache.cut("lang");e.user.clear();this.saveUser();e.nomad.cleanStores();e.nomad.dashboards.cleanDashboardsCache();e.setupBuddy.setSetupBuddyDone(false)}else if(t.prevSiteUrl!==t.siteUrl){this.removeLastState();e.nomad.removeSetting("default_view");e.nomad.cleanStores();e.nomad.dashboards.cleanDashboardsCache();t.prevSiteUrl=t.siteUrl;this._saveCacheItem(this.SETTINGS_CACHE_KEY,t)}if(t.default_view==="Recents"){e.nomad.removeSetting("default_view")}},cleanStores:function a(t){var i=[];t=t||function(){};_.each(e.nomad.stores,function n(e){i.push(_.bind(e.cutAll,e))});async.parallel(i,t)},getSetting:function(e){return this._fetchCacheItem(this.SETTINGS_CACHE_KEY)[e]},setSetting:function(e,t){this._setCacheItem(this.SETTINGS_CACHE_KEY,e,t)},removeSetting:function(e){if(e){this._removeCacheItem(this.SETTINGS_CACHE_KEY,e)}},getLastState:function(e){return this._fetchCacheItem(this.LAST_STATE_CACHE_KEY)[e]},setLastState:function(e,t){this._setCacheItem(this.LAST_STATE_CACHE_KEY,e,t)},removeLastState:function(e){this._removeCacheItem(this.LAST_STATE_CACHE_KEY,e)},_fetchCacheItem:function(t){return e.cache.get(t)?e.cache.get(t):{}},_saveCacheItem:function(t,i){e.cache.set(t,i)},_setCacheItem:function(e,t,i){var n=this._fetchCacheItem(e);if(_.isObject(t)){n=_.extend(n,t)}else{n[t]=i}this._saveCacheItem(e,n)},_removeCacheItem:function(t,i){if(i){var n=this._fetchCacheItem(t);delete n[i];this._saveCacheItem(t,n)}else{e.cache.cut(t)}},enableOffline:function(t){var i=false;if(t){i=e.nomad.getSetting("prevSiteUrl")!==e.nomad.getSetting("siteUrl");e.nomad.setSetting("prevSiteUrl",e.nomad.getSetting("siteUrl"))}e.offline.userEnabled=_.isUndefined(e.nomad.getSetting("offlineEnabled"))?true:!i&&Boolean(e.nomad.getSetting("offlineEnabled"))},getRelationshipLink:function(t,i){var n=e.metadata.getModule(t);var a=_.find(n.fields,function(t){if(t.type==="link"){var n=e.metadata.getRelationship(t.relationship);return n&&(n.lhs_module===i||n.rhs_module===i)}});return a?a.name:null},getRelationship:function(t,i){var n=e.metadata.getModule(t);var a=n.fields[i].relationship;return e.metadata.getRelationship(a)},onPause:function(t){e.logger.debug("App was paused");e.logger.debug(t);this.timePaused=(new Date).getTime();_.each(e.modules,function(e){if(_.isFunction(e.onAppPause)){e.onAppPause()}});e.controller.layoutManager.onAppPause()},onResume:function(i){var n=((new Date).getTime()-(this.timePaused||0))/1e3;e.logger.debug("App resumed: "+n);e.logger.debug(i);_.each(e.modules,function(e){if(_.isFunction(e.onAppResume)){e.onAppResume()}});e.controller.layoutManager.onAppResume();_.delay(function(){var i=t;if(i!==e.nomad.computeOrientation()){e.trigger("app:orientation:changed",window.orientation)}},1e3)},onMemoryWarning:function(){e.controller.clean();e.logger.warn("App received memory warning");e.analytics.trackEvent("device","low-memory")},onBackButtonClicked:function(){e.analytics.trackEvent("device","back");if(e.activeComponents.hasActiveComponents()){e.activeComponents.closeRecent();return}if(e.overlay.isActive())return;e.nomad.dismissAlerts();var t=e.events._events;if(document.activeElement)document.activeElement.blur();e.controller.goBack()},onOrientationChange:function(){var t=this;var i=$("body");if(e.isTablet&&document.activeElement)document.activeElement.blur();i.addClass("rotate");_.delay(function(){i.removeClass("rotate");if($.os.ios&&e.utils.versionCompare($.os.version,"7",">=")){window.scrollTo(0,window.scrollY)}t.computeOrientation();e.analytics.trackEvent("orientation",window.orientation);e.trigger("app:orientation:changed",window.orientation)},1e3)},computeOrientation:function(){if(e.isTablet&&(e.config.deviceMode.landscape||e.config.deviceMode.portrait)){if(e.config.deviceMode.landscape){t="landscape"}if(e.config.deviceMode.portrait){t="portrait"}}else{if($.os.ios){t=window.orientation===90||window.orientation===-90?"landscape":"portrait"}else{t=document.body.clientWidth>document.body.clientHeight?"landscape":"portrait"}}var a=$.os.ios?t==="portrait"?screen.height-window.innerHeight:screen.width-window.innerHeight:0;n.landscape=", height="+(screen.width-a);n.portrait=", height="+(screen.height-a);if(t==="landscape"){if($.os.ios&&e.isTablet){i.setAttribute("content",n.default+n.landscape)}$("html").removeClass("portrait").addClass("landscape")}else{if($.os.ios&&e.isTablet){i.setAttribute("content",n.default+n.portrait)}$("html").removeClass("landscape").addClass("portrait")}return t},getOrientation:function(){return t},dismissAlerts:function(){e.alert.dismissAll("success");e.alert.dismissAll("error")},supportsFavs:function(t){var i=e.metadata.getModule(t);return i?i.favoritesEnabled:false},supportsMyItems:function(t){var i=e.metadata.getModule(t);return i?!_.isUndefined(i.fields.assigned_user_id):false},buildLinkRoute:function(e,t,i,n,a){var o=_.isString(e)?e:e.get("module");o+="/"+t+"/link/"+i;if(n){o+="/"+n}if(a){o+="/"+a}return o},_initializeRemoteWebInspector:function(){if(e.config.weinre&&e.config.weinre.server!==""){var t=document.createElement("script");t.setAttribute("src","http://"+e.config.weinre.server+":"+e.config.weinre.port+"/target/target-script-min.js#"+e.config.weinre.guid);$("body").append(t)}},contextMetaViews:{list:{numberOfItems:2},detail:{numberOfItems:999},all:{numberOfItems:999,customModsOnly:true,useVarDef:true}},contextMeta:{},initializeContextMeta:function(){var t=this;_.each(t.contextMetaViews,function(i,n){t.contextMeta[n]=t.contextMeta[n]||{};var a=i.type||n;var o=_.keys(e.metadata.getModules());if(i.customModsOnly){o=_.reject(o,function(t){return e.nomad.isStandardModule(t)})}_.each(o,function(i){if(e.metadata.getModule(i)){var o=e.data.createBean(i);t.contextMeta[n][i]=t.calculateContextMeta(o,i,a)}})})},calculateContextMeta:function(t,i,n){var a=this.contextMetaViews[n].numberOfItems||999;var o=e.metadata.getView(i,n);var s=[];var r;if(this.contextMetaViews[n].useVarDef){s=[e.metadata.getModule(i)]}else if(o){s=o.panels}_.each(s,function(e,i){r=t.getContextMetaData(e.fields,a)});return r},getContextMeta:function(e,t){var i=this.contextMeta[e]||{};return t?i[t]:i},isStandardModule:function(t){return _.contains(e.config.knownModules,t)},initSubpanels:function(){var t=e.metadata.getModuleNames({filter:"visible"});t.push("Users");_.each(t,function(i){var n=e.metadata.getModule(i,"layouts");var a=n?n.subpanels:null;if(!a||!a.meta||!_.isArray(a.meta.components))return;var o=[];_.each(a.meta.components,function(n,a){var s;var r;try{s=e.data.getRelatedModule(i,n.context.link);r=e.nomad.getRelationship(i,n.context.link)}catch(l){s=null;r=null}if(!_.contains(t,s))s=null;if(s&&r){n.module=s;n.creatable=(_.isUndefined(n.canCreate)&&_.isUndefined(n.creatable)?true:n.canCreate||n.creatable)&&!_.contains(e.config.nonCreatableModules,s);n.linkable=(_.isUndefined(n.canLink)&&_.isUndefined(n.linkable)?true:n.canLink||n.linkable)&&!_.contains(e.config.nonLinkableModules,s)&&!(_.contains(["Meetings","Calls","Notes","Tasks"],s)&&r.via_parent_id);n.unlinkable=_.isUndefined(n.unlinkable)?true:n.unlinkable}else{o.push(a)}});for(var s=0;s<o.length;++s){a.meta.components.splice(o[s]-s,1)}})},hasLinkableSubpanels:function(t){return _.any(t,function(t){return t.linkable&&e.acl.hasAccess("list",t.module)})},hasCreatableSubpanels:function(t){return _.any(t,function(t){return t.creatable&&e.acl.hasAccess("create",t.module)})},getSubpanels:function(t){var i=e.metadata.getModule(t,"layouts").subpanels;return i&&i.meta?i.meta.components:[]},canCreateModule:function(t){return e.acl.hasAccess("create",t)&&!_.include(e.config.nonCreatableModules,t)},hasAccessToReqFields:function(t,i){var n=i||"edit";var a="edit";var o=e.metadata.getModule(t).fields;var s=o.assigned_user_name;var r=["team_name"];if(s&&s.type==="relate"){r.push(s.name,s.id_name)}return!_.chain(e.metadata.getView(t,a).panels[0].fields).filter(function(e){if(_.contains(r,e.name)){return false}return o[e.name]&&o[e.name].required}).find(function(i){return!e.acl.hasAccess(n,t,null,i.name)}).value()},canCreateRelated:function(e,t,i,n){return this.canCreateModule(e)&&this.hasAccessToReqFields(e,i)&&this._getSubpanel(t,n).creatable},canLinkRelated:function(e,t){return this._getSubpanel(e,t).linkable},canUnlinkRelated:function(e,t){return this._getSubpanel(e,t).unlinkable},canDisplay:function(e,t){return!(e.context.get("link")&&(t.type==="parent"||t.type==="relate"&&_.include(e.relateFields,t.name)))},_getSubpanel:function(e,t){return _.find(this.getSubpanels(e),function(e){return e.context.link===t})||{}},getSingularModuleName:function(t){return e.lang.getModuleName(t)},getPluralModuleName:function(t){return e.lang.getModuleName(t,{plural:true})},showAlert:function(t,i,n,a){this._showAlert(t,i,n||e.lang.get("LBL_WARNING"),a||e.lang.get("LBL_OK"))},showConfirm:function(t,i,n,a){this._showConfirm(t,i,n||e.lang.get("LBL_CONFIRM"),a||[e.lang.get("LBL_NO"),e.lang.get("LBL_YES")])},_executeActionSheetCallback:function(t){if(e.routing.emulateBackButton){e.activeComponents.executeOnActiveComponentClose(t)}else{t()}},sendEmail:function(t,i,n){var a=this;if(t.length>1){this.showActionSheet(e.lang.get("LBL_MOBILE_CHOOSE_RECIPIENT"),t,function(e,t){a._executeActionSheetCallback(function(){a._showEmailComposer(i,n,e)})})}else{this._showEmailComposer(i,n,t[0])}},showEmailBody:function(t,i){var n=_.isArray(t)?t[0]:t;var a=i.get(n.name);var o=e.view.fields.EmailbodyField.getPlainTextValue(n.name,i);var s="emailbody-edit";var r=e.context.getContext({create:true});r.prepare();e.controller.loadDynamic({layoutDef:{className:"EmailBodyView",gaTrack:"EmailBodyView",meta:{components:[{view:s,editedFieldName:e.lang.get(n.label,"Emails"),value:a||e.nomad.utils.nl2br(o)}]},context:r}})},sendConsoleLog:function(e,t,i){var n=this;this._getConsoleLogFilename(function(a){n._showEmailComposer(t,i,e,a)})},callPhone:function(t,i){var n=this;if(_.isArray(t)&&t.length>1){var a=this._buildNamedList(t);this.showActionSheet(e.lang.get("LBL_MOBILE_CHOOSE_PHONE"),a,function(a,o){n._executeActionSheetCallback(function(){e.telephony.callPhone(n._extractValue(t,o),i)})})}else{e.telephony.callPhone(this._extractValue(t),i)}},sendSms:function(t,i){var n=this;if(_.isArray(t)&&t.length>1){var a=this._buildNamedList(t);this.showActionSheet(e.lang.get("LBL_MOBILE_CHOOSE_PHONE"),a,function(e,a){n._executeActionSheetCallback(function(){n._showSmsComposer(n._extractValue(t,a),i)})})}else{this._showSmsComposer(this._extractValue(t),i)}},openUrl:function(t,i){if(_.isArray(t)&&t.length>1){var n=_.map(t,function(e){return _.keys(e)[0]});var a=this;this.showActionSheet(e.lang.get("LBL_MOBILE_CHOOSE_URL"),n,function(e,n){a._executeActionSheetCallback(function(){a._browseUrl(a._normalizeUrl(a._extractValue(t,n),i))})})}else{this._browseUrl(this._normalizeUrl(this._extractValue(t),i))}},openWebPage:function(e){this._browseWebPage(e)},showDateTimePicker:function(e,t,i){this._showDateTimePicker(e,t,i)},openDoc:function(t){var i=this;if(_.isArray(t)&&t.length>1){var n=_.map(t,function(t,i,n){return e.nomad.utils.replaceGuid(_.keys(t)[0],e.lang.get("LBL_MOBILE_DOC")+" "+(i+1))});this.showActionSheet(e.lang.get("LBL_MOBILE_CHOOSE_DOC"),n,function(e,n){i._executeActionSheetCallback(function(){i._openDocWorker(t,n)})})}else{this._openDocWorker(t)}},_openDocWorker:function(t,i){var n=_.clone(this._extractValue(t,i));var a=this._normalizeUrl(n.url);n.url=a.replace("{download_token}",e.api.getDownloadToken()).replace("{oauth_token}",e.api.getOAuthToken());this._flushCacheUrl(n);n.openExternally?this._browseUrl(n.url):this._browseDoc(n)},openAddress:function(t){var i=e.clientInfo.device;var n=i.osVersion||i.version||"";var a=!i.ios||i.ios&&!e.isNative?"g":"a";if(_.isArray(t)&&t.length>1){var o=this;var s=_.map(t,function(e){return _.keys(e)[0]});this.showActionSheet(e.lang.get("LBL_MOBILE_CHOOSE_LOCATION"),s,function(e,i){o._executeActionSheetCallback(function(){o._openMap(o._extractValue(t,i),a)})})}else{this._openMap(this._extractValue(t),a)}},_openMap:function(t,i){var n="";var a=i==="a"?"maps.apple.com":"maps.google.com";if(!t){t=""}else{var o="";if(t.country&&_.isString(t.country)){o=t.country.replace(/\s?\,\s?/g,",");if(/ of$/.test(o)||/ of the$/.test(o)){var s=o.split(",");o=s[s.length-1];for(var r=0;r<s.length-1;r++){o=o.concat(" "+s[r])}}else{o=t.country.replace(/\,/g,"")}}t=_.compact([t.street,t.city,t.state,t.postalcode,o]).join(",")}n="http://"+a+"/maps?q="+encodeURI(t);e.logger.debug("Opening map: "+n);this._browseUrl(n)},_buildNamedList:function(e){return _.map(e,function(e){return _.keys(e)[0]+" - "+_.values(e)[0]})},_extractValue:function(e,t){if(!t)t=0;return _.isString(e)?e:_.values(e[t])[0]||e[t].value||e[t]},_normalizeUrl:function(t,i){if(i){t=encodeURI(t)}if(e.nomad.utils.urlHasProtocolRegExp.test(t))return t;if(/^\.\.\//.test(t)){var n=window.location.href.split("#")[0].split("index.html")[0];t=n+t;return t}return"http://"+t},_flushCacheUrl:function(e){if(_.has(e,"noCache")&&!e.noCache)return;var t=e.url.split("#")[0];var i=[t,t.indexOf("?")!==-1?"&":"?","__ts=",+new Date];e.noCache=false;e.url=i.join("")},isEmptyValue:function(e){return _.isNull(e)||_.isUndefined(e)||!_.isNumber(e)&&_.isEmpty(e)||_.isNumber(e)&&!_.isFinite(e)},redraw:function(e){var t=$(document.body);var i=$("<style> body {opacity: 0.99;}</style>");function n(){t.append(i);_.delay(function(){i.remove()},e)}if(!e){n()}else{_.delay(n,e)}},configure:function(t,i,n){function a(){var t=e.routing.utils.convertSugarRoute(n.replace("#",""))||e.nomad.DEFAULT_ROUTE;e.router.navigate(t,{trigger:true})}function o(){e.nomad.setSetting({loginName:i,loginUrl:t,siteUrl:e.config.siteUrl});var n=e.controller.context.get("params");if(n&&n.layout==="login"){$("#username").val(i);$("#url").val(t);$("#password").val("");var o=e.controller.context.get("model");if(o){o.set("username",i);o.set("url",t);o.set("password","")}}else{e.router.login()}_.delay(function(){a()},1e3)}if(!e.config.allowUrlReconfigure){a();return false}e.logger.debug("Reconfiguring the client with username="+i+" and loginUrl="+t);i=i?decodeURIComponent(i):"";t=t?decodeURIComponent(t):"";if(e.config.configUrlWhiteList){var s=0;for(;s<e.config.configUrlWhiteList.length;s++){var r=new RegExp(e.config.configUrlWhiteList[s]);if(r.test(t))break}if(s===e.config.configUrlWhiteList.length){e.logger.warn("Configure server URL "+t+" is not in the white list. Ignoring value");t=e.nomad.getSetting("loginUrl")||""}}var l=i!==e.nomad.getSetting("loginName")||t!==e.nomad.getSetting("loginUrl");if(l){if(e.api.isAuthenticated()){e.logout({complete:function(){o()}},true)}else{o()}}else{a()}return l},updateAuthStore:function(){if(e.isNative){e.keychain.OAUTH["meta:hash"]=e.metadata.getHash();e.keychain.OAUTH["userpref:hash"]=e.user.get("_hash")}},isDownloadTokenSupported:function(){return!_.isEmpty(e.api.getDownloadToken())},getFileOptions:function(){var t=e.nomad.isDownloadTokenSupported();return{htmlJsonFormat:false,iframe:false,passOAuthToken:!t,passDownloadToken:t}},getProductVersion:function(){return e.clientInfo.app.productVersion+"."+e.clientInfo.app.productBuild+(e.config.env!=="prod"?" ("+e.config.env+")":"")+(_.isEmpty(e.config.buildTag)?"":" "+e.config.buildTag)},getServerVersion:function(){return e.serverInfo&&e.api.isAuthenticated()?e.serverInfo.version+" "+e.serverInfo.flavor:"N/A"},getServerUrl:function(){return e.isNative?e.config.siteUrl+"/rest/v"+e.config.restVersion:e.config.serverUrl},getDesktopUrl:function(){return e.config.siteUrl+"?mobile=0"},canFollow:function(t){var i=t.module;return e.serverInfo.isSevenUp&&_.contains(e.config.followableModules,i)&&e.acl.hasAccessToModel("view",t)},getModuleRelationships:function(t){var i=e.metadata.getModule(t);if(_.isEmpty(i.layouts.subpanels)){return}var n=i.layouts.subpanels.meta.components;var a=_.map(n,function(e){return e.context.link});var o=_.select(i.fields,function(e){return _.contains(a,e.name)&&e.type==="link"});return _.chain(o).pluck("name").map(function(i){return e.nomad.getRelationship(t,i)}).select(function(e){return!_.isEmpty(e)}).map(function(e,t){e.label=_.find(n,function(e){return e.context.link===o[t].name}).label;return e}).value()},showBackToSugarPage:function(t){e.controller.loadScreen({root:"Error",errorCode:404,backToSugar:true,sugarRoute:t})},configureSugarLogic:function(){if(e.isSynced){var t=[e.view.views.EditView,e.view.views.DetailView,e.view.views.ListView];_.each(t,function(t){var i=t.prototype.plugins;var n=i.indexOf("SugarLogic");var a=n!==-1;if(e.config.sugarLogic.enabled&&!a){i.push("SugarLogic")}else if(!e.config.sugarLogic.enabled&&a){i.splice(n,1)}})}},setFontSize:function(t){t||(t=e.config.UI.defaultFontSize);document.documentElement.style.fontSize=e.config.UI.fontSizes[t]+"px"},setHTMLDirection:function(){if(!e.config.UI.supportedRTL)return;var t=e.user.getPreference("language")||e.cache.get("lang");var i=["ar_SA","he_IL"];var n=_.contains(i,t)||e.config.UI.rtl||false;$("html").toggleClass("rtl",n);e.lang.direction=n?e.lang.DIRECTION_RTL:e.lang.DIRECTION_LTR},buildBulkRequest:function(t){var i;var n="/v"+e.config.restVersion;t=t||{};i=e.api.buildURL.call({serverUrl:n},t.module,null,t.attributes,t.params);return{url:i,method:t.method||"GET",headers:t.headers,data:t.data}},syncApp:function(){$("html").addClass("syncApp");e.sync({callback:function(t){if(!t){e.nomad.updateServerInfo();var i=[function n(t){e.nomad.startRecordsPreloader(function(i){if(i){e.logger.error("Records preloading failed. Error:"+i)}t()})}];if(e.supportedFeatures.dashboards){e.nomad.dashboards.reset();i.push(function a(t){e.nomad.dashboards.start();e.nomad.dashboards.fetchDashboards({notifyIfChanged:false},function(i){if(i){e.logger.error("Couldn't preload dashboards. Error: "+i);e.nomad.showAlert(e.lang.get("ERR_MOBILE_DASHBOARDS_FETCHING"))}t(null)})})}async.parallel(i,function(){e.events.trigger("nomad:sync:complete");$("html").removeClass("syncApp")})}}})},share:function(t){e.nomad._share(t)},getFtsEnabledModules:function(){if(e.supportedFeatures.fts){var t=[];_.each(e.metadata.getModules(),function(e,i){if(e.ftsEnabled){t.push(i)}},this);return t}else{return null}},redirectToNativeApp:function(){e.nomad._redirectToNativeApp()}})})(SUGAR.App)},function(e,t){(function(e){_.extend(e.nomad,{recordsPreloaderPromptKey:"preload_prompted",startRecordsPreloader:function(t){if(e.offlineEnabled&&e.config.offline.prefetch.enabled&&e.offline.storage.getMigrationSummary().storageRebuilt){e.logger.debug("Prefetching static modules");e.offline.syncManager.recordsPreloader.start({callback:function(i){if(i){t(i)}else{e.nomad.promptAndPreloadUserRecords(true,null,t)}}})}else{t()}},promptAndPreloadUserRecords:function(t,i,n){var a=this;var o=e.lang.get(t?"LBL_OFFLINE_PREFETCH_FIRST_PROMPT":"LBL_OFFLINE_PREFETCH_PROMPT");var s=t?[e.lang.get("LBL_LATER"),e.lang.get("LBL_YES")]:null;var r=i?"_preloadRelationships":"_preloadRecords";if(t){var l=this.getSetting(this.recordsPreloaderPromptKey);if(l){return n()}}e.nomad.showConfirm(o,function(t){a.setSetting(a.recordsPreloaderPromptKey,true);if(t===2){e.nomad.dismissAlerts();a[r](function(t){e.controller.clean();if(t){e.alert.show("prefetch_failed",{level:"error",messages:e.lang.get("LBL_OFFLINE_PREFETCH_ERROR"),autoClose:true,closable:true})}else{e.alert.show("prefetch_success",{level:"success",messages:e.lang.get("LBL_OFFLINE_PREFETCH_SUCCESS"),autoClose:true,closable:true})}if(n)n(t)})}else{if(n)n()}},null,s)},_preloadRecords:function(t){var i=this._getModulesToPreload();var n=this._getPreloaderFilter();e.offline.syncManager.recordsPreloader.start({filter:n,callback:t,modules:i})},_preloadRelationships:function(t){var i=this._getPreloaderFilter();var n=this._getModulesToPreload();var a={};_.each(n,function(t,i){var n=this.getModuleRelationships(i);a[i]={maxThreshold:t,relationships:{}};_.each(n,function(t){if(t.rhs_key!=="id"&&e.offline.storage.getRelationshipType(t.name)!=="many-to-many"){a[i].relationships[t.rhs_module]=t}})},this);e.offline.syncManager.recordsPreloader.start({filter:i,callback:t,relatedModules:a})},_getPreloaderFilter:function(){var t=[{$favorite:"_this"},{$owner:"_this"}];if(e.supportedFeatures.followingPreloaderFilter){t.push({$following:"_this"})}return[{$or:t}]},_getModulesToPreload:function(){var t={};var i=_.filter(e.offline.utils.getOfflineModules(),function(t){return!e.config.offline.prefetch.staticModules[t]});_.each(i,function(i){var n=e.config.offline.prefetch.dynamicModules&&e.config.offline.prefetch.dynamicModules[i]?e.config.offline.prefetch.dynamicModules[i]:e.config.offline.prefetch.maxThreshold;n=n||100;t[i]=n});return t}})})(SUGAR.App)},function(e,t){(function(e){e.view.NomadLayoutManager=_.extend({_dynamicLayout:null,init:function(t){this.rootLayout={el:t.rootHolder,layoutRef:null};this.recordLayout={el:t.recordHolder,layoutRef:null};this.layoutCache=new e.nomad.hashmap;return this},loadStatic:function(t){var i=this._getLayoutDefs(t);this._beforeLoadStatic(t,i);var n=this._buildLayoutsFromDef(i,t);if(e.isTablet&&this.getRecordLayout()&&i.length===1){this._disposeLayout(this.getRecordLayout())}this._afterLoad(t);_.invoke(this.getLayouts(),"onAfterLayout");return n},loadDynamic:function(e){_.defaults(e,{isDynamic:true,animateRender:true,appendTo:"record"});e.appendTo=e.appendTo==="record"?this._getRecordLayoutContainer():this.rootLayout;var t=this._buildLayoutsFromDef([e])[0];this._afterLoad.apply(this,arguments);return t},getLayouts:function(){var t=[];if(this.getRootLayout()){t.push(this.getRootLayout())}if(this.getRecordLayout()){t.push(this.getRecordLayout())}if(e.isTablet){return t}else{return t.length?[_.last(t)]:[]}},onAppPause:function(){e.activeComponents.closeAll();_.invoke(this.getLayouts(),"onAppPause")},onAppResume:function(){var t=(new Date).getTime()-e.nomad.timePaused;_.each(this.getLayouts(),function(i){if(t>e.config.refreshOnResumeTimeout&&i.name!=="edit"){i.context.resetLoadFlag();i.loadData()}i.onAppResume()})},_getRootLayoutDef:function(t){var i;switch(t.root){case"Recents":case"Search":i={mixed:true,module:"Search",name:"list"};break;case"Offline":if(t.module==="TxLog"){i={module:"TxLog",name:"list"}}else{i={module:t.root,name:t.module?t.module:"offline",create:true};i.cacheDisabled=true}break;case"About":case"Settings":case"SetupBuddy":case"ErrorEmulation":case"Error":case"Login":i={module:t.root,name:t.root.toLowerCase(),create:true,cacheDisabled:true};if(t.root==="Error"){i.code=t.errorCode;i.backToSugar=t.backToSugar;i.sugarRoute=t.sugarRoute}break;default:if(t.root==="Dashboards"||t.dashboardId){i=this._getDashboardLayoutParams(t,true);if(!i){return null}}else if(t.link){i={name:"list",link:t.link,module:e.data.getRelatedModule(t.parentModule,t.link),parentModelId:t.parentModelId,parentModule:t.parentModule,subType:"relationships"}}else{i={module:t.module,name:"list"}}break}i.appendTo=this.rootLayout;return i},_getRecordLayoutDef:function(e){var t;var i=e.action;if(e.module==="Dashboards"||!(e.modelId||e.dashboardId||i==="create"||i==="associate")){return null}if(e.link){if(i==="create"){t={link:e.link,parentModule:e.parentModule,parentModelId:e.parentModelId,create:true,name:"edit",layoutOptions:e.layoutOptions}}else if(i==="associate"){t={link:e.link,parentModule:e.parentModule,parentModelId:e.parentModelId,skipFetch:true,name:"list-selector",subType:"associate"}}else{t={link:e.link,parentModule:e.parentModule,parentModelId:e.parentModelId,modelId:e.modelId,name:i||"detail"}}}else{if(e.root==="Dashboards"||e.dashboardId){t=this._getDashboardLayoutParams(e,false);if(!t){return null}t.animateRender=false}else if(i==="create"){t={module:e.module,create:true,name:"edit"}}else if(i==="create-related"||i==="associate-related"){t={parentModelId:e.modelId,parentModule:e.module,name:"pickerlist",create:true,action:i==="create-related"?"create":"associate"}}else{t={module:e.module,modelId:e.modelId,name:i||"detail"}}}t.appendTo=this._getRecordLayoutContainer();if(_.isUndefined(t.animateRender)){t.animateRender=true}return t},_getLayoutDefs:function(t){var i;var n;var a=[];i=this._getRootLayoutDef(t);if(i){a.push(i)}n=this._getRecordLayoutDef(t);if(n){a.push(n)}if(e.isTablet){return a}else{return[_.last(a)]}},_beforeLoadStatic:function(t,i){this.disposeDynamicLayout({disposeAll:true});e.activeComponents.closeAll();$(document.body).toggleClass("show-content-child",i.length===2);$("#menu-left").toggleClass("hide",t.root==="Login")},_afterLoad:function(e){this._checkAlerts()},_getLayout:function(t){var i=this._getLayoutId(t);var n=this.layoutCache.get(i);if(!n){var a=t.context||this._getPreparedContext(t);return e.view.createLayout(_.extend(_.omit(t,"appendTo"),{context:a,def:t}))}else{n.options.def=t;return n}},_attachLayout:function(t){var i=this;var n=t.options.def;var a=n.appendTo;var o=n.appendTo.layoutRef;function s(){if(o&&!e.isTablet&&$.os.android){o.$el.hide()}i._handleLayoutFullScreen(t,o);a.layoutRef=t;t.$el.show();$(a.el).append(t.$el);_.each([i.rootLayout,i.recordLayout],function(e){if(e!==t.getDefinition().appendTo&&e.layoutRef===t){e.layoutRef=null}});t.onAfterShow(n)}if(!o||o&&o!==t){if(t.getDefinition().animateRender){t.getOverlay$El().show()}s()}this._renderLayout(t);return o},_renderLayout:function(e){if(e.cached){e.renderFromCache({animation:{enabled:e.getDefinition().animateRender,preAnimationDelay:0,animationLength:200}})}else{e.render({animation:this._getFreshRenderAnimationOptions(e)})}},_getFreshRenderAnimationOptions:function(e){return{enabled:e.getDefinition().animateRender,preAnimationDelay:200,animationLength:200}},_cacheLayout:function(t){var i=t.options.def;var n=this._getLayoutId(i);var a=this.layoutCache.get(n);if(!this._canCache(i)){return}if(a){this.layoutCache.remove(a);this.layoutCache.push(n,a)}else{t.cached=true;this.layoutCache.push(n,t)}if(this.layoutCache.count()>e.config.layoutCacheSize){var o=this.layoutCache.shift();this._disposeLayout(o,{hardDispose:true})}},_canCache:function(t){var i=t.cacheDisabled||t.isDynamic||t.name==="edit"&&t.create===true||_.contains(e.config.disableLayoutCache,t.subType);return!i},_disposeLayout:function(t,i){if(t.disposed===true){e.logger.debug("Trying to dispose already disposed layout "+t.name+".");return}i=i||{};t.onDetach();if(t.getDefinition().appendTo.layoutRef===t){t.getDefinition().appendTo.layoutRef=null}var n=this._dynamicLayout&&this._dynamicLayout.prevLayout===t;if((n||t.cached)&&!i.hardDispose){if(i.detachDelay){var a=this;_.delay(function(){if(!(_.contains(a.getLayouts(),t)||t.disposed)){t.$el.detach()}},i.detachDelay)}else{t.$el.detach()}}else{delete t.prevLayout;t.dispose()}},_getPreparedContext:function(t){var i=e.context.getContext(t);i.prepare();return i},_buildLayoutsFromDef:function(e,t){var i=[];var n=t&&t.propagatingData;_.each(e,function(e){var t=this._getLayout(e);var a=t.model;if(n&&n.id===a.id&&_.contains(["detail","edit"],t.type)){a.inSync=true;a.set(n);a.inSync=null}var o=this._attachLayout(t);this._cacheLayout(t);if(t.isDynamic()){o.cached=true;t.prevLayout=o;this._dynamicLayout=t}else{this._dynamicLayout=null}if(o&&o!==t){this._disposeLayout(o,{detachDelay:200})}i.push(t)},this);return i},getRecordLayout:function(){return this._getRecordLayoutContainer().layoutRef},getRootLayout:function(){return this.rootLayout.layoutRef},isDynamicLayoutLoaded:function(){return!!this._dynamicLayout},invalidateLayouts:function(e){this.layoutCache.iterate(function(t){var i;var n;var a;i=e[t.type];if(!i){return}a=_.isArray(i)?i:i.items;if(i.modules){n=_.contains(i.modules,t.module)}else if(i.modelIds){n=_.contains(i.modelIds,t.model.get("id"))}else if(a){_.each(a,function(e){n=e.module===t.module&&(!e.modelId||e.modelId===t.model.get("id"));return!n})}if(n){t.needLoadParams=i.loadParams||e.loadParams||true}})},disposeDynamicLayout:function(e){e=e||{};var t=this;function i(){if(e.disposeAll){return!!t._dynamicLayout}else{return false}}do{if(this._dynamicLayout){var n=this._dynamicLayout;var a=n.prevLayout;this._attachLayout(a);this._dynamicLayout=a.isDynamic()?a:null;this._disposeLayout(n,{hardDispose:true})}}while(i())},_getLayoutId:function(e){var t=_.chain(e).omit(["child","appendTo","context","animateRender","dashletId"]).keys().sort().value();return JSON.stringify(_.pick(e,t))},_getRecordLayoutContainer:function(){return e.isTablet?this.recordLayout:this.rootLayout},_checkAlerts:function(){var t=e.alert.getAll();_.each(t,function(t,i){if(!t.viewCounter)t.viewCounter=0;t.viewCounter++;if(t.viewCounter>=(e.config.maxAlertsPerLayout||2)){e.alert.dismiss(i)}})},_clean:function(e){var t=this;var i=function(e){function i(e,t){if(e.prevLayout===t){return true}else if(e.prevLayout){return i(e.prevLayout,t)}else{return false}}return t._dynamicLayout&&i(t._dynamicLayout,e)};if(e.disposeAll){this.disposeDynamicLayout({disposeAll:true});_.each(this.getLayouts(),function(e){if(e){this._disposeLayout(e,{hardDispose:true})}},this)}var n=[];this.layoutCache.iterate(function(e){if(this.getRootLayout()!==e&&this.getRecordLayout()!==e&&!i(e)){e.dispose();n.push(e)}else{if(_.isFunction(e.clean)){e.clean()}}},this);_.each(n,function(e){this.layoutCache.remove(e)},this)},_handleLayoutFullScreen:function(t,i){var n;var a;if(!e.isTablet){return}n="show-content-child";a=t.options.def.fullScreen&&this.getLayouts().length>1;if(a){$(document.body).removeClass(n);t._inFullScreen=true}else if(i&&i._inFullScreen){i._inFullScreen=false;$(document.body).addClass(n)}},_getDashboardLayoutParams:function(t,i){var n=!!t.modelId;var a=!!(t.parentModule&&t.parentModelId);var o;var s;var r;r={module:"Dashboards",name:"detail",dashletId:t.dashletId,dashboardId:t.dashboardId,parentModule:t.parentModule,parentModelId:t.parentModelId};if(a){if(t.parentDashboardId){o={name:"detail",module:"Dashboards",dashboardId:t.parentDashboardId,dashletId:t.parentDashletId}}else{o={name:"list",module:t.parentModule};if(t.linkParentModule){_.extend(o,{link:t.moduleLink,parentModule:t.linkParentModule,parentModelId:t.linkParentModelId,subType:"relationships"})}}}if(n){s={module:t.module,modelId:t.modelId,name:t.action||"detail"}}if(e.isTablet){if(n){return i?r:s}else{if(i){return a?o:r}else{return a?r:null}}}else{return i||t.root&&!n?r:s}}},Backbone.Events)})(SUGAR.App)},function(e,t){(function(e){var t={_callbacks:[],_executeOnceOnPopState:[],CLOSE_RECENT:"close-recent",CLOSE_ALL:"close-all",DYNAMIC_LAYOUT:"dynamic-layout",enableBackButtonHandling:function(){window.addEventListener("popstate",_.bind(e.activeComponents.handlePopState,e.activeComponents),false)},add:function(t,i,n){var a={componentId:t,closeCallback:i,context:n};if(e.routing.emulateBackButton){var o=this.buildHash(t);if(e.nomad.utils.isOnDynamicRoute()){e.routing.history.replaceState(null,null,o)}else{e.routing.history.pushState(null,null,o)}}this._callbacks.push(a)},remove:function(t,i,n,a){if(_.isUndefined(a))a=true;if(!t){this._callbacks=[];return}this._callbacks=_.reject(this._callbacks,function(e){return this._callbackMatches(e,t,i,n)},this);if(e.routing.emulateBackButton&&e.nomad.utils.isOnDynamicRoute()&&a){if(this.hasActiveComponents()){this.setRecentComponentUrl()}else{this.goBack(true);

}}},setRecentComponentUrl:function(){var t=_.last(this._callbacks);var i=this.buildHash(t.componentId);if(e.nomad.utils.isOnDynamicRoute()){e.routing.history.replaceState(null,null,i)}else{e.routing.history.pushState(null,null,i)}},close:function(e,t,i){this._callbacks=_.reject(this._callbacks,function(n){var a=this._callbackMatches(n,e,t,i);if(a){this._runCallback(n)}return a},this)},closeAll:function(){_.each(this._callbacks,function(e){this._runCallback(e,this.CLOSE_ALL)},this);this.clear()},hasActiveComponents:function(){return this._callbacks.length>0},clear:function(){this._callbacks=[]},closeRecent:function(){var t=this._callbacks.pop();if(t){this._runCallback(t,this.CLOSE_RECENT);if(e.routing.emulateBackButton&&this.hasActiveComponents()){this.setRecentComponentUrl()}}},_callbackMatches:function(e,t,i,n){var a=t===e.componentId;var o=!i||i===e.closeCallback;var s=!n||n===e.context;return a&&o&&s},_runCallback:function(e,t){var i=e.closeCallback;var n=e.context;n?i.call(n,t):i(t)},buildHash:function(t){var i=e.nomad.utils.getHash();return i+"~"+t},goBack:function(t){this.silentGoBack=t;e.routing.history.back()},registerDynamicLayout:function(t){if(!e.routing.emulateBackButton)return;e.activeComponents.add(this.DYNAMIC_LAYOUT,function(){e.controller.disposeDynamic({fromActiveComponents:true})},e.controller)},unregisterDynamicLayout:function(t){if(!e.routing.emulateBackButton)return;if(t&&t.fromActiveComponents){if(this.hasActiveComponents()){this.setRecentComponentUrl()}}else{this.removeDynamicLayoutsCallbacks(t)}},removeDynamicLayoutsCallbacks:function(t){function i(e){return e.componentId===this.DYNAMIC_LAYOUT}if(t&&t.disposeAll){this._callbacks=_.reject(this._callbacks,i,this)}else{var n=_.select(this._callbacks,i,this);var a=_.last(n);this._callbacks.splice(this._callbacks.indexOf(a),1)}if(this.hasActiveComponents()){this.setRecentComponentUrl()}else if(e.nomad.utils.isOnDynamicRoute()){this.goBack()}},executeOnActiveComponentClose:function(e){this._executeOnceOnPopState.push(e)},executePopStateCallbacks:function(){_.each(this._executeOnceOnPopState,function(e){e()});this._executeOnceOnPopState=[]},handlePopState:function(){this.executePopStateCallbacks();if(this.silentGoBack){this.silentGoBack=false;return}function t(){e.activeComponents.closeRecent()}if(e.activeComponents.hasActiveComponents()){if($.browser.chromeWeb){_.defer(t)}else if($.os.ios){_.delay(t,100)}}}};e.augment("activeComponents",t,false);e.events.on("actionsheet:show",function(t,i){if(t){e.activeComponents.add(i.ACTIONSHEET,i.onCancel,i)}else{e.activeComponents.remove(i.ACTIONSHEET)}}).on("list:actionsheet:item:click",function(t,i){if(e.routing.emulateBackButton&&!i){e.activeComponents.executeOnActiveComponentClose(t)}else{t()}}).on("tutorial:show",function(t,i){if(t){e.activeComponents.add(i.TUTORIAL,i.onClose,i)}else{e.activeComponents.remove(i.TUTORIAL)}}).on("app:mainmenu:show",function(t){var i=e.activeComponents;var n="main-menu";if(t.show){i.add(n,function(){t.view.toggleMenu(false,t.disableAnimation,t.callback)})}else{i.remove(n)}}).on("app:rightmenu:show",function(t){var i=t.view;var n=i?i.RIGHT_MENU+i.cid:false;var a=e.activeComponents;var o=t.disableAnimation;if(t.show){a.add(n,function(){i.toggleRightMenu(false,o,t.callback)})}else if(i){a.remove(n)}}).on("list:item:context:menu:show",function(t,i,n){if(t){e.activeComponents.add(i.LIST_VIEW_CONTEXT_MENU,function(t){var n=t!==e.activeComponents.CLOSE_ALL;i.hideContextMenu(null,true,n)})}else{e.activeComponents.remove(i.LIST_VIEW_CONTEXT_MENU,null,null,!n)}}).on("list:item:contextmenu:action:execute",function(t,i,n){var a=e.nomad.utils.isOnDynamicRoute();if(e.routing.emulateBackButton&&!n){e.activeComponents.executeOnActiveComponentClose(i);if(a){e.activeComponents.goBack(true)}}else{i();t.hideContextMenu()}})})(SUGAR.App)},function(e,t){(function(e){var t=e.data.sync;var i=e.data.createBeanCollection;var n=e.data.createMixedBeanCollection;_.extend(e.data,{sync:function(i,n,a){var o;var s;a.apiOptions=a.apiOptions||{};a.apiOptions.cid=n.cid;a.apiOptions.pageHash=window.location.hash;a.params=a.params||{};a.query=a.params.q;if(i==="read"){e.offlineEnabled&&(a.params.skipOfflineRead=n.offlineReadDisabled)}if(n instanceof e.BeanCollection&&a.query){o=n.orderBy;n.orderBy=null}if(n instanceof e.MixedBeanCollection&&!_.isEmpty(n.module_list)){delete a.fields}else if(this._isRecentsCollection(n)){a.module_list=e.metadata.getModuleNames({filter:"visible",access:"list"});a.limit=a.max_num=e.config.fetchLimit.recents;delete a.fields}s=t.apply(this,arguments);if(o){n.orderBy=o}return s},_getMergedFields:function(t){return _.chain(t).map(function(t){return e.metadata.getModule(t).mergedFields}).flatten().uniq().value()},_isRecentsCollection:function(t){return t instanceof e.BeanCollection&&t.module==="Recents"},createBeanCollection:function(e,t,n){return this._createCollection(i,arguments)},createMixedBeanCollection:function(e){return this._createCollection(n,arguments)},_createCollection:function(e,t){var i=e.apply(this,t);i.cid=_.uniqueId("c");return i}})})(SUGAR.App)},function(e,t){(function(e){_.extend(e.Router.prototype,{login:function(){var t=e.controller.layoutManager.getRootLayout(),i=t&&t.name==="login";if(!i){e.controller.clean({disposeAll:true});e.controller.loadScreen({root:"Login"})}},logout:function(t){t=t==="1";e.logger.debug("Logging out: "+t);e.logout({complete:function(){e.router.navigate("#");e.router.login()}},t)}});var t=e.routing.beforeRoute;e.routing.location=window.location;e.routing.history=window.history;e.routing.beforeRoute=function(i,n){if(document.activeElement){document.activeElement.blur()}if(i==="about"){return true}if(i==="Configure"){var a=n[0]||e.nomad.getSetting("loginUrl"),o=n[1]||e.nomad.getSetting("loginName"),s=n[2]?decodeURIComponent(n[2]):"#";e.nomad.configure(a,o,s);return false}if(e.api.isAuthenticated()&&this.firstStart){e.logger.debug("PARSING ROUTE ON STARTUP FOR DETECTING SUGAR ROUTE");this.firstStart=false;var r=this.location.hash.replace("#","").split("~")[0];if(r){var l=e.routing.utils.convertSugarRoute(r);if(l!==r){if(_.isString(l)){this.replaceRoute("#"+l)}else{e.nomad.showBackToSugarPage(r)}return false}}}if(e.routing.emulateBackButton&&e.nomad.utils.isOnDynamicRoute()){if(e.nomad.utils.canGoBack()){window.history.go(-1)}else{var c=e.nomad.utils.getHash();this.replaceRoute(c)}return false}if(e.api.isAuthenticated()&&!e.isSynced){e.nomad.syncApp();return false}else{return t.call(this,i,n)}};e.routing.replaceRoute=function(e){if(e[0]!=="#"){e="#"+e}if(this.history.replaceState){this.history.replaceState(null,null,e);Backbone.history.loadUrl(e)}else{this.location.replace(e)}}})(SUGAR.App)},function(e,t){(function(e){_.extend(e.nomad,{declareRoutes:function(){var t=this.customRoutes;this.routes=[{route:":linkParentModule/:linkParentModelId/link/:link/:parentModelId/Dashboards/:dashboardId/:dashletId",name:"record:linkedListRecordDashboard",callback:t.linkedListRecordDashboard},{route:"Dashboards/:parentDashboardId/:parentDashletId/:parentModule/:parentModelId/Dashboards/:dashboardId/:dashletId",name:"record:twinDashboard",callback:t.twinDashboard},{route:"(:root/):parentModule/:parentModelId/Dashboards/:dashboardId/:dashletId(/:module)(/:modelId)(/:action)",name:"record:dashboard",callback:t.recordDashboard},{route:"Dashboards(/:dashboardId)(/:dashletId)(/:module)(/:recordId)(/:action)",name:"home:dashboard",callback:t.dashboard},{route:"About",name:"about",callback:t.about},{route:"Settings",name:"settings",callback:t.settings},{route:"error/:code",name:"error:code",callback:t.error},{route:"error",name:"error",callback:t.error},{route:"logout",name:"logout",callback:t.logout},{route:"ErrorEmulation",name:"erroremulation",callback:t.errorEmulation},{route:"logout/?clear=:clear",name:"logout:clear",callback:t.logout},{route:"Offline(/:module)(/:id)",name:"offline",callback:t.offline},{route:"createCall?direction=:direction&start_date=:start_date&duration_hours=:duration_hours&duration_minutes=:duration_minutes&status=:status",name:"relationships:createCall",callback:t.createCall},{route:":module/:id/link/:calls_link/createCall?direction=:direction&start_date=:start_date&duration_hours=:duration_hours&duration_minutes=:duration_minutes&status=:status&log_call=:log_call",name:"record:createCall",callback:t.createRelatedCall},{route:":module/:id/link/:link",name:"relationships:list",callback:t.relatedList},{route:":module/:id/link/:link/create",name:"relationships:create",callback:t.createRelated},{route:":module/:id/link/:link/associate",name:"relationships:create",callback:t.associate},{route:":module/:id/link/:link/:relatedId(/:action)",name:"relationships:action",callback:t.relatedRecord},{route:"Recents",name:"recents:list",callback:_.partial(t.list,"Recents")},{route:"Recents/:module/create",name:"recents:create",callback:_.partial(t.create,"Recents")},{route:"Recents/:module/:id(/:action)",name:"recents:record",callback:_.partial(t.record,"Recents")},{route:"",name:"defaultView",callback:_.partial(t.defaultView)},{route:"Search",name:"search:list",callback:_.partial(t.list,"Search")},{route:"Search/:module/create",name:"search:create",callback:_.partial(t.create,"Search")},{route:"Search/:module/:id(/:action)",name:"search:record",callback:_.partial(t.record,"Search")},{route:":module",name:"list",callback:_.partial(t.list,"")},{route:":module/create",name:"create",callback:_.partial(t.create,"")},{route:":module/:id(/:action)",name:"record",callback:_.partial(t.record,"")},{route:/Configure\/([^\/]*)\/([^\/]*)\/([^\/]*)/,name:"Configure",callback:function(){}},{route:/Configure\/([^\/]*)\/([^\/]*)/,name:"Configure",callback:function(){}}];e.routing.setRoutes(this.routes)},customRoutes:{dashboard:function(t,i,n,a,o){e.logger.debug("Route changed to Dashboard"+(t?", dashboardId: "+t:"")+(i?", dashletId: "+i:"")+(n?", recordModule: "+n:"")+(a?", recordId: "+a:"")+(o?", recordAction: "+o:""));var s={root:"Dashboards",dashboardId:t,dashletId:i,module:n,modelId:a,action:o};e.controller.loadScreen(s)},recordDashboard:function(t,i,n,a,o,s,r,l){e.logger.debug(e.utils.formatString("Route changed to record:dashboard, module: {0}, recordId: {1}, dashboardId: {2}, dashletId: {3}",[i,i,a,o]));var c={root:t,parentModule:i,parentModelId:n,dashboardId:a,dashletId:o,module:s,modelId:r,action:l};e.controller.loadScreen(c)},linkedListRecordDashboard:function(t,i,n,a,o,s){var r={linkParentModule:t,linkParentModelId:i,moduleLink:n,parentModule:e.data.getRelatedModule(t,n),parentModelId:a,dashboardId:o,dashletId:s};e.controller.loadScreen(r)},twinDashboard:function(t,i,n,a,o,s){var r={root:"Dashboards",parentDashboardId:t,parentDashletId:i,parentModule:n,parentModelId:a,dashboardId:o,dashletId:s};e.controller.loadScreen(r)},defaultView:function(){if(e.supportedFeatures.settingsDefaultView){e.nomad.navigateToDefaultView()}else{return e.controller.loadScreen({root:"Search"})}},list:function(t,i){e.logger.debug("Route changed to list: "+(t||i));return e.controller.loadScreen({root:t,module:i})},record:function(t,i,n,a){e.logger.debug("Route changed: "+i+"/"+n+"/"+a);return e.controller.loadScreen({root:t,module:i,modelId:n,action:a})},create:function(t,i){e.logger.debug("Route changed: create "+i);return e.controller.loadScreen({root:t,module:i,action:"create"})},relatedList:function(t,i,n){e.logger.debug("Route changed to list rels: "+t+"/"+i+"/"+n);return e.controller.loadScreen({link:n,parentModule:t,parentModelId:i})},relatedRecord:function(t,i,n,a,o){e.logger.debug("Route changed to action rel: "+t+"/"+i+"/"+n+"/"+a);return e.controller.loadScreen({link:n,parentModule:t,parentModelId:i,modelId:a,action:o})},associate:function(t,i,n){e.logger.debug("Route changed to associate related record: "+t+"/"+i+"/"+n+"/associate");return e.controller.loadScreen({link:n,parentModule:t,parentModelId:i,action:"associate"})},createRelated:function(t,i,n){e.logger.debug("Route changed to create related record: "+t+"/"+i+"/"+n+"/create");return e.controller.loadScreen({link:n,parentModule:t,parentModelId:i,action:"create"})},about:function(){return e.controller.loadScreen({root:"About"})},logout:function(t){e.activeComponents.closeAll();e.overlay.show("logout",{spinner:true,tint:true,label:"LBL_MOBILE_WAIT"});t=t==="1";e.logout({success:function(t){if(e.api.isExternalLogin()&&t&&t.url){e.nomad.handleExternalLogout(t.url)}},complete:function(){e.router.navigate("#");e.router.login()}},t,{timeout:e.config.logoutTimeout})},settings:function(){e.controller.loadScreen({root:"Settings"})},error:function(t){e.controller.loadScreen({root:"Error",errorCode:t})},offline:function(t,i){e.controller.loadScreen({root:"Offline",module:t,modelId:i})},errorEmulation:function(){e.controller.loadScreen({root:"ErrorEmulation"})},createCall:function(t,i,n,a,o){return e.controller.loadScreen({module:"Calls",action:"createCall",callData:{direction:t,startDate:i,durationHours:n,durationMinutes:a,status:o}})},createRelatedCall:function(t,i,n,a,o,s,r,l,c){return e.controller.loadScreen({parentModule:t,parentModelId:i,action:"createCall",link:n,callData:{direction:a,startDate:o,durationHours:s,durationMinutes:r,status:l,logCall:c}})}}});e.routing.utils={convertSugarRoute:function(t){if(_.isEmpty(t))return"";if(t==="logout"){return"logout"}if(t==="activities"){return"Activities"}var i=_.reduce(e.nomad.routes,function(e,t){var i=t.route;if(_.isString(i)&&i.indexOf(":")===-1){e.push(i)}return e},[]);if(_.contains(i,t)){return t}var n=t.split("/"),a=n[0],o,s=["home","search","recents","dashboards"],r=_.contains(s,n[0].toLowerCase()),l=r?n[0]+"/":null;if(a==="bwc"){var c=n[1],d=c.split("?")[1],u=e.nomad.utils.parseQueryString(d);a=u["module"];if(!a)return"";var f=u["action"],h=u["record"];f=f.toLowerCase();if(f==="index"){o=[a]}else if(f==="detailview"&&!_.isEmpty(h)){o=[a,h]}else if(f==="editview"&&_.isEmpty(h)){if(u["parent_type"]&&u["parent_id"]){o=[u["parent_type"],u["parent_id"],"link",a.toLowerCase(),"create"]}else{o=[a,"create"]}}else{o=[a]}}else{o=n}var p=o.length;if(r){if(a==="Dashboards"){return t}else if(a==="Home"&&n.length===2){return t.replace("Home","Dashboards")}else{if(!o[1]||!_.contains(e.metadata.getModuleNames(),o[1])){return n[0].toLowerCase()==="home"?e.nomad.DEFAULT_ROUTE:n[0]}else{o.shift();a=o[0]}}}var m=o[1],g=o[2],v=o[3];function b(){var e=r?l:"";return e+_.toArray(arguments).join("/")}var y=e.metadata.getModule(a),E=(r?l:"")+o.join("/");if(r&&p===2||y&&(g==="Dashboards"||o[5]==="Dashboards")){return E}else if(a==="Offline"){var L=["TxLog","offlineStats","offlineSettings"];if(t===a||m==="TxLog"&&g||_.contains(L,m)&&o.length===2){return E}return false}else if(a==="Configure"||a.substring(0,10)==="createCall"){return E}else if(y){var w=["vcard-import","create"],x=m==="create";if(x){return b(a,"create")}else if(!_.isEmpty(m)&&!x){if(_.isEmpty(g)&&!_.contains(w,m)){return b(a,m)}else if(_.contains(["duplicate","edit","create-related","associate-related"],g)&&(_.isEmpty(v)||_.isNumber(parseInt(v)))){return E}else if(g==="links"&&_.contains(["create","associate"],v)){return E}}var S=["vcard-import"];if(!_.isEmpty(m)&&_.contains(S,m)){return false}if(g==="link"){var A=o[4],R=o[5];if(!_.isEmpty(v)&&_.isEmpty(A)){return E}else if(v==="calls"&&A.split("?")[0]==="createCall"){return E}else if(A&&_.isEmpty(R)){return E}else if(A&&_.contains(["duplicate","edit"],R)){return E}else{return false}}return a}else if(m==="offline"&&g==="TxLog"&&!_.isEmpty(v)){return E}else if(a==="error"&&m&&!g){return E}return false}}})(SUGAR.App)},function(e,t){(function(e){var t=function(e){e=e||{};this.items=[]};_.extend(t.prototype,{add:function(t){this.items.unshift(t);if(this.items.length>e.config.navigationHistoryLimit){this.items.pop()}},getItem:function(e){return this.items[e]},getRecent:function(){return this.getItem(1)},reset:function(){this.items=[]},onGoBack:function(){}});var i=function(){t.apply(this,arguments)};i.prototype=Object.create(t.prototype);_.extend(i.prototype,{add:function(e){var i=JSON.stringify(e),n=JSON.stringify(this.getItem(0));if(i!==n){t.prototype.add.call(this,e)}},onGoBack:function(){this.items.shift()}});var n=e.Controller.extend({_screenContext:{},_propagatingData:null,_navigationInfo:{SAVE_ACTION:0,BACK_ACTION:1,LINK_ACTION:2,ACCESS_ERROR:4,error:null,navigatingBackBy:null},initialize:function(){e.plugins.attach(this,"view");this.context=e.context.getContext();if(e.isTouchCapable&&e.config.fastClickEnabled){window.FastClick.attach(document.body)}if(!_.isEmpty($.os)){$(document.body).addClass($.os.android?"android":"ios")}this.layoutManager=e.view.NomadLayoutManager.init({rootHolder:e.$contentEl,recordHolder:$("#content-child")});this._initializeHistory();this._initializeNavigation();this._initializeOffline()},_initializeHistory:function(){this.contextHistory=new t;this.routeHistory=new i},_duplicateRecord:function(t){var i=this,n=t.link,a;var o=this.layoutManager.loadStatic(_.extend(t,{dupe:true,action:"create"}));if(n){var s=e.data.createBean(t.parentModule,{id:t.parentModelId});a=e.data.createRelatedBean(s,t.modelId,n)}else{a=e.data.createBean(t.module,{id:t.modelId})}a.fetch({relate:!!t.link,complete:function(){var e=i.layoutManager.getRecordLayout();if(e){e.context.get("model").copy(a)}}});return o},_createCall:function(t){var i=t.callData,n=this.layoutManager.loadStatic(_.extend(t,{action:"create",layoutOptions:{isLoggingCall:i&&i.logCall}}));var a=this.layoutManager.getRecordLayout().getComponent("edit");var o=e.nomad.utils.minutesToQuarterHours(i.durationMinutes);var s=i.durationHours;if(o===60){s=i.durationHours+1;o=0}a.setCallData({direction:i.direction,date_start:i.startDate,duration_hours:String(s),duration_minutes:String(o),status:i.status});return n},loadDynamic:function(t){var i=t.layoutDef,n=this.layoutManager.loadDynamic(i);e.activeComponents.registerDynamicLayout(i);this._loadData([n]);this._afterLoad(t);return n},disposeDynamic:function(t){this.layoutManager.disposeDynamicLayout(t);e.activeComponents.unregisterDynamicLayout(t)},loadScreen:function(e){if(!this.canLoadScreen(e)){return false}var t;this._beforeLoadStatic(e);if(e.action==="duplicate"){t=this._duplicateRecord(e)}else if(e.action==="createCall"){t=this._createCall(e)}else{if(this._propagatingData){e=_.extend({propagatingData:this._propagatingData},e)}t=this.layoutManager.loadStatic(e)}this._loadData(t);this._afterLoad(e)},getScreenContext:function(){return this._screenContext},getScreenContextRoot:function(){var e=this._screenContext.root;var t=this._screenContext;if(e==="Dashboards"){e=[e];if(t.parentDashboardId){e.push(t.parentDashboardId,t.parentDashletId)}else if(t.dashboardId){e.push(this._screenContext.dashboardId);t.dashletId&&e.push(t.dashletId)}e=e.join("/")}return e},_afterLoad:function(t){t=t||{};this._navigationInfo.navigatingBackBy=null;var i=t.layoutDef&&t.layoutDef.isDynamic?t:this._screenContext;e.trigger("app:view:change",_.clone(i))},_beforeLoadStatic:function(t){this._screenContext=e.utils.deepCopy(t);if(t.root==="Login"){this.contextHistory.reset();this.routeHistory.reset()}else{this.contextHistory.add(t);this.routeHistory.add(t)}this._navigationInfo.error=null;this._propagatingData=null;if(t.modelId&&this._navigationInfo.navigatingBackBy===null){_.each(this.layoutManager.getLayouts(),function(e){var i=e?e.getDataById(t.modelId):null;if(i){this._propagatingData=i}},this)}},_loadData:function(t){_.each(t,function(t){var i=t.context.isDataFetched(),n=false,a=this._navigationInfo.navigatingBackBy===null,o={},s;if(!i||t.isDynamic()){n=true}else if(t.needLoadParams){if(_.isObject(t.needLoadParams)){o=t.needLoadParams}t.needLoadParams=null;o.backgroundSync=true;n=true}else{if(_.contains(["detail","edit"],t.type)){n=a}else if(t.type==="list"){if(this._hasListModuleChanged()&&(_.contains(e.config.modulesToAlwaysRefresh,t.module)||e.config.forceListReload)){n=true;s=e.offlineEnabled?{forceServerSync:true}:null}else{n=false}}}if(n){o.params=s;this._loadDataWithParams(t,o)}},this)},_hasListModuleChanged:function(){var e=this.contextHistory.getRecent(),t=this.getScreenContextRoot();if(_.isEmpty(e)){return true}else if(t&&t===e.root){return false}else{return e.module!==this._screenContext.module}},_loadDataWithParams:function(e,t){t.params=t.params||{};if(e.name==="detail"||e.name==="edit"){t.params.viewed=true}if(t.partialLoad){e.loadDataPartial(t)}else{e.context.resetLoadFlag();e.loadData(t)}},goBack:function(){if(this.layoutManager.isDynamicLayoutLoaded()){this.disposeDynamic()}else if(this._hasAccessErrorOnRecordView()&&!this._isNavigatedFromListView()){e.routing.replaceRoute(this._getGoBackRoute())}else{this._navigateBack()}},_isNavigatedFromListView:function(){var e=this._screenContext,t=this.contextHistory.getRecent(),i=e.link?["link","parentModelId","parentModule"]:["module"],n=!t.action&&!t.modelId;return n&&_.isEqual(_.pick(e,i),_.pick(t,i))},_navigateBack:function(){var t=this.routeHistory.getRecent();this._navigationInfo.navigatingBackBy=this._navigationInfo.BACK_ACTION;if(!t&&e.isNative){if(navigator.app&&navigator.app.exitApp){e.logger.debug("Exiting Application");navigator.app.exitApp()}}else{this.routeHistory.onGoBack();e.router.goBack()}},_hasAccessErrorOnRecordView:function(){var e=this._screenContext,t=this.contextHistory.getRecent(),i=this._navigationInfo.error===this._navigationInfo.ACCESS_ERROR;return e.modelId&&_.contains(["edit","detail"],e.action)&&i&&t},_initializeNavigation:function(){e.events.on("app:header:cancel",function(){this.goBack()},this);e.events.on("data:sync:success",function(t,i,n){var a={};if(t==="delete"){var o=this.layoutManager.getRootLayout(),s=_.without(["Recents"],o.module),r=o.context.get("parentModel"),l=o.context.get("parentModule");a={list:{modules:s}};if(i.link){this._invalidateAfterLinkAction(i)}if(!_.isEmpty(r)){this.layoutManager.invalidateLayouts({detail:[{modelId:r.id,module:l}]})}this.layoutManager.invalidateLayouts(a)}var c=this.layoutManager.getRecordLayout(),d;if(t==="delete"&&c&&c.model.id===i.id){d=this._getGoBackRoute();this._navigationInfo.navigatingBackBy=this._navigationInfo.SAVE_ACTION;e.routing.replaceRoute(d)}else if(n.params.viewed&&this.getScreenContextRoot()!=="Recents"){this.layoutManager.invalidateLayouts({list:{modules:["Recents"]}})}},this);e.events.on("data:sync:error",function(t,i,n,a){var o=this._screenContext;if(a&&e.error.isAccessError(a)&&o.action==="edit"&&o.modelId){this._navigationInfo.error=this._navigationInfo.ACCESS_ERROR}},this);e.events.on("edit:view:save",function(t){var i={},n=t.model;if(t.isCreate){i={list:{modules:[n.module,"Recents","Search"]}}}else{i={list:{modules:["Search"]},detail:{items:[{module:n.module,modelId:n.get("id")}],loadParams:{partialLoad:true}}}}this.layoutManager.invalidateLayouts(i);if(n.link){this._invalidateAfterLinkAction(n)}var a=t.isCreate,o,s=this.contextHistory.getRecent();this._navigationInfo.navigatingBackBy=this._navigationInfo.SAVE_ACTION;if(!e.acl.hasAccessToModel("view",n)){this.layoutManager.invalidateLayouts({detail:[{module:n.module,modelId:n.get("id")}]});o=this._getGoBackRoute();e.routing.replaceRoute(o)}else if(a&&this._screenContext.link&&(!s||this._screenContext.parentModelId===s.modelId)){this._handleAfterLinkNavigation(t)}else if(e.isTablet||e.config.detailAfterCreate&&a){o=this._getGoBackRoute(n.id);e.routing.replaceRoute(o)}else if(this._screenContext.action==="duplicate"){e.router.go(-2)}else{e.router.go(-1)}},this);e.events.on("associate:view:save",this._handleAfterLinkNavigation,this);e.events.on("app:access:error",function(e){this.layoutManager.invalidateLayouts({list:{modules:[e.module]}})},this)},_invalidateAfterLinkAction:function(e){var t={detail:[{modelId:e.link.bean.id,module:e.link.bean.module}]};this.layoutManager.invalidateLayouts(t)},_initializeOffline:function(){e.events.on("offline:data:updated",function(e){if(e.action==="delete"){this.layoutManager.invalidateLayouts({list:{modules:[e.module,"Recents"]}})}if(e.isCollection){var t=this.layoutManager.getRootLayout();if(t.type!=="list"||t.module!==e.module){this.layoutManager.invalidateLayouts({list:{modules:[e.module]}})}}},this)},_handleAfterLinkNavigation:function(t){var i=this.contextHistory.getRecent();var n=t.model;var a=t.parentModel;this._navigationInfo.navigatingBackBy=this._navigationInfo.LINK_ACTION;this.layoutManager.invalidateLayouts({list:{modules:[n.module,"Recents"]},detail:[{module:a.module,modelId:a.id}]});if(this.contextHistory.items.length>1){if(i&&_.contains(["associate-related","create-related"],i.action)){e.router.go(-2)}else{e.router.go(-1)}}else{this.navigate(e.router.buildRoute(a.module,a.id))}},_getGoBackRoute:function(t){var i=this.getScreenContext(),n=this.getScreenContextRoot(),a=i.link,o=a?i.parentModule:i.module,s;s=a?e.nomad.buildLinkRoute(o,i.parentModelId,a,t):e.router.buildRoute(o,t);if(n){if(t){s=n+"/"+s}else{s=n}}return s},clean:function(t){t=t||{};e.session.cutAll();e.activeComponents.closeAll();e.overlay.hideAll();if(t.disposeAll&&e.supportedFeatures.dashboards){e.nomad.dashboards.resetCollection()}this.layoutManager._clean(t)},navigate:function(t){var i=this;if(e.routing.emulateBackButton&&e.nomad.utils.isOnDynamicRoute()){$(window).one("hashchange",function(){i._navigateToRoute(t)});e.activeComponents.closeAll();e.activeComponents.goBack()}else{this._navigateToRoute(t)}},_navigateToRoute:function(t){if(e.routing.location.hash===t){e.routing.replaceRoute(t)}else{e.routing.location.hash=t}},canLoadScreen:function(t){var i=e.data.getRelatedModule(t.parentModule,t.link);var n=t.module||i||t.parentModule;var a;if(t.dashboardId||t.root==="Dashboards"){if(!e.supportedFeatures.dashboards){e.routing.replaceRoute("Search");return false}a=e.nomad.dashboards.getDashboard(t.dashboardId);if(!a||!a.get("metadata").dashlets.length){e.nomad.navigateToDefaultView();return false}else if(t.parentModule&&t.parentModelId){if(!e.nomad.dashboards.isDashletAvailable(t.dashboardId,t.dashletId)){var o=e.router.buildRoute(t.parentModule,t.parentModelId);e.routing.replaceRoute(o);return false}}return true}if(!this.canLoadModuleScreen(t)){var s=e.nomad.utils.getHash().substring(1);e.nomad.showBackToSugarPage(s);return false}if(!_.contains(e.config.nonAclModules,n)){if(t.action==="create"&&!e.nomad.canCreateModule(n)||!e.acl.hasAccess("access",n)){this.loadScreen({root:"Error",errorCode:403});return false}}if(!e.offlineEnabled&&this._isOfflineScreen(t)){e.controller.navigate("");return false}return true},canLoadModuleScreen:function(t){var i=true,n;if(t.module){n=t.module;i=!!e.metadata.getModule(n)||_.contains(e.config.customViews,n)}else if(t.parentModule&&t.link){n=e.data.getRelatedModule(t.parentModule,t.link);i=!!e.metadata.getModule(n)}return i},_isOfflineScreen:function(e){return e.root==="Offline"||e.module==="TxLog"}});e.augment("NomadController",n,false)})(SUGAR.App)},function(e,t){(function(e){var t=window.nomadAppEventHandlerContext={};var i=[];var n=function(e){var t=_.pluck(i,"module");var n=_.indexOf(t,e.module);if(n!==-1){i[n]=e}else{i.unshift(e)}};var a=0;function o(){if(!e.offlineEnabled){e.nomad.showAlert(e.lang.get("ERR_OFFLINE_START_FAILED_OUT_OF_SPACE"));return}var t=new Date-0;if(t-a<e.config.offline.cleanupConfirmationInterval){return}a=t;e.nomad.showConfirm(e.lang.get("ERR_OFFLINE_CLEAN_UP_CONFIRMATION"),function(t){var i="db_cleanup";e.nomad.dismissAlerts();if(t===2){e.overlay.show(i);e.alert.show(i,{level:"info",messages:e.lang.get("LBL_OFFLINE_DB_CLEANING_IN_PROGRESS"),autoClose:false,closable:false});e.offline.compactStorage({callback:function(t){e.router.navigate("Search",true);e.overlay.hide(i);e.alert.dismiss(i);if(t){e.alert.show(i,{level:"error",messages:e.lang.get("ERR_OFFLINE_DB_CLEANING_ERROR"),autoClose:true,closable:true})}else{e.alert.show(i,{level:"success",messages:e.lang.get("LBL_OFFLINE_DB_CLEANING_COMPLETED"),autoClose:true,closable:true})}}})}})}e.events.on("all",function(t){var i=[];var n=arguments;_.each(e.events._events,function(e,n){var a=n.split(".");if(a.length>1&&a[0]===t){i.push(n)}});if(i.length>0){_.each(i,function(t){n[0]=t;e.events.trigger.apply(e.events,n)})}});e.events.on("app:init",function(){window.clearInterval(e.metadata._validateMDInterval);e.metadata._validateMDInterval=null;e.routing.emulateBackButton=!e.isNative&&e.config.emulateBackButton;if(e.routing.emulateBackButton){e.activeComponents.enableBackButtonHandling()}e.routing.firstStart=true;e.isBodyScrollRequired=$.os.android&&!e.isTablet;_.extend(e.metadata.fieldTypeMap,{iframe:"url",link:"url",multienum:"multienum",name:"name","double":"float",username:"text",user_name:"text"});_.extend(e.view.NomadField.prototype.viewFallbackMap,{view:"readonly",edit:"readonly",about:"readonly",settings:"edit"});e.lang.setCurrentLanguage(e.lang.getLanguage()||"en_us");e.nomad.updateServerInfo();e.nomad.resetMeta(false,false);e.nomad.restoreUser();e.nomad.enableOffline();e.nomad.initSubpanels();e.data.declareModels();e.nomad.declareRoutes();e.nomad.updateAuthStore();e.config.sugarLogic=e.config.sugarLogic||{};if(e.config.sugarLogic.enabled&&e.config.sugarLogic.isDynamic)e.loadSugarLogic();e.nomad.configureSugarLogic();if(e.isSynced){e.nomad.initializeContextMeta()}e.api.setExternalLogin(e.config.externalLoginEnabled&&e.nomad.getSetting("externalLogin"));if(e.isNative){var t=e.nomad.getSetting("serverUrl");var i=e.nomad.getSetting("siteUrl");if(t){t=t.replace(/\/rest\/v10/,"");e.nomad.removeSetting("serverUrl")}e.config.siteUrl=i||t||"http://localhost:8888";e.api.serverUrl=e.nomad.getServerUrl();if(!i){e.nomad.setSetting("siteUrl",e.config.siteUrl)}}e.logger.debug("Site URL: "+e.config.siteUrl);if(e.isNative&&navigator.splashscreen){_.delay(function(){navigator.splashscreen.hide()},500)}},t).on("nativeMessage",function(t){e.logger.debug("Received native message: "+JSON.stringify(t));if(t.target==="redirect"&&!_.isEmpty(t.path)){var i=t.path.split("/");var n=i[1];var a=i[2];var o=i[3];e.nomad.configure(n,a,o)}}).on("app:sync",function(){e.nomad._isSyncing=true;e.overlay.show("app:sync",{template:"preloader-panel",label:"LBL_LOADING"})},t).on("app:sync:complete",function(){if(e.api.isExternalLogin()){e.nomad.setSetting("loginName",e.user.get("user_name"))}e.nomad._isSyncing=false;e.nomad._hasAskedForSync=false;e.logger.debug("Sync complete");e.hacks.hackModuleList();e.nomad.initSubpanels();e.hacks.hackAcls();e.nomad.saveUser();e.nomad.initializeContextMeta();e.nomad.updateAuthStore();e.analytics.init();e.nomad.configureSugarLogic()},t).on("nomad:sync:complete",function(){_.delay(function(){e.overlay.hide("app:sync",true)},300);e.cache.set("app:synced","1")},t).on("app:sync:error",function(t){e.nomad._isSyncing=false;e.nomad._hasAskedForSync=false;e.logger.debug("Sync failed");if(!(t instanceof SUGAR.Api.HttpError)){var i=_.extend({version:"N/A",flavor:"N/A",minVersion:e.config.minServerVersion,supportedFlavors:e.config.supportedServerFlavors.join(", ")},t.server_info);t=e.lang.get(t.label,null,i)||(_.isString(t)?t:e.lang.get("LBL_MOBILE_META_SYNC_FAILED"));e.nomad.showAlert(t,function(){e.nomad.dismissAlerts();e.overlay.hide("app:sync",true);e.router.login()},e.lang.get("ERR_GENERIC_TITLE"))}else if(t.code!=="invalid_grant"){e.nomad.showConfirm(e.lang.get("LBL_MOBILE_META_SYNC_FAILED_RETRY"),function(t){e.nomad.dismissAlerts();if(t!==2){e.overlay.hide("app:sync",true);e.router.login()}else{e.nomad.syncApp()}},e.lang.get("ERR_GENERIC_TITLE"),e.lang.get("LBL_MOBILE_RELOGIN_BUTTON")+","+e.lang.get("LBL_YES"))}else{e.overlay.hide("app:sync");e.error.handleInvalidGrantError()}},t).on("offline:prefetch:start",function(){i=[];e.overlay.hide("app:sync");e.overlay.show("app:sync",{template:"preloader-panel",label:"LBL_OFFLINE_PREFETCHING"})},t).on("offline:prefetch:complete",function(t){i=[];if(t&&t.status!==412){e.nomad.showAlert(e.lang.get("ERR_OFFLINE_PREFETCH_FAILED"))}},t).on("offline:prefetch:progress",function(t){var a=e.config.maxPreloaderPanelMessages||4;var o=[];var s={};s.module=e.nomad.getPluralModuleName(t.module);if(t.parentModule){s.parentModule=e.nomad.getPluralModuleName(t.parentModule);

s.relationship=e.lang.get(t.relatedModules[t.module].label,t.parentModule);s.module=e.lang.get("LBL_OFFLINE_PREFETCHING_RELATIONSHIP",null,s)}n(_.extend(t,s));_.each(i,function(t,i){if(i+1>a){return false}if(i===0){o.push("<span class='current'>"+e.lang.get("LBL_OFFLINE_PREFETCHING_MODULE",null,t)+"</span>")}else{o.push("<span class='completed'>"+e.lang.get("LBL_OFFLINE_PREFETCHING_MODULE_COMPLETE",null,t)+"</span>")}});e.overlay.hide("app:sync");e.overlay.show("app:sync",{template:"preloader-panel",message:o.join("<br />")})},t).on("offline:encryption:start",function(){e.alert.show("offline_encryption",{level:"info",messages:e.lang.get("LBL_OFFLINE_ENCRYPTION_IN_PROGRESS"),autoClose:false,closable:false})},t).on("offline:encryption:complete",function(t){if(t){e.alert.dismiss("offline_encryption");e.alert.show("offline_error",{level:"error",messages:t.localizedMessage(),autoClose:true})}else{e.alert.show("offline_encryption",{level:"success",messages:e.lang.get("LBL_OFFLINE_ENCRYPTION_SUCCESS"),autoClose:true})}},t).on("app:login:success",function(){e.nomad.resetUserSettings();e.nomad.enableOffline(true);e.nomad.setSetting("externalLogin",e.config.externalLoginEnabled&&e.api.isExternalLogin());e.nomad.syncApp()},t).on("app:logout",function(){e.alert.dismiss("logout");e.nomad.resetMeta(false,true);e.data.declareModels();e.activeComponents.closeAll();e.nomad.disposeAllAdditionalComponents();e.controller.clean({disposeAll:true})}).on("app:start",function(){e.started=true},t).on("offline:failure",function(t){if(t===e.offline.Error.StorageUnavailableError){e.nomad.showAlert(t.localizedMessage()+"\n"+e.lang.get("LBL_OFFLINE_DISABLED"))}if(t===e.offline.Error.OfflineDisabledError){}else if(t===e.offline.Error.OutOfSpaceError){o()}else{e.alert.show("offline_error",{level:"error",messages:t.localizedMessage(),autoClose:true})}},t).on("app:dashboards:changed",function(){if(!e.api.isAuthenticated()){return}var t=e.lang.get("LBL_DASHBOARDS_CHANGED_PROMPT");e.nomad.dashboards.verifyDefaultView();e.nomad.showConfirm(t,function(t){if(t===2){e.nomad.dismissAlerts();e.nomad.navigateToDefaultView();e.controller.clean();e.nomad.mainMenu.render()}})},t).on("app:locale:change",function(){e.nomad.setHTMLDirection()},t)})(SUGAR.App)},function(e,t){(function(e){var t=1024*1024;var i={set:function s(e,t,i){e[t]=i},push:function r(e,t,i){if(!e[t]){e[t]=[]}e[t].push(i)},pushDocField:function l(e,t,i){e.docFields[i.name]=i}};var n={byType:{name:{dataName:"nameField",action:i.set},fullname:{dataName:"fullNameField",action:i.set},image:{dataName:"imageField",action:i.pushDocField},phone:{dataName:"phoneFields",action:i.push},url:{dataName:"urlFields",action:i.push},email:{ignore:false,dataName:"emailFields",action:i.push},file:{dataName:"docFields",action:i.pushDocField},fieldset:{action:function(e,t,a){var o=true;_.each(a.fields,function(t){var i=n.byType[t.type];if(i){i.action(e,i.dataName,a);o=false}});if(o)i.push(e,"otherFields",a)}},emailbody:{dataName:"emailbodyFields",action:i.push}},byNameRegEx:{"^(?=.*address)((?!email).)*$":{dataName:"addressFields",action:i.push}},"default":{dataName:"otherFields",action:i.push}};var a=function(e){var t=null;_.each(n.byNameRegEx,function(i,n){var a=new RegExp(n);if(a.test(e.name)){t=i}});return t};var o=e.data.beanModel;e.NomadBean=e.data.beanModel.extend({initialize:function(){this.addValidationTask("nomadValidation",_.bind(this._nomadValidator,this));o.prototype.initialize.apply(this,arguments)},_nomadValidator:function(t,i,n){var a=e.metadata.getModule(this.module).fields;_.each(t,function(e,t){var n=a[t];if(n&&n.type==="image"){if(this._imageRequiredValidator(n,t,this)){i[t]=i[t]||{};i[t].required=true}}},this);n(null,t,i)},_imageRequiredValidator:function(t,i,n){if(!e.supportedFeatures.fileUpload){return}var a=false;if(t.required){a=_.isEmpty(n.get(i))}return a},getContextMetaData:function(t,i){var o=n;var s=this;var r={otherFields:[],phoneFields:[],urlFields:[],emailFields:[],addressFields:[],additionalListFields:[],docFields:{},emailbodyFields:[]};_.each(t,function(t,n){var s=o.byType[t.type]||a(t)||(r[o.default.dataName].length<i?o["default"]:null);if(s&&!s.ignore){s.action(r,s.dataName,t)}if(n>0&&n<=e.config.numberOfAdditionalListFields){r.additionalListFields.push(t)}});r.headerField=r.fullNameField||r.nameField;r.subpanels=e.nomad.getSubpanels(this.module);r.hasLinkableSubpanels=e.nomad.hasLinkableSubpanels(r.subpanels);r.hasCreatableSubpanels=e.nomad.hasCreatableSubpanels(r.subpanels);r.listItemTitleField=t[0];r.avatarField=_.find(t,function(t){return t.type==="image"&&t.name==="picture"&&_.contains(e.config.modulesWithAvatars,s.module)});r.addressFieldsGroups=_.groupBy(r.addressFields,function(e){if(e.type==="address"){return e.name}return s.fields[e.name].group});r.actions=this.getAvailableActions(r);return r},getAvailableActions:function c(e){var t={};var i=this._canHaveFiles(e.docFields)||this._canHavePDFs()||this.canHaveAttachments();var n=e.phoneFields.length;var a=[n&&"phone",n&&"message",e.urlFields.length&&"url",_.keys(e.addressFieldsGroups).length&&"map",i&&"doc",e.emailFields.length&&"email",e.emailbodyFields.length&&"emailbody"];_.each(a,function(e){if(e){t[e]=!!e}});return t},getAddresses:function(t){var i;var n;var a;var o=this;return _.chain(t).map(function(t,s){if(s.lastIndexOf("_c")===s.length-2){s=s.replace("_c","")}a={};_.each(t,function(t,n){var r=o.get(t.name);if(r){i=t.name;i=i.replace(s+"_","");if(i.lastIndexOf("_c")===i.length-2)i=i.replace("_c","");if(t.type==="enum"){var l=e.metadata.getModule(o.module).fields[t.name];var c=e.lang.getAppListStrings(l.options)||{};r=c[r]||r}a[i]=r}});if(_.keys(a).length){n={};var r=e.lang.get("LBL_"+s.toUpperCase(),o.module);n[r]=a;return n}}).compact().value()},getDocuments:function(t,i){var n=this;this.docsLoading=true;t=_.filter(t,function(t){return e.acl.hasAccessToModel("read",this,t.name)},this);if(this.canHaveAttachments()){var a=this.get("attachment_list");this._createDocData(a,t)}else if(this._canHaveFiles(t)){var o=[];var s=this.get("doc_url");if(_.has(this.fields,"doc_url")&&!_.isEmpty(s)){var r=this.get("filename");if(_.has(this.fields,"doc_type"))r+=" ("+this.get("doc_type")+")";o=this._createDocData([{name:r,uri:s,openExternally:true,nonSugarURL:true}],t,null,{silent:true})}if(i){n._createDocData(i,t,o)}else{this.getFiles({success:function(e){n._createDocData(e,t,o)},error:function(t){e.logger.debug("Error creating file url for "+n.module+" : "+t);n.docsLoading=false;n.trigger("docs:ready",o)}},{iframe:false,deleteIfFails:false})}}else if(this._canHavePDFs()){this._createDocData([{name:this.module+".pdf",uri:e.api.serverUrl+"/"+this.module+"/"+this.id+"/pdf",file_mime_type:"application/pdf",filename:this.get("name")+".pdf",oauth:true}],t)}else{this.docsLoading=false;this.trigger("docs:ready",[])}},_createDocData:function(i,n,a,o){var s=this;var r=_.pluck(n,"name");this.docsLoading=false;o=o||{};a=a||[];function l(t){if(!_.isString(t)||s.module==="Documents")return false;return!e.acl.hasAccessToModel("read",s,t)||!_.contains(r,t)}_.each(i,function(i,o){var r;var c;var d;var u;var f=i.uri||i.file_uri;var h=i["content-length"];var p=i.name||i.document_revision_filename;if(!f||l(o)){return}c=_.find(n,function(e){return e.name===o});d=c?e.lang.get(c.label,s.module):p;if(p&&h){d+=" ("+s._fileSizeFormat(i["content-length"])+")";if(h>t)i.openExternally=true}if(p&&!i.nonSugarURL){u=f.split(/rest\/v\d*\//)[1];f=e.api.serverUrl+"/"+u+"?platform="+e.config.platform;if(e.nomad.isDownloadTokenSupported()){if(!i.oauth){f+="&download_token={download_token}"}}else{f+="&oauth_token={oauth_token}"}}r={};r[d]={url:f,openExternally:i.openExternally||false,isImage:c&&c.type==="image",file_mime_type:i.file_mime_type||this.get("file_mime_type")||i["content-type"]||"",filename:i.filename||this.get("filename")||i.name||"",oauth:i.oauth};a.push(r)},this);if(!o.silent)this.trigger("docs:ready",a);return a},_fileSizeFormat:function(t){return t<=0?"0":""+e.nomad.utils.humanFileSize(t)},_canHaveFiles:function(t){var i=e.config.modulesWithFiles||[];return!_.isEmpty(t)||_.contains(i,this.module)||_.has(this.fields,"doc_url")},_canHavePDFs:function(){var t=e.config.modulesWithPDFs||[];return _.contains(t,this.module)},getFieldsDataArray:function(t,i){var n;var a;var o;var s;var r=[];var l=this;var c;var d;_.each(t,function(t){s={};a=l.get(t.name);d=t.name;o=e.metadata.getModule(l.module).fields[d];if(a&&(_.isUndefined(i)||a.match(i))){c=t.label||o.label||o.vname||d;n=e.lang.get(c,l.module);s[n]=a;r.push(s)}});return r},getAccessibleFields:function(t,i){i=i||"read";var n=this;t=_.filter(t,function(t){return e.acl.hasAccessToModel(i,n,t.name)});return t||[]},getAccessibleFieldsGroups:function(e,t){var i={};var n=this;_.each(e,function(e,a){e=n.getAccessibleFields(e,t);if(e.length){i[a]=e}});return i},isDataDefined:function(e,t){return _.any(e,function(e){var i=this.get(e.name);return t?_.isString(i)&&i.match(t):i},this)},hasActiveEmail:function(e){return _.any(e,function(e){return _.any(this.get(e.name),function(e){return!Number(e.invalid_email)&&!Number(e.opt_out)})},this)},hasDeleteAccess:function(){if(e.acl.hasAccessToModel("delete",this)&&!_.contains(e.config.nonDeletableModules,this.module)){return!(e.serverInfo.isSevenUp&&(this.get("closed_revenue_line_items")||_.find(e.config.nonDeletableSalesStages,function(e){return e===this.get("sales_status")||e===this.get("sales_stage")},this)))}},hasUnlinkAccess:function(t,i){if(i.relationship_type==="many-to-many"){return true}if(!_.isEmpty(t)){return!_.find(t,function(t){return!e.acl.hasAccessToModel("edit",this,t.name)},this)}else if(i.via_parent_id){return e.acl.hasAccessToModel("edit",this,i.relationship_role_column)}else{return true}},changeCurrencyId:function(t,i){i=i||{};var n=this.get("currency_id")||t;var a={};var o=i.silentField||{};_.each(this.fields,function(i,o){if(i.type!=="currency")return;var s=this.get(o);if(!!s){var r=e.currency.convertAmount(s,n,t);this.set(o,r,{silent:true})}a[o]=true},this);this.set("currency_id",t,{silent:true});if(!i.silent){_.each(a,function(e,t){if(o===t){return false}this.trigger("change:"+t)},this)}},getChangeDiff:function(e,t){var i={};e=e||{};t=t||[];_.each(this.attributes,function(n,a){if(_.contains(t,a))return;var o=e[a];if(!_.isEqual(o,n)){i[a]=o}});return i},save:function(e,t){t=t||{};t.lastModified=this.get("date_modified");return o.prototype.save.call(this,e,t)},uploadFile:function(t,i,n,a){n=n||{};a=a||{};a.iframe=false;var o=this;a.deleteIfFails=!!a.isCreate;return e.api.file("create",{id:this.id,module:this.module,field:t},i,{success:function(e,i,a){var s=e[t];if(s){o._onFileChange(e,t);if(n.success){n.success(e)}}else{var r=new SUGAR.Api.HttpError({xhr:a});r.responseText=e.xhr?e.xhr.message:r.responseText;if(n.error)n.error(r)}},error:function(e){e.isFileUploadError=true;n.error.call(this,e)}},a)},deleteFile:function(t,i,n,a){var o=this;var s;a=a||{};s={success:function(e){o._onFileChange(e,t);if(n.success){n.success(e)}},error:function(e){e.isFileUploadError=true;if(n.error){n.error(e)}}};return e.api.file("delete",{module:this.module,id:this.id,field:t},null,s,a)},_onFileChange:function(e,t){this.set(t,e[t].name);if(e.record){this.set("date_modified",e.record.date_modified)}else{this._docsUpdated=true}},isCloseActionAvailable:function(){var t=this.get("status");var i=e.nomad.utils.getClosedStatusValue(this.module);var n=i===t;return i&&!n&&e.acl.hasAccessToModel("edit",this)&&!_.contains(e.config.nonEditableModules,this.module)}});e.data.beanModel=e.NomadBean})(SUGAR.App)},function(e,t){(function(e){var t=[];var i=function(e){return _.find(t,function(t){return t.key===e})};var n={maxCount:3,has:function(e){return _.isUndefined(this.get(e))?false:true},get:function(e){var t=i(e);return t?t.val:undefined},set:function(e,n){if(this.has(e)){var a=i(e);a.val=n}else{if(this.maxCount<=t.length){t.shift()}t.push({key:e,val:n})}},cut:function(e){var i=null;if(_.find(t,function(t,n){var a=t.key===e;if(a){i=n}return a})){t.splice(i,1)}},cutAll:function(){t=[]}};e.augment("session",n)})(SUGAR.App)},function(e,t){(function(e){var t={inProgress:{read:"LBL_LOADING",update:"LBL_SAVING",create:"LBL_SAVING","delete":"LBL_DELETING",unlink:"LBL_UNLINKING",backgroundFetch:"LBL_OFFLINE_SERVER_FETCH"},finished:{update:"LBL_SAVED",create:"LBL_SAVED","delete":"LBL_DELETED",unlink:"LBL_UNLINKED"}};var i="DATA_SYNCING";var n={requestsInProgress:null,init:function a(){this._subscribeSyncEvents();e.events.on("data:sync:error data:sync:abort",this.onSyncError,this)},_subscribeSyncEvents:function o(){e.events.on("data:sync:start",this.onSyncStart,this).on("data:sync:success",this.onSyncSuccess,this)},_unsubscribeSyncEvents:function s(){e.events.off("data:sync:start data:sync:success",null,this)},onSyncStart:function r(e,t,i){i=i||{};if(!this._shouldShowAlert(e,t,i)){return}this.showSyncAlert(e,t,i);this.requestsInProgress++},onSyncSuccess:function l(e,t,i){i=i||{};if(!this._shouldShowAlert(e,t,i)){return}if(this.requestsInProgress){this.requestsInProgress--}if(!this.requestsInProgress){i.requestFinished=true;this.showSyncAlert(e,t,i)}},onSyncError:function c(){if(this.requestsInProgress){this.requestsInProgress--}this.hideSyncAlert()},pause:function d(e,t,i){i=i||{};this._unsubscribeSyncEvents();this.onSyncStart(e,t,i)},resume:function u(e,t,i,n){n=n||{};this._subscribeSyncEvents();if(!i){this.onSyncSuccess(e,t,n)}},showSyncAlert:function f(i,n,a){var o=a.requestFinished;var s=o?"finished":"inProgress";var r;if(o){this.hideSyncAlert()}else{if(!this._overlayDisabled(i,n,a)){this.showOverlay()}}if(i==="delete"&&a.relate){i="unlink"}if(a.backgroundFetch){i="backgroundFetch"}r=e.lang.get(t[s][i]);if(r){this._showAlert(r,o)}},_shouldShowAlert:function h(e,t,i){return!(i.backgroundSync||this.isOfflineRead(e,t,i)||this._isSuccessAlertCurrentlyShowing())},_showAlert:function p(t,n){var a=this.getAlertOptions(t,n);e.alert.show(i,a)},getAlertOptions:function m(e,t){var i={level:"success",autoClose:true,messages:e};if(!t){_.extend(i,{level:"load",closeable:false,autoClose:false})}return i},hideSyncAlert:function g(){this.hideOverlay();if(!this._isSuccessAlertCurrentlyShowing()){e.alert.dismiss(i)}},_overlayDisabled:function v(t,i,n){return n.backgroundFetch||t==="read"&&i instanceof e.BeanCollection},showOverlay:function b(){e.overlay.show("data:sync",{spinner:false})},hideOverlay:function y(){e.overlay.hide("data:sync")},isOfflineRead:function E(t,i,n){return e.offlineEnabled&&t==="read"&&!n.backgroundFetch&&!i.offlineReadDisabled},_isSuccessAlertCurrentlyShowing:function L(){var t=e.alert.get(i)||{};return t.level==="success"}};e.augment("syncAlertManager",n)})(SUGAR.App)},function(e,t){(function(e){var t=e.alert.show;var i={};e.events.on("offline:status:update",function(e){if(!e.noConnection){i={}}});e.events.on("app:view:change",function(e){if(e.layoutDef&&e.layoutDef.isDynamic)return;var t=!!(e.dashboardId&&e.dashletId&&!e.modelId);$(document.body).toggleClass("has-pagination",t)});e.alert.show=function(n,a){a=a||{};if(a.pageHash&&a.pageHash!==window.location.hash){return}if(a.uid&&e.offlineEnabled){var o=a.requestOptions?a.requestOptions.params:{};if(!o.skipOfflineRead&&i[a.uid]){return}i[a.uid]=1}return t.apply(this,arguments)}})(SUGAR.App)},function(e,t){(function(e){var t=e.plugins._isPluginDisabled;_.extend(e.plugins,{attach:function(e,t){_.each(e.plugins,function(i){var n=this._get(i,t);if(n&&!this._isPluginDisabled(e,i,n)){var a=_.extend({},_.isFunction(e.events)?e.events():e.events,n.events);var o=_.omit(n,"initialize","events");_.each(o,function(t,i){if(_.isFunction(t)){var n=e[i];e[i]=function(){var e;var i;if(n){e=n.apply(this,arguments)}i=t.apply(this,arguments);if(!_.isUndefined(i)){e=i}return e}}});e.events=a;if(_.isFunction(n.onAttach)){n.onAttach.call(e,e,n)}if(_.isFunction(n.initialize)){e.once("init",n.initialize)}}},this)},_isPluginDisabled:function(e,i,n){var a=n.isEnabled?!n.isEnabled(e):false;return t.call(this,e,i)||a}})})(SUGAR.App)},function(e,t){(function(e){var t={};var i={triggerViewSync:function(e,i,n,a){_.each(t,function(t){if(this.shouldSync(t,e)){t.receiveSyncData(i,n,a)}},this)},shouldSync:function(e,t){return e!==t},registerView:function(e){t[e.cid]=e},unregisterView:function(e){delete t[e.cid]},_getSyncableViews:function(){return t},_reset:function(){t={}}};e.augment("syncableViewsManager",i)})(SUGAR.App)},function(e,t){(function(e){e.nomad.dashboards={_started:false,_cacheKey:"dashboards",isStarted:function(){return this._started},reset:function(){this._started=false},resetCollection:function(){if(this.collection){this.collection.reset()}},start:function(){this._started=true;this.cacheDashletStore=e.nomad.stores.dashlets;this.initCollection()},initCollection:function(){var t=this.getCachedDashboards()||[];this.collection=this.collection||e.data.createBeanCollection("Dashboards");this.collection.reset(t,{silent:true})},fetchDashboards:function(t,i){var n=this;async.waterfall([_.bind(n._fetchDashboards,n),_.bind(n._fetchDashboardMeta,n)],function(a,o){if(a){e.logger.debug("Error while fetching dashboards"+a)}else{n._processFetchResults(o,t)}i&&i(a)})},_fetchDashboards:function(t){var i=this;var n=_.map(e.metadata.getModuleNames(),function(t){return e.nomad.buildBulkRequest({module:"Dashboards/"+t,params:{max_num:-1,view_name:"record"}})});n.push(e.nomad.buildBulkRequest({module:"Dashboards"}));e.api.bulk({requests:n},{success:function(e){t(null,i._getSuccessfullResponses(e))},error:t})},_fetchDashboardMeta:function(t,i){var n=this;var a=_.map(t,function(t){return e.nomad.buildBulkRequest({module:"Dashboards",attributes:{id:t.id}})});e.api.bulk({requests:a},{success:function(e){i(null,n._getSuccessfullResponses(e))},error:i})},_processFetchResults:function(t,i){var n=this.collection.toJSON();i=i||{};t=_.filter(t,function(e){var t=e.metadata;this.adjustDashboardMetadata(t);return!_.isEmpty(t.dashlets)},this);this._cacheDashboards(t);this.cleanUnusedDashletsCache();this.collection.reset(t,{silent:true});if(i.notifyIfChanged&&this._isAnyDashboardChanged(n,t)){e.events.trigger("app:dashboards:changed")}},getDashboards:function(e){var t;if(!this._started){return[]}t=this.collection.models;if(e){switch(e.type){case"home":t=_.filter(t,function(e){return e.get("dashboard_module")==="Home"});break;case"detail":t=_.filter(t,function(e){return e.get("dashboard_module")!=="Home"});break}if(e.module){t=_.filter(t,function(t){return t.get("dashboard_module")===e.module})}}return t},getDashboard:function(e){return this.collection.get(e)},adjustDashboardMetadata:function(t){var i=this;t.dashlets=[];_.each(t.components,function(n){_.each(n.rows,function(n){_.each(n,function(n){var a=n.view;var o;if(!a){return}o=_.values(a).join("");n.id=String(Math.abs(e.nomad.utils.getHashCode(o)));t.dashlets.push(n);i._normalizeDashletMeta(n)})})});this.cleanDashlets(t.dashlets)},cleanDashlets:function(e){var t;var i=[];for(t=e.length-1;t>-1;t--){if(!_.contains(i,e[t].id)&&this.canCreateDashlet(e[t])){i.push(e[t].id)}else{e.splice(t,1)}}},canCreateDashlet:function(t){var i=false;var n=this._getDashletType(t);if(this.isDashletSupported(t)){if(n==="tabbed-dashlet"){var a=e.metadata.getView(null,t.view.type);i=Boolean(a)&&_.any(a.tabs,function(t){return e.nomad.utils.isAccessibleModule(t.module,"list")})}else if(n==="dashablelist"){i=e.nomad.utils.isAccessibleModule(t.view.module,"list")}else if(n==="casessummary"){i=e.nomad.utils.isAccessibleModule("Cases","list")}else{i=true}}return i},isDashletSupported:function(t){var i=this._getDashletType(t);var n=e.config.dashboards.dashlets[i];return n&&n.enabled&&e.utils.versionCompare(e.serverInfo.version,n.minServerVersion,">=")},_normalizeDashletMeta:function(e){var t=e.view;if(!t.module&&e.context&&e.context.module){t.module=e.context.module}if(!t.type&&t.name){t.type=t.name}},getDashboardDashlets:function(e){var t=this.getDashboard(e);return t.get("metadata").dashlets},isDashletAvailable:function(e,t){return _.chain(this.getDashboardDashlets(e)).pluck("id").contains(t).value()},getDashletTitle:function(t){var i=t||{};var n=t.type;var a=t.label;var o=t.module;if(n==="dashablelist"){i={module:e.lang.getAppListStrings("moduleList")[o]||o}}else if(n==="bubblechart"&&!o){o=e.nomad.utils.isModuleVisible("RevenueLineItems")?"RevenueLineItems":"Opportunities"}return e.lang.get(a,o,i)},getDashletConfig:function(e,t){var i=_.find(this.getDashboardDashlets(e)||[],function(e){return e.id.toString()===t});return i},_cacheDashboards:function(t){e.cache.set(this._cacheKey,t)},getCachedDashboards:function(){return e.cache.get(this._cacheKey)},verifyDefaultView:function(){if(!e.nomad.getSetting("default_view")){return}var t=e.nomad.getSetting("default_view").split(":");var i=t[0]==="Dashboards"&&t[1];var n;var a;var o=true;if(i){a=!!this.getDashboard(i);n=t[2];o=a&&(n?this.isDashletAvailable(i,n):true);if(!o){e.nomad.removeSetting("default_view")}}},cleanDashboardsCache:function t(i){e.cache.cut(this._cacheKey)},cleanDashletsCache:function i(e){e=e||function(){};this.cacheDashletStore.cutAll(e)},cleanUnusedDashletsCache:function n(e){var t=this;this.cacheDashletStore.getAll(function i(n,a){if(n){return e(n)}var o=[];var s=[];t.collection.each(function(e){var t=e.get("metadata");_.each(t.dashlets,function(e){if(!_.contains(o,e.id)){o.push(e.id)}})});_.each(a,function(e,i){if(!_.contains(o,i)){s.push(function(e){t.cacheDashletStore.cut(i,e)})}});async.parallel(s,e)})},_getDashletType:function(t){var i=e.metadata.getView(null,t.view.type);return i&&i.tabs?"tabbed-dashlet":t.view.type},_isAnyDashboardChanged:function(e,t){t=t||[];return e.length!==t.length||_.any(e,function(e){return!_.any(t,function(t){return e.id===t.id&&e.date_modified===t.date_modified},this)},this)},_getSuccessfullResponses:function(e){var t=[];_.each(e,function(e){if(e.status===200){if(e.contents.records){t.push.apply(t,e.contents.records)}else if(e.contents&&e.contents.metadata){t.push(e.contents)}}});return t}}})(SUGAR.App)},function(e,t){(function(e){var t={INTERNET_UNAVAILABLE:-1,CONNECTION_FAILED:-2,CONNECTION_TIMEOUT:-3,INVALID_CREDENTIALS:-4};function i(){e.router.login()}var n=e.error.handleStatusCodesFallback;var a=e.error.enableOnError;var o=e.error.handleUnhandledError;e.error.statusCodes["200"]=e.error.statusCodes["0"];e.error=_.extend(e.error,{enableOnError:function(){if(e.config.raven&&e.config.raven.enabled){return true}return a.apply(this,arguments)},_alertUnauthorized:function(){e.alert.show("auth_error",{level:"error",messages:e.lang.get("ERR_MOBILE_NOT_AUTHORIZED"),autoClose:true})},_alertSystemError:function(t){var i=t.status||t.status===0?t.status.toString():"N/A";var n;if(t instanceof e.offline.Error){n=t.localizedMessage()}else{n=e.lang.get("ERR_MOBILE_INTERNAL").replace("{{{code}}}",i)}e.alert.show("system_error",{level:"error",messages:n,autoClose:true,uid:"ERR_MOBILE_INTERNAL_"+i,pageHash:t.request?t.request.params.pageHash:null})},handleNeedLoginError:function(){e.alert.show("auth_error",{level:"error",messages:e.lang.get("ERR_MOBILE_INVALID_CREDS"),autoClose:true});i();this._sendAnalytics(t.INVALID_CREDENTIALS)},handleInvalidGrantError:function(){e.alert.show("auth_error",{level:"error",messages:e.lang.get("ERR_MOBILE_SESSION_EXPIRED"),autoClose:true});i()},handleUnhandledError:function(t,i,n){try{this.logFatalError(t,{url:i,line:n,version:e.nomad.getProductVersion(),serverVersion:e.nomad.getServerVersion(),serverUrl:e.nomad.getServerUrl(),clientInfo:e.clientInfo})}catch(a){}},logFatalError:function(t,i){try{var n=e.config.env==="prod";t=t||"Unknown error";e.logger.fatal(JSON.stringify(i));t=n?e.lang.get("ERR_INTERNAL_ERR_MSG"):"FATAL: "+t;e.alert.show("system_error",{level:"error",messages:t,autoClose:true});e.analytics.trackEvent("device","exception")}catch(a){}},handleUnauthorizedError:function(){this._alertUnauthorized();i()},handleForbiddenError:function(e){this._alertUnauthorized();this._sendAnalytics(e.status)},handleNotFoundError:function(t){e.alert.show("not_found_error",{level:"error",messages:this._adjustErrorMessage("ERR_MOBILE_NOT_FOUND",t),autoClose:true});this._sendAnalytics(t.status)},handleTimeoutError:function(i){e.alert.show("system_error",{level:"error",messages:this._adjustErrorMessage("ERR_MOBILE_TIMEOUT",i),autoClose:true,uid:"ERR_MOBILE_TIMEOUT",pageHash:i.request.params.pageHash});this._sendAnalytics(t.CONNECTION_TIMEOUT)},handleMethodConflictError:function(e){this._sendAnalytics(e.status)},handleStatusCodesFallback:function(a,o,s){var r;var l=a.status;e.alert.dismissAll({animate:false});if(_.isUndefined(a.status)){if(a===e.offline.Error.OutOfSpaceError){e.alert.show("offline_error",{level:"error",messages:a.localizedMessage(),autoClose:true})}return}var c;if(a.status=="0"&&(a.textStatus==="error"||a.textStatus==="abort")&&_.isEmpty(a.errorThrown)){if(!e.nomad.isOnline()){r="Device is offline";l=t.INTERNET_UNAVAILABLE}else{r="Server is unreachable. "+(navigator.connection?"Connection: "+navigator.connection.type:"");l=t.CONNECTION_FAILED}e.alert.show("network_error",this.prepareNetworkAlertParams(a,s))}else if(a.status=="412"){if(e.nomad._isSyncing||e.nomad._hasAskedForSync)return;e.nomad._hasAskedForSync=true;e.nomad.showConfirm(e.lang.get("ERR_MOBILE_METADATA_CHANGED_RELOAD"),function(t){e.nomad.dismissAlerts();if(t===2){if(document.activeElement)document.activeElement.blur();e.controller.clean({disposeAll:true});e.nomad.syncApp()}else{e.nomad._hasAskedForSync=false;e.alert.show("meta_error",{level:"error",messages:e.lang.get("ERR_MOBILE_METADATA_CHANGED"),autoClose:true})}})}else if(a.status=="422"&&a.message&&(c=a.message.match(/^(.*) is an invalid email address$/))){e.alert.show("meta_error",{level:"error",messages:e.lang.get("ERROR_EMAIL",null,{email:c[1]}),autoClose:false})}else if(a.status=="433"){if(e.config.scheme==="rebrand"){e.alert.show("incompatible_client",{level:"error",messages:e.lang.get("ERR_MOBILE_INCOMPATIBLE_REBRAND_CLIENT_VERSION",null,{brandName:e.config.brandName}),autoClose:false})}else{e.nomad.showConfirm(e.lang.get("ERR_MOBILE_INCOMPATIBLE_CLIENT_VERSION",null,{brandName:e.config.brandName}),function(t){e.nomad.dismissAlerts();if(t===2){e.nomad.openAppStore()}i()})}}else{this._alertSystemError(a);if(a.status=="400")i()}var d=!_.contains([0,433,412],a.status);if(d||!d&&e.logger.levels[e.config.logLevel].value<=e.logger.levels.DEBUG.value){if(r)e.logger.error(r);n(a);this._logRequestUrl(a)}this._sendAnalytics(l)},handleNotSupportedPlatform:function(){window.location.replace("error-not-supported-platform.html?desktop_url="+e.nomad.getDesktopUrl())},handleExternalLoginNotAvailable:function(){e.alert.show("sso_error",{level:"error",messages:e.lang.get("ERR_MOBILE_SSO_NOT_CONFIGURED"),autoClose:true})},isAccessError:function(e){return _.contains([403,404],e.status)},prepareNetworkAlertParams:function(t,i){var n;var a=e.nomad.isOnline()?this._adjustErrorMessage("ERR_MOBILE_CONNECTION_FAILED",t):e.lang.get("ERR_MOBILE_INTERNET_UNAVAILABLE");n={level:"error",messages:a,autoClose:true,pageHash:t.request.params.pageHash,requestOptions:i};if(!t.isFileUploadError){n.uid="ERR_MOBILE_CONNECTION_FAILED"}return n},_sendAnalytics:function(t){t=t||"unknown";e.analytics.trackEvent("api-error",t)},_adjustErrorMessage:function(t,i){var n=i&&i.request&&i.request.params?e.api.isLoginRequest(i.request.params.url):false;if(n)t+="_LOGIN";return e.lang.get(t,null,{brandName:e.config.brandName,minVersion:e.config.minServerVersion,supportedFlavors:e.config.supportedServerFlavors.join(", ")})},_logRequestUrl:function(t){if(t.request&&t.request.params&&t.request.params.url)e.logger.error("URL of failed request: "+t.request.params.url)}});e.error.statusCodes["422"]=e.error.handleStatusCodesFallback})(SUGAR.App)},function(e,t){(function(e){var t={DIMENSIONS:{offlineMode:1,connection:2,sugarInstance:3},METRICS:{},initialized:false,trackEventSplitter:/^(.*):([\-\w]+)\.?(\S+)?$/,eventSplitter:/\s{2,}/,currentViewId:"",loginProcessed:true,init:function(){if(e.config.analytics.enabled){e.nomad.loadAnalytics()}if(e.config.analytics.enabled&&typeof Analytics!=="undefined"&&Analytics){if(this.initialized)return;this.initialize();var t=e.config.analytics.id;t=_.isObject(t)?e.isNative?t.native:t.web:t;analytics.start(t,e.config.analytics);e.logger.debug("Analytics enabled - "+t)}else{e.events.off(null,null,this);this.initialized=false;e.logger.debug("Analytics disabled")}},processConfig:function(t){var i={};if(t.analytics&&!e.isNative){i.analytics=_.extend({},e.config.analytics,{enabled:Boolean(t.analytics.enabled)})}return i},initialize:function(){e.events.on("app:view:change",function(e){var t={module:"",layoutType:"",track:"",link:e.link};if(e.action){this._handleGAForActions(e,t)}else if(e.parentModelId){this._handleGAForParentModule(e,t)}else if(e.root){this._handleGAForRootModules(e,t)}else if(e.layoutDef){this._handleGAForLayout(e,t)}else{t.layoutType=e.modelId?"detail":"list";t.module=e.module||e.parentModule||e.root}this._buildViewIdAndTrack(t)},this).on("app:start",function(){if(e.api.isAuthenticated()){this._trackServerInstance(e.config.siteUrl)}},this).on("app:login:success",function(){if(!_.isEmpty(e.serverInfo.version)){e.analytics.trackEvent("login",e.serverInfo.version);e.analytics.loginProcessed=true}else{e.analytics.loginProcessed=false}e.analytics.trackEvent("useHttps",e.nomad.getSetting("useHttps")?"enabled":"disabled");this._trackServerInstance(e.config.siteUrl)},this).on("app:sync:complete",function(){if(!e.analytics.loginProcessed){e.analytics.trackEvent("login",e.serverInfo.version);e.analytics.loginProcessed=true}},this).on("app:logout",function(){e.analytics.loginProcessed=false},this).on("offline:enabled",function(t){e.analytics.setDimension(e.analytics.DIMENSIONS.offlineMode,t?"enabled":"disabled")},this).on("offline:failure",function(t){e.analytics.trackEvent("offline-failure",t.code)},this).on("offline:encryption:complete",function(t){e.analytics.trackEvent("storage-encryption",t?"failed":"success")},this).on("offline:tx:create",function(t){e.analytics.trackEvent("tx-create",e.offline.utils.actionToSymbol(t.txOptions))},this).on("offline:tx:success",function(t){e.analytics.trackEvent("tx-success",e.offline.utils.actionToSymbol(t.tx),e.offline.utils.getTxAge(t.tx))},this).on("offline:tx:error",function(t){e.analytics.trackEvent("tx-error",t.errorCode||"unknown",e.offline.utils.getTxAge(t.tx),e.offline.utils.actionToSymbol(t.tx))},this).on("offline:tx:rollback",function(t){e.analytics.trackEvent("tx-rollback",e.offline.utils.actionToSymbol(t.tx),e.offline.utils.getTxAge(t.tx))},this).on("offline:wins:completed",function(t){e.analytics.trackEvent("offline:wins","synced",t.syncedRecords,"numRecords")},this);this.initialized=true},onAppPause:function(t){e.analytics.trackEvent("device","pause")},onAppResume:function(){this.trackEvent("device","resume")},_handleGAForParentModule:function(e,t){t.module=e.parentModule;if(e.modelId){t.layoutType="details"}else if(e.dashletId){this._handleGAForDashlets(e,t)}else{t.layoutType="relationships"}},_handleGAForRootModules:function(t,i){switch(t.root){case"Login":i.layoutType=t.root.toLowerCase();i.module=t.root;i.track="create";break;case"About":case"Settings":i.layoutType=t.root.toLowerCase();i.module=e.utils.capitalize(t.root);i.track="create";break;case"Offline":switch(t.module){case"TxLog":i.layoutType=t.modelId?"detail":"list";i.module=t.module;break;case"offlineStats":i.layoutType=t.module;i.module=t.root;i.track="create";break;default:i.layoutType=t.root.toLowerCase();i.module=t.root;i.track="create";break}break;case"Search":case"Recents":if(t.module&&t.modelId){i.layoutType="detail";i.module=t.module}else{i.layoutType="list";i.module=t.root}break;case"Dashboards":if(t.dashletId){this._handleGAForDashlets(t,i)}else{i.layoutType="dashboard"}break}},_handleGAForActions:function(t,i){switch(t.action){case"duplicate":i.layoutType="edit";i.track="duplicate";break;case"create-related":case"associate-related":i.layoutType="pickerlist";break;case"associate":
i.layoutType=t.action;i.module=e.data.getRelatedModule(t.parentModule,t.link);i.track=t.parentModule;break;default:i.layoutType=t.action?t.action:"detail";break}if(t.action==="create"&&t.parentModelId){i.layoutType="edit";i.module=t.parentModule;i.track=t.link;i.link="create"}if(!i.module){i.module=t.module||t.parentModule}},_handleGAForLayout:function(t,i){var n=t.layoutDef.gaTrack;if(n==="teamset"){i.layoutType="multienum";i.module=e.controller.getScreenContext().module;i.track="teamset"}else if(n==="textarea"){i.layoutType=n;i.module=t.layoutDef.context.get("parentModel")?t.layoutDef.context.get("parentModel").module:null}else{i.layoutType=n;i.module=e.controller.getScreenContext().module;if(n==="relate"||n==="parent-list"){i.track=t.layoutDef.context.attributes.module}else if(n==="about"){i.module="Login"}}},_handleGAForDashlets:function(t,i){var n=e.nomad.dashboards.getDashletConfig(t.dashboardId,t.dashletId).view;var a=t.root==="Dashboards";i.layoutType=a?"dashlet":"record-dashlet";if(n.template==="tabbed-dashlet"){i.layoutType="";i.module=""}else if(n.type==="dashablelist"){i.module=a?"list":t.parentModule;i.track=a?n.module:"list";i.link=a?i.link:n.module}else{i.module=a?n.type:t.parentModule;i.track=a?"":n.type}},_buildViewIdAndTrack:function(e){var t=_.compact([e.layoutType,e.module,e.track,e.link]).join("/");if(!_.isEmpty(t)){this.setActiveView(t)}},setActiveView:function(e,t){this.currentViewId=e;if(!t){this.trackPageView(e)}},trackPageView:function(t){if(!this.initialized)return;e.logger.debug("GAN-page: "+t);if(e.offlineEnabled){this.setDimension(this.DIMENSIONS.connection,e.offline.status.noConnection?"offline":"online")}analytics.trackPageView(t)},trackEvent:function(t,i,n,a){if(!this.initialized)return;i=""+(i||"[unknown]");a=""+(a||this.currentViewId);e.logger.debug("GAN-event: "+t+":"+i+"("+n+")"+" for "+a);analytics.trackEvent({category:t,action:i,label:a,value:n})},startSession:function(){if(!this.initialized)return;analytics.startSession()},setDimension:function(e,t){if(!this.initialized)return;analytics.setDimension({index:e,value:t})},setMetric:function(e,t){if(!this.initialized)return;analytics.setMetric({index:e,value:t})},detachAnalytics:function(e){var t=this.getTrackableElements(e);t.unbind(".analytics")},attachAnalytics:function(e){var t=this;var i=this.getTrackableElements(e);i.unbind(".analytics");i.each(function(e,i){t._attachAnalytics(i)})},getTrackableElements:function(e){var t=this._getTrackableElements(e);if(e.attr("track")){t=t.add(e)}return t},_getTrackableElements:function(e){return $("[track]",e)},_attachAnalytics:function(e){var t=$(e);var i=(t.attr("track")||"").trim();if(i==="")return;var n=i.match(this.trackEventSplitter);var a=(n[1]||"").trim();var o=n[2];var s=n[3]||"";var r=a.replace(this.eventSplitter," ").split(" ");r=_.map(r,function(e){return e+".analytics"});a=r.join(" ");this._attachEvents(a,o,s,t)},_attachEvents:function(t,i,n,a){if(t){a.off(t);a.on(t,function(t){i=i||t.currentTarget.id;e.analytics.trackEvent(t.type,i,n&&$(this).hasClass(n)?1:0)})}},_trackServerInstance:function(t){if(e.config.analytics.instanceTracking){e.analytics.setDimension(e.analytics.DIMENSIONS.sugarInstance,this._instanceKeyFromUrlWhitelist(t))}},_instanceKeyFromUrlWhitelist:function(t){var i=_.find(e.config.analytics.serverUrlWhiteList||[],function(e){var i=new RegExp(e,"i");return i.test(t)});return i?i:"others"},dispose:function(){e.events.off(null,null,t);this.initialized=false}};e.augment("analytics",t,false)})(SUGAR.App)},function(e,t){(function(e){e.events.on("nativeMessage",function(e){if(e.target==="telephony"){t.callStateChanged(e.calls)}});var t={CALL_STATE:{IDLE:"IDLE",DIALING:"DIALING",CONNECTED:"CONNECTED"},_callModule:"Calls",getCallLog:function(){return e.nomad.getSetting("callLog")},setCallLog:function(t){e.nomad.setSetting("callLog",t)},clearCallLog:function(){e.nomad.removeSetting("callLog")},callPhone:function(t,i){var n={phone:t,module:i.module,recordId:i.id,recordName:i.get("name")};this.setCallLog(n);if(!e.isNative){this.bindCallEnd()}if(!$.os.phone){n.started=true;n.startedOn=(new Date).getTime()}e.logger.debug("Initiating a phone call to "+t);e.nomad._callPhone(t)},callStateChanged:function(t){if(t.length===0)return;e.logger.debug("Call state changed: "+t.length);var i=t[0];e.logger.debug("First call: "+i.id+":"+i.state);var n=this.getCallLog();var a=$.os.ios&&e.utils.versionCompare($.os.version,8,">=");if(n){if(i.state===this.CALL_STATE.DIALING){n.state=i.state;n.direction="Outbound";n.startedOn=(new Date).getTime();n.started=true;this.setCallLog(n);if(a){this.onAppResume()}}else if(i.state===this.CALL_STATE.IDLE){n.state=i.state;n.endedOn=(new Date).getTime();this.setCallLog(n)}}},onAppPause:function(){},onAppResume:function(){if(!e.isSynced)return;var t=this.getCallLog();if(_.isEmpty(t))return;if($.os.android&&t.state!==this.CALL_STATE.IDLE&&e.isNative)return;if(!t.started){this.clearCallLog();return}t.endedOn=t.endedOn||(new Date).getTime();var i=this;if(this._canLogCall(t)){e.nomad.showConfirm(e.lang.get("LBL_MOBILE_LOG_CALL_CONFIRM"),function(e){if(e===2)i.logCall(t)})}this.clearCallLog()},logCall:function(t){var i=t.endedOn-t.startedOn;var n=i/1e3;var a=1;var o=0;if(n>60){a=n/60;if(a>60){o=a/60;a=a%60}}var s=e.nomad.getRelationshipLink(t.module,this._callModule);var r=t.direction==="Outbound"&&s?e.nomad.buildLinkRoute(t.module,t.recordId,s,null,"createCall"):"createCall";r+="?direction="+t.direction+"&start_date="+new Date(t.startedOn).toISOString()+"&duration_hours="+o+"&duration_minutes="+a+"&status=Held"+"&log_call=true";e.router.navigate(r,{trigger:true})},_canLogCall:function(t){var i=["Employees","Calls"];var n=!_.contains(i,t.module);var a=e.metadata.getModule(this._callModule);var o=a&&e.acl.hasAccess("create",this._callModule);var s=t.module==="Users"&&t.recordId===e.user.get("id");return o&&a&&n&&!s},bindCallEnd:function(){var t;var i=[{state:this.CALL_STATE.DIALING}];this.callStateChanged(i);if($.os.android){t=_.bind(function(){if(this._pageIsVisible()){e.logger.debug("bindCallEnd return handler called");document.removeEventListener("webkitvisibilitychange",t);this.onAppResume()}},this);document.addEventListener("webkitvisibilitychange",t,false)}else if($.os.ios){t=_.bind(function(){window.removeEventListener("pageshow",t);this.onAppResume()},this);window.addEventListener("pageshow",t,false)}},_pageIsVisible:function(){return!document.webkitHidden}};e.augment("telephony",t,false)})(SUGAR.App)},function(e,t){(function(e){var t={kTouchIdForLogin:1,kPasskey:2,kTouchIdForPasskey:4,kTouchIdEnabledKey:"touchIdEnabled",init:function(){this._touchIdEnabledOnLogin=true;this._authFailedCount=0;e.events.on("app:logout",function(e){this.toggleTouchIdOnLogin(false)},this)},isTouchIdAuthenticationSupported:function(){var t=e.clientInfo.device;var i=t.touchIdSupported&&e.config.localSecurity.enabled;if(e.isSynced){i=i&&e.config.localSecurity.touchIdForLoginEnabled&&e.supportedFeatures.localSecurityServerSupport}return i},isPasskeyAuthenticationSupported:function(){return e.supportedFeatures.localSecurityServerSupport&&e.isNative&&e.config.localSecurity.enabled&&e.config.localSecurity.passkeyEnabled},isTouchIdForLoginSetup:function(){return this.isTouchIdAuthenticationSupported()&&Boolean(e.nomad.getSetting(this.kTouchIdEnabledKey))},isTouchIdEnrolled:function(e){this._isTouchIdEnrolled(e)},storeCredentials:function(t,i){this._storeCredentials(t,i);e.nomad.setSetting(this.kTouchIdEnabledKey,true)},resetCredentials:function(){this._resetCredentials();e.nomad.setSetting(this.kTouchIdEnabledKey,false)},toggleTouchIdOnLogin:function(e){this._touchIdEnabledOnLogin=e},isTouchIdEnabledOnLogin:function(){return this.isTouchIdForLoginSetup()&&this._touchIdEnabledOnLogin},performTouchId:function(e,t){this._performTouchId(e,t)},isStepNeeded:function(){return!this.isTouchIdForLoginSetup()},canPerformStep:function(){return Boolean(this.getTempCredential())},performStepAction:function(e){e=e||{};if(e.action==="enable"){this.moveTempCredentialsToStorage()}},cleanupStep:function(){this.resetTempCredential()},setTempCredential:function(e){this._tempTouchIdCredential=e},getTempCredential:function(){return this._tempTouchIdCredential},resetTempCredential:function(){this._tempTouchIdCredential=null},moveTempCredentialsToStorage:function(){var t=e.nomad.getSetting("loginName");this.storeCredentials(t,this._tempTouchIdCredential);this.resetTempCredential()},processConfig:function(t){var i={};if(t.mobile&&e.config.localSecurity.enabled&&e.isNative&&$.os.ios){var n=t.mobile.localSecurityMask;if(_.isNumber(n)){var a=e.config.localSecurity;i.localSecurity=_.extend({},a,{touchIdForLoginEnabled:Boolean(n&this.kTouchIdForLogin),passkeyEnabled:Boolean(n&this.kPasskey),touchIdForPasskeyEnabled:Boolean(n&this.kTouchIdForPasskey)});if(a.touchIdForLoginEnabled!==i.localSecurity.touchIdForLoginEnabled){this.resetCredentials()}}}return i},performTouchIdSetup:function(t){var i=this;async.series([function(t){i.isTouchIdEnrolled(function(i){if(i){var n=e.lang.get("LBL_TOUCH_ID_DISCLAIMER",null,{brandName:e.config.brandName})+e.lang.get("LBL_TOUCH_ID_ENABLE_CONFIRM_MSG");e.nomad.showConfirm(n,function(e){t(e!==2)},e.lang.get("LBL_ENABLE_TOUCHID"))}else{e.nomad.showAlert(e.lang.get("LBL_TOUCH_ID_NOT_ENROLLED_MSG",null,{brandName:e.config.brandName}),null,e.lang.get("LBL_SETUP_TOUCHID"));t(true)}})},function(t){var n={title:"",buttonLabels:[e.lang.get("LBL_CANCEL_BUTTON_LABEL"),e.lang.get("LBL_ENABLE")],defaultText:e.lang.get("LBL_LOGIN_PASSWORD"),inputStyle:3};var a;var o="wait_to_verify_password";async.retry(e.config.localSecurity.maxAllowedPasswordAttempt,function(t){var s=(a?e.lang.get("ERR_MOBILE_INVALID_PASSWORD")+"\n\n":"")+e.lang.get("LBL_TOUCH_ID_ENTER_PASSWORD_TITLE",null,{brandName:e.config.brandName});e.overlay.show(o);e.nomad.showPrompt(s,function(n){var s=n.buttonIndex;if(s===2){var r=n.input1;e.alert.show(o,{level:"info",messages:e.lang.get("LBL_MOBILE_WAIT"),autoClose:false,closable:false});i._verifyPasswordForTouchId(r,function(n,s){a=!n;var l;var c=!n;if(n){i.setTempCredential(r)}else if(s){c=false;l=true}e.alert.dismiss(o);e.overlay.hide(o);t(c,l)})}else{e.overlay.hide(o);t(false,true)}},n)},function(i,n){if(i){e.router.logout(true)}t(i||n)})}],function(e){t(!e)})},_verifyPasswordForTouchId:function(t,i){var n=this;e.alert.dismissAll("error");e.api.verifyPassword(t,{error:function(t){e.error.handleHttpError(t,null,{params:{skipOfflineRead:true}});i(false,t)},success:function(t){if(t.valid){i(true)}else{e.alert.show("auth_error",{level:"error",messages:e.lang.get("ERR_MOBILE_INVALID_PASSWORD"),autoClose:true});i(false)}}})}};e.augment("localSecurity",t,false)})(SUGAR.App)},function(e,t){(function(e){var t={isSetupBuddySupported:function(){return!e.config.skipSetupBuddy},isSetupBuddyDone:function(){return Boolean(e.nomad.getSetting("setupBuddyDone"))},setSetupBuddyDone:function(t){e.nomad.setSetting("setupBuddyDone",t);if(t){this._cleanUp()}},show:function(e){this._setupBuddyCompleteCallback=e;if(this.isSetupBuddySupported()&&!this.isSetupBuddyDone()&&this._canPerformSetupBuddy()){this._showSetupBuddyView();return}if(!this.isSetupBuddyDone()&&!this._isSetupBuddyNeeded()){this.setSetupBuddyDone(true)}this._setupBuddyCompleteCallback()},_showSetupBuddyView:function(){var t=e.controller.layoutManager.getRootLayout();var i=t&&t.name==="setupbuddy";if(!i){e.controller.loadScreen({root:"SetupBuddy"})}},_isSetupBuddyNeeded:function(){return e.localSecurity.isStepNeeded()},_canPerformSetupBuddy:function(){return e.localSecurity.canPerformStep()},performStepAction:function(t){e.localSecurity.performStepAction(t);this.setSetupBuddyDone(true);this._setupBuddyCompleteCallback()},_cleanUp:function(){e.localSecurity.cleanupStep()}};e.augment("setupBuddy",t,false)})(SUGAR.App)},function(e,t){(function(e){SUGAR.forms.FlashField=function(){};SUGAR.forms.markField=SUGAR.forms.unmarkField=function(){};e.metadata.copy=function(t,i){i=i||{};if(i.bean instanceof e.Bean){return e.utils.deepCopy(t)}else{return t}};var t=SUGAR.expressions.SidecarExpressionContext.prototype.setValue;SUGAR.expressions.SidecarExpressionContext.prototype.setValue=function(e,i){t.apply(this,arguments);var n=this.getField(e);if(n&&n.type==="enum"&&n.def.visibility_grid){n.render()}};SUGAR.expressions.SidecarExpressionContext.prototype.setFieldRequired=function(e,t){t=SUGAR.expressions.Expression.isTruthy(t);var i=this.view.getField(e,this.model);if(i){i.setRequired(t)}};_.extend(SUGAR.expressions.SidecarExpressionContext.prototype,{addClass:function(e,t){var i=this.view.getField(e,this.model);if(i){i.$el.addClass(t)}},removeClass:function(e,t){var i=this.view.getField(e,this.model);if(i){i.$el.removeClass(t)}}});var i=e.metadata.set;var n=["collection"];e.metadata.set=function(t,u,f){if(t.modules_info&&t.modules_info.RevenueLineItems&&t.modules.Opportunities&&t.modules.Opportunities.config&&t.modules.Opportunities.config.opps_view_by&&t.modules.Opportunities.config.opps_view_by!=="RevenueLineItems"){t.modules_info.RevenueLineItems.visible=t.modules_info.RevenueLineItems.display_tab=false}if(t._override_values){_.each(t._override_values,function(e,i){if(!t[e]){delete t._override_values[i]}})}if(t.config){var h={};_.extend(h,e.analytics.processConfig(t.config));_.extend(h,e.localSecurity.processConfig(t.config));h.offlineEnabled=Boolean(t.config.offlineEnabled);t.config=h}var p=false;if(t.server_info){p=e.nomad.isSevenUp(t.server_info);t.server_info.isSevenUp=p}else{t.server_info={}}if(!f&&t._hash!=="_base_"){s(t.views);var m=e.metadata.getHash();if(m!==t._hash&&m!=="_base_"){if(t.modules){e.logger.debug("Metadata hash has changed. Resetting to base.");e.metadata.reset();e.metadata.set(JSON.parse(JSON.stringify(e.baseMetadata)),false,true)}else{t._hash=m}}e.nomad.initSupportedFeatures();e.nomad.updateSupportedFeatures(t);if(t.app_list_strings&&t.app_list_strings.available_language_dom)delete t.app_list_strings.available_language_dom[""];if(!t.currencies){t.currencies={}}_.each(t.currencies,function(e){e.conversion_rate=e.conversion_rate||e.rate});_.each(t.modules_info,function(i,n){if(_.contains(e.config.unsupportedModules,n)){delete t.modules_info[n]}});if(t.modules_info){_.each(e.config.hiddenModules,function(e){if(t.modules_info[e]){t.modules_info[e].visible=false}})}if(!t.mod_strings)t.mod_strings={};t.mod_strings=_.extend({},e.mod_strings,t.mod_strings);var g=e.config.unsupportedModules||[];_.each(t.modules,function(e,i){if(_.contains(g,i)){delete t.modules[i];delete t.mod_strings[i]}});var v=_.contains(["ENT","ULT"],t.server_info.flavor);var b="portal_flag";if(_.isEmpty(t.relationships))t.relationships={};var y=t.relationships.tasks_notes;if(y){y.relationship_role_column="parent_type";y.relationship_role_column_value="Tasks";y.relationship_type="one-to-many"}_.each(t.relationships,function(e,i){e=e||{};e.relationship_type=e.true_relationship_type||e.relationship_type;if(t.modules[e.lhs_module]&&t.modules[e.rhs_module]){if(e.relationship_role_column==="parent_type"||i==="contact_tasks"||i==="contact_notes"){e.via_parent_id=true}}else if(i!=="_hash"){delete t.relationships[i]}});if(t.relationships.accounts_opportunities){t.relationships.accounts_opportunities={lhs_key:"id",lhs_module:"Accounts",lhs_table:"accounts",name:"accounts_opportunities",relationship_type:"one-to-many",rhs_key:"account_id",rhs_module:"Opportunities",rhs_table:"opportunities"}}_.extend(t.relationships,e.baseMetadata.relationships);var E={};var L={};var w={};_.each(t.modules,function(i,a){if(i._patched)return;if(p)delete i.subpanels;var s=w[a]||{},r={};w[a]=s;var c=["fieldTemplates","menu"];if(a!=="Forecasts"){c.push("config")}x(i,c);if(a!=="Activities"&&i.filters){i.filters={basic:i.filters.basic,"default":i.filters.default}}if(i.layouts){x(i.layouts,_.filter(_.keys(i.layouts),function(e){return!_.contains(["list","detail","edit","subpanels"],e)}));if(i.layouts.subpanels&&i.layouts.subpanels.meta&&i.layouts.subpanels.meta.components){if(!_.isArray(i.layouts.subpanels.meta.components)){delete i.layouts.subpanels}else{_.each(i.layouts.subpanels.meta.components,function(e){s[e.label]=true})}}}if(i.views){x(i.views,_.filter(_.keys(i.views),function(e){return!_.contains(["list","detail","edit","forecast-pipeline"],e)}))}if(i.views&&i.views["forecast-pipeline"]){var u=i.views["forecast-pipeline"];_.extend(u.meta.timeperiod[0],{type:"enum",view:"edit"});delete u.meta.panels;delete u.templates}if(!v){delete i.fields[b]}if(a==="RevenueLineItems"||a==="Products"){if(i.fields.opportunity_name&&i.fields.opportunity_id&&i.fields.opportunity_id.required){i.fields.opportunity_name.required=true}}_.each(i.fields,function(e,t){if(_.contains(n,e.type)){delete i.fields[t];return}if(t!=="_hash"&&_.isEmpty(e.name)){delete i.fields[t];return}x(e,["comment","dbType","isnull","table","reportable","audited","join_name","merge_filter","duplicate_merge","bean_name","cols","rows","function","importable","massupdate","studio","bean_filter_field","link_class","link_file","rhs_key_override","enable_range_search","duplicate_merge_dom_value","help","no_default","comments","custom_module","db_concat_fields","sort_on","subquery","query_type","operator","db_field","custom_type"]);s[e.vname]=true;if(e.type==="id")delete e.len;if(e.name==="name"||e.type==="name")e.unified_search=true;if(e.formula)o(e.formula,E,w,L);if(e.options)L[e.options]=true;var a=["id","assigned_user_id","modified_user_id","create_by"];if(_.contains(a,e.name))e.unified_search=false;if(e.type==="relate"||e.type==="parent")delete e.len;if(e["link-type"]&&!e.link_type)e.link_type=e["link-type"];if(e.relationship_fields){r[e.name]=true;_.each(e.relationship_fields,function(e){r[e]=true;var t=i.fields[e];if(t){s[t.vname]=true;if(t.options)L[t.options]=true}})}if(e.required&&i.fields.email&&e.name==="email1"){i.fields.email.required=true}});var f=i.fields.team_name;if(f){delete f.len;f.type="teamset"}f=i.fields.name;if(f){f.type="name"}if(a==="Meetings"){f=i.fields.date_start;if(f&&f.validation){delete f.validation.compareto}}else if(a==="Activities"){i.views=e.baseMetadata.modules.Activities.views;i.views["activitystream-dashlet"].meta.view.limit=e.config.fetchLimit.activities}if(i.views){delete i.views.listview;delete i.views.search;if(i.views.edit&&i.views.edit.meta&&i.views.edit.meta.panels){_.each(i.views.edit.meta.panels[0].fields,function(e){if(_.isObject(e)&&(e.name==="reminder"||e.name==="email_reminder")){_.each(["fields","related_fields"],function(t){_.find(e[t],function(i,n){if((i.name||i)===e.name+"_checked"){e[t].splice(n,1);return true}})})}})}}var h;if(t.mod_strings&&t.mod_strings[a]){if(t.mod_strings[a].LBL_EMAIL)h="LBL_EMAIL";else if(t.mod_strings[a].LBL_EMAIL_ADDRESS)h="LBL_EMAIL_ADDRESS"}var m=/^(?=.*address)((?!email).)*$/;var y=_.find(i.fields,function(e){return e.type==="file"});if(a!=="Forecasts"){_.each(i.views,function(t,n){if(t.meta){delete t.meta.templateMeta;if(t.meta.panels){if(t.meta.panels.length)t.meta.panels.length=1;if(t.meta.panels[0]){var o=[];var l=t.meta.panels[0].fields;var c=-1;delete t.meta.panels[0].label;l=_.reject(l,function(t){var o=_.isString(t)?t:t.name;var s=_.isEmpty(i.fields[o])&&t.type!=="fieldset";if(s)e.logger.error(a+"."+n+"."+o+" field is missing vardef");return s});if(n==="list"){l=_.filter(l,function(e){return!!e["default"]})}t.meta.panels[0].fields=l;_.each(l,function(e,t){var a=_.isObject(e),u=a?e.name:e,f=i.fields[u],p;if(e.options)L[e.options]=true;r[u]=true;s[e.label||f.vname]=true;if(f){if(f.options)L[f.options]=true;if(f.type==="relate"){r[f.id_name]=true;r[f.link]=true}else if(f.type==="parent"){r["parent_id"]=true;r["parent_type"]=true}}if(e.type==="fieldset"){_.each(e.fields,function(e){r[e.name]=true;if(e["default"])s[e["default"]]=true;else s[e.label||i.fields[e.name].vname]=true;if(e.options)L[e.options]=true})}if(!v&&u===b){c=t}if(a){x(e,["default","enabled","link","width","wireless_edit_only","customCode"]);if(m.test(e.name)&&f){if(n==="edit"||n==="detail"){p=_.extend(e,{index:t});if(!p.group){p.group=f.group}if(p.group)o.push(p)}else if(e.group||f.group){s[d(e.group||f.group)]=true}}if(e.name==="email1"){l[t]={name:"email",type:"email",label:e.label||h,required:f.required};s[e.label||h]=true;r.email=true}}else{if(m.test(u)&&f){if((n==="edit"||n==="detail")&&f.group){o.push({name:u,group:f.group,index:t})}else if(f.group){s[d(f.group)]=true}}if(e==="email1"){l[t]={name:"email",type:"email",label:h,required:f.required};s[h]=true;r.email=true}}});if(c!==-1){l.splice(c,1)}var u={};if(o.length>0){u=_.groupBy(o,"group");var f=0;_.each(u,function(e,t){var i=e[0].index-f;_.each(e,function(e){l.splice(i,1)});var n={name:t,fields:_.pluck(e,"name"),type:"address",label:d(t)};l.splice(i,0,n);f+=e.length-1;s[n.label]=true})}if(n==="edit"&&(a==="Meetings"||a==="Calls")){l.push({name:"send_invites",type:"bool",label:"LBL_SEND_INVITE"});l.push({name:"invitees",type:"invitees",label:"LBL_INVITEES"})}}}var p=_.map(t.meta.panels[0].fields,function(e){return e.name||e});if(y&&!_.contains(p,y.name)&&n==="edit"&&a!=="Notes"){t.meta.panels[0].fields.push(y.name)}}})}var S=[];var A=[];var R=function(i,n,a){S.push(n);n=i[n];if(n){var o=1e3;_.each(n.collection_list,function(n,r){if(!i[r]&&!n.generate_select&&!_.contains(A,n.module)&&!_.contains(g,n.module)){n.title_key="LBL_"+n.get_subpanel_data.toUpperCase()+"_SUBPANEL_TITLE";n.order=-o++;n.creatable=!_.contains(e.config.nonCreatableModules,n.module);n.linkable=false;i[r]=n;var l=t.mod_strings[a];if(l&&!l[n.title_key]){l[n.title_key]=n.module}s[n.title_key]=true;A.push(n.module)}})}};if(_.isObject(i.subpanels)&&!_.isArray(i.subpanels)&&!_.isEmpty(i.subpanels.subpanel_setup)){_.each(i.subpanels.subpanel_setup,function(n,o){if(!n)return;if(o!=="activities"&&o!=="history"){if((a==="Meetings"||a==="Calls")&&_.contains(["Users","Leads","Contacts"],n.module)){n.linkable=true;n.creatable=n.module!=="Users";s[n.title_key]=true}else{if(n.panel_definition){if(n.module!=="Users"){n.creatable=!_.contains(e.config.nonCreatableModules,n.module)&&!_.isEmpty(_.find(n.top_buttons,function(e){return!e.widget_class||e.widget_class.indexOf("Create")>-1}));n.linkable=!_.contains(e.config.nonLinkableModules,n.module)&&!_.isEmpty(_.find(n.top_buttons,function(e){return!e.widget_class||e.widget_class.indexOf("Select")>-1}));s[n.title_key]=true}else{S.push(o)}}else{n.creatable=(_.isUndefined(n.canCreate)?true:n.canCreate)&&!_.contains(e.config.nonCreatableModules,n.module);n.linkable=(_.isUndefined(n.canLink)?true:n.canLink)&&!_.contains(e.config.nonLinkableModules,n.module);s[n.title_key]=true}}if(n.panel_definition)n.order=-n.order;if(n.get_subpanel_data&&n.get_subpanel_data.indexOf("function:")===0)n.get_subpanel_data=n.set_subpanel_data;var r=i.fields[n.get_subpanel_data];if(!r||!t.relationships[r.relationship]){S.push(o);delete s[n.title_key];if(t.modules[n.module])e.logger.error("Invalid "+a+"."+o+" subpanel")}}x(n,["add_subpanel_data","set_subpanel_data","top_buttons","panel_definition","sort_by","sort_order","subpanel_name"])});R(i.subpanels.subpanel_setup,"activities",a);R(i.subpanels.subpanel_setup,"history",a);_.each(S,function(e){delete i.subpanels.subpanel_setup[e]});l(i)}else{delete i.subpanels}});t.views&&_.each(e.baseMetadata.views,function(e,i){if(!t.views[i]){t.views[i]=e}});if(!e.config.skipStringCleanup){if(_.isEmpty(t.modules)&&!_.isEmpty(e.metadata.getModules())){r(e.metadata.getStrings("app_strings"),t.app_strings);r(e.metadata.getStrings("app_list_strings"),t.app_list_strings);if(!_.isEmpty(t.mod_strings)){var S=e.metadata.getStrings("mod_strings");_.each(S,function(e,i){r(e,t.mod_strings[i])})}}else{if(t.mod_strings&&!t.mod_strings._patched){t.mod_strings=_.pick(t.mod_strings,_.keys(t.modules));_.each(t.mod_strings,function(i,n){_.each(i,function(i,o){var s=w[n]||{},r=a(t.modules[n]);if(!s[o]&&!_.contains(_.union(e._mod_strings,r),o)){delete t.mod_strings[n][o]}_.each(s,function(e,i){if(!t.mod_strings[i])E[i]=true})})});t.mod_strings._patched=true}if(t.app_list_strings&&!t.app_list_strings._patched){_.each(t.app_list_strings,function(i,n){if(!L[n]&&!_.contains(e._app_list_strings,n)){delete t.app_list_strings[n]}});t.app_list_strings._patched=true}if(t.app_strings&&!t.app_strings._patched){_.each(e._app_strings,function(e){E[e]=true});_.each(t.app_strings,function(e,i){if(!E[i]){delete t.app_strings[i]}});t.app_strings._patched=true}}}if(t.app_list_strings.reminder_time_options){if(!_.isArray(t.app_list_strings.reminder_time_options)){var A=[],R=_.keys(t.app_list_strings.reminder_time_options).sort(function(e,t){return e-t});_.each(R,function(e){A.push([e,t.app_list_strings.reminder_time_options[e]])});t.app_list_strings.reminder_time_options=A}var C=_.find(t.app_list_strings.reminder_time_options,function(e){return e[0]==-1});if(!C){t.app_list_strings.reminder_time_options.unshift([-1,t.app_strings.LBL_NONE])}}}if(t.views&&t.views["forecastdetails"]){t.views["forecastdetails"].meta.timeperiod[0].type="enum"}if(t.views&&t.views["bubblechart"]){_.extend(t.views["bubblechart"].meta.filter_duration[0],{type:"enum",view:"edit"})}i.apply(this,arguments);c(t,p)};function a(e){var t=e.filters;if(!t||!t.basic||!t.basic.meta){return[]}return _.pluck(t.basic.meta.filters,"name")}function o(t,i,n,a){var o,s=/.*?(?:translateLabel\((?:'|")(\w+)(?:'|")\s*,\s*(?:'|")(\w*)(?:'|")\)).*?/gm,r=[/.*?(?:getDropdownValue\((?:'|")(\w+)(?:'|"))+.*?/gm,/.*?(?:getDropdownKeySet\((?:'|")(\w+)(?:'|"))+.*?/gm,/.*?(?:getDropdownValueSet\((?:'|")(\w+)(?:'|"))+.*?/gm];e.nomad.utils.execRegex(t,s,function(e){var t=e[2];if(!_.isEmpty(t)){n[t]=n[t]||{};n[t][e[1]]=true}else{i[e[1]]=true}});var l=function c(e){a[e[1]]=true};for(o=0;o<3;++o){e.nomad.utils.execRegex(t,r[o],l)}}function s(t){_.each(t,function(i,n){if(e.config.dashboards.dashlets[n]||i.meta&&i.meta.tabs){if(i.templates){i.templates=null}}else{delete t[n]}})}function r(e,t){if(t&&e){_.each(t,function(i,n){if(e[n])return;delete t[n]})}}function l(e){var t=_.chain(e.subpanels.subpanel_setup).values().sortBy(function(e){return e.order}).value();_.each(t,function(e){e.context={link:e.get_subpanel_data};e.label=e.title_key;x(e,["subpanel_name","title_key","get_subpanel_data","order"])});e.layouts=_.extend(e.layouts||{},{subpanels:{meta:{components:t}}});delete e.subpanels}function c(t,i){if(t._hash==="_base_")return;var n=null;t.modules=_.omit(t.modules,"Forecasts");_.each(t.modules,function(a,o){var s=[];_.each(a.views,function(t){if(t.meta&&t.meta.panels){var i=_.chain(t.meta.panels[0].fields).filter(function(e){return e.type!=="link"}).map(function(e){return _.isString(e)?{name:e}:e}).value();_.each(i,function(e){if(_.contains(f,e.type)){e.sortable=0}});n=new e.view.View({context:e.context.getContext(),meta:{panels:[{fields:i}]}});s=_.union(s,n.getFieldNames(o));n.dispose();if(_.contains(s,"email")){s.push("email1")}}});if(o==="Activities"){return}s=_.union(s,i?["name","my_favorite","following"]:["name"]);if(_.find(s,function(e){return a.fields[e]&&a.fields[e].type==="currency"})){s=_.union(s,["currency_id"])}if(o==="Opportunities"){s=_.union(s,["closed_revenue_line_items"])}if(o==="Documents"){s=_.union(s,["doc_url","doc_type","filename"])}if(!t.server_info.ftsEnabled||!a["ftsEnabled"]){s=_.chain(a.fields).filter(function(e){return!!e.unified_search&&e.type!=="link"}).map(function(e){return e.name}).union(s).value()}a.mergedFields=_.union(a.mergedFields||[],s);var r=/\$[a-z_]+/gi,l=[];a.fields&&_.each(a.mergedFields,function c(e){if(a.fields[e]&&a.fields[e].formula){var t=a.fields[e].formula.match(r);_.each(t,function(e){e=e.substr(1);if(a.fields[e]&&a.fields[e].type!=="link"&&!_.contains(l,e)&&!_.contains(a.mergedFields,e)){l.push(e);c(e)}})}});a.mergedFields=_.union(a.mergedFields,l)})}function d(e){var t=e.toUpperCase();if(t.substr(-2)==="_C"){t=t.substr(0,t.length-2)}return"LBL_"+t}var u={base:1,bool:1,currency:1,date:1,datetimecombo:1,email:1,emailbody:1,"enum":1,"float":1,file:1,image:1,"int":1,multienum:1,name:1,parent:1,password:1,phone:1,radioenum:1,relate:1,address:1,invitees:1,send_invites:1,teamset:1,text:1,textarea:1,url:1,tag:1};var f=["teamset","multienum","image","file"];var h={image:function(){return e.supportedFeatures["fileUpload"]?undefined:["edit"]},password:["edit"],emailbody:["list"],html:[],encrypt:[],currency_id:[]},p={currency_symbol:[]};var m=e.metadata._patchMetadata;e.metadata._patchMetadata=function(t,i){if(!i||i._patched===true){return i}m.apply(this,arguments);_.each(i.views,function(t,n){if(t.meta){_.each(t.meta.panels,function(t){var a=[];_.each(t.fields,function(t,o){var s=h[t.type];if(_.isFunction(s)){s=s()}if(s&&(s.length===0||_.contains(s,n))){a.push(o)}var r=p[t.name];if(r&&(r.length===0||_.contains(r,n))){a.push(o)}if(n==="edit"&&!(u[t.type]||_.contains(e.customization.getCustomFields(),t.type))){t.view="readonly"}if(n==="edit"&&t.name==="date_modified"){t.view="readonly"}if(n==="edit"&&t.name==="date_entered"){t.view="readonly"}if(n==="edit"&&t.type==="url"&&i.fields[t.name]){var l=i.fields[t.name].gen,c=!isNaN(parseInt(l,10))?!!parseInt(l,10):!!l;if(c){t.view="readonly"}}});_.each(a,function(e,i){t.fields.splice(e-i,1)})},this)}},this);return i};e.error.errorName2Keys.email="ERR_MOBILE_EMAIL";var g={All:["created_by","created_by_name","modified_by_name","modified_user_id","date_entered","date_modified","my_favorite","deleted",/^email([^_]|_(?!c$|reminder))+$/],Employees:["user_name","user_hash","system_generated_password","pwd_last_changed","authenticate_id","sugar_login","is_admin","picture","status"],Calls:["status"],Contacts:["portal_active","portal_app","portal_name","portal_password","portal_password1"],Notes:["contact_email","contact_phone","file_mime_type","file_url"],Tasks:["contact_email","contact_phone","status"],Meetings:["status"],RevenueLineItems:["quote_id","quote_name"],Opportunities:["closed_revenue_line_items"]};var v=["file","password","image"];var b=function(){var t=null;e.events.on("app:sync:complete",function(){t=null});var i={"7.0":{"ENT, ULT":{Opportunities:["amount","date_closed"]}}};function n(t,n){var a=_.find(i,function(i,a){if(!e.utils.versionCompare(n,a,">="))return false;var o=_.find(i,function(e,i){var n=i.split(/,\s*/);return _.contains(n,t)});return o});return a&&_.values(a)[0]}function a(){if(t!==null)return t;var i=e.metadata.getServerInfo(),a=i.flavor,o=i.version,s=g,r=n(a,o);t=e.nomad.utils.merge(s,r,function(e,t){return _.union(e,t)});return t}return function(e){var t=a(),i=t.All,n=t[e];if(n)i=_.union(i,n);return i}}();var y=e.Bean.prototype.copy;e.Bean.prototype.copy=function(t,i,n){_.each(this._defaults,function(e,t){this.set(t,"")},this);y.call(this,t,i,n);var a=this.get("email1");var o=function(e,t){if(_.isString(t)){e.unset(t)}else{_.each(e.attributes,function(i,n){if(t.test(n))e.unset(n)})}};_.each(b(this.module),function(e){o(this,e)},this);var s=e.metadata.getModule(this.module);var r=s?s.fields:null;var l=_.chain(r).filter(function(e){return _.contains(v,e.type)}).pluck("name").value();_.each(l,function(e){this.unset(e)},this);if(a)this.set("email1",a);_.each(this.toJSON(),function(t,i){if(!e.acl.hasAccessToModel("edit",this,i)||r[i].readonly){o(this,i)}},this)};e.MixedBeanCollection.prototype.fetch=function(t){var i=e.metadata.getModuleNames({filter:"visible",access:"list"});t=t||{};t.module_list=this.module_list=t.module_list||this.module_list||i;if(t.module_list!==i){t.module_list=_.filter(t.module_list,function(e){return _.contains(i,e)})}if(!t.module_list.length)return;var n=!_.isUndefined(t.myItems)?t.myItems:this.myItems;if(n){var a=_.select(t.module_list,function(t){return e.nomad.supportsMyItems(t)});t=_.extend({},t,{module_list:a})}return e.BeanCollection.prototype.fetch.call(this,t)};e.augment("hacks",{hackModuleList:function(){var t=e.user.get("module_list"),i=e.metadata.getModules();for(var n=0;n<t.length;++n){if(!i[t[n]])t.splice(n--,1)}},hackAcls:function(){var t=e.user.getAcls(),i=t.Users;if(_.isEmpty(t)){return}i["delete"]="no";if(_.isArray(i.fields)){i.fields={}}i.fields.status={
create:"no",write:"no"};_.each(_.keys(t),function(i){if(!e.metadata.getModule(i)&&!_.contains(e.user.get("module_list"),i)){delete t[i]}});e.user.set("acl",t)}});delete e.validation.validators.datetime;delete e.validation.validators.primaryEmail;var E=$.param;$.param=function(e){if(e instanceof ArrayBuffer){return e}else return E.apply(this,arguments)};var L=$.ajax;$.ajax=function(e){if(e.files&&e.files.length>0){return w(e)}else{return L.apply($,arguments)}};function w(t){var i=t.files,n=t.files.fieldName,a=i.fileData.name||"newfile",o=i.fileData.type||"application/octet-stream",s=i.fileData.binary,r={"OAuth-Token":e.api.getOAuthToken()};function l(e){function t(e){return e.charCodeAt(0)&255}var i=Array.prototype.map.call(e,t);var n=new Uint8Array(i);return n.buffer}var c="xxxxxx",d="\r\n",u="";u+="--"+c+d;u+="Content-Disposition: form-data;";u+='name="'+n+'"; filename="'+a+'"'+d;u+="Content-Type: "+o+d+d;u+=s+d;u+="--"+c+"--";return $.ajax({complete:t.complete,error:t.error,success:t.success,type:"POST",url:t.url,data:l(u),processData:false,contentType:"multipart/form-data; boundary="+c,headers:r,dataType:"json"})}function x(e,t){_.each(t,function(t){if(t instanceof RegExp){x(e,_.filter(_.keys(e),function(e){return t.test(e)}))}else{delete e[t]}})}var S=e.metadata.sync;e.metadata.sync=function(t,i){if(e.lang.getLanguage()&&e.user.get("preferences")&&e.lang.getLanguage()!==e.user.get("preferences").language||!e.config.cacheMeta){i=i||{};i.forceRefresh=true;e.logger.debug("Forcing meta refresh as user language has changed")}S.call(this,t,i)};e.accessibility={run:function(){}};e.logger.ServerWriter.write=function(){};e.cache.clean=function(){};e.events.on("app:init",function(){var t=e.api.records;e.api.records=function(i,n,a,o,s,r){var l;r=r||{};if(o.recents){delete o.recents;n="recent";if(s.success){l=s.success;s.success=function(e){e.next_offset=-1;l.apply(this,arguments)}}}return t.apply(e.api,arguments)};function i(){var t=0;var i=false;$(window.document).on({ajaxSuccess:function n(a,o,s){var r,l,c;if(i||s.type.toUpperCase()!=="GET"){return}r=o.getResponseHeader("cache-control")||"";l=/max-age=(\d+)/i.exec(r)||[];l=+l[1]||0;if(l>e.config.maxHttpCacheAge){l=e.config.maxHttpCacheAge}c=new Date;c=c.setSeconds(c.getSeconds()+l);if(c>t){t=c}},ajaxError:function(){i=t>(new Date).getTime()},ajaxBeforeSend:function a(n,o,s){var r=(new Date).getTime();if(s.type==="GET"){if(i&&t>r){s.url+=(s.url.indexOf("?")===-1?"?":"&")+"nomad_timestamp="+r}else{i=false}}else if(s.url!==e.api.buildURL("bulk")){i=t>r}}})}i();var n=e.api.buildURL;e.api.buildURL=function(e,t,i,a){var o=n.apply(this,arguments);if(t==="favorite"||t==="unfavorite"){var s={fields:"my_favorite,following"};if(t==="favorite"){s.viewed=1}o+="?"+$.param(s)}return o}})})(SUGAR.App)},function(e,t){(function(e){e.baseMetadata={_hash:"_base_",modules:{Dashboards:{_hash:"DashboardsHash",fields:{_hash:"DashboardsFieldsHash",id:{name:"id",type:"id"},name:{name:"name",type:"varchar",unified_search:true},dashboard_type:{name:"dashboard_type",type:"varchar"},date_modified:{name:"date_modified",type:"datetime"},url:{name:"url",type:"varchar"},metadata:{name:"metadata",type:"metadata"}},layouts:{detail:{meta:{components:[{view:"dashboard"}]}}},views:{detail:{meta:{panels:[{fields:[]}]}}}},Comments:{_hash:"CommentsHash",layouts:{},fields:{name:{name:"name",type:"varchar"},date_entered:{name:"date_entered",type:"datetime"},date_modified:{name:"date_modified",type:"datetime"},created_by:{name:"created_by",type:"id"},created_by_name:{name:"created_by_name",type:"relate",link:"created_by_link"},activities:{name:"activities",type:"link",relationship:"comments",module:"Activities"},parent_id:{name:"parent_id",type:"id"},data:{name:"data",type:"json"},_hash:"CommentsFieldsHash"}},Activities:{_hash:"ActivitiesHash",layouts:{},fields:{_hash:"ActivitiesFieldsHash",name:{name:"name",type:"varchar"},date_entered:{name:"date_entered",type:"datetime"},date_modified:{name:"date_modified",type:"datetime"},parent_id:{name:"parent_id",type:"id"},parent_type:{name:"parent_type",type:"varchar"},activity_type:{name:"activity_type",type:"varchar"},data:{name:"data",type:"json"},comment_count:{name:"comment_count",type:"int"},last_comment:{name:"last_comment",type:"json"},created_by:{name:"created_by",type:"id"},comments:{module:"Comments",name:"comments",relationship:"comments",type:"link"}},mergedFields:[],filters:{_hash:"ActivitiesFiltersHash",activity:{meta:{create:false,default_filter:"all_records",quicksearch_field:[],quicksearch_priority:2,filters:[{id:"all_records",name:"LBL_LISTVIEW_FILTER_ALL",filter_definition:[],editable:false},{id:"messages_for_create",name:"LBL_ACTIVITY_CREATE",filter_definition:{$or:[{activity_type:"create"},{activity_type:"attach"}]},editable:false},{id:"messages_for_update",name:"LBL_ACTIVITY_UPDATE",filter_definition:{activity_type:"update"},editable:false},{id:"messages_for_link",name:"LBL_ACTIVITY_LINK",filter_definition:{activity_type:"link"},editable:false},{id:"messages_for_unlink",name:"LBL_ACTIVITY_UNLINK",filter_definition:{activity_type:"unlink"},editable:false},{id:"messages_for_post",name:"LBL_ACTIVITY_POST",filter_definition:{activity_type:"post"},editable:false}]}}},views:{list:{meta:{panels:[{fields:[]}]}},"activitystream-dashlet":{meta:{panels:[{fields:[]}],view:{auto_refresh:0,currentFilterId:"all_records",module:"Activities",type:"activitystream-dashlet"}}}}},Filters:{_hash:"FiltersHash",fields:{_hash:"FiltersFieldsHash"},layouts:{}},Teams:{_hash:"TeamsHash",favoritesEnabled:false,ftsEnabled:false,mergedFields:["id","name","name_2"],fields:{_hash:"TeamsFieldsHash",id:{name:"id",type:"id"},name:{name:"name",type:"varchar",unified_search:true},name_2:{name:"name_2",type:"varchar",unified_search:true},primary:{name:"primary",type:"boolean"}},views:{list:{meta:{panels:[{fields:[{name:"name",type:"text"},{name:"name_2",type:"varchar"}]}]}}},layouts:{list:{meta:{type:"list",components:[{view:"list"}]}}}},Login:{_hash:"LoginHash",fields:{_hash:"LoginFieldsHash",username:{name:"username",type:"username",required:true},password:{name:"password",type:"password",required:true},url:{name:"url",type:"url",required:true}},views:{login:{meta:{panels:[{label:"Login",fields:[{name:"username",label:"Username"},{name:"password",label:"Password"},{name:"url",label:"URL"}]}]}}},layouts:{login:{meta:{type:"login",components:[{view:"login"}]}}}},About:{_hash:"AboutHash",fields:{_hash:"AboutFieldsHash",app_version:{name:"app_version",type:"varchar"},server_version:{name:"server_version",type:"varchar"},server_url:{name:"server_url",type:"url"},support_email:{name:"support_email",type:"url"},support_website:{name:"support_website",type:"url"}},views:{about:{meta:{panels:[{label:"LNK_ABOUT",fields:[{name:"app_version",label:"LBL_MOBILE_APP_VERSION",view:"readonly"},{name:"server_version",label:"LBL_MOBILE_SERVER_VERSION",view:"readonly"},{name:"server_url",label:"LBL_MOBILE_SERVER_URL",css_class:"server_url"},{name:"support_email",label:"LBL_MOBILE_FEEDBACK",css_class:"support_email hide"},{name:"support_website",label:"LBL_MOBILE_SUPPORT",css_class:"support_website"}]}]}}},layouts:{about:{meta:{type:"about",components:[{view:"about"}]}}}},Error:{_hash:"Error",fields:{_hash:"ErrorHash",message:{name:"message",type:"varchar"}},layouts:{error:{meta:{type:"error",components:[{view:"error"}]}}},views:{error:{meta:{panels:[{fields:[]}]}}}},Settings:{_hash:"SettingsHash",fields:{_hash:"SettingsFieldsHash",language:{name:"language",type:"enum","default":"en_us"},logging:{name:"logging",type:"enum"},fontSize:{name:"fontSize",type:"enum","default":"normal"}},views:{settings:{meta:{panels:[{label:"LNK_SETTINGS",fields:[{name:"language",label:"LBL_LANGUAGE",options:"available_language_dom",view:"edit","default":"en_us"},{name:"logging",label:"LBL_LOG_LEVEL",options:["TRACE","DEBUG","INFO","WARN","ERROR","FATAL"],view:"edit"},{name:"fontSize",label:"LBL_SET_FONTSIZE",view:"edit","default":"normal"}]}]}}},layouts:{settings:{meta:{type:"settings",components:[{view:"settings"}]}}}},SetupBuddy:{_hash:"SetupBuddyHash",fields:{},views:{"setup-buddy":{meta:{panels:[{fields:[]}]}}},layouts:{setupbuddy:{meta:{type:"setup-buddy",components:[{view:"setup-buddy"}]}}}},TxLog:{_hash:"txLogHash",fields:{_hash:"TxLogFieldsHash",_tx_action:{name:"_tx_action"},_tx_bean_module:{name:"_tx_bean_module"},_tx_updated_fields:{name:"_tx_updated_fields"},_tx_error_count:{name:"_tx_error_count"}},views:{list:{meta:{panels:[{label:"XXX",fields:[{name:"_tx_action"},{name:"_tx_bean_module"}]}]}},detail:{meta:{panels:[{label:"XXX",fields:[{name:"_tx_action"},{name:"_tx_bean_module"}]}]}}},layouts:{list:{meta:{type:"list",components:[{view:"list"}]}},detail:{meta:{type:"detail",components:[{view:"detail"}]}}}},Offline:{_hash:"OfflineHash",fields:{_hash:"OfflineFieldsHash"},views:{offline:{meta:{panels:[{label:"LNK_SETTINGS",fields:[]}]}}},layouts:{offline:{meta:{type:"offline",components:[{view:"offline"}]}},offlineSettings:{meta:{type:"offline",components:[{view:"offline-settings"}]}},offlineStats:{meta:{type:"offline",components:[{view:"offline-stats"}]}}}},Recents:{_hash:"RecentsHash",fields:{_hash:"RecentsFieldsHash"},views:{},layouts:{}},Search:{_hash:"SearchHash",fields:{_hash:"SearchFieldsHash",assigned_user_id:{name:"assigned_user_id"}},views:{list:{meta:{panels:[{fields:[]}]}}},layouts:{list:{meta:{type:"list"}}},favoritesEnabled:true},ErrorEmulation:{_hash:"ErrorEmulationHash",fields:{_hash:"ErrorEmulationHash",language:{name:"language",type:"enum","default":"en_us"}},views:{errors:{meta:{panels:[{label:"LNK_SETTINGS",fields:[]}]}}},layouts:{erroremulation:{meta:{type:"errors",components:[{view:"error-emulation"}]}}}},ProductTypes:{_hash:"ProductTypesHash",fields:{_hash:"ProductTypesFieldsHash",id:{name:"id",type:"id"},name:{name:"name",type:"varchar",vname:"LBL_NAME"}},views:{list:{meta:{panels:[{fields:[{name:"name"}]}]}}},layouts:{list:{meta:{type:"list",components:[{view:"list"}]}}},mergedFields:["name"],ftsEnabled:false,favoritesEnabled:false,_patched:true},ProductCategories:{_hash:"ProductCategoriesHash",fields:{_hash:"ProductCategoriesFieldsHash",id:{name:"id",vname:"LBL_ID",type:"id",required:true},name:{name:"name",vname:"LBL_NAME",type:"varchar",len:50,required:true},parent_id:{name:"parent_id",type:"id",vname:"LBL_PARENT_NAME"},parent_name:{id_name:"parent_id",link:"member_categories",module:"ProductCategories",name:"parent_name",source:"non-db",type:"relate",unified_search:true,vname:"LBL_PARENT_CATEGORY"}},views:{list:{meta:{panels:[{fields:[{name:"name"},{name:"parent_name"}]}]}}},layouts:{list:{meta:{type:"list",components:[{view:"list"}]}}},mergedFields:["name","parent_name","parent_id"],ftsEnabled:false,favoritesEnabled:false,_patched:true},ProductTemplates:{_hash:"ProductTemplatesHash",fields:{_hash:"ProductTemplatesFieldsHash",id:{name:"id",vname:"LBL_ID",type:"id",required:true},deleted:{name:"deleted",vname:"LBL_DELETED",type:"bool",required:false,"default":"0"},date_entered:{name:"date_entered",vname:"LBL_DATE_ENTERED",type:"datetime"},date_modified:{name:"date_modified",vname:"LBL_DATE_MODIFIED",type:"datetime"},modified_user_id:{name:"modified_user_id",rname:"user_name",id_name:"modified_user_id",vname:"LBL_MODIFIED_ID",type:"assigned_user_name"},created_by:{name:"created_by",rname:"user_name",id_name:"modified_user_id",vname:"LBL_CREATED_ID",type:"assigned_user_name"},type_id:{name:"type_id",type:"id",required:false,vname:"LBL_TYPE_ID"},manufacturer_id:{name:"manufacturer_id",type:"id",required:false,vname:"LBL_LIST_MANUFACTURER_ID"},manufacturer_name:{name:"manufacturer_name",rname:"name",id_name:"manufacturer_id",type:"relate",vname:"LBL_MANUFACTURER_NAME",join_name:"manufacturers",link:"manufacturer_link",module:"Manufacturers"},category_id:{name:"category_id",type:"id",required:false,vname:"LBL_LIST_CATEGORY_ID"},category_name:{name:"category_name",rname:"name",id_name:"category_id",vname:"LBL_CATEGORY_NAME",join_name:"product_categories",type:"relate",link:"category_link",module:"ProductCategories",source:"non-db"},type_name:{name:"type_name",rname:"name",id_name:"type_id",vname:"LBL_TYPE",join_name:"product_types",type:"relate",link:"type_link",module:"ProductTypes",source:"non-db"},name:{name:"name",vname:"LBL_NAME",type:"varchar",len:50,required:true},mft_part_num:{name:"mft_part_num",vname:"LBL_MFT_PART_NUM",type:"varchar",len:50},vendor_part_num:{name:"vendor_part_num",vname:"LBL_VENDOR_PART_NUM",type:"varchar",len:50},date_cost_price:{name:"date_cost_price",vname:"LBL_DATE_COST_PRICE",type:"date"},cost_price:{name:"cost_price",vname:"LBL_COST_PRICE",type:"currency",required:true,len:null},discount_price:{name:"discount_price",vname:"LBL_DISCOUNT_PRICE",required:true,type:"currency",len:null},list_price:{name:"list_price",vname:"LBL_LIST_PRICE",required:true,type:"currency",len:null},cost_usdollar:{name:"cost_usdollar",vname:"LBL_COST_USDOLLAR",type:"currency",len:null},discount_usdollar:{name:"discount_usdollar",vname:"LBL_DISCOUNT_USDOLLAR",type:"currency",len:null},list_usdollar:{name:"list_usdollar",vname:"LBL_LIST_USDOLLAR",type:"currency",len:null},currency_id:{name:"currency_id",vname:"LBL_CURRENCY",type:"currency_id",required:false,"default":"-99"},currency_symbol:{name:"currency_symbol",type:"varchar",vname:"LBL_CURRENCY_SYMBOL_NAME",source:"non-db"},currency:{name:"currency",vname:"LBL_CURRENCY",type:"varchar",required:false,sortable:false},status:{name:"status",vname:"LBL_STATUS",type:"enum",options:"product_template_status_dom",len:100},tax_class:{name:"tax_class",vname:"LBL_TAX_CLASS",type:"enum",options:"tax_class_dom",len:100},date_available:{name:"date_available",vname:"LBL_DATE_AVAILABLE",type:"date"},website:{name:"website",vname:"LBL_URL",type:"varchar",len:255},weight:{name:"weight",vname:"LBL_WEIGHT",type:"decimal",len:12,precision:"2"},qty_in_stock:{name:"qty_in_stock",vname:"LBL_QUANTITY",type:"int",len:5},description:{name:"description",vname:"LBL_DESCRIPTION",type:"text"},support_name:{name:"support_name",vname:"LBL_SUPPORT_NAME",type:"varchar",len:50},support_description:{name:"support_description",vname:"LBL_SUPPORT_DESCRIPTION",type:"varchar",len:255},support_contact:{name:"support_contact",vname:"LBL_SUPPORT_CONTACT",type:"varchar",len:50},support_term:{name:"support_term",vname:"LBL_SUPPORT_TERM",type:"enum",options:"support_term_dom",len:100},pricing_formula:{name:"pricing_formula",vname:"LBL_PRICING_FORMULA",type:"varchar",len:100},pricing_factor:{name:"pricing_factor",vname:"LBL_PRICING_FACTOR",type:"decimal",len:8,precision:"2"},created_by_link:{name:"created_by_link",type:"link",relationship:"product_templates_created_by",vname:"LBL_CREATED_BY_USER",link_type:"one",module:"Users",source:"non-db"},modified_user_link:{name:"modified_user_link",type:"link",relationship:"product_templates_modified_user",vname:"LBL_MODIFIED_BY_USER",link_type:"one",module:"Users",source:"non-db"},category_link:{name:"category_link",type:"link",relationship:"product_templates_product_categories",vname:"LBL_PRODUCT_CATEGORIES",link_type:"one",module:"ProductCategories",source:"non-db"},type_link:{name:"type_link",type:"link",relationship:"product_templates_product_types",vname:"LBL_PRODUCT_TYPES",link_type:"one",module:"ProductTypes",source:"non-db"},manufacturer_link:{name:"manufacturer_link",type:"link",relationship:"product_templates_manufacturers",vname:"LBL_MANUFACTURERS",link_type:"one",module:"Manufacturers",source:"non-db"}},views:{list:{meta:{panels:[{fields:[{name:"name",label:"LBL_NAME"},{name:"category_name",label:"LBL_CATEGORY_NAME"}]}]}}},layouts:{list:{meta:{type:"list",components:[{view:"list"}]}}},mergedFields:["currency_id","category_id","category_name","cost_price","cost_usdollar","discount_price,","discount_usdollar","list_price","list_usdollar","mft_part_num","name","tax_class","weight"],ftsEnabled:false,favoritesEnabled:false,_patched:true},Forecasts:{_hash:"ForecastsHash",config:{sales_stage_won:["Closed Won"],sales_stage_lost:["Closed Lost"]}},Manufacturers:{_hash:"ManufacturersHash",fields:{_hash:"ManufacturersFieldsHash",id:{name:"id",type:"id"},name:{name:"name",type:"name",unified_search:true}},views:{list:{meta:{panels:[{fields:[{name:"name",label:"LBL_NAME","default":true,enabled:true,type:"name"}]}]}}},layouts:{list:{meta:{type:"list",components:[{view:"list"}]}}},mergedFields:["name"],ftsEnabled:false,favoritesEnabled:false},Twitter:{_hash:"TwitterHash",layouts:{},fields:{_hash:"TwitterFieldsHash"},mergedFields:[],views:{twitter:{meta:{panels:[{fields:[]}],view:{auto_refresh:0,currentFilterId:"all_records",module:"Twitter",type:"twitter"}}}}},Home:{_hash:"HomeHash",layouts:{},fields:{_hash:"HomeFieldsHash"},mergedFields:[],views:{casessummary:{meta:{dashlets:[{description:"LBL_CASE_SUMMARY_CHART_DESC",label:"LBL_CASE_SUMMARY_CHART"}],tabs:[{filters:{status:{$in:["New"]}},status:"New",link:"cases",module:"Cases"},{filters:{status:{$in:["Pending Input"]}},status:"Pending Input",link:"cases",module:"Cases",favoritesEnabled:false,ftsEnabled:false},{filters:{status:{$in:["Assigned"]}},status:"Assigned",link:"cases",module:"Cases",favoritesEnabled:false,ftsEnabled:false}]}}}}},views:{"activitystream-dashlet":{meta:{}},twitter:{meta:{}}},relationships:{comments:{lhs_key:"id",lhs_module:"Activities",lhs_table:"activities",name:"comments",relationship_type:"one-to-many",rhs_key:"parent_id",rhs_module:"Comments",rhs_table:"comments"},product_templates_product_types:{lhs_key:"id",lhs_module:"ProductTypes",lhs_table:"product_types",name:"product_templates_product_types",relationship_type:"one-to-many",rhs_key:"type_id",rhs_module:"ProductTemplates",rhs_table:"product_templates"},product_templates_product_categories:{lhs_key:"id",lhs_module:"ProductCategories",lhs_table:"product_categories",name:"product_templates_product_categories",relationship_type:"one-to-many",rhs_key:"category_id",rhs_module:"ProductTemplates",rhs_table:"product_templates"}},app_strings:{LBL_TRY_AGAIN:"Try again",LBL_NEW_RECORDS:"Recently Created",LBL_ASSIGNED_TO_ME:"My {{module}}",LBL_LISTVIEW_FILTER_ALL:"All {{module}}",LBL_UNFAVORITE:"Unfavorite",LBL_ACTIVITY_CREATE:"Created {{{record}}} {{{module}}}",LBL_ACTIVITY_UPDATE:"Updated {{{changes}}} on {{{record}}} {{{module}}}",LBL_ACTIVITY_LINK:"Linked {{{relatedRecord}}} to {{{record}}} {{{module}}}",LBL_ACTIVITY_UNLINK:"Unlinked {{{relatedRecord}}} from {{{record}}} {{{module}}}",LBL_OFFLINE_PREFETCHING_RELATIONSHIP:"{{relationship}} for {{parentModule}}",LBL_OFFLINE_PREFETCH_RELATED_ACTION:"Download related records...",ERR_OFFLINE_NO_CONNECTION_ENABLE_ERROR:"Failed to enable offline mode. Unable to reach the server.",LBL_SHOWING_CACHED_DATA:"Unable to reach the server. Showing latest available data ({{lastFetched}})",LBL_FUTURE:"Future",LBL_CLOSE_AND_SAVE_BUTTON:"Close {{moduleSingular}} and save",LBL_DASHBOARDS_CHANGED_PROMPT:"Your dashboard configuration has changed. Do you want to reload?",LBL_RECORDS:"Records",LBL_DASHBOARDS:"Dashboards",LBL_MOBILE_SEARCH_PLACEHOLDER:"Search {{searchCriteria}}...",LBL_MOBILE_SPECIFIC_DASHBOARD:"Specific Dashboard",LBL_MOBILE_SPECIFIC_MODULE:"Specific Module",LBL_MOBILE_DEFAULT_VIEW:"Start Screen",LBL_MOBILE_DEFAULT_MODULE:"Selected Module",LBL_MOBILE_DEFAULT_DASHBOARD:"Selected Dashboard",LBL_MOBILE_DEFAULT_DASHLET:"Selected Dashlet",LBL_ALL_DASHLETS:"All Dashlets",LBL_MOBILE_GLOBAL_SEARCH:"Global Search",LBL_MOBILE_ACTIVITYSTREAM_POST_PLACEHOLDER:"Type @ to mention a user. Type # to reference a record.",LBL_MOBILE_NEW_COMMENT:"New comment",LBL_MOBILE_TUTORIAL_HOME_MENU:"Main menu",LBL_MOBILE_TUTORIAL_HOME_PLUS:"Quick create new record",LBL_MOBILE_TUTORIAL_HOME_SWIPE:"Swipe for more options",LBL_DETAIL_RELATED:"Related",LBL_RECORD_SHARE_BUTTON:"Share",LBL_RECORD_NOT_FOUND:"Record not found.",LBL_RELATED_RECORD_NOT_FOUND:"Related record not found.",LBL_NOT_AUTHORIZED:"You are not authorized to view this record.",LBL_SET_FONTSIZE:"Font size",LBL_FONTSIZE_TINY:"Tiny",LBL_FONTSIZE_SMALL:"Small",LBL_FONTSIZE_NORMAL:"Normal (default)",LBL_FONTSIZE_LARGE:"Large",LBL_FONTSIZE_LARGER:"Larger",LBL_FONTSIZE_HUGE:"Huge",LBL_FONTSIZE_EXTRA_HUGE:"Extra huge",LBL_CLOSE_SAVE_BUTTON:"Close task and save",LBL_MOBILE_PROCESSING_FILE:"Preparing file...",ERR_MOBILE_FILE_SIZE_LIMIT_EXCEEDED:"File is too big. Maximum allowed size is {{size}}",LBL_MOBILE_TUTORIAL_DETAIL_EDIT_ACTION:"Edit record",LBL_LATER:"Later",LBL_LOADING_FILES:"Still loading document list. Please try again later",LBL_NEW_WEB_VERSION:"A new version of this application is available. Would you like to update?",LBL_MOBILE_DOWNLOAD_FAILED:"Download failed\r\n{{{this}}}",LBL_MOBILE_DETAIL_SHOW_MORE:"More...",LBL_MOBILE_DETAIL_SHOW_LESS:"...Less",LBL_OFFLINE_MODE:"Offline Mode",LBL_OFFLINE_PREFETCH_PROMPT:"Downloading your assigned, favorited, and followed records for offline access may take some time to complete. A fast connection is recommended. Would you like to proceed?",LBL_OFFLINE_PREFETCH_FIRST_PROMPT:"Do you want your assigned, favorited, and followed records to be downloaded now for offline access? A fast connection is recommended as this operation may take some time. You may download later from Main Menu > Offline.",LBL_OFFLINE_PREFETCH_SUCCESS:"Records downloaded successfully",LBL_OFFLINE_PREFETCH_ACTION:"Download your records...",LBL_OFFLINE_PREFETCH_ERROR:"Error while downloading records",LBL_OFFLINE_PREFETCHING:"Loading records...",LBL_OFFLINE_PREFETCHING_MODULE:"Loading {{module}} {{progressValue}}...",LBL_OFFLINE_PREFETCHING_EST_TIME:"Time left is about {{estimatedTime}}s...",LBL_OFFLINE_PREFETCHING_MODULE_COMPLETE:"Loading {{module}} completed",LBL_OFFLINE_DB_CLEANING_IN_PROGRESS:"Cleaning storage...",LBL_OFFLINE_DB_CLEANING_COMPLETED:"Clean-up completed",LBL_OFFLINE_ROLLBACK_PROMPT:"Do you want to rollback this change?",LBL_OFFLINE_ROLLBACK_SUCCESS:"Rollback completed",LBL_OFFLINE_ROLLBACK_FAILED:"Rollback failed",LBL_OFFLINE_CLEAR_DB:"Clear Storage...",LBL_OFFLINE_COMPACT_DB:"Compact Storage...",LBL_OFFLINE_CLEAN_UP_PROMPT:"This action will delete records you haven't accessed in a while. Proceed?",LBL_OFFLINE_CLEAR_DB_PROMPT:"Do you want to delete all records from the local storage?",LNK_OFFLINE_SETTINGS:"Offline",LBL_OFFLINE_SETTINGS:"Debug settings",LBL_OFFLINE_STATUS_NO_PENDING_TX:"No changes pending synchronization.",LBL_OFFLINE_STATUS_PENDING_TX:"Changes are pending synchronization.",LBL_OFFLINE_STATUS_ONLINE:"Device is online.",LBL_OFFLINE_STATUS_OFFLINE:"Device is offline.",LBL_OFFLINE_STATUS_BAD_NETWORK:"Unable to reach the server.",LBL_OFFLINE_STATUS_SYNC_FAILED:"Last synchronization attempt failed. Check the transaction log.",LBL_OFFLINE_SYNC_IN_PROGRESS:"Synchronization in progress...",LBL_OFFLINE_TRANSACTION_SYNCED:"Transaction synchronized.",LBL_OFFLINE_ENABLE_PROMPT:"Are you sure you want to turn on offline support?",LBL_OFFLINE_DISABLE_PROMPT:"Do you want to turn off offline support? All changes pending synchronization will be lost.",LBL_OFFLINE_ENABLED:"Offline mode enabled",LBL_OFFLINE_DISABLED:"Offline mode disabled",LBL_OFFLINE_STATS:"Storage statistics",LBL_OFFLINE_SERVER_FETCH:"Fetching from server...",LBL_OFFLINE_MERGE_DATA_CONFIRM:"Someone has edited the same record on the server. Confirm to auto-merge your changes or reject to discard them.",LBL_OFFLINE_LAST_SYNC_TS:"Last synchronization attempt: {{ts}}",LBL_ACTION_UPDATE:"UPDATE",LBL_ACTION_CREATE:"CREATE",LBL_ACTION_DELETE:"DELETE",LBL_ACTION_LINK:"LINK",LBL_ACTION_UNLINK:"UNLINK",LBL_ACTION_FAVORITE:"FAVORITE",LBL_ACTION_FOLLOW:"FOLLOW",LBL_ACTION_CREATE_EXPLANATION:'Created {{module}} "{{name}}"',LBL_ACTION_UPDATE_EXPLANATION:'Updated {{module}} "{{name}}"',LBL_ACTION_DELETE_EXPLANATION:'Deleted {{module}} "{{name}}"',LBL_ACTION_LINK_EXPLANATION:'Linked {{module}} "{{name}}" to {{relatedModule}} "{{relatedName}}"',LBL_ACTION_UNLINK_EXPLANATION:'Unlinked {{module}} "{{name}}" from {{relatedModule}} "{{relatedName}}"',LBL_ACTION_FOLLOW_EXPLANATION:'Followed {{module}} "{{name}}"',LBL_ACTION_UNFOLLOW_EXPLANATION:'Unfollowed {{module}} "{{name}}"',LBL_ACTION_FAVORITE_EXPLANATION:'Favorited {{module}} "{{name}}"',LBL_ACTION_UNFAVORITE_EXPLANATION:'Unfavorited {{module}} "{{name}}"',LBL_ACTION_CREATE_RELATED_EXPLANATION:'Created {{module}} "{{name}}" related to {{relatedModule}} "{{relatedName}}"',LBL_EMAIL_ACTION_SET_PRIMARY:"Primary",LBL_EMAIL_ACTION_SET_OPT_OUT:"Opt-out",LBL_EMAIL_ACTION_SET_OPT_IN:"Opt-in",LBL_EMAIL_ACTION_SET_VALID:"Valid",LBL_EMAIL_ACTION_SET_INVALID:"Invalid",LBL_ROLLBACK_BUTTON:"Rollback",LBL_TX_LOG:"Transaction Log",LBL_TX_LOG_DETAIL:"Transaction Detail",LBL_RECORD_DELETED:"(Record deleted)",LBL_FILE_SIZE_UNITS_B:"Bytes",LBL_FILE_SIZE_UNITS_KB:"kB",LBL_FILE_SIZE_UNITS_MB:"MB",LBL_CHOOSE_ITEMS:"Choose items",LBL_OFFLINE_DB_SIZE:"Database size",LBL_OFFLINE_DATA_ENCRYPTION_ENABLED:"Data encryption is enabled.",LBL_OFFLINE_RECORDS_PER_MODULE:"Records per module",LBL_OFFLINE_TOTAL_RECORDS_COUNT:"Total number of records",LBL_RECENTLY_VIEWED:"Recently Viewed",ERR_MOBILE_METADATA_CHANGED_RELOAD:"Server configuration has changed and reload is required. Proceed?",ERR_MOBILE_CONFLICT:"Someone has edited the same record on the server. Confirm to auto-merge your changes or reject to discard them.",ERR_MOBILE_METADATA_CHANGED:"Server configuration has changed.",ERR_MOBILE_FILE_READ:"Failed to read the file",ERR_MOBILE_FILE_NOT_FOUND:"File not found",ERR_MOBILE_FILE_NOT_READABLE:"File not readable",ERR_MOBILE_FILE_ABORTED:"Read operation was aborted",ERR_MOBILE_FILE_SECURITY:"File is locked",ERR_MOBILE_VIEW_NOT_SUPPORTED:"Mobile version does not support this functionality. Do you want to open the desktop version?",ERR_OFFLINE:"Offline error",ERR_OFFLINE_STORAGE_UNAVAILABLE:"Failed to open local storage",ERR_OFFLINE_STORAGE_CREATE:"Failed to create local storage",ERR_OFFLINE_START_FAILED_OUT_OF_SPACE:"Failed to create local storage: you've run out of space.",ERR_OFFLINE_OUT_OF_SPACE:"You've run out of space for local storage.",ERR_OFFLINE_DB_CLEANING_ERROR:"Database clean-up failed",ERR_OFFLINE_CLEAN_UP_CONFIRMATION:"You've run out of space for offline storage. Storage clean-up is recommended. Do you want to perform it now?",ERR_OFFLINE_PREFETCH_FAILED:"Failed to prefetch records from server",ERR_OFFLINE_SYNC_ERROR:"Synchronization error",ERR_OFFLINE_SYNC_CONFLICT:"Synchronization conflict",ERR_OFFLINE_SERVERTIME_UNAVAILABLE:"Failed to get server time",ERR_MOBILE_DASHBOARDS_FETCHING:"Failed to load dashboards from server",ERR_FILTERS_FETCHING:"Unable to fetch your filters",ERR_OFFLINE_ENCRYPTION_FAILED:"Failed to encrypt local storage",LBL_OFFLINE_ENCRYPTION_IN_PROGRESS:"Encrypting offline data. This may take several minutes.",LBL_OFFLINE_ENCRYPTION_SUCCESS:"Offline data encryption completed.",LBL_OK:"OK",LBL_YES:"Yes",LBL_NO:"No",LBL_CANCEL_BUTTON_LABEL:"Cancel",LBL_SKIP:"Skip",LBL_MOBILE_RELOGIN_BUTTON:"Re-login",LBL_MOBILE_META_SYNC_FAILED:"Unable to sync with server.",LBL_MOBILE_META_SYNC_FAILED_RETRY:"Unable to sync with server. Retry?",LBL_LOADING:"Loading...",LBL_WARNING:"Warning",LBL_CONFIRM:"Confirm",LBL_ENABLE:"Enable",LNK_ABOUT:"About",LBL_MOBILE_APP_VERSION:"App Version",LBL_MOBILE_SERVER_VERSION:"Server Version",LBL_MOBILE_SERVER_URL:"Server URL",LBL_MOBILE_FEEDBACK:"Feedback",LBL_MOBILE_SUPPORT:"Support",LBL_COPYRIGHT:"Copyright © 2004-2016 SugarCRM Inc. All Rights Reserved.",LBL_TRADEMARK:"SugarCRM is a trademark of SugarCRM, Inc. All other company and product names may be trademarks of the respective companies with which they are associated.",LBL_TRADEMARK2:"SugarCRM ®, Sugar Enterprise™ and Sugar™ are trademarks of SugarCRM Inc.",LBL_LOGIN_USERNAME:"Username",LBL_LOGIN_PASSWORD:"Password",LNK_TERMS_OF_USE:"Terms of Use",LNK_PRIVACY_POLICY:"Privacy Policy",LNK_THIRD_PARTY_SOFTWARE:"Third Party Software",LBL_LOGIN_BUTTON_TITLE:"Log In",LBL_EXTERNAL_LOGIN_BUTTON_TITLE:"Single Sign-On",LBL_LOG_LEVEL:"Log Level",LBL_NOT_AVAILABLE:"N/A",LBL_USE_HTTPS:"Use secure connection",LBL_TOUCHID:"Touch ID",LBL_ENABLE_TOUCHID:"Enable Touch ID",LBL_SETUP_TOUCHID:"Setup Touch ID",LBL_TOUCH_ID_AUTHENTICATE_SUBTITLE:"Sign in using your finger",LBL_TOUCH_ID_NOT_ENROLLED_MSG:"Oops. Touch ID is not yet set up on your device. \n\nGo to your device settings to set up Touch ID. Once set up, enable Touch ID for {{{brandName}}} in Main Menu > Settings.",LBL_TOUCH_ID_DISCLAIMER:"Using Touch ID with {{{brandName}}} will allow you to use your fingerprint instead of entering your username and password to access {{{brandName}}}. \n\nAnyone with a fingerprint registered on your device can access your data. ",LBL_TOUCH_ID_ENABLE_CONFIRM_MSG:"Would you like to proceed with Touch ID?",LBL_TOUCH_ID_ENTER_PASSWORD_TITLE:"Enter {{{brandName}}} Password to Enable Touch ID",LBL_SETUPBUDDY_HEADER_TITLE:"Setup",LBL_SETUPBUDDY_TOUCH_ID_ADDITIONAL_DISCLAIMER:"Turn off Touch ID at any time in Main Menu > Settings.",ERR_SYNC_FAILED:"Unable to sync with server.",ERR_INTERNAL_ERR_MSG:"Internal error",ERR_MOBILE_NOT_AUTHORIZED:"Access not authorized.",ERR_MOBILE_INVALID_CREDS:"Invalid username or password.",ERR_MOBILE_INVALID_PASSWORD:"Invalid password.",ERR_MOBILE_SESSION_EXPIRED:"Your session expired.",ERR_MOBILE_SSO_NOT_CONFIGURED:"SSO login is unavailable. Ensure the instance is on Sugar 7.5 or greater and configured for SSO.",ERR_MOBILE_NOT_FOUND:"Resource not found.",ERR_MOBILE_TIMEOUT:"Server is not responding.",ERR_MOBILE_CONNECTION_FAILED:"Can't reach the server.",ERR_MOBILE_NOT_FOUND_LOGIN:"No {{{brandName}}} server found at the given URL.",ERR_MOBILE_TIMEOUT_LOGIN:"Server is not responding at the given URL.",ERR_MOBILE_CONNECTION_FAILED_LOGIN:"Server unavailable at the given URL.",ERR_MOBILE_INTERNET_UNAVAILABLE:"Internet connection unavailable.",ERR_MOBILE_INTERNAL:"Internal error ({{{code}}}). Please try again later.",ERR_MOBILE_VALIDATION:"Record is invalid",ERR_SERVER_FLAVOR_INCOMPATIBLE:"Incompatible server flavor: {{{flavor}}}. Supported flavors: {{{supportedFlavors}}}.",ERR_SERVER_VERSION_INCOMPATIBLE:"Incompatible server version: {{{version}}}. Minimum required version: {{{minVersion}}}.",ERR_MOBILE_INCOMPATIBLE_REBRAND_CLIENT_VERSION:"Your app is outdated and is no longer compatible with the {{{brandName}}} instance you are connecting to.",ERR_MOBILE_INCOMPATIBLE_CLIENT_VERSION:"Your app is outdated and is no longer compatible with the {{{brandName}}} instance you are connecting to. Do you want to download the new version from App Store?",ERR_GENERIC_TITLE:"Error",LBL_MOBILE_BY:"By",LBL_MOBILE_FILTER_IS_NOT_AVAILABLE:"This filter is not available in offline"}};e._mod_strings=["LBL_MODULE_NAME","LBL_MODULE_NAME_SINGULAR","LBL_RELATED_RECORD_DEFAULT_NAME","LBL_RELATED_MODULE","LBL_CREATE_RELATED","LBL_CREATE_MODULE","LBL_RELATED_MODULE","LBL_EDIT_RELATED","LBL_EDIT","LBL_ASSOC_EXISTING","LBL_ASSOC","LBL_ASSIGN","LBL_RELATED_MODULE_PLURAL","LBL_DASHLET_FORECAST_NOT_SETUP","LBL_DASHLET_FORECAST_NOT_SETUP_ADMIN","LBL_DASHLET_FORECAST_CONFIG_LINK_TEXT","LBL_FORECASTS_MISSING_SALES_STAGE_VALUES","LBL_CLOSED","LBL_FORECAST_DETAILS_SURPLUS","LBL_FORECAST_DETAILS_EXCEED","LBL_FORECAST_DETAILS_DEFICIT","LBL_FORECAST_DETAILS_SHORT","LBL_FORECAST_DETAILS_NO_DATA","LBL_FORECAST_DETAILS_MEETING_QUOTA","LBL_SALES_STAGE","LBL_AMOUNT","LBL_PERCENT","LBL_CUMULATIVE_TOTAL","LBL_OW_PROBABILITY","LBL_QUOTA","LBL_QUOTA_ADJUSTED","LBL_DASHLET_TOP10_SALES_OPPORTUNITIES_NAME","LBL_NEW_RECORDS","LBL_ASSIGNED_TO_ME","LBL_LISTVIEW_FILTER_ALL","LBL_MY_SCHEDULED_ITEMS","LBL_MY_SCHEDULED_CALLS","LBL_MY_SCHEDULED_MEETINGS"];e._app_list_strings=["record_type_display","moduleIconList","moduleList","moduleListSingular","available_language_dom","forecasts_options_dataset","forecasts_chart_options_group","top10_opportunities_duration_options","history_filter_options","generic_timeperiod_options","opportunity_metrics_dom"];e._app_strings=_.keys(e.baseMetadata.app_strings).concat(["LBL_TRY_AGAIN","LBL_FAVORITES_FILTER","LBL_ACTIVITY_STREAM","LBL_RECORD_NOT_FOUND","LBL_RELATED_RECORD_NOT_FOUND","LBL_NOT_AUTHORIZED","LBL_SET_FONTSIZE","LBL_LATER","LBL_ACTION_UPDATE","LBL_ACTION_CREATE","LBL_ACTION_DELETE","LBL_ACTION_LINK","LBL_ACTION_UNLINK","LBL_ACTION_FAVORITE","LBL_ACTION_FOLLOW","LBL_ROLLBACK_BUTTON","LBL_UNLINKING","LBL_DELETING","LBL_SAVING","LBL_UNLINKED","LBL_DELETED","LBL_SAVED","LBL_MOBILE_CHOOSE_RECIPIENT","LBL_MOBILE_CHOOSE_PHONE","LBL_MOBILE_CHOOSE_URL","LBL_MOBILE_DOC","LBL_MOBILE_CHOOSE_DOC","LBL_MOBILE_CHOOSE_LOCATION","LBL_MOBILE_WAIT","LBL_MOBILE_LOG_CALL_CONFIRM","LBL_MOBILE_TUTORIAL_HOME_MENU","LBL_MOBILE_TUTORIAL_HOME_PLUS","LBL_MOBILE_TUTORIAL_DETAIL_EDIT_ACTION","LBL_MOBILE_TUTORIAL_HOME_SWIPE","LBL_MOBILE_DOWNLOAD_STARTED","LBL_MOBILE_DOWNLOAD_COMPLETED","LBL_UPCOMING","LBL_MOBILE_NO_RECORDS","LBL_RECENTLY_UPDATED","LBL_RECENTLY_VIEWED","LBL_MOBILE_NO_ACTIONS_AVAILABLE","LBL_DELETE_BUTTON","LBL_SAVE_BUTTON_LABEL","LBL_HOME","LBL_ENABLE","LBL_SKIP","LBL_MOBILE_DESKTOP","LBL_LOGOUT","LBL_RECORDS","LBL_MOBILE_SEARCH_PLACEHOLDER","LBL_DONE_BUTTON_LABEL","LBL_OPTIONAL","LBL_CHOOSE_LINK","LBL_NO_ACCESS","LBL_NO_ACCESS_LOWER","LBL_CHOOSE_PARENT_TYPE","LBL_RELATED_MODULE","LBL_MOBILE_UPLOAD_IN_PROGRESS","LBL_MOBILE_UPLOAD_SUCCESS","LBL_MOBILE_PROCESSING_IMAGE","LBL_MOBILE_PROCESSING_FILE","LBL_MOBILE_DELETE_CONFIRM","LBL_DUPLICATE_BUTTON","LBL_CREATE_RELATED_RECORD","LBL_ASSOC_RELATED_RECORD","LBL_MOBILE_SELECT_TEAMS","LBL_CHOOSE_ITEMS","LBL_VIEW_BUTTON","LBL_EDIT_BUTTON","LBL_UNLINK_BUTTON","LBL_CALL_BUTTON","LBL_SMS_BUTTON","LBL_EMAIL_BUTTON","LBL_MAP_BUTTON","LBL_URL_BUTTON","LBL_FILE_BUTTON","LBL_FOLLOW","LBL_UNFOLLOW","LBL_FAVORITE","LBL_UNFAVORITE","LBL_FOLLOWING","LBL_MOBILE_SHOW_MORE_TOP","LBL_MOBILE_SHOW_MORE","LBL_MOBILE_DETAIL_SHOW_MORE","LBL_MOBILE_DETAIL_SHOW_LESS","LBL_MOBILE_PTR_RELEASE","LBL_LOADING_FILES","LBL_MOBILE_UNLINK_CONFIRM","LBL_INVITEES","LBL_SEND_INVITE","LBL_SELECT_ACTION_LABEL","LNK_SETTINGS","LBL_LANGUAGE","LBL_NAME","LBL_NONE","LBL_TIME_RELATIVE","LBL_TIME_AGO_NOW","LBL_TIME_AGO_SECONDS","LBL_TIME_AGO_MINUTE","LBL_TIME_AGO_MINUTES","LBL_TIME_AGO_HOUR","LBL_TIME_AGO_HOURS","LBL_TIME_AGO_DAY","LBL_TIME_AGO_DAYS","LBL_TIME_AGO_YEAR","LBL_TIME_UNTIL_SECONDS","LBL_TIME_UNTIL_MINUTE","LBL_TIME_UNTIL_MINUTES","LBL_TIME_UNTIL_HOUR","LBL_TIME_UNTIL_HOURS","LBL_TIME_UNTIL_DAY","LBL_TIME_UNTIL_DAYS","LBL_TIME_UNTIL_YEAR","LBL_NOT_AVAILABLE","LBL_FILE_SIZE_UNITS_B","LBL_FILE_SIZE_UNITS_KB","LBL_FILE_SIZE_UNITS_MB","LBL_USE_HTTPS","LBL_TOUCHID","LBL_ENABLE_TOUCHID","LBL_SETUP_TOUCHID","LBL_TOUCH_ID_AUTHENTICATE_SUBTITLE","LBL_TOUCH_ID_NOT_ENROLLED_MSG","LBL_TOUCH_ID_DISCLAIMER","LBL_TOUCH_ID_ENABLE_CONFIRM_MSG","LBL_TOUCH_ID_ENTER_PASSWORD_TITLE","LBL_SETUPBUDDY_HEADER_TITLE","LBL_SETUPBUDDY_TOUCH_ID_ADDITIONAL_DISCLAIMER","LBL_REMOVE","LBL_TODAY","LBL_FUTURE","LBL_CLOSE_BUTTON_TITLE","LBL_CLOSE_AND_SAVE_BUTTON","LBL_MOBILE_SPECIFIC_DASHBOARD","LBL_MOBILE_SPECIFIC_MODULE","LBL_MOBILE_DEFAULT_VIEW","LBL_MOBILE_DEFAULT_MODULE","LBL_MOBILE_DEFAULT_DASHBOARD","LBL_MOBILE_DEFAULT_DASHLET","LBL_MOBILE_GLOBAL_SEARCH","LBL_DASHBOARDS_CHANGED_PROMPT","LBL_DEFAULT_HELP_DASHBOARD_TITLE","LBL_DEFAULT_HELP_DASHLET_TITLE","LBL_LEARNING_RESOURCES_NAME","LBL_DASHLET_RECENT_TWEETS_SUGARCRM_NAME","TPL_DASHLET_MY_MODULE","LBL_DEFAULT_DASHBOARD_TITLE","LBL_ACTIVE_TASKS_DASHLET_DUE_NOW","LBL_ACTIVE_TASKS_DASHLET_UPCOMING","LBL_ACTIVE_TASKS_DASHLET_TODO","LBL_COMMENT","LBL_ACTIVITY_CREATE","LBL_ACTIVITY_UPDATE","LBL_ACTIVITY_LINK","LBL_ACTIVITY_UNLINK","LBL_MOBILE_ACTIVITYSTREAM_POST_PLACEHOLDER","LBL_SUBMIT_BUTTON_LABEL","LBL_SHOWING_CACHED_DATA","LBL_DASHLET_FORECASTS_GROUPBY","LBL_DASHLET_FORECASTS_DATASET","LBL_DASHLET_FORECASTS_CHART_NAME","LBL_LIKELY","LBL_BEST","LBL_ACTIVE_TASKS_DASHLET","LBL_INACTIVE_TASKS_DASHLET_DEFERRED","LBL_INACTIVE_TASKS_DASHLET_COMPLETED","LBL_ALL_DASHLETS","LBL_MOBILE_NEW_COMMENT","LBL_TWITTER_REPLY","LBL_TWITTER_RETWEET","LBL_TWITTER_FAVORITE","LBL_CONNECT_TEST_FAIL","LBL_ERROR_CANNOT_FIND_TWITTER","LBL_CONFIGURE_TWITTER","LBL_PLANNED_ACTIVITIES_DASHLET","LBL_HISTORY_DASHLET","LBL_DASHLET_OPPORTUNITY_NAME","LBL_DASHLET_CASES_SUMMARY_NAME","LBL_DASHLET_CASESSUMMARY_SUMMARY","LBL_DASHLET_CASESSUMMARY_OPEN_CASES","LBL_DASHLET_CASESSUMMARY_CLOSE_CASES","LBL_OFFLINE_MODE","LBL_OFFLINE_PREFETCH_PROMPT","LBL_OFFLINE_PREFETCH_FIRST_PROMPT","LBL_OFFLINE_PREFETCH_SUCCESS","LBL_OFFLINE_PREFETCH_ERROR","LBL_OFFLINE_PREFETCH_ACTION","LBL_OFFLINE_PREFETCH_RELATED_ACTION","LBL_OFFLINE_PREFETCHING","LBL_OFFLINE_PREFETCHING_MODULE","LBL_OFFLINE_PREFETCHING_EST_TIME","LBL_OFFLINE_PREFETCHING_RELATIONSHIP","LBL_OFFLINE_PREFETCHING_MODULE_COMPLETE","LBL_OFFLINE_DB_CLEANING_IN_PROGRESS","LBL_OFFLINE_DB_CLEANING_COMPLETED","LBL_OFFLINE_ROLLBACK_PROMPT","LBL_OFFLINE_ROLLBACK_FAILED","LBL_OFFLINE_ROLLBACK_SUCCESS","LNK_OFFLINE_SETTINGS","LBL_OFFLINE_ENABLE_PROMPT","LBL_OFFLINE_DISABLE_PROMPT","LBL_OFFLINE_ENABLED","LBL_OFFLINE_DISABLED","LBL_OFFLINE_CLEAR_DB","LBL_OFFLINE_COMPACT_DB","LBL_OFFLINE_CLEAN_UP_PROMPT","LBL_OFFLINE_CLEAR_DB_PROMPT","LBL_OFFLINE_SERVER_FETCH","LBL_OFFLINE_MERGE_DATA_CONFIRM","LBL_OFFLINE_LAST_SYNC_TS","LBL_OFFLINE_SYNC_IN_PROGRESS","LBL_OFFLINE_TRANSACTION_SYNCED","LBL_OFFLINE_TOTAL_RECORDS_COUNT","LBL_OFFLINE_DB_SIZE","LBL_OFFLINE_DATA_ENCRYPTION_ENABLED","LBL_OFFLINE_RECORDS_PER_MODULE","LBL_TX_LOG","LBL_TX_LOG_DETAIL","LBL_OFFLINE_SETTINGS","LBL_OFFLINE_STATS","LBL_ACTION_CREATE_EXPLANATION","LBL_ACTION_UPDATE_EXPLANATION","LBL_ACTION_DELETE_EXPLANATION","LBL_ACTION_LINK_EXPLANATION","LBL_ACTION_UNLINK_EXPLANATION","LBL_ACTION_FAVORITE_EXPLANATION","LBL_ACTION_FOLLOW_EXPLANATION","LBL_ACTION_UNFOLLOW_EXPLANATION","LBL_ACTION_UNFAVORITE_EXPLANATION","LBL_ACTION_CREATE_RELATED_EXPLANATION","LBL_EMAIL_ACTION_SET_PRIMARY","LBL_EMAIL_ACTION_SET_OPT_OUT","LBL_EMAIL_ACTION_SET_OPT_IN","LBL_EMAIL_ACTION_SET_VALID","LBL_EMAIL_ACTION_SET_INVALID","LBL_EMAIL_ADD","LBL_RECORD_DELETED","ERR_MOBILE_EMAIL","ERR_MOBILE_FILE_NOT_SUPPORTED","ERR_MOBILE_FILE_READ","ERR_MOBILE_FILE_NOT_FOUND","ERR_MOBILE_FILE_NOT_READABLE","ERR_MOBILE_FILE_ABORTED","ERR_MOBILE_FILE_SECURITY","ERR_MOBILE_FILE_SIZE_LIMIT_EXCEEDED","ERR_MOBILE_BROWSER_NOT_AUTHORIZED","ERR_MOBILE_BROWSER_FORBIDDEN","ERR_MOBILE_BROWSER_PAGE_NOT_FOUND","ERR_MOBILE_BROWSER_INTERNAL_SERVER_ERROR","ERR_MOBILE_BROWSER_SERVICE_UNAVAILABLE","ERR_MOBILE_STORAGE_UNAVAILABLE","ERR_MOBILE_GENERIC_NATIVE_ERROR","ERR_MOBILE_FILE_PROCESSING","ERR_MOBILE_METADATA_CHANGED","ERR_MOBILE_DASHBOARDS_FETCHING","ERR_FILTERS_FETCHING","ERR_NO_DOCS","ERR_MOBILE_UPLOAD","ERR_MOBILE_VALIDATION","ERR_NO_RECORDS_SELECTED","ERR_RENDER_FAILED_TITLE","ERR_RENDER_FAILED_MSG","ERR_RENDER_FIELD_FAILED_MSG","ERR_CONTACT_TECH_SUPPORT","ERR_NO_VIEW_ACCESS_TITLE","ERR_LAYOUT_RENDER_TITLE","ERR_INTERNAL_ERR_MSG","ERROR_MAXVALUE","ERROR_MINVALUE","ERROR_MAX_FIELD_LENGTH","ERROR_MIN_FIELD_LENGTH","ERROR_DATETIME","ERROR_FIELD_REQUIRED","ERROR_EMAIL","ERROR_NUMBER","ERROR_IS_BEFORE","ERROR_IS_AFTER","ERROR_IS_GREATER_THAN","ERROR_IS_LESS_THAN","ERROR_DUPLICATE_EMAIL","ERR_MOBILE_CONFLICT","ERR_MOBILE_VIEW_NOT_SUPPORTED","ERR_OFFLINE","ERR_OFFLINE_STORAGE_UNAVAILABLE","ERR_OFFLINE_STORAGE_CREATE","ERR_OFFLINE_START_FAILED_OUT_OF_SPACE","ERR_OFFLINE_OUT_OF_SPACE","ERR_OFFLINE_CLEAN_UP_CONFIRMATION","ERR_OFFLINE_PREFETCH_FAILED","ERR_OFFLINE_DB_CLEANING_ERROR","ERR_OFFLINE_SYNC_CONFLICT","ERR_OFFLINE_SYNC_ERROR","ERR_OFFLINE_SERVERTIME_UNAVAILABLE","ERR_OFFLINE_NO_CONNECTION_ENABLE_ERROR","ERR_OFFLINE_ENCRYPTION_FAILED","LBL_OFFLINE_ENCRYPTION_IN_PROGRESS","LBL_OFFLINE_ENCRYPTION_SUCCESS","LBL_RELATED_RECORD_DEFAULT_NAME","LBL_RELATED_MODULE","LBL_CREATE_RELATED","LBL_CREATE_MODULE","LBL_RELATED_MODULE","LBL_EDIT_RELATED","LBL_EDIT","LBL_ASSOC_EXISTING","LBL_ASSOC","LBL_ASSIGN","LBL_RELATED_MODULE_PLURAL","LBL_CHART_LEGEND_CLOSE","LBL_CHART_LEGEND_OPEN","LBL_CHART_NO_DATA","LBL_DASHLET_TOP10_SALES_OPPORTUNITIES_NAME","LBL_DASHLET_PIPLINE_NAME","LBL_CHART_UNDEFINED","LBL_NO_FIELD_ACCESS","LBL_RECORD_SHARE_BUTTON","TPL_RECORD_SHARE_SUBJECT","TPL_RECORD_SHARE_BODY","LBL_MOBILE_BY","LBL_MOBILE_FILTER_IS_NOT_AVAILABLE"]);

e.mod_strings={}})(SUGAR.App)},function(e,t){(function(e){"use strict";e.augment("customization",{_customFields:[],init:function(){},registerField:function t(e){this._customFields.push(e)},getCustomFields:function i(){return this._customFields}})})(SUGAR.App)},function(e,t){(function(e){var t=/(?:(?:(?:(?:(?:(?:https?)|ftp|itms|itms-apps):\/\/)|skype:)[a-z0-9-\._~\:\/?#[\]@!$&'()*+,;=%]+)|(?:[a-z0-9]{1}(?:[a-z0-9-]+\.)+(?:com|net|gov|edu|us)(?:(?:\?|\/)[a-z0-9-\._~\:\/?#[\]@!$&'()*+,;=%]+)?))/gi;var i=/[.?,!]+$/;$.merge=function(){return _.union.apply(this,arguments)};_.extend(async,{retry:function(e,t,i){var n=5;var a=[];if(typeof e==="function"){i=t;t=e;e=n}e=parseInt(e,10)||n;var o=function(n,o){var s=function(e,t){return function(i){e(function(e,n){i(!e||t,{err:e,result:n})},o)}};while(e){a.push(s(t,!(e-=1)))}async.series(a,function(e,t){t=t[t.length-1];(n||i)(t.err,t.result)})};return i?o():o}});e.nomad.utils={urlHasProtocolRegExp:/^(?!javascript)[a-z-]+:/i,augmentZeptoDetect:function(e){var t=$.os;var i=$.browser;t.desktop=!e&&(i.chrome||i.safari)&&!(t.phone||t.tablet||t.ipod||t.silk||t.kindle||t.rimtabletos||t.wp||t.blackberry||t.bb10||t.playbook||t.touchpad);i.chromeMobile=i.chrome&&!e&&!t.desktop&&(t.ios||t.android&&t.phone);i.chromeWeb=i.chrome&&!e},execRegex:function(e,t,i){var n;while((n=t.exec(e))!==null){if(n.index===t.lastIndex){t.lastIndex++}i(n)}},sizePicture:function(e){var t=parseInt(e.height,10);var i=parseInt(e.width,10);var n=e.image.naturalHeight;var a=e.image.naturalWidth;if(n<a){e.sizeProp=t/n*a+"px "+t+"px"}else{e.sizeProp=i+"px "+i/a*n+"px"}},stripLastEmptyStrings:function(e){var t=e.split("\n");while(t.length>0){if(_.isEmpty(_.last(t))){t.pop()}else break}return t.join("\n")},minutesToQuarterHours:function(e){e=parseInt(e,10);if(e===0)return e;if(e<8)return 15;var t=Math.floor(e/15);var i=e%15;if(i>7)t=t+1;return t*15},pad:function(e,t,i){i=i||"0";e=String(e);return e.length>=t?e:new Array(t-e.length+1).join(i)+e},getPrimaryEmail:function(e,t){var i=_.find(e,this.isPrimaryEmail);if(t&&i){return i.email_address}return i},replaceGuid:function(e,t){var i=/([\w\d]{8}\-[\w\d]{4}-[\w\d]{4}-[\w\d]{4}-[\w\d]{12})/;return e.replace(i,t)},extractAndSortEmails:function(e){var t=_.flatten(_.map(e,_.values));t=_.reject(t,function(e){return Number(e.invalid_email)||Number(e.opt_out)});t=_.sortBy(t,function(e){return Number(e.primary_address)?0:1});t=_.pluck(t,"email_address");return t},isPrimaryEmail:function(e){var t=e.primary_address;if(!_.isBoolean(t)){t=!!parseInt(e.primary_address,10)}return t},nl2br:function(e){var t=e||"";t=String(t);return t.replace(/\n|\r|\r\n/g,"<br />")},iso2sugar:function n(t,i){if($.os.android&&(e.isNative||i.nativeSupport))return t;return t.replace(/\.?\d+?Z/,"+00:00")},getTimeZoneOffsetString:function(e){var t=e||(new Date).getTimezoneOffset();var i=t>=0?"+":"-";t=Math.abs(t);var n=Math.floor(t/60);var a=t%60;return i+this.pad(n,2)+":"+this.pad(a,2)},getHash:function(){var t=e.routing.location.hash;if(t){t=t.split("~")[0]}return t||"#"},isOnDynamicRoute:function(){return e.routing.location.hash.indexOf("~")!==-1},canGoBack:function(){var e=$.browser.chromeMobile?2:1;return window.history.length>e},resolveUrl:function(e,t){var i=document,n=i.getElementsByTagName("base")[0],a=n&&n.href,o=i.head||i.getElementsByTagName("head")[0],s=n||o.appendChild(i.createElement("base")),r=i.createElement("a"),l;s.href=t;r.href=e;l=r.href;if(n)n.href=a;else o.removeChild(s);return l},merge:function(){function e(e,t){return t}return function t(i,n,a){var o;if(_.isUndefined(i))o=n;else if(_.isUndefined(n))o=i;else{var s=_.first(arguments,2);var r=_.map(s,_.keys);var l=_.intersection.apply(_,r);var c={};_.each(s,function(e,t){_.each(r[t],function(t){c[t]=e[t]})});if(_.isUndefined(a))a=e;_.each(l,function(e){c[e]=a(i[e],n[e])});return c}return _.clone(o)}}(),deepClone:function a(e){var t={};_.each(e,function(e,i){t[i]=_.isObject(e)?a(e):e});return t},getOfflineStatusClass:function(){var t=e.offline.status;if(t){if(t.state===e.offline.STATE.ERROR){return"status-error"}else if(t.state===e.offline.STATE.WARNING){return"status-warning"}}return"status-success"},humanFileSize:function(){var t=" K M G T P E Z Y".split(" ").map(function(e){return e+"B"});function i(e,i){var n=0;var a=1024;var o=i?0:1;while(e>a/10&&++n<t.length-1){e/=a}this.value=(e+.05).toFixed(o);this.units=t[n]}i.prototype._i18nUnits=function(){var t="LBL_FILE_SIZE_UNITS_"+this.units;var i=e.lang.get(t);return i===t?null:i};i.prototype.toString=function(e){var t=e&&this._i18nUnits()||this.units;return this.value+" "+t};return function(e,t){return e!==-1?new i(e,t):null}}(),isErrorEmulationEnabled:function(){return e.config.errorEmulation.enabled&&e.user.get("user_name")===e.config.errorEmulation.user.toLowerCase()},parseQueryString:function(e){function t(e,t){var i=String(e).replace(/^&/,"").replace(/&$/,"").split("&"),n=i.length,a,o,s,r,l,c,d,u,f,h,p,m,g,_,v,b=function(e){return decodeURIComponent(e.replace(/\+/g,"%20"))};if(!t){t=this.window}for(a=0;a<n;a++){h=i[a].split("=");p=b(h[0]);m=h.length<2?"":b(h[1]);while(p.charAt(0)===" "){p=p.slice(1)}if(p.indexOf("\x00")>-1){p=p.slice(0,p.indexOf("\x00"))}if(p&&p.charAt(0)!=="["){_=[];g=0;for(o=0;o<p.length;o++){if(p.charAt(o)==="["&&!g){g=o+1}else if(p.charAt(o)==="]"){if(g){if(!_.length){_.push(p.slice(0,g-1))}_.push(p.substr(g,o-g));g=0;if(p.charAt(o+1)!=="["){break}}}}if(!_.length){_=[p]}for(o=0;o<_[0].length;o++){f=_[0].charAt(o);if(f===" "||f==="."||f==="["){_[0]=_[0].substr(0,o)+"_"+_[0].substr(o+1)}if(f==="["){break}}c=t;for(o=0,v=_.length;o<v;o++){p=_[o].replace(/^['"]/,"").replace(/['"]$/,"");d=o!==_.length-1;l=c;if(p!==""&&p!==" "||o===0){if(c[p]===u){c[p]={}}c=c[p]}else{s=-1;for(r in c){if(c.hasOwnProperty(r)){if(+r>s&&r.match(/^\d+$/g)){s=+r}}}p=s+1}}l[p]=m}}}var i={};t(e,i);return i},docIsAvailable:function(t){return!_.isEmpty(t)&&(!e.offline||e.offline.isOnline())},isValidDate:function(e){return _.isDate(e)&&!isNaN(e.getTime())},isModelSynchronized:function(t,i){var n=["_last_fetched","_client_date_modified"];var a;var o;if(t.get("date_modified")!==i.date_modified){return false}o=_.omit(i,n);a=_.omit(t.toJSON(),n);return _.isEmpty(e.utils.getChangedProps(a,o,false))},getObjectPrimitives:function(e){var t={};function i(e){return!_.isObject(e)&&!_.isFunction(e)}_.each(e,function(e,n){if(i(e)){t[n]=e}});return t},waitFor:function(e,t,i){var n=false;var a=new Date-0;var o=false;i=i||2e3;var s=function(){o=new Date-0-a>i;n=e();if(!n&&!o){window.setTimeout(s,200)}else{t(o?{message:"Max wait timeout"}:null)}};window.setTimeout(s,200)},deepExtend:function(){var e=this;if(arguments.length<1||typeof arguments[0]!=="object"){return false}if(arguments.length<2)return arguments[0];var t=arguments[0];var i=Array.prototype.slice.call(arguments,1);var n;var a;var o;i.forEach(function(i){if(typeof i!=="object")return;for(var s in i){if(i[s]!==void 0){a=t[s];n=i[s];if(n===t)continue;if(typeof n!=="object"||n===null){t[s]=n;continue}if(typeof a!=="object"){o=Array.isArray(n)?[]:{};t[s]=e.deepExtend(o,n);continue}if(Array.isArray(n)){o=Array.isArray(a)?a:[]}else{o=!Array.isArray(a)?a:{}}t[s]=e.deepExtend(o,n)}}});return t},isTabletLandscapeMode:function(){return e.isTablet&&e.nomad.getOrientation()==="landscape"},isForecastConfigValid:function(){var t=true;var i=e.metadata.getModule("Forecasts","config");var n=i.sales_stage_won;var a=i.sales_stage_lost;var o=i.sales_stage_won.concat(i.sales_stage_lost);var s=e.lang.getAppListStrings("sales_stage_dom");if(n.length===0||a.length===0||_.isEmpty(s)){t=false}else{t=_.every(o,function(e){return e!==""&&_.has(s,e)},this)}return t},getForecastNotSetUpMessage:function(t){var i=t?"LBL_DASHLET_FORECAST_NOT_SETUP_ADMIN":"LBL_DASHLET_FORECAST_NOT_SETUP";var n=e.lang.get(i,"Forecasts");var a=e.config.siteUrl.indexOf("?")===-1?"?":"&";if(t){var o=e.lang.get("LBL_DASHLET_FORECAST_CONFIG_LINK_TEXT","Forecasts");n+='  <a class="lnk-non-forecast" href="'+e.config.siteUrl+a+'mobile=0#Forecasts/config">'+o+"</a>"}return n},wrapAsyncCallback:function o(e){return{success:function t(i){e(null,i)},error:e}},isAccessibleModule:function(t,i){i=i||"list";return!_.contains(e.config.unsupportedModules,t)&&_.contains(e.metadata.getModuleNames({filter:"visible",access:i}),t)},getClosedStatusValue:function(e){var t={Calls:"Held",Tasks:"Completed",Meetings:"Held"};return t[e]},isModuleVisible:function(t){var i=e.metadata.get().modules_info[t];return i&&i.visible},getHashCode:function(e){var t=0;var i;var n;var a;if(e.length===0)return t;for(i=0,a=e.length;i<a;i++){n=e.charCodeAt(i);t=(t<<5)-t+n;t|=0}return t},charHtmlEntity:function(e,t){var i=e;if(t){if(e==="<"){i="&lt;"}else if(e==="'"){i="&#x27;"}else if(e===">"){i="&gt;"}else if(e==="\n"){i="<br>"}}else{if(e==="&"){i="&amp;"}else if(e==="<"){i="&lt;"}else if(e===">"){i="&gt;"}else if(e==="'"){i="&#x27;"}else if(e==='"'){i="&quot;"}else if(e==="\n"){i="<br>"}}return i},stringHtmlEntity:function s(e,t){var i="";_.each(e,function(e){i+=this.charHtmlEntity(e,t)},this);return i},escapeRegExp:function r(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},migrateKeyValueStore:function(t,i){var n=e.config.env+":"+e.config.appId+":";if(t.get(n+"store:version")!==t.version){_.chain(localStorage).keys().filter(function(e){return e.indexOf(n)===0}).each(function(i){t.set(i,e.cache.get(i));localStorage.removeItem(i)}).value();t.set(n+"store:version",t.version)}var a=i.getAll();if(!_.isEmpty(a)){_.each(a,function(e,i){t.set(i,e)});i.cutAll()}},formatLinks:function l(e){var n="";if(e&&e.length>0){n=e.replace(t,_.bind(function(e){var t=e.match(i)||"";if(t){e=e.replace(i,"")}var n=this.urlHasProtocolRegExp.test(e)?e:"http://"+e;return'<a href="'+n+'">'+e+"</a>"+t},this))}return n},isElVisible:function(e){return e&&e.get(0)&&e.get(0).offsetParent!==null},isDirectionLTR:function(){return!e.config.UI.supportedRTL||e.lang.direction===e.lang.DIRECTION_LTR}}})(SUGAR.App)},function(e,t){(function(e){var t=function(){this.stack=[];this.hash={}};t.prototype={clear:function(){this.stack=[];this.hash={}},iterate:function(e,t){_.each(this.stack,function(t,i){e.call(this,t.item,i)},t)},remove:function(e,t){var i=[];if(!_.isFunction(e)){var n=-1;var a;for(var o=0;o<this.stack.length;o++){if(_.isString(e)?this.stack[o].uid===e:this.stack[o].item===e){n=o;a=this.stack[o];break}}if(n>-1&&a){delete this.hash[a.uid];this.stack.splice(n,1)}}else{_.each(this.stack,function(n,a){var o=e.call(t,n.item,a);if(o){i.push(n)}},this);_.each(i,function(e){this.remove(e.uid)},this)}},shift:function(){var e=this.stack.shift();delete this.hash[e.uid];return e.item},pop:function(){var e=this.stack.pop();delete this.hash[e.uid];return e.item},push:function(e,t){if(!this.hash[e]){this.stack.push({uid:e,item:t})}this.hash[e]=t},get:function(e){return this.hash[e]},getByIndex:function(e){var t=this.stack[e];return t?t.item:null},count:function(){return this.stack.length},isEmpty:function(){return!this.stack.length}};e.nomad.hashmap=t})(SUGAR.App)},function(e,t){(function(e){e.augment("overlay",{init:function(){this.overlayHash={}},show:function(t,i){if(this.overlayHash[t]){return false}i=_.extend({tint:false,spinner:true,template:false},i);var n=i.message||"";if(!n&&i.label){n=e.lang.get(i.label)}var a=$(e.template.get("overlay")());if(i.template){a.html(e.template.get(i.template)({message:n}))}else{var o=a.find("#overlay-message");a.toggleClass("tint",i.tint);a.toggleClass("spinner",i.spinner);o.text(n).show()}e.$rootEl.append(a);a.show();this.overlayHash[t]=a},hide:function(e,t){var i=this.overlayHash[e];if(i){if(t){i.animate({opacity:"0"},500,"ease",function(){i.remove()})}else{i.remove()}}delete this.overlayHash[e]},hideAll:function(){_.each(this.overlayHash,function(e,t){if(e){e.remove();delete this.overlayHash[t]}},this)},isActive:function(){return!_.isEmpty(e.overlay.overlayHash)}})})(SUGAR.App)},function(e,t){(function(e){e.plugins.register("clear-field","view",{events:{"keyup.clear-field input":"checkIfFieldEmpty","focusin.clear-field input":"checkIfFieldEmpty","touchend.clear-field .icon-remove-sign":"clearOnClick"},checkIfFieldEmpty:function(e){var t=$(e.currentTarget);if(t.val()){t.parent().addClass("not-empty")}else{t.parent().removeClass("not-empty")}},clearOnClick:function(e){var t=$(e.currentTarget).parent().find("input");t.val("");t.parent().removeClass("not-empty");var i;var n;var a;if(t.hasClass("search-query")){this.onSearchClearClick();i=this.$el.find("input");a=0}else{n=t.parents(".control-group").eq(0).parent().index();a=t.parents(".control-group").find("input").index(t);t.trigger("change");i=this.$(".pad, .modal-body form").children().eq(n).find("input")}if(!_.isEmpty(i)){i=i.get(a);if(i){i.focus()}}e.preventDefault();e.stopPropagation()}})})(SUGAR.App)},function(e,t){(function(e){function t(e,t){var i=e[t];e[t]=function(){i.apply(e,arguments);if(this._currentRecordId){this.selectCurrentRecord({modelId:this._currentRecordId})}}}e.plugins.register("current-record","view",{initialize:function(){this._currentRecordId=null;this.listenTo(e,"app:view:change",function(e){if(e.layoutDef&&e.layoutDef.isDynamic){return}this.selectCurrentRecord(e)});t(this,"onAfterRender")},selectCurrentRecord:function(e){var t=e.modelId||e.parentModelId;this.$el.find(".current").removeClass("current");this._currentRecordId=t;if(t){this.getListItemEl(t).addClass("current")}}})})(SUGAR.App)},function(e,t){(function(e){e.plugins.register("hide-alerts-onfocus","view",{events:{"focusin.hide-alerts-onfocus input":"fieldOnFocus","touchstart.hide-alerts-onfocus select":"fieldOnFocus"},fieldOnFocus:function(){var t={animate:false};e.alert.dismissAll(false,t)}})})(SUGAR.App)},function(e,t){(function(e){var t=[{name:"close",label:"LBL_CLOSE_BUTTON_TITLE",icon:"icon-times",isEnabled:function(e){return e.isCloseActionAvailable()},action:"onClose",autoClose:true}];var i={close:{label:"LBL_CLOSE_AND_SAVE_BUTTON",fn:function(){this.model.set("status",e.nomad.utils.getClosedStatusValue(this.module));this.saveRecord()},needsAccess:{field:"status",action:"edit"},showOnCreate:false,isEnabled:function(e){return e.isCloseActionAvailable()}}};e.plugins.register("item-actions","view",{initialize:function(){var n=this;if(this instanceof e.view.views.ListView){_.each(t,function(e){n.contextMenuActions.push(e)})}if(this instanceof e.view.views.EditView){this.headerActions=this.headerActions||{};_.extend(this.headerActions,i)}},onClose:function(t,i){var n="status";i.set(n,e.nomad.utils.getClosedStatusValue(i.module||this.module));i.save(null,{fields:[n],error:function a(){i.set(n,i.previousAttributes()[n])},success:_.bind(function o(){if(i.collection&&_.isArray(i.collection.filterDef)&&_.find(i.collection.filterDef,function(e){return e[n]&&e[n]["$not_in"]&&_.contains(e[n]["$not_in"],i.get(n))})){this.collection.remove(i);this.collection.next_offset!==-1&&--this.collection.next_offset;if(!this.collection.length){this.collection.fetch()}}},this)})}})})(SUGAR.App)},function(e,t){(function(e){e.plugins.register("context-menu","view",{contextMenuActions:null,isListItemSwippable:true,LIST_VIEW_CONTEXT_MENU:"list_view_context_menu",events:{"swipeLeft.context-menu article":function(t){if(e.nomad.utils.isDirectionLTR()){this.onSwipeLeftItem(t)}else{this.onSwipeRightItem(t)}},"swipeRight.context-menu article":function(t){if(e.nomad.utils.isDirectionLTR()){this.onSwipeRightItem(t)}else{this.onSwipeLeftItem(t)}},"click.context-menu .cm-item-btn:not(.disabled)":"onClickCMItem","longTap.context-menu article":"onLongTapItem"},initialize:function(){this.contextMenuOnSwipeDisabled=this.contextMenuDisabled||this.options.contextMenuOnSwipeDisabled||!e.isNative&&$.os.ios;this._defineBasicMenuActions();this.contextMenuActions=[].concat(this.basicMenuActions);this.isListItemSwippable=this.module!=="Activities"&&this.layout&&this.layout.module!=="Dashboards"||this.module==="Search"||this.module==="Recents";this.listenTo(e,"app:orientation:changed",function(){if(this.activeListItem){var e=this.activeListItem.attr("module")||this.module;var t=this.activeListItem.attr("data-id");var i=this.getModel(t,e);this.calculateContextMenuItems(i);this._refreshContextMenu(i)}})},_defineBasicMenuActions:function(){this.basicMenuActions=this.basicMenuActions||[{name:"favorite",label:function(e){return e.get("my_favorite")?"LBL_UNFAVORITE":"LBL_FAVORITE"},isEnabled:function(t){return e.acl.hasAccessToModel("view",t)&&!_.contains(e.config.nonEditableModules,t.module)},isFavorite:true,action:function(e,t){this.onToggleFieldValue(t,"favorite","my_favorite")}},{name:"view",label:"LBL_VIEW_BUTTON",icon:"icon-eye",isEnabled:function(t){return!e.acl.hasAccessToModel("edit",t)||_.contains(e.config.nonEditableModules,t.module)},action:"onEditItem"},{name:"edit",label:"LBL_EDIT_BUTTON",icon:"icon-pencil",isEnabled:function(t){return e.acl.hasAccessToModel("view",t)&&!_.contains(e.config.nonEditableModules,t.module)},action:"onEditItem"},{name:"email",access:"list",label:"LBL_EMAIL_BUTTON",icon:"icon-envelope",isEnabled:function(e){var t=this.modContextData[e.module];if(t.actions.email){var i=e.getAccessibleFields(t.emailFields);return e.hasActiveEmail(i)}return false},isMultiple:function(t){var i=t.getAccessibleFields(this.modContextData[t.module].emailFields);var n=t.getFieldsDataArray(i);var a=e.nomad.utils.extractAndSortEmails(n);return a.length>1},action:"onEmail",autoClose:true},{name:"follow",label:function(e){return e.get("following")?"LBL_UNFOLLOW":"LBL_FOLLOW"},isEnabled:function(t){return e.nomad.canFollow(t)},isFollow:true,action:function(e,t){this.onToggleFieldValue(t,"follow","following")}},{name:"unlink",label:"LBL_UNLINK_BUTTON",icon:"icon-minus-circle",isEnabled:function(e){return this.unlinkVisible&&e.hasUnlinkAccess(this.relateFields,this.relationship)},action:"onUnlinkItem"},{name:"delete",label:"LBL_DELETE_BUTTON",isEnabled:function(e){return!e.link&&e.hasDeleteAccess()},icon:"icon-trash-o",action:"onRemoveItem"},{name:"call",access:"list",label:"LBL_CALL_BUTTON",icon:"icon-phone",isEnabled:function(e){var t=this.modContextData[e.module];if(!t.actions.phone)return false;var i=e.getAccessibleFields(t.phoneFields);return e.isDataDefined(i)},isMultiple:function(e){var t=e.getAccessibleFields(this.modContextData[e.module].phoneFields);var i=e.getFieldsDataArray(t);return i.length>1},action:"onCall",autoClose:true},{name:"sms",access:"list",label:"LBL_SMS_BUTTON",icon:"icon-comment",isEnabled:function(e){var t=this.modContextData[e.module];if(!t.actions.phone)return false;var i=e.getAccessibleFields(t.phoneFields);return e.isDataDefined(i)},isMultiple:function(e){var t=e.getAccessibleFields(this.modContextData[e.module].phoneFields);var i=e.getFieldsDataArray(t);return i.length>1},action:"onSMS",autoClose:true},{name:"map",access:"list",label:"LBL_MAP_BUTTON",icon:"icon-map-marker",isEnabled:function(e){var t=this.modContextData[e.module];if(!t.actions.map)return false;var i=e.getAccessibleFieldsGroups(t.addressFieldsGroups);var n=e.getAddresses(i);return _.any(n)},isMultiple:function(e){var t=e.getAccessibleFieldsGroups(this.modContextData[e.module].addressFieldsGroups);var i=e.getAddresses(t);return i.length>1},action:"onMap",autoClose:true},{name:"url",access:"list",label:"LBL_URL_BUTTON",icon:"icon-external-link",isEnabled:function(t){var i=this.modContextData[t.module];if(!i.actions.url)return false;var n=t.getAccessibleFields(i.urlFields);var a=e.view.fields.UrlField.prototype.regexp;return t.isDataDefined(n,a)},isMultiple:function(t){var i=t.getAccessibleFields(this.modContextData[t.module].urlFields);var n=t.getFieldsDataArray(i,e.view.fields.UrlField.prototype.regexp);return n.length>1},action:"onURL",autoClose:true},{name:"file",access:"list",label:"LBL_FILE_BUTTON",icon:"icon-file",isEnabled:function(t){var i=t.getAccessibleFields(this.modContextData[t.module].docFields);var n=!_.isEmpty(i)||!_.isEmpty(t.docData)||t._canHaveFiles()||t.canHaveAttachments()||t._canHavePDFs();var a=e.acl.hasAccessToModel("view",t);return n&&a},isMultiple:function(e){return e.docData&&e.docData.length>1},isFile:true,action:"onViewFile",autoClose:true}]},onClickGrip:function(e){if(this.disableListItemClick){this.disableListItemClick=false;return false}var t=$(e.currentTarget).closest("article");if(t.hasClass("active-list-item")){this.hideContextMenu(t)}else{if(this.activeListItem){this.hideContextMenu(this.activeListItem,!!this.activeListItem)}this.showContextMenu(t)}return false},onSwipeLeftItem:function(e){if(this.contextMenuOnSwipeDisabled)return;if($.__swipeHelper.swipeOrientation!=="vertical"){var t=$(e.currentTarget);if(this.activeListItem){if($(e.currentTarget).attr("data-id")===this.activeListItem.attr("data-id")){return}this.hideContextMenu(this.activeListItem,!!this.activeListItem)}this.showContextMenu(t)}},onSwipeRightItem:function(e){if(this.contextMenuOnSwipeDisabled)return;var t=this.activeListItem&&this.activeListItem.get(0);if(e.currentTarget===t){this.hideContextMenu()}},showContextMenu:function(t){var i=t.find(".menu-container");var n=t.attr("module")||this.module;var a=t.attr("data-id");var o=this.getModel(a,n);if(_.isEmpty(i)){return}this.activeListItem=t;if(o){this.initContextMenu(i,o);this.renderContextMenu(i,o);this.listenTo(o,"change",this._refreshContextMenu)}i.addClass("on");this.activeListItem.addClass("active-list-item");if(e.config.analytics.enabled)e.analytics.attachAnalytics(i);e.events.trigger("list:item:context:menu:show",true,this)},initContextMenu:function(e,t){var i=this;var n=this.modContextData&&this.modContextData[t.module];this.calculateContextMenuItems(t);if(n&&this.hasDocAction){t.once("docs:ready",function(n){t.docData=n;i.renderContextMenu(e,t)});t.getDocuments(n.docFields)}},renderContextMenu:function(t,i){var n={contextMenuItems:this.contextMenuItems,isEmptyMenu:_.isEmpty(this.contextMenuItems),fileIconDisabled:!(i.docsLoading||e.nomad.utils.docIsAvailable(i.docData)),docsLoading:i.docsLoading,following:i.get("following"),my_favorite:!!i.get("my_favorite")};var a=e.template.get("context-menu")(n);t.find(".context-menu").remove();t.append(a)},calculateContextMenuItems:function(e){var t=this._getMaxMenuItemsCount();var i=[];var n=false;var a=this;_.each(this.contextMenuActions,function(o){if(a.isActionAvailable(o,e)&&i.length<t){i.push(o);if(o.isFile){n=true}}},this);this.contextMenuItems=i;this.hasDocAction=n},_getMaxMenuItemsCount:function(){var e=this.$el.width();var t=63;return Math.floor(e/t)},hideContextMenu:function(t,i){var n=t||this.activeListItem;if(n){n=$(n);var a=n.attr("module")||this.module;var o=n.attr("data-id");var s=this.getModel(o,a);var r=n.find(".menu-container");r.removeClass("on").find(".context-menu").remove();n.removeClass("active-list-item");if(e.config.analytics.enabled)e.analytics.detachAnalytics(r);if(s){s.off("docs:ready");this.stopListening(s,"change",this._refreshContextMenu)}}this.activeListItem=null;e.events.trigger("list:item:context:menu:show",false,this,i)},_refreshContextMenu:function(e){this.renderContextMenu(this.activeListItem.find(".menu-container"),e)},onClickCMItem:function(t){t.preventDefault();t.stopPropagation();var i=this;var n=$(t.target).closest("article");var a=$(t.currentTarget);var o=a.attr("action");var s=_.find(this.contextMenuActions,function(e){return e.name===o});var r=n.attr("module")||this.module;var l=n.attr("data-id");var c=this.getModel(l,r);var d=_.isFunction(s.isMultiple)&&s.isMultiple.call(i,c);function u(){if(_.isFunction(s.action)){s.action.call(i,t,c)}else{i[s.action].call(i,t,c)}if(!d&&s.autoClose){i.hideContextMenu()}}e.events.trigger("list:item:contextmenu:action:execute",this,u,d)},onViewFile:function(t,i){var n=i.docData;if(_.isEmpty(n)){alert(e.lang.get(i.docsLoading?"LBL_LOADING_FILES":"ERR_NO_DOCS"));return}e.nomad.openDoc(i.docData)},onCall:function(t,i){var n=i.getAccessibleFields(this.modContextData[i.module].phoneFields);var a=i.getFieldsDataArray(n);e.nomad.callPhone(a,i)},onSMS:function(t,i){var n=i.getAccessibleFields(this.modContextData[i.module].phoneFields);var a=i.getFieldsDataArray(n);e.nomad.sendSms(a)},onEmail:function(t,i){var n=i.getAccessibleFields(this.modContextData[i.module].emailFields);var a=i.getFieldsDataArray(n);var o=e.nomad.utils.extractAndSortEmails(a);if(!_.isEmpty(o)){e.nomad.sendEmail(o)}},onURL:function(t,i){var n=i.getAccessibleFields(this.modContextData[i.module].urlFields);var a=i.getFieldsDataArray(n,e.view.fields.UrlField.prototype.regexp);e.nomad.openUrl(a,true)},onMap:function(t,i){var n=i.getAccessibleFieldsGroups(this.modContextData[i.module].addressFieldsGroups);var a=i.getAddresses(n);e.nomad.openAddress(a)},onRemoveItem:function(e,t){return this._deleteRecord(e,t)},onUnlinkItem:function(e,t){return this._deleteRecord(e,t,true)},onToggleFieldValue:function(e,t,i){var n=e.get(i);var a=this;e[t](!n,{error:function(){e.set(i,n);a.hideContextMenu()}});this.hideContextMenu()},onEditItem:function(t,i){if(!t.defaultPrevented&&!t.cancelBubble){var n=this._buildRecordRoute({model:i,hash:{link:this.context.get("link"),appendRoot:true,action:"edit"}});e.controller.navigate(n)}return false},onLongTapItem:function(t){if(this.contextMenuDisabled||this.activeListItem&&this.activeListItem.get(0)===t.currentTarget||e.nomad.isSwiping)return;if($.os.android){this.disableListItemClick=true;e.analytics.trackEvent("longTap","c-menu");if(this.activeListItem){this.hideContextMenu(null,true)}this.showContextMenuActionSheet(t)}},_deleteRecord:function(t,i,n){var a=this;var o=e.lang.get(n?"LBL_MOBILE_UNLINK_CONFIRM":"LBL_MOBILE_DELETE_CONFIRM");a.hideContextMenu();e.nomad.showConfirm(o,function(e){if(e===2){a._deleteRecordAction(i,n)}});return false},_deleteRecordAction:function(e,t){e.destroy({relate:t,wait:true})},showContextMenuActionSheet:function(t){this.disableListItemClick=true;var i=$(t.currentTarget).closest("article");var n=i.attr("module")||this.module;var a=i.attr("data-id");var o=this.getModel(a,n);var s=[];var r=[];var l=this;this.activeListItem=i;_.each(this.contextMenuActions,function(t){if(l.isActionAvailable(t,o)){var i=t.label;if(_.isFunction(i)){i=i(o)}s.push(t);r.push(e.lang.get(i))}});if(r.length>0){e.nomad.showActionSheet(e.lang.get("LBL_SELECT_ACTION_LABEL"),r,function c(n,a){var r=s[a];var c=_.isFunction(r.isMultiple)&&r.isMultiple.call(l,o);l.onCloseContextMenuActionSheet(i);function d(){if(_.isFunction(r.action)){r.action.call(l,t,o)}else{l[r.action].call(l,t,o)}l.activeListItem=null}e.events.trigger("list:actionsheet:item:click",d,c);if(e.isNative)return;return c?false:true},function d(){l.onCloseContextMenuActionSheet(i);l.activeListItem=null})}o.off("docs:ready");o.on("docs:ready",function(e){o.docData=e});this.modContextData[o.module]&&o.getDocuments(this.modContextData[o.module].docFields)},onCloseContextMenuActionSheet:function(e){e.removeClass("selected-item");this.disableListItemClick=false}})})(SUGAR.App)},function(e,t){(function(e){e.plugins.register("fast-click-highlight","view",{events:{"touchstart.fast-click-highlight .fast-click-highlighted":"onTouchStart","touchmove.fast-click-highlight .fast-click-highlighted":"onTouchMove","touchend.fast-click-highlight .fast-click-highlighted":"onTouchEnd","touchcancel.fast-click-highlight .fast-click-highlighted":"onTouchEnd"},onTouchStart:function(e){_.delay(_.bind(function(){if(!this._flag&&$(e.currentTarget).hasClass("fast-click-highlighted")&&!$(e.target).hasClass("inert")&&!$(e.target).hasClass("grip")){$(e.currentTarget).addClass("selected-item")}},this),50)},onTouchEnd:function(){_.delay(_.bind(function(){if(this.$el){this.$el.find(".selected-item").removeClass("selected-item");this._flag=false}},this),50)},onTouchMove:function(){if(!this._flag){this.$el.find(".selected-item").removeClass("selected-item")}this._flag=true}})})(SUGAR.App)},function(e,t){(function(e){e.plugins.register("focus-on-input","view",{events:{"focus.focus-on-input input":"inputOnFocus"},inputOnFocus:function(t){if(!e.isTablet||!$.os.android)return;var i=$(t.target).parents(".scroll").get(0);var n=$(t.target).parents("span[sfuuid]").get(0).offsetTop;_.delay(function(){i.scrollTop=n},1e3)}})})(SUGAR.App)},function(e,t){(function(e){e.plugins.register("pagination","view",{events:{"click.pagination .show-more-top-btn":"showMoreTopRecords","click.pagination .show-more-bottom-btn":"showMoreBottomRecords"},initialize:function t(){this.listenTo(e,"offline:server:read",this._onServerReadStatusUpdate);this.listenTo(this.collection,"sync",this._onDataSyncSuccess)},isEnabled:function i(e){return e.options.module!=="Recents"},_onServerReadStatusUpdate:function n(t){var i=t.status===e.offline.api.SERVER_READ_STATUS.start;if(this.collection.offlineReadDisabled){return}if(this.isCurrentListUpdated(t.apiOptions)){_.extend(t,{backgroundFetch:true});if(i){e.syncAlertManager.onSyncStart("read",this.collection,t)}else{e.syncAlertManager.onSyncSuccess("read",this.collection,t)}if(this.scroll){this.scroll.reflow()}}},_onDataSyncSuccess:function a(){if(!this.collection){return}while(this.collection.length>this.getMaxPageSize()){this.collection.shift()}this.$(".show-more-top-btn").toggle(this.needShowMoreTopButton());this.$(".show-more-bottom-btn").toggle(this.needShowMoreBottomBtn());if(this.scroll){this.scroll.reflow()}},showMoreTopRecords:function o(){var t=Math.max(this.collection.offset-this.collection.length-e.config.maxQueryResult,0);this.refresh({offset:t,limit:e.config.fetchLimit.maxPageSize})},showMoreBottomRecords:function s(){this.refresh({paginate:true})},needShowMoreTopButton:function r(){return this.collection.dataFetched&&Math.max(this.collection.next_offset,this.collection.offset)>this.getMaxPageSize()},needShowMoreBottomBtn:function l(){return this.collection.dataFetched&&this.collection.next_offset!==-1}})})(SUGAR.App)},function(e,t){(function(e){e.plugins.register("ptr","view",{isEnabled:function(){return!!e.config.pullToRefresh},initialize:function(){this.listenTo(e,"app:orientation:changed",function(){this.scrollReflow()});this.listenTo(e,"app:rightmenu:show",function(t){if(!e.isTablet){t.show?this.destroyScroll():this.initScroll()}});this.listenTo(e,"app:keyboard:hide",function(){this.scrollReflow()});this.listenTo(e,"app:header:clicked",function(e){if(e===this.layout){this.scrollToTop()}});this.listenTo(this,"ptr:data:load:complete",function(){this.hidePullToRefresh();this.scrollReflow()})},_dispose:function(){this.destroyScroll()},onAfterRender:function(){if(_.isEmpty(this.$easyScrollerParent)){this.$el.wrap('<div class="easy-scroller-parent"><div class="easy-scroller-holder"></div></div>');this.$easyScrollerParent=this.$el.closest(".easy-scroller-parent")}if(!this.scroll){this.initScroll()}else{this.scrollReflow()}},initScroll:function(){var e=this.$easyScrollerParent;if(_.isEmpty(e)){return false}this.destroyScroll();var t=e.get(0);var i=e.find(".easy-scroller-holder").get(0);if(i&&t){this.scroll=new window.EasyScroller(i,t,{scrollingY:true,scrollingX:false})}this.initPullToRefresh()},destroyScroll:function(){if(this.scroll){this.destroyPullToRefresh();this.scroll.destroy();this.scroll=null}},initPullToRefresh:function(){if(this.scroll){var t=this.$el;t.pullToRefresh({callback:_.bind(this.onRefresh,this,true),template:e.template.get("ptr"),templateTarget:this.$easyScrollerParent,height:50,scroller:this.scroll.scroller,action:e.lang.get("LBL_MOBILE_PTR_RELEASE"),refresh:e.lang.get("LBL_LOADING")})}},hidePullToRefresh:function(){if(this.$el){this.$el.pullToRefresh("hide")}},destroyPullToRefresh:function(){if(this.$el&&this.$el.pullToRefresh){this.$el.pullToRefresh("destroy")}},scrollReflow:function(){if(this.scroll){this.scroll.reflow()}},onRefresh:function(){if(this.ptrRefresh){this.ptrRefresh()}},scrollToTop:function(){if(this.scroll){this.scroll.scroller.scrollTo(0,0,true)}}})})(SUGAR.App)},function(e,t){(function(e){e.plugins.register("android-keyboard-tracker","view",{events:{"focusin.android-keyboard-tracker input":"onFocusInput"},onAfterShow:function(){if($.os.android){var e=this;_.delay(function(){e.offsetHeight=parseInt(document.body.offsetHeight,10);

},600)}},onFocusInput:function(){if($.os.android){var t=this;_.delay(function(){var i=window.setInterval(function(){if(t.offsetHeight===parseInt(document.body.offsetHeight)){e.trigger("app:keyboard:hide");window.clearInterval(i)}},200)},600)}}})})(SUGAR.App)},function(e,t){(function(e){e.plugins.register("refresh-timeago","view",{onBeforeRender:function(){this.removeTimeago()},onAfterRender:function(){this.refreshTimeago()},refreshTimeago:function(){this.$("time").liverelativedate()},removeTimeago:function(){this.$("time").liverelativedate("destroy")}})})(SUGAR.App)},function(e,t){(function(e){e.plugins.register("swiper","view",{_activeIndex:null,events:{"swipeRight .pagination__bar":"previous","swipeLeft .pagination__bar":"next"},initialize:function(){this.listenTo(this,"swiper:change:by_view",this.setSlideByIndex);this.listenTo(this,"swiper:update",this.update)},onAfterRender:function(){var t=this;if(this.Swiper){return}this.Swiper=new Swiper(this.$el.find(this.swiperSelector),_.extend({noSwipingClass:"no-swiping",pagination:this.$(".pagination").get(0),bulletClass:"icon-circle-thin",bulletActiveClass:"icon-circle",nextButton:this.$(".next").get(0),prevButton:this.$(".prev").get(0),buttonDisabledClass:"disabled",paginationBulletRender:function(e,t){return'<span class="icon '+t+'"></span>'},onSlideChangeStart:function(e){t.trigger("swiper:change:by_plugin",e.activeIndex);t._activeIndex=e.activeIndex},onTouchMove:function(t,i){if(e.activeComponents.hasActiveComponents()){t.lockSwipes()}else{e.nomad.isSwiping=true}},onTouchEnd:function(t){e.nomad.isSwiping=false;t.unlockSwipes()}},this.swiperSettings));if(this._activeIndex){this.setSlideByIndex(this._activeIndex,true)}},previous:function(){this.Swiper.slidePrev()},next:function(){this.Swiper.slideNext()},_dispose:function(){if(this.Swiper){this.Swiper.destroy();delete this.Swiper}},update:function(){if(this.Swiper){this.Swiper.update(true)}},setSlideByIndex:function(e,t){this._activeIndex=e;if(this.Swiper){this.Swiper.slideTo(e,t?0:this.Swiper.params.speed)}}})})(SUGAR.App)},function(e,t){(function(e){e.plugins.register("create-post","view",{createPost:function(t,i){i=i||{};var n=e.context.getContext({create:true,model:t});n.prepare();var a=e.controller.loadDynamic({layoutDef:{fullScreen:true,appendTo:i.appendTo,meta:{components:[{view:{name:"taggable",context:n}}]},context:n}});var o=function s(){t.off("save");e.controller.goBack()};t.on("save",function r(){var n=t.get("value");if(!n){o();return}var a=(new Date).getTime().toString();e.overlay.show(a);t.set("data",{value:n,tags:t.get("tags")},{silent:true});i.savePost(function s(t,i){e.overlay.hide(a);!t&&o()})})}})})(SUGAR.App)},function(e,t){(function(e){function t(e,t){var i;var n;if(e){i=_.every(t.criteria,function(t){return t==="test_passed"?e.testing_enabled&&e.test_passed:e[t]});e._isValid=i}n=i?t.success:t.error;n.call(this,e)}e.plugins.register("connector","view",{checkConnector:function(i){var n=i.name;var a=e.session.get("connectors");var o=a&&a[n];if(o&&o._isValid){t.call(this,a[n],i)}else{this.getConnectors(function(e){t.call(this,e[n],i)})}},getConnectorModuleFieldMapping:function(t,i){t=(e.session.get("connectors")||{})[t];if(t&&t.field_mapping&&t.field_mapping.beans&&t.field_mapping.beans[i]){return t.field_mapping.beans[i]}return{}},getConnectors:function(t){var i=e.api.buildURL("connectors");var n=this;e.api.call("GET",i,{},{success:function(i){var a=i.connectors||{};_.each(a,function(e){e.connectorHash=i._hash;e._isValid=true});e.session.set("connectors",a);t.call(n,a)}})}})})(SUGAR.App)},function(e,t){(function(e){var t=e.config.raven;var i=function(){var e=[];var i=t&&t.enabled&&t.enhancedErrorReporting&&t.enhancedErrorReporting.maxLogSize;return{push:function(t){t.timestamp=(new Date).toISOString();e.push(t);if(e.length>i){e.shift()}},empty:function(){e=[]},getAll:function(){return _.clone(e).reverse()}}}();function n(e,t,i){var n=e[t];e[t]=function(){i.apply(this,arguments);return n.apply(this,arguments)};e[t]._originalMethod=n}function a(e,t){e[t]=e[t]._originalMethod}function o(e,t,i){var n={method:e,module:t.module};if(t.id){n.modelId=t.id}if(t.filterDef){n.filterDef=t.filterDef}if(i){n.options=_.pick(i,["byPtr","limit","myItems","query","offset"]);if(i.relate&&t.link&&t.link.bean){n.link=t.link.name;n.parentModule=t.link.bean.module;n.parentId=t.link.bean.id}if(i.favorite){n.action=t.get("my_favorite")?"favorite":"unfavorite"}if(i.following){n.action=t.get("following")?"follow":"unfollow"}}return n}function s(e){return{route:e}}function r(e,t,i){return{code:e.code,status:e.status}}function l(e){return{options:e}}var c=[{context:e.data,method:"sync",filter:o,label:"data-manager.sync"},{context:e.nomad,method:"login",label:"app.login"},{context:e.nomad,method:"logout",label:"app.logout"},{context:e.nomad,method:"onMemoryWarning"},{context:e.nomad,method:"onResume"},{context:e.nomad,method:"onPause"},{context:e.error,method:"handleHttpError",filter:r},{context:e.NomadController.prototype,method:"navigate",filter:s},{context:e.NomadController.prototype,method:"goBack"},{context:e.NomadController.prototype,method:"clean",label:"controller.clean"},{context:e.view.NomadLayoutManager,method:"loadStatic",filter:l},{context:e.view.NomadLayoutManager,method:"loadDynamic",filter:l}];var d={init:function(){if(!(t&&t.enabled&&t.enhancedErrorReporting)||this.initialized)return false;_.each(c,function(e){n(e.context,e.method,function(){var t={label:e.label||e.method};if(e.filter){_.extend(t,e.filter.apply(this,arguments)||{})}i.push(t)})});this.initialized=true},getLog:function(){return i.getAll()},dispose:function(){_.each(c,function(e){a(e.context,e.method)});i.empty();this.initialized=false}};e.augment("enhancedErrorReporter",d,true)})(SUGAR.App)},function(e,t){(function(e){e.view.ActionSheet=Backbone.View.extend({events:{"touchstart .item":"onItemTouchStart","touchmove .item":"onItemTouchMove","click .item":"onSelect","click .cancel":"onCancel"},plugins:["fast-click-highlight"],ACTIONSHEET:"actionsheet",initialize:function(t){var i=this;$(window).on("orientationchange.actionsheet",function(){$(i.popup).addClass("invisible");_.delay(function(){i.position()},1e3)});e.plugins.attach(this,"view");this.container=$("#actionsheet-overlay");this.orientationSupport=_.isNumber(window.orientation);this.options=_.extend({title:"",template:"actionsheet",items:[],onSelect:false,onCancel:false,cancelText:e.lang.get("LBL_CANCEL_BUTTON_LABEL")},t);this.render();this.show()},onItemTouchStart:function(e){this._moved=false},onItemTouchMove:function(e){this._moved=true},onSelect:function(e){if(this._moved){this._moved=false;return false}var t=parseInt(e.target.dataset.index,10);var i=this.options.items[t];var n=true;if(this.options.onSelect){n=this.options.onSelect.call(this,i,t)}if(n!==false){this.remove()}},onCancel:function(){this.remove();if(this.options.onCancel){this.options.onCancel.call(this)}},render:function(){var t=e.template.get(this.options.template)(this.options);var i=$(t);this.popup=i;this.container.empty();this.$el.empty().append(i).appendTo(this.container);_.delay(_.bind(this.position,this),20)},show:function(){this.render();this.container.show();e.trigger("actionsheet:show",true,this)},hide:function(){this.container.hide();if($.os.ios){e.nomad.redraw(100)}},position:function(){var e=this.popup;var t=this.orientationSupport&&_.contains([90,-90],window.orientation);e.toggleClass("compact",t);var i=document.documentElement;var n=e.get(0);var a=i.clientWidth;var o=i.clientHeight;var s=n.offsetWidth;var r=n.offsetHeight;var l=o-r;var c=a-s;var d;var u;if(l<=0){d=0}else{d=l/2}if(c<=0){u=0}else{u=c/2}e.css({top:d+"px",left:u+"px"}).removeClass("invisible")},remove:function(){Backbone.View.prototype.remove.call(this);this.hide();e.trigger("actionsheet:show",false,this);this.container.empty();$(window).off("orientationchange.actionsheet")}},{show:function(t,i,n,a){return new e.view.ActionSheet({title:t,items:i,onSelect:n,onCancel:a})}})})(SUGAR.App)},function(e,t){(function(e){_.extend(e.nomad,{preInit:function(t,i){t.app.productVersion=e.config.appVersion;t.app.productBuild=e.config.appBuild;t.device=$.os;if(window.navigator.standalone){e.routing.replaceRoute("")}this.initAppCache();this.initAnalytics();if(!e.config.allowBrowserContextMenu&&$.browser.chromeWeb){window.addEventListener("contextmenu",function(e){e.preventDefault()})}if(e.offline&&e.config.offline)e.config.offline.storageAdapter="webSql";i()},initAppCache:function(){var t=window.applicationCache;if(!t)return;t.addEventListener("updateready",function(i){e.nomad.showConfirm(e.lang.get("LBL_NEW_WEB_VERSION"),function(){e.logger.debug("Swapping application cache and reloading page");t.swapCache();window.location.reload()})},false)},_showConfirm:function(e,t,i,n){var a=confirm(e);var o=a?2:1;t(o)},_showAlert:function(e,t,i,n){alert(e);if(t)t()},showPrompt:function(e,t,i){var n=window.prompt(e||"","");var a={buttonIndex:n!==null?2:1,input1:n};t(a)},_getConsoleLogFilename:function(e){e()},_showEmailComposer:function(e,t,i){window.location="mailto:"+i+"?subject="+(e||"")+"&body="+(t||"")},_showSmsComposer:function(e,t){if(t){if($.os.ios){window.location="sms:"+e+"&body="+t}else{window.location="sms:"+e+"?body="+t}}else{window.location="sms:"+e}},_callPhone:function(e){window.location="tel:"+e},_browseUrl:function(e){window.open(e)},_browseWebPage:function(e){window.open(e)},openAppStore:function(){},_browseDoc:function(e){if(e.oauth){this._downloadDoc(e)}else{this._browseUrl(e.url)}},_downloadDoc:function(t){var i=new window.XMLHttpRequest;var n="download_doc";i.open("GET",t.url);i.addEventListener("loadend",_.bind(function(){e.alert.dismiss(n);var a=this._getBlob(i.response,t.file_mime_type);this._makeBlobUrl(a,function(e){window.location=e})},this),false);i.setRequestHeader("OAuth-Token",e.api.getOAuthToken());i.overrideMimeType("application/octet-stream; charset=x-user-defined");i.responseType="arraybuffer";i.send(null);e.alert.show(n,{level:"info",messages:e.lang.get("LBL_MOBILE_DOWNLOAD_STARTED",null,t.filename),autoClose:true,closeable:false})},_getBlob:function(e,t){var i;try{i=new Blob([e],{type:t})}catch(n){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(n.name=="TypeError"&&window.BlobBuilder){var a=new BlobBuilder;a.append([e.buffer]);i=a.getBlob(t)}else if(n.name=="InvalidStateError"){i=new Blob([e.buffer],{type:t})}else{throw n}}return i},_makeBlobUrl:function(t,i){var n=window.URL||window.webkitURL;var a=$.os.ios&&(e.utils.versionCompare($.os.version,7,"<")||$.browser.chromeMobile);if(n&&!a){i(n.createObjectURL(t))}else{var o=new window.FileReader;o.onloadend=function(){i(o.result)};o.readAsDataURL(t)}},showActionSheet:function(t,i,n,a){e.view.ActionSheet.show(t,i,n,a)},_showDateTimePicker:function(e,t,i){},_share:function(t,i){var n=this;var a=[e.lang.get("LBL_EMAIL_BUTTON"),e.lang.get("LBL_SMS_BUTTON")];this.showActionSheet(e.lang.get("LBL_RECORD_SHARE_BUTTON"),a,function(e,i){n._executeActionSheetCallback(function(){var e=encodeURIComponent(t.body+"\r\n\r\n"+t.url);if(i===0){n._showEmailComposer(t.subject,e,"")}if(i===1){n._showSmsComposer("",e)}})})},initAnalytics:function(){Analytics=function(){};function e(){if(window.ga)ga.apply(window,arguments)}_.extend(Analytics.prototype,{start:function(t,i){e("create",t,"none");if(i.optOut){window["ga-disable-"+t]=true}e("set","anonymizeIp",i.anonymize)},startSession:function(){},trackPageView:function(t){e("send","pageview",t)},trackEvent:function(t){e("send","event",t.category,t.action,t.label,t.value)},setDimension:function(t){e("set","dimension"+t.index,t.value)},setMetric:function(t){e("set","metric"+t.index,t.value)}});analytics=new Analytics},loadAnalytics:function(){(function(e,t,i,n,a,o,s){e["GoogleAnalyticsObject"]=a;e[a]=e[a]||function(){(e[a].q=e[a].q||[]).push(arguments)},e[a].l=1*new Date;o=t.createElement(i),s=t.getElementsByTagName(i)[0];o.async=1;o.src=n;s.parentNode.insertBefore(o,s)})(window,document,"script","//www.google-analytics.com/analytics.js","ga")},getConnectionType:function(){return"none"},isOnline:function(){return window.navigator.onLine},handleExternalLogin:function(e,t){window.location.href=e.payload.url},handleExternalLogout:function(e){var t=new Image;t.src=e},handleAuthTokens:function(){var t;var i;var n=e[e.config.authStore];var a=["_AuthAccessToken","_AuthRefreshToken","_DownloadToken"];_.each(a,function(e){t=window.localStorage.getItem(e);if(t){i=true;n.set(e.slice(1),t);window.localStorage.removeItem(e)}});if(i){e.api.setExternalLogin(true);e.trigger("app:login:success")}},_redirectToNativeApp:function(){if($.os.desktop){return}$("<iframe />").attr("src","sugarcrm:///Configure?page="+encodeURIComponent(window.location.hash.substr(1))).attr("style","display:none;").appendTo("body")},openDb:function t(e){return window.openDatabase(e.name,"1.0",e.name,5)},_isPlatformSupported:function(){return $.os.ios&&$.browser.safari&&e.utils.versionCompare($.os.version,"8",">=")||$.os.android&&$.browser.chrome&&e.utils.versionCompare($.os.version,"4.1",">=")||!$.os.ios&&!$.os.android&&$.browser.webkit||e.config.env==="dev"}})})(SUGAR.App)},function(e,t){(function(e){_.extend(e.localSecurity,{_isTouchIdEnrolled:function(e){e(false)},_performTouchId:function(e,t){},_storeCredentials:function(e,t){},_resetCredentials:function(){}})})(SUGAR.App)},function(e,t){(function(e){e.view.views.ErrorEmulationView=e.view.NomadView.extend({globalEvents:{"app:error:emulation:exceptions":"processExceptions"},events:{"click .error-emulation-check input":"onClick","change .error-emulation-select":"onSelectChange"},initialize:function(t){var i=["app:error:emulation:offline","app:error:emulation:http","app:error:emulation:api","app:error:emulation:crud","app:error:emulation:exceptions"];_.each(i,function(t){e.events.unregister(e,t);e.events.register(t,e)});e.view.NomadView.prototype.initialize.call(this,t)},onBeforeRender:function(){var t=e.config.errorEmulation;var i=t.emulationExceptions;var n=_.findWhere(t.http,{status:true});var a=_.keys(t.api);var o;var s;if(n){o=_.contains(_.keys(i),n.name);if(i[n.name]){s=_.difference(a,i[n.name].methods)}}this.crudDisabled=o;this.offlineErrorItems={};_.each(t.offline,function(e,t){this.offlineErrorItems[t]=e.status},this);this.offlineDisabled=_.isEmpty(this.offlineErrorItems);this.httpErrorItems={};_.each(t.http,function(e){this.httpErrorItems[e.name]=e.status},this);this.apiErrorItems={};_.each(t.api,function(e,t){this.apiErrorItems[t]={status:e.status,crud:e.crud,disabled:s&&_.contains(s,t)}},this);if(!e.serverInfo.isSevenUp){delete this.apiErrorItems.follow}},onAfterRender:function(){this.$crudSelects=this.$el.find("[data-type=crud]");this.$apiBoxes=this.$el.find("[data-type=api]")},getHeaderData:function(){return{title:"Error Emulation",save:false,back:true}},onClick:function(t){var i=$(t.target).attr("data-type");var n=$(t.target).attr("class");var a="app:error:emulation:"+i;e.config.errorEmulation[i][n].status=!e.config.errorEmulation[i][n].status;e.trigger(a,n)},onSelectChange:function(t){var i=$(t.target).attr("data-type");var n=$(t.target).attr("data-parent-type");var a=t.target.value;var o="app:error:emulation:"+i;var s=n?e.config.errorEmulation.api[n][i]:e.config.errorEmulation[i];this.updateConfig(s,a);e.trigger(o,a)},updateConfig:function(e,t){var i=_.findWhere(e,{name:t});_.each(e,function(e){e.status=false});if(t!=="default"){i.status=true}},processExceptions:function(t){var i=this;if(t.code==="enableAll"){this.$crudSelects.prop("disabled",false);this.$apiBoxes.prop("disabled",false)}else{if(t.operation){this.$crudSelects.val(t.operation);_.each(this.$crudSelects,function(n){var a=$(n).attr("data-parent-type");var o=e.config.errorEmulation.api[a].crud;i.updateConfig(o,t.operation)});this.$crudSelects.prop("disabled","disabled")}if(t.methods){var n=_.map(t.methods,function(e){return"."+e}).join(", ");var a=this.$apiBoxes.not(n).prop("disabled","disabled").prop("checked",false);_.each(a,function(t){var i=t.className;e.config.errorEmulation.api[i].status=false})}}}})})(SUGAR.App)}]);