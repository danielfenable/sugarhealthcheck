function base64_encode(data){var b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var o1,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,enc="",tmp_arr=[];if(!data){return data;}
do{o1=data.charCodeAt(i++);o2=data.charCodeAt(i++);o3=data.charCodeAt(i++);bits=o1<<16|o2<<8|o3;h1=bits>>18&0x3f;h2=bits>>12&0x3f;h3=bits>>6&0x3f;h4=bits&0x3f;tmp_arr[ac++]=b64.charAt(h1)+b64.charAt(h2)+b64.charAt(h3)+b64.charAt(h4);}while(i<data.length);enc=tmp_arr.join('');var r=data.length%3;return(r?enc.slice(0,r-3):enc)+'==='.slice(r||3);}
/* End of File include/javascript/phpjs/base64_encode.js */


/*! http://mths.be/placeholder v2.0.8 by @mathias */
;(function(window,document,$){var isOperaMini=Object.prototype.toString.call(window.operamini)=='[object OperaMini]';var isInputSupported='placeholder'in document.createElement('input')&&!isOperaMini;var isTextareaSupported='placeholder'in document.createElement('textarea')&&!isOperaMini;var prototype=$.fn;var valHooks=$.valHooks;var propHooks=$.propHooks;var hooks;var placeholder;if(isInputSupported&&isTextareaSupported){placeholder=prototype.placeholder=function(){return this;};placeholder.input=placeholder.textarea=true;}else{placeholder=prototype.placeholder=function(){var $this=this;$this.filter((isInputSupported?'textarea':':input')+'[placeholder]').not('.placeholder').bind({'focus.placeholder':clearPlaceholder,'blur.placeholder':setPlaceholder}).data('placeholder-enabled',true).trigger('blur.placeholder');return $this;};placeholder.input=isInputSupported;placeholder.textarea=isTextareaSupported;hooks={'get':function(element){var $element=$(element);var $passwordInput=$element.data('placeholder-password');if($passwordInput){return $passwordInput[0].value;}
return $element.data('placeholder-enabled')&&$element.hasClass('placeholder')?'':element.value;},'set':function(element,value){var $element=$(element);var $passwordInput=$element.data('placeholder-password');if($passwordInput){return $passwordInput[0].value=value;}
if(!$element.data('placeholder-enabled')){return element.value=value;}
if(value==''){element.value=value;if(element!=safeActiveElement()){setPlaceholder.call(element);}}else if($element.hasClass('placeholder')){clearPlaceholder.call(element,true,value)||(element.value=value);}else{element.value=value;}
return $element;}};if(!isInputSupported){valHooks.input=hooks;propHooks.value=hooks;}
if(!isTextareaSupported){valHooks.textarea=hooks;propHooks.value=hooks;}
$(function(){$(document).delegate('form','submit.placeholder',function(){var $inputs=$('.placeholder',this).each(clearPlaceholder);setTimeout(function(){$inputs.each(setPlaceholder);},10);});});$(window).bind('beforeunload.placeholder',function(){$('.placeholder').each(function(){this.value='';});});}
function args(elem){var newAttrs={};var rinlinejQuery=/^jQuery\d+$/;$.each(elem.attributes,function(i,attr){if(attr.specified&&!rinlinejQuery.test(attr.name)){newAttrs[attr.name]=attr.value;}});return newAttrs;}
function clearPlaceholder(event,value){var input=this;var $input=$(input);if(input.value==$input.attr('placeholder')&&$input.hasClass('placeholder')){if($input.data('placeholder-password')){$input=$input.hide().next().show().attr('id',$input.removeAttr('id').data('placeholder-id'));if(event===true){return $input[0].value=value;}
$input.focus();}else{input.value='';$input.removeClass('placeholder');input==safeActiveElement()&&input.select();}}}
function setPlaceholder(){var $replacement;var input=this;var $input=$(input);var id=this.id;if(input.value==''){if(input.type=='password'){if(!$input.data('placeholder-textinput')){try{$replacement=$input.clone().attr({'type':'text'});}catch(e){$replacement=$('<input>').attr($.extend(args(this),{'type':'text'}));}
$replacement.removeAttr('name').data({'placeholder-password':$input,'placeholder-id':id}).bind('focus.placeholder',clearPlaceholder);$input.data({'placeholder-textinput':$replacement,'placeholder-id':id}).before($replacement);}
$input=$input.removeAttr('id').hide().prev().attr('id',id).show();}
$input.addClass('placeholder');$input[0].value=$input.attr('placeholder');}else{$input.removeClass('placeholder');}}
function safeActiveElement(){try{return document.activeElement;}catch(exception){}}}(this,document,jQuery));
/* End of File sidecar/lib/jquery-placeholder/jquery.placeholder.js */


+function($){"use strict";function transitionEnd(){var el=document.createElement('bootstrap')
var transEndEventNames={'WebkitTransition':'webkitTransitionEnd','MozTransition':'transitionend','OTransition':'oTransitionEnd otransitionend','transition':'transitionend'}
for(var name in transEndEventNames){if(el.style[name]!==undefined){return{end:transEndEventNames[name]}}}}
$.fn.emulateTransitionEnd=function(duration){var called=false,$el=this
$(this).one($.support.transition.end,function(){called=true})
var callback=function(){if(!called)$($el).trigger($.support.transition.end)}
setTimeout(callback,duration)
return this}
$(function(){$.support.transition=transitionEnd()})}(jQuery);
/* End of File include/javascript/twitterbootstrap/transition.js */

!function($){"use strict";var Button=function(element,options){this.$element=$(element)
this.options=$.extend({},$.fn.button.defaults,options)}
Button.prototype.setState=function(state){var d='disabled',$el=this.$element,data=$el.data(),val=$el.is('input')?'val':'html'
state=state+'Text'
data.resetText||$el.data('resetText',$el[val]())
$el[val](data[state]||this.options[state])
setTimeout(function(){state=='loadingText'?$el.addClass(d).attr(d,d):$el.removeClass(d).removeAttr(d)},0)}
Button.prototype.toggle=function(){var $parent=this.$element.closest('[data-toggle="buttons-radio"]')
$parent&&$parent.find('.active').removeClass('active')
this.$element.toggleClass('active')}
$.fn.button=function(option){return this.each(function(){var $this=$(this),data=$this.data('button'),options=typeof option=='object'&&option
if(!data)$this.data('button',(data=new Button(this,options)))
if(option=='toggle')data.toggle()
else if(option)data.setState(option)})}
$.fn.button.defaults={loadingText:'loading...'}
$.fn.button.Constructor=Button
$(document).on('click.button.data-api','[data-toggle^=button]',function(e){var $btn=$(e.target)
if(!$btn.hasClass('btn'))$btn=$btn.closest('.btn')
$btn.button('toggle')})}(window.jQuery);
/* End of File include/javascript/twitterbootstrap/bootstrap-button.js */


+function($){"use strict";var Tooltip=function(element,options){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null
this.init('tooltip',element,options)}
Tooltip.DEFAULTS={animation:true,placement:'top',selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:'hover focus',title:'',delay:0,html:false,container:false}
Tooltip.prototype.init=function(type,element,options){this.enabled=true
this.type=type
this.$element=$(element)
this.options=this.getOptions(options)
var triggers=this.options.trigger.split(' ')
for(var i=triggers.length;i--;){var trigger=triggers[i]
if(trigger=='click'){this.$element.on('click.'+this.type,this.options.selector,$.proxy(this.toggle,this))}else if(trigger!='manual'){var eventIn=trigger=='hover'?'mouseenter':'focus'
var eventOut=trigger=='hover'?'mouseleave':'blur'
this.$element.on(eventIn+'.'+this.type,this.options.selector,$.proxy(this.enter,this))
this.$element.on(eventOut+'.'+this.type,this.options.selector,$.proxy(this.leave,this))}}
this.options.selector?(this._options=$.extend({},this.options,{trigger:'manual',selector:''})):this.fixTitle()}
Tooltip.prototype.getDefaults=function(){return Tooltip.DEFAULTS}
Tooltip.prototype.getOptions=function(options){options=$.extend({},this.getDefaults(),this.$element.data(),options)
if(options.delay&&typeof options.delay=='number'){options.delay={show:options.delay,hide:options.delay}}
return options}
Tooltip.prototype.getDelegateOptions=function(){var options={}
var defaults=this.getDefaults()
this._options&&$.each(this._options,function(key,value){if(defaults[key]!=value)options[key]=value})
return options}
Tooltip.prototype.enter=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget)[this.type](this.getDelegateOptions()).data('bs.'+this.type)
clearTimeout(self.timeout)
self.hoverState='in'
if(!self.options.delay||!self.options.delay.show)return self.show()
self.timeout=setTimeout(function(){if(self.hoverState=='in')self.show()},self.options.delay.show)}
Tooltip.prototype.leave=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget)[this.type](this.getDelegateOptions()).data('bs.'+this.type)
clearTimeout(self.timeout)
self.hoverState='out'
if(!self.options.delay||!self.options.delay.hide)return self.hide()
self.timeout=setTimeout(function(){if(self.hoverState=='out')self.hide()},self.options.delay.hide)}
Tooltip.prototype.show=function(){var e=$.Event('show.bs.'+this.type)
if(this.hasContent()&&this.enabled){this.$element.trigger(e)
if(e.isDefaultPrevented())return
var $tip=this.tip()
this.setContent()
if(this.options.animation)$tip.addClass('fade')
var placement=typeof this.options.placement=='function'?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement
var autoToken=/\s?auto?\s?/i
var autoPlace=autoToken.test(placement)
if(autoPlace)placement=placement.replace(autoToken,'')||'top'
$tip.detach().css({top:0,left:0,display:'block'}).addClass(placement)
this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element)
var pos=this.getPosition()
var actualWidth=$tip[0].offsetWidth
var actualHeight=$tip[0].offsetHeight
if(autoPlace){var $parent=this.$element.parent()
var orgPlacement=placement
var docScroll=document.documentElement.scrollTop||document.body.scrollTop
var parentWidth=this.options.container=='body'?window.innerWidth:$parent.outerWidth()
var parentHeight=this.options.container=='body'?window.innerHeight:$parent.outerHeight()
var parentLeft=this.options.container=='body'?0:$parent.offset().left
placement=placement=='bottom'&&pos.top+pos.height+actualHeight-docScroll>parentHeight?'top':placement=='top'&&pos.top-docScroll-actualHeight<0?'bottom':placement=='right'&&pos.right+actualWidth>parentWidth?'left':placement=='left'&&pos.left-actualWidth<parentLeft?'right':placement
$tip.removeClass(orgPlacement).addClass(placement)}
var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight)
this.applyPlacement(calculatedOffset,placement)
this.$element.trigger('shown.bs.'+this.type)}}
Tooltip.prototype.applyPlacement=function(offset,placement){var replace
var $tip=this.tip()
var width=$tip[0].offsetWidth
var height=$tip[0].offsetHeight
var marginTop=parseInt($tip.css('margin-top'),10)
var marginLeft=parseInt($tip.css('margin-left'),10)
if(isNaN(marginTop))marginTop=0
if(isNaN(marginLeft))marginLeft=0
offset.top=offset.top+marginTop
offset.left=offset.left+marginLeft
$tip.offset(offset).addClass('in')
var actualWidth=$tip[0].offsetWidth
var actualHeight=$tip[0].offsetHeight
if(placement=='top'&&actualHeight!=height){replace=true
offset.top=offset.top+height-actualHeight}
if(/bottom|top/.test(placement)){var delta=0
if(offset.left<0){delta=offset.left*-2
offset.left=0
$tip.offset(offset)
actualWidth=$tip[0].offsetWidth
actualHeight=$tip[0].offsetHeight}
this.replaceArrow(delta-width+actualWidth,actualWidth,'left')}else{this.replaceArrow(actualHeight-height,actualHeight,'top')}
if(replace)$tip.offset(offset)}
Tooltip.prototype.replaceArrow=function(delta,dimension,position){this.arrow().css(position,delta?(50*(1-delta / dimension)+"%"):'')}
Tooltip.prototype.setContent=function(){var $tip=this.tip()
var title=this.getTitle()
$tip.find('.tooltip-inner')[this.options.html?'html':'text'](title)
$tip.removeClass('fade in top bottom left right')}
Tooltip.prototype.hide=function(){var that=this
var $tip=this.tip()
var e=$.Event('hide.bs.'+this.type)
function complete(){if(that.hoverState!='in')$tip.detach()}
this.$element.trigger(e)
if(e.isDefaultPrevented())return
$tip.removeClass('in')
$.support.transition&&this.$tip.hasClass('fade')?$tip.one($.support.transition.end,complete).emulateTransitionEnd(150):complete()
this.$element.trigger('hidden.bs.'+this.type)
return this}
Tooltip.prototype.fixTitle=function(){var $e=this.$element
if($e.attr('title')||typeof($e.attr('data-original-title'))!='string'){$e.attr('data-original-title',$e.attr('title')||'').attr('title','')}}
Tooltip.prototype.hasContent=function(){return this.getTitle()}
Tooltip.prototype.getPosition=function(){var el=this.$element[0]
return $.extend({},(typeof el.getBoundingClientRect=='function')?el.getBoundingClientRect():{width:el.offsetWidth,height:el.offsetHeight},this.$element.offset())}
Tooltip.prototype.getCalculatedOffset=function(placement,pos,actualWidth,actualHeight){return placement=='bottom'?{top:pos.top+pos.height,left:pos.left+pos.width / 2-actualWidth / 2}:placement=='top'?{top:pos.top-actualHeight,left:pos.left+pos.width / 2-actualWidth / 2}:placement=='left'?{top:pos.top+pos.height / 2-actualHeight / 2,left:pos.left-actualWidth}:{top:pos.top+pos.height / 2-actualHeight / 2,left:pos.left+pos.width}}
Tooltip.prototype.getTitle=function(){var title
var $e=this.$element
var o=this.options
title=$e.attr('data-original-title')||(typeof o.title=='function'?o.title.call($e[0]):o.title)
return title}
Tooltip.prototype.tip=function(){return this.$tip=this.$tip||$(this.options.template)}
Tooltip.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find('.tooltip-arrow')}
Tooltip.prototype.validate=function(){if(!this.$element[0].parentNode){this.hide()
this.$element=null
this.options=null}}
Tooltip.prototype.enable=function(){this.enabled=true}
Tooltip.prototype.disable=function(){this.enabled=false}
Tooltip.prototype.toggleEnabled=function(){this.enabled=!this.enabled}
Tooltip.prototype.toggle=function(e){var self=e?$(e.currentTarget)[this.type](this.getDelegateOptions()).data('bs.'+this.type):this
self.tip().hasClass('in')?self.leave(self):self.enter(self)}
Tooltip.prototype.destroy=function(){this.hide().$element.off('.'+this.type).removeData('bs.'+this.type)}
var old=$.fn.tooltip
$.fn.tooltip=function(option){return this.each(function(){var $this=$(this)
var data=$this.data('bs.tooltip')
var options=typeof option=='object'&&option
if(!data)$this.data('bs.tooltip',(data=new Tooltip(this,options)))
if(typeof option=='string')data[option]()})}
$.fn.tooltip.Constructor=Tooltip
$.fn.tooltip.noConflict=function(){$.fn.tooltip=old
return this}}(window.jQuery);
/* End of File include/javascript/twitterbootstrap/bootstrap-tooltip.js */


+function($){"use strict";var backdrop='.dropdown-backdrop'
var toggle='[data-toggle=dropdown]'
var Dropdown=function(element){var $el=$(element).on('click.bs.dropdown',this.toggle)}
Dropdown.prototype.toggle=function(e){var $this=$(this)
if($this.is('.disabled, :disabled'))return
var $parent=getParent($this)
var isActive=$parent.hasClass('open')
clearMenus()
if(!isActive){if('ontouchstart'in document.documentElement&&!$parent.closest('.navbar-nav').length){$('<div class="dropdown-backdrop"/>').insertAfter($(this)).on('click',clearMenus)}
$parent.trigger(e=$.Event('show.bs.dropdown'))
if(e.isDefaultPrevented())return
$parent.toggleClass('open').trigger('shown.bs.dropdown')
$this.focus()}
return false}
Dropdown.prototype.keydown=function(e){if(!/(38|40|27)/.test(e.keyCode))return
var $this=$(this)
e.preventDefault()
e.stopPropagation()
if($this.is('.disabled, :disabled'))return
var $parent=getParent($this)
var isActive=$parent.hasClass('open')
if(!isActive||(isActive&&e.keyCode==27)){if(e.which==27)$parent.find(toggle).focus()
return $this.click()}
var $items=$('[role=menu] li:not(.divider):visible a',$parent)
if(!$items.length)return
var index=$items.index($items.filter(':focus'))
if(e.keyCode==38&&index>0)index--
if(e.keyCode==40&&index<$items.length-1)index++
if(!~index)index=0
$items.eq(index).focus()}
function clearMenus(){$(backdrop).remove()
$(toggle).each(function(e){var $parent=getParent($(this))
if(!$parent.hasClass('open'))return
$parent.trigger(e=$.Event('hide.bs.dropdown'))
if(e.isDefaultPrevented())return
$parent.removeClass('open').trigger('hidden.bs.dropdown')})}
function getParent($this){var selector=$this.attr('data-target')
if(!selector){selector=$this.attr('href')
selector=selector&&/#/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,'')}
var $parent=selector&&$(selector)
return $parent&&$parent.length?$parent:$this.parent()}
var old=$.fn.dropdown
$.fn.dropdown=function(option){return this.each(function(){var $this=$(this)
var data=$this.data('dropdown')
if(!data)$this.data('dropdown',(data=new Dropdown(this)))
if(typeof option=='string')data[option].call($this)})}
$.fn.dropdown.Constructor=Dropdown
$.fn.dropdown.noConflict=function(){$.fn.dropdown=old
return this}
$(document).on('click.bs.dropdown.data-api',clearMenus).on('click.bs.dropdown.data-api','.dropdown form',function(e){e.stopPropagation()}).on('click.bs.dropdown.data-api',toggle,Dropdown.prototype.toggle).on('keydown.bs.dropdown.data-api',toggle+', [role=menu]',Dropdown.prototype.keydown)}(window.jQuery);
/* End of File include/javascript/twitterbootstrap/bootstrap-dropdown.js */


+function($){"use strict";var Popover=function(element,options){this.init('popover',element,options)}
if(!$.fn.tooltip)throw new Error('Popover requires tooltip.js')
Popover.DEFAULTS=$.extend({},$.fn.tooltip.Constructor.DEFAULTS,{placement:'right',trigger:'click',content:'',template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'})
Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype)
Popover.prototype.constructor=Popover
Popover.prototype.getDefaults=function(){return Popover.DEFAULTS}
Popover.prototype.setContent=function(){var $tip=this.tip()
var title=this.getTitle()
var content=this.getContent()
$tip.find('.popover-title')[this.options.html?'html':'text'](title)
$tip.find('.popover-content')[this.options.html?'html':'text'](content)
$tip.removeClass('fade top bottom left right in')
if(!$tip.find('.popover-title').html())$tip.find('.popover-title').hide()}
Popover.prototype.hasContent=function(){return this.getTitle()||this.getContent()}
Popover.prototype.getContent=function(){var $e=this.$element
var o=this.options
return $e.attr('data-content')||(typeof o.content=='function'?o.content.call($e[0]):o.content)}
Popover.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find('.arrow')}
Popover.prototype.tip=function(){if(!this.$tip)this.$tip=$(this.options.template)
return this.$tip}
var old=$.fn.popover
$.fn.popover=function(option){return this.each(function(){var $this=$(this)
var data=$this.data('bs.popover')
var options=typeof option=='object'&&option
if(!data)$this.data('bs.popover',(data=new Popover(this,options)))
if(typeof option=='string')data[option]()})}
$.fn.popover.Constructor=Popover
$.fn.popover.noConflict=function(){$.fn.popover=old
return this}}(jQuery);
/* End of File include/javascript/twitterbootstrap/bootstrap-popover.js */

!function($){"use strict";var Modal=function(element,options){this.options=options
this.$element=$(element).delegate('[data-dismiss="modal"]','click.dismiss.modal',$.proxy(this.hide,this))
this.options.remote&&this.$element.find('.modal-body').load(this.options.remote)}
Modal.prototype={constructor:Modal,toggle:function(){return this[!this.isShown?'show':'hide']()},show:function(){var that=this,e=$.Event('show')
this.$element.trigger(e)
if(this.isShown||e.isDefaultPrevented())return
this.isShown=true
this.escape()
this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass('fade')
if(!that.$element.parent().length){that.$element.appendTo(document.body)}
that.$element.show()
if(transition){that.$element[0].offsetWidth}
that.$element.addClass('in').attr('aria-hidden',false)
that.enforceFocus()
transition?that.$element.one($.support.transition.end,function(){that.$element.focus().trigger('shown')}):that.$element.focus().trigger('shown')})},hide:function(e){e&&e.preventDefault()
var that=this
e=$.Event('hide')
this.$element.trigger(e)
if(!this.isShown||e.isDefaultPrevented())return
this.isShown=false
this.escape()
$(document).off('focusin.modal')
this.$element.removeClass('in').attr('aria-hidden',true)
$.support.transition&&this.$element.hasClass('fade')?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var that=this
$(document).on('focusin.modal',function(e){if(that.$element[0]!==e.target&&!that.$element.has(e.target).length){that.$element.focus()}})},escape:function(){var that=this
if(this.isShown&&this.options.keyboard){this.$element.on('keyup.dismiss.modal',function(e){e.which==27&&that.hide()})}else if(!this.isShown){this.$element.off('keyup.dismiss.modal')}},hideWithTransition:function(){var that=this,timeout=setTimeout(function(){that.$element.off($.support.transition.end)
that.hideModal()},500)
this.$element.one($.support.transition.end,function(){clearTimeout(timeout)
that.hideModal()})},hideModal:function(that){this.$element.hide().trigger('hidden')
this.backdrop()},removeBackdrop:function(){this.$backdrop.remove()
this.$backdrop=null},backdrop:function(callback){var that=this,animate=this.$element.hasClass('fade')?'fade':''
if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate
this.$backdrop=$('<div class="modal-backdrop '+animate+'" />').appendTo(document.body)
this.$backdrop.click(this.options.backdrop=='static'?$.proxy(this.$element[0].focus,this.$element[0]):$.proxy(this.hide,this))
if(doAnimate)this.$backdrop[0].offsetWidth
this.$backdrop.addClass('in')
doAnimate?this.$backdrop.one($.support.transition.end,callback):callback()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass('in')
$.support.transition&&this.$element.hasClass('fade')?this.$backdrop.one($.support.transition.end,$.proxy(this.removeBackdrop,this)):this.removeBackdrop()}else if(callback){callback()}}}
$.fn.modal=function(option){return this.each(function(){var $this=$(this),data=$this.data('modal'),options=$.extend({},$.fn.modal.defaults,$this.data(),typeof option=='object'&&option)
if(!data)$this.data('modal',(data=new Modal(this,options)))
if(typeof option=='string')data[option]()
else if(options.show)data.show()})}
$.fn.modal.defaults={backdrop:true,keyboard:true,show:true}
$.fn.modal.Constructor=Modal
$(document).on('click.modal.data-api','[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr('href'),$target=$($this.attr('data-target')||(href&&href.replace(/.*(?=#[^\s]+$)/,''))),option=$target.data('modal')?'toggle':$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data())
e.preventDefault()
$target.modal(option).one('hide',function(){$this.focus()})})}(window.jQuery);
/* End of File include/javascript/twitterbootstrap/bootstrap-modal.js */

!function($){"use strict";var dismiss='[data-dismiss="alert"]',Alert=function(el){$(el).on('click',dismiss,this.close)}
Alert.prototype.close=function(e){var $this=$(this),selector=$this.attr('data-target'),$parent
if(!selector){selector=$this.attr('href')
selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,'')}
$parent=$(selector)
e&&e.preventDefault()
$parent.length||($parent=$this.hasClass('alert')?$this:$this.parent())
$parent.trigger(e=$.Event('close'))
if(e.isDefaultPrevented())return
$parent.removeClass('in')
function removeElement(){$parent.trigger('closed').remove()}
$.support.transition&&$parent.hasClass('fade')?$parent.on($.support.transition.end,removeElement):removeElement()}
$.fn.alert=function(option){return this.each(function(){var $this=$(this),data=$this.data('alert')
if(!data)$this.data('alert',(data=new Alert(this)))
if(typeof option=='string')data[option].call($this)})}
$.fn.alert.Constructor=Alert
$(document).on('click.alert.data-api',dismiss,Alert.prototype.close)}(window.jQuery);
/* End of File include/javascript/twitterbootstrap/bootstrap-alert.js */

!function($){var Datepicker=function(element,options){this.element=$(element);this.rawFormat=options.format||this.element.data('date-format')||'mm/dd/yyyy';this.appendTo=options.appendTo;this.format=DPGlobal.parseFormat(this.rawFormat);this.possibleChars=DPGlobal.getPossibleDateChars(this.rawFormat);this.picker=$(DPGlobal.template).appendTo(this.appendTo?this.appendTo:"body").on({click:$.proxy(this.click,this),mousedown:$.proxy(this.mousedown,this)});this.isInput=this.element.is('input');this.component=this.element.is('.date')?this.element.find('.add-on'):false;if(this.isInput){this.element.on({focus:$.proxy(this.show,this),blur:$.proxy(this.hide,this),keyup:$.proxy(this.update,this),keydown:$.proxy(this.keydown,this),keypress:$.proxy(this.keypress,this),click:$.proxy(this.click,this)});if(this.element.parent().find('.add-on').length){this.element.parent().find('.add-on[data-icon=calendar]').on({click:$.proxy(this.focusShow,this)});}}else{if(this.component){this.component.on('click',$.proxy(this.show,this));}else{this.element.on('click',$.proxy(this.show,this));}}
this.minViewMode=options.minViewMode||this.element.data('date-minviewmode')||0;if(typeof this.minViewMode==='string'){switch(this.minViewMode){case'months':this.minViewMode=1;break;case'years':this.minViewMode=2;break;default:this.minViewMode=0;break;}}
this.viewMode=options.viewMode||this.element.data('date-viewmode')||0;if(typeof this.viewMode==='string'){switch(this.viewMode){case'months':this.viewMode=1;break;case'years':this.viewMode=2;break;default:this.viewMode=0;break;}}
this.startViewMode=this.viewMode;this.weekStart=options.weekStart||this.element.data('date-weekstart')||0;this.enableKeyboard=options.enableKeyboard||true;if(options.languageDictionary){this.languageDictionary(options.languageDictionary);}
this.weekEnd=this.weekStart===0?6:this.weekStart-1;this.dates=options.languageDictionary||{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};this.fillDow();this.fillMonths();this.update();this.showMode();};Datepicker.prototype={constructor:Datepicker,languageDictionary:function(datesLangDict){var reqPropsIndx,requiredProperties=['days','daysShort','months','monthsShort'];for(reqPropsIndx=0;reqPropsIndx<requiredProperties.length;reqPropsIndx++){if(typeof datesLangDict[requiredProperties[reqPropsIndx]]==='undefined'){return false;}}
this.dates=datesLangDict;return true;},getLanguageDictionary:function(){return this.dates;},focusShow:function(e){this.element[0].focus();},show:function(e){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();$(window).on('resize',$.proxy(this.place,this));if(e){e.stopPropagation();e.preventDefault();}
if(!this.isInput){$(document).on('mousedown',$.proxy(this.hide,this));}
this.element.trigger({type:'show',date:this.date});this.hidden=false;},hide:function(){this.picker.hide();this.hidden=true;$(window).off('resize',this.place);this.viewMode=this.startViewMode;this.showMode();if(!this.isInput){$(document).off('mousedown',this.hide);}else{if(!this.verifyDate(this.element.val())){this.element.trigger({type:'hide'});return;}}
this.setValue(this.element.val());this.element.trigger({type:'hide',date:this.date});},set:function(){var formated=DPGlobal.formatDate(this.date,this.format);if(!this.isInput){if(this.component){this.element.find('input').prop('value',formated);}
this.element.data('date',formated);}else{this.element.prop('value',formated);}},setValue:function(newDate){if(typeof newDate==='string'){this.date=DPGlobal.parseDate(newDate,this.format).dateObject;}else{this.date=new Date(newDate);}
this.set();this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0);this.fill();},place:function(){var offset=this.component?this.component.offset():this.element.offset();if(this.appendTo&&this.appendTo!="body"){offset.left=(this.element.offset().left-$(this.appendTo).offset().left)+$(this.appendTo).scrollLeft();offset.top=(this.element.offset().top-$(this.appendTo).offset().top)+$(this.appendTo).scrollTop();}
this.picker.css({top:offset.top+this.height,left:offset.left});},verifyDate:function(dateString){return DPGlobal.parseDate(dateString,this.format).inputDateStringWasValid;},verifyInput:function(dateInput){return this.possibleChars.toLowerCase().indexOf(dateInput)!==-1;},update:function(newDate){var dateInput=typeof newDate==='string'?newDate:(this.isInput?this.element.prop('value'):this.element.data('date'));this.date=DPGlobal.parseDate(dateInput,this.format).dateObject;try{this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0);this.fill();}catch(e){}
return true;},fillDow:function(){var dowCnt=this.weekStart;var html='<tr>';while(dowCnt<this.weekStart+7){html+='<th class="dow">'+this.dates.daysShort[(dowCnt++)%7]+'</th>';}
html+='</tr>';this.picker.find('.datepicker-days thead').append(html);},fillMonths:function(){var html='';var i=0;while(i<12){html+='<span class="month">'+this.dates.monthsShort[i++]+'</span>';}
this.picker.find('.datepicker-months td').append(html);},fill:function(){var d=new Date(this.viewDate),year=d.getFullYear(),month=d.getMonth(),currentDate=this.date.valueOf();this.picker.find('.datepicker-days th:eq(1)').text(this.dates.months[month]+' '+year);var prevMonth=new Date(year,month-1,28,0,0,0,0),day=DPGlobal.getDaysInMonth(prevMonth.getFullYear(),prevMonth.getMonth());prevMonth.setDate(day);prevMonth.setDate(day-(prevMonth.getDay()-this.weekStart+7)%7);var nextMonth=new Date(prevMonth);nextMonth.setDate(nextMonth.getDate()+42);nextMonth=nextMonth.valueOf();var html=[];var clsName,prevY,prevM;while(prevMonth.valueOf()<nextMonth){if(prevMonth.getDay()===this.weekStart){html.push('<tr>');}
clsName='';prevY=prevMonth.getFullYear();prevM=prevMonth.getMonth();if((prevM<month&&prevY===year)||prevY<year){clsName+=' old';}else if((prevM>month&&prevY===year)||prevY>year){clsName+=' new';}
if(prevMonth.valueOf()===currentDate){clsName+=' active';}
html.push('<td class="day'+clsName+'">'+prevMonth.getDate()+'</td>');if(prevMonth.getDay()===this.weekEnd){html.push('</tr>');}
prevMonth.setDate(prevMonth.getDate()+1);}
this.picker.find('.datepicker-days tbody').empty().append(html.join(''));var currentYear=this.date.getFullYear();var months=this.picker.find('.datepicker-months').find('th:eq(1)').text(year).end().find('span').removeClass('active');if(currentYear===year){months.eq(this.date.getMonth()).addClass('active');}
html='';year=parseInt(year/10,10)*10;var yearCont=this.picker.find('.datepicker-years').find('th:eq(1)').text(year+'-'+(year+9)).end().find('td');year-=1;for(var i=-1;i<11;i++){html+='<span class="year'+(i===-1||i===10?' old':'')+(currentYear===year?' active':'')+'">'+year+'</span>';year+=1;}
yearCont.html(html);},keypress:function(e){function isFirefoxDeleteOrTabKey(){if(e.keyCode===46&&e.which===0||e.keyCode===9&&e.which===0){return true;}
return false;}
switch(e.keyCode){case 27:case 33:case 34:case 36:case 35:case 37:case 39:case 38:case 40:case 32:case 13:case 8:break;default:if(!isFirefoxDeleteOrTabKey()){var chr=String.fromCharCode(e.which);if(!this.verifyInput(chr)){e.preventDefault();}}
break;}},keydown:function(e){var self=this,sign,day,month,direction,newDate,newViewDate,dateChanged=false,element,isYearBasedMove,yearMultiplier;function _updateDate(type,sign,multiplier){multiplier=multiplier||1;if(type==='months'){newDate=DPGlobal.multiplyMonths(self.date,sign,(1*multiplier));newViewDate=DPGlobal.multiplyMonths(self.viewDate,sign,(1*multiplier));}else{newDate=new Date(self.date);newDate.setDate(self.date.getDate()+(sign*multiplier));newViewDate=new Date(self.viewDate);newViewDate.setDate(self.viewDate.getDate()+(sign*multiplier));}
dateChanged=true;}
switch(e.keyCode){case 27:this.hide();e.preventDefault();break;case 33:case 34:if(!this.enableKeyboard)break;direction=e.keyCode==33?-1:1;yearMultiplier=(e.shiftKey)?12:1;_updateDate('months',direction,yearMultiplier);break;case 36:case 35:if(!this.enableKeyboard)break;direction=e.keyCode==36?-1:1;isYearBasedMove=(e.shiftKey)?true:false;if(isYearBasedMove){if(direction<0){day=1;month=0;}else{day=31;month=11;}
newDate=new Date(self.date.getFullYear(),month,day,0,0,0);newViewDate=new Date(self.viewDate.getFullYear(),month,day,0,0,0);}else{day=(direction<0)?1:0;addmonth=(direction<0)?0:1;newDate=new Date(self.date.getFullYear(),(self.date.getMonth()+addmonth),day,0,0,0);newViewDate=new Date(self.viewDate.getFullYear(),(self.viewDate.getMonth()+addmonth),day,0,0,0);}
dateChanged=true;break;case 37:case 39:if(!this.enableKeyboard)break;direction=e.keyCode==37?-1:1;_updateDate('days',direction);break;case 38:case 40:if(!this.enableKeyboard)break;direction=e.keyCode==38?-1:1;_updateDate('days',direction,7);break;case 32:case 13:this.hide();e.preventDefault();break;default:break;}
if(dateChanged){this.date=newDate;this.viewDate=newViewDate;this.setValue(this.date);this.update(this.date);e.preventDefault();this.element.trigger({type:'changeDate',date:this.date});if(this.isInput){element=this.element;}else if(this.component){element=this.element.find('input');}
if(element){element.change();}}},click:function(e){e.stopPropagation();e.preventDefault();var target=$(e.target).closest('span, td, th, input');if(target.length===1){switch(target[0].nodeName.toLowerCase()){case'input':if(this.hidden){this.show();}
break;case'th':switch(target[0].className){case'switch':this.showMode(1);break;case'prev':case'next':this.viewDate['set'+DPGlobal.modes[this.viewMode].navFnc].call(this.viewDate,this.viewDate['get'+DPGlobal.modes[this.viewMode].navFnc].call(this.viewDate)+
DPGlobal.modes[this.viewMode].navStep*(target[0].className==='prev'?-1:1));this.fill();this.set();break;}
break;case'span':if(target.is('.month')){var month=target.parent().find('span').index(target);this.viewDate.setMonth(month);}else{var year=parseInt(target.text(),10)||0;this.viewDate.setFullYear(year);}
if(this.viewMode!==0){this.date=new Date(this.viewDate);this.element.trigger({type:'changeDate',date:this.date,viewMode:DPGlobal.modes[this.viewMode].clsName});}
this.showMode(-1);this.fill();this.set();break;case'td':if(target.is('.day')){var day=parseInt(target.text(),10)||1;var month=this.viewDate.getMonth();if(target.is('.old')){month-=1;}else if(target.is('.new')){month+=1;}
var year=this.viewDate.getFullYear();this.date=new Date(year,month,day,0,0,0,0);this.viewDate=new Date(year,month,Math.min(28,day),0,0,0,0);this.fill();this.set();this.element.trigger({type:'changeDate',date:this.date,viewMode:DPGlobal.modes[this.viewMode].clsName});this.hide();}
break;}}},mousedown:function(e){e.stopPropagation();e.preventDefault();},showMode:function(dir){if(dir){this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+dir));}
this.picker.find('>div').hide().filter('.datepicker-'+DPGlobal.modes[this.viewMode].clsName).show();}};$.fn.datepicker=function(option,val){return this.each(function(){var $this=$(this),data=$this.data('datepicker'),options=typeof option==='object'&&option;if(($this).hasClass('dropdown-menu')!==true){if(!data){$this.data('datepicker',(data=new Datepicker(this,$.extend({},$.fn.datepicker.defaults,options))));}
if(typeof option==='string')data[option](val);}});};$.fn.DateVerifier=function(dateString,format){var formatObject=DPGlobal.parseFormat(format);return DPGlobal.parseDate(dateString,formatObject).inputDateStringWasValid;};$.fn.datepicker.defaults={};$.fn.datepicker.Constructor=Datepicker;var DPGlobal={modes:[{clsName:'days',navFnc:'Month',navStep:1},{clsName:'months',navFnc:'FullYear',navStep:1},{clsName:'years',navFnc:'FullYear',navStep:10}],isLeapYear:function(year){return(((year%4===0)&&(year%100!==0))||(year%400===0));},multiplyMonths:function(d,sign,term){var originalDate=d.getDate(),newDate;term=term||1;d.setMonth(d.getMonth()+(sign*term));newDate=d.getDate();if(newDate<originalDate){d.setDate(1);d.setDate(d.getDate()-1);}
return d;},getDaysInMonth:function(year,month){return[31,(DPGlobal.isLeapYear(year)?29:28),31,30,31,30,31,31,30,31,30,31][month];},getPossibleDateChars:function(format){var i,len,chars;chars='0123456789';done:for(i=0,len=format.length;i<len;i++){switch(format.charAt(i)){case'/':case'.':case'-':chars+=format.charAt(i);break done;default:break;}}
return chars;},parseFormat:function(format){var separator=format.match(/[.\/\-\s].*?/),parts=format.split(/\W+/);if(!separator||!parts||parts.length===0){throw new Error("Invalid date format.");}
return{separator:separator,parts:parts};},parseDate:function(dateIn,format){var parts=dateIn.split(format.separator),date=new Date(),isLegalDate=true,val,i,cnt,originalDate,len,monthsSet=false,dayValue=null,isValid=true;isValid=dateIn.lastIndexOf(format.separator)!==-1;date.setHours(0);date.setMinutes(0);date.setSeconds(0);date.setMilliseconds(0);function _setDate(theDay){if(_isInRange(theDay,1,31)){date.setDate(theDay);if(date.getDate()<theDay){date.setDate(0);}}else{isValid=false;}}
function _isInRange(val,min,max){var value=parseInt(val,10);return(!isNaN(value)&&value>=min&&value<=max);}
function century(){return new Date().getFullYear().toString().substr(0,2);}
function twoDigitString(n){return n.toString().length===1?'0'+n:n.toString();}
if(parts.length===format.parts.length){for(i=0,cnt=format.parts.length;i<cnt;i++){if(!parts[i]){return false;}
val=parseInt(parts[i],10);switch(format.parts[i]){case'dd':case'd':if(!monthsSet){dayValue=val;}else{_setDate(val);}
break;case'mm':case'm':if(_isInRange(val,1,12)){originalDate=date.getDate();date.setMonth(val-1);if(date.getDate()<originalDate){date.setDate(0);}
if(dayValue){_setDate(dayValue);}
monthsSet=true;}else{isValid=false;}
break;case'yy':len=val.toString().length;if(len===4&&century()===val.toString().substr(0,2)){date.setFullYear(century()+val.toString().substr(-2));}
else if(_isInRange(val,0,99)){date.setFullYear(century()+twoDigitString(val));}else{isValid=false;}
break;case'yyyy':len=val.toString().length;if(_isInRange(val,0,9999)){if(len<3){date.setFullYear(century()+twoDigitString(val));}
else if(len===3){isValid=false;}else{date.setFullYear(val);}}else{isValid=false;}
break;}}}else{isValid=false;}
return{'dateObject':date,'inputDateStringWasValid':isValid};},formatDate:function(date,format){var val={d:date.getDate(),m:date.getMonth()+1,yy:date.getFullYear().toString().substring(2),yyyy:date.getFullYear()};val.dd=(val.d<10?'0':'')+val.d;val.mm=(val.m<10?'0':'')+val.m;var date=[];for(var i=0,cnt=format.parts.length;i<cnt;i++){date.push(val[format.parts[i]]);}
return date.join(format.separator);},headTemplate:'<thead>'+'<tr>'+'<th class="prev">&lsaquo;</th>'+'<th colspan="5" class="switch"></th>'+'<th class="next">&rsaquo;</th>'+'</tr>'+'</thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'};DPGlobal.template='<div class="datepicker dropdown-menu">'+'<div class="datepicker-days">'+'<table class=" table-condensed">'+
DPGlobal.headTemplate+'<tbody></tbody>'+'</table>'+'</div>'+'<div class="datepicker-months">'+'<table class="table-condensed">'+
DPGlobal.headTemplate+
DPGlobal.contTemplate+'</table>'+'</div>'+'<div class="datepicker-years">'+'<table class="table-condensed">'+
DPGlobal.headTemplate+
DPGlobal.contTemplate+'</table>'+'</div>'+'</div>';}(window.jQuery);
/* End of File include/javascript/twitterbootstrap/bootstrap-datepicker.js */

!function($){"use strict";var Tab=function(element){this.element=$(element)}
Tab.prototype={constructor:Tab,show:function(){var $this=this.element,$ul=$this.closest('ul:not(.dropdown-menu)'),selector=$this.attr('data-target'),previous,$target,e
if(!selector){selector=$this.attr('href')
selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,'')}
if($this.parent('li').hasClass('active'))return
previous=$ul.find('.active:last a')[0]
e=$.Event('show',{relatedTarget:previous})
$this.trigger(e)
if(e.isDefaultPrevented())return
$target=$(selector)
this.activate($this.parent('li'),$ul)
this.activate($target,$target.parent(),function(){$this.trigger({type:'shown',relatedTarget:previous})})},activate:function(element,container,callback){var $active=container.find('> .active'),transition=callback&&$.support.transition&&$active.hasClass('fade')
function next(){$active.removeClass('active').find('> .dropdown-menu > .active').removeClass('active')
element.addClass('active')
if(transition){element[0].offsetWidth
element.addClass('in')}else{element.removeClass('fade')}
if(element.parent('.dropdown-menu')){element.closest('li.dropdown').addClass('active')}
callback&&callback()}
transition?$active.one($.support.transition.end,next):next()
$active.removeClass('in')}}
$.fn.tab=function(option){return this.each(function(){var $this=$(this),data=$this.data('tab')
if(!data)$this.data('tab',(data=new Tab(this)))
if(typeof option=='string')data[option]()})}
$.fn.tab.Constructor=Tab
$(document).on('click.tab.data-api','[data-toggle="tab"], [data-toggle="pill"]',function(e){e.preventDefault()
$(this).tab('show')})}(window.jQuery);
/* End of File include/javascript/twitterbootstrap/bootstrap-tab.js */

!function($){"use strict";var Collapse=function(element,options){this.$element=$(element)
this.options=$.extend({},$.fn.collapse.defaults,options)
if(this.options.parent){this.$parent=$(this.options.parent)}
this.options.toggle&&this.toggle()}
Collapse.prototype={constructor:Collapse,dimension:function(){var hasWidth=this.$element.hasClass('width')
return hasWidth?'width':'height'},show:function(){var dimension,scroll,actives,hasData
if(this.transitioning)return
dimension=this.dimension()
scroll=$.camelCase(['scroll',dimension].join('-'))
actives=this.$parent&&this.$parent.find('> .accordion-group > .in')
if(actives&&actives.length){hasData=actives.data('collapse')
if(hasData&&hasData.transitioning)return
actives.collapse('hide')
hasData||actives.data('collapse',null)}
this.$element[dimension](0)
this.transition('addClass',$.Event('show'),'shown')
$.support.transition&&this.$element[dimension](this.$element[0][scroll])},hide:function(){var dimension
if(this.transitioning)return
dimension=this.dimension()
this.reset(this.$element[dimension]())
this.transition('removeClass',$.Event('hide'),'hidden')
this.$element[dimension](0)},reset:function(size){var dimension=this.dimension()
this.$element.removeClass('collapse')
[dimension](size||'auto')
[0].offsetWidth
this.$element[size!==null?'addClass':'removeClass']('collapse')
return this},transition:function(method,startEvent,completeEvent){var that=this,complete=function(){if(startEvent.type=='show')that.reset()
that.transitioning=0
that.$element.trigger(completeEvent)}
this.$element.trigger(startEvent)
if(startEvent.isDefaultPrevented())return
this.transitioning=1
this.$element[method]('in')
$.support.transition&&this.$element.hasClass('collapse')?this.$element.one($.support.transition.end,complete):complete()},toggle:function(){this[this.$element.hasClass('in')?'hide':'show']()}}
$.fn.collapse=function(option){return this.each(function(){var $this=$(this),data=$this.data('collapse'),options=typeof option=='object'&&option
if(!data)$this.data('collapse',(data=new Collapse(this,options)))
if(typeof option=='string')data[option]()})}
$.fn.collapse.defaults={toggle:true}
$.fn.collapse.Constructor=Collapse
$(document).on('click.collapse.data-api','[data-toggle=collapse]',function(e){var $this=$(this),href,target=$this.attr('data-target')||e.preventDefault()||(href=$this.attr('href'))&&href.replace(/.*(?=#[^\s]+$)/,''),option=$(target).data('collapse')?'toggle':$this.data()
$this[$(target).hasClass('in')?'addClass':'removeClass']('collapsed')
$(target).collapse(option)})}(window.jQuery);
/* End of File include/javascript/twitterbootstrap/bootstrap-collapse.js */

!function($){var Color=function(val){this.value={h:1,s:1,b:1,a:1};this.setColor(val);};Color.prototype={constructor:Color,setColor:function(val){val=val.toLowerCase();var that=this;$.each(CPGlobal.stringParsers,function(i,parser){var match=parser.re.exec(val),values=match&&parser.parse(match),space=parser.space||'rgba';if(values){if(space=='hsla'){that.value=CPGlobal.RGBtoHSB.apply(null,CPGlobal.HSLtoRGB.apply(null,values));}else{that.value=CPGlobal.RGBtoHSB.apply(null,values);}
return false;}});},setHue:function(h){this.value.h=1-h;},setSaturation:function(s){this.value.s=s;},setLightness:function(b){this.value.b=1-b;},setAlpha:function(a){this.value.a=parseInt((1-a)*100,10)/100;},toRGB:function(h,s,b,a){if(!h){h=this.value.h;s=this.value.s;b=this.value.b;}
h*=360;var R,G,B,X,C;h=(h%360)/ 60;C=b*s;X=C*(1-Math.abs(h%2-1));R=G=B=b-C;h=~~h;R+=[C,X,0,0,X,C][h];G+=[X,C,C,X,0,0][h];B+=[0,0,X,C,C,X][h];return{r:Math.round(R*255),g:Math.round(G*255),b:Math.round(B*255),a:a||this.value.a};},toHex:function(h,s,b,a){var rgb=this.toRGB(h,s,b,a);return'#'+((1<<24)|(parseInt(rgb.r)<<16)|(parseInt(rgb.g)<<8)|parseInt(rgb.b)).toString(16).substr(1);},toHSL:function(h,s,b,a){if(!h){h=this.value.h;s=this.value.s;b=this.value.b;}
var H=h,L=(2-s)*b,S=s*b;if(L>0&&L<=1){S /=L;}else{S /=2-L;}
L /=2;if(S>1){S=1;}
return{h:H,s:S,l:L,a:a||this.value.a};}};var Colorpicker=function(element,options){this.element=$(element);var format=options.format||this.element.data('color-format')||'hex';this.format=CPGlobal.translateFormats[format];this.isInput=this.element.is('input');this.component=this.element.is('.color')?this.element.find('.add-on'):false;this.picker=$(CPGlobal.template).appendTo('body').on('mousedown',$.proxy(this.mousedown,this));if(this.isInput){this.element.on({'focus':$.proxy(this.show,this),'keyup':$.proxy(this.update,this)});}else if(this.component){this.component.on({'click':$.proxy(this.show,this)});}else{this.element.on({'click':$.proxy(this.show,this)});}
if(format=='rgba'||format=='hsla'){this.picker.addClass('alpha');this.alpha=this.picker.find('.colorpicker-alpha')[0].style;}
if(this.component){this.picker.find('.colorpicker-color').hide();this.preview=this.element.find('i')[0].style;}else{this.preview=this.picker.find('div:last')[0].style;}
this.base=this.picker.find('div:first')[0].style;this.update();};Colorpicker.prototype={constructor:Colorpicker,show:function(e){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();$(window).on('resize',$.proxy(this.place,this));if(!this.isInput){if(e){e.stopPropagation();e.preventDefault();}}
$(document).on({'mousedown':$.proxy(this.hide,this)});this.element.trigger({type:'show',color:this.color});},update:function(){this.color=new Color(this.isInput?this.element.prop('value'):this.element.data('color'));this.picker.find('i').eq(0).css({left:this.color.value.s*100,top:100-this.color.value.b*100}).end().eq(1).css('top',100*(1-this.color.value.h)).end().eq(2).css('top',100*(1-this.color.value.a));this.previewColor();},hide:function(){this.picker.hide();$(window).off('resize',this.place);if(!this.isInput){$(document).off({'mousedown':this.hide});if(this.component){this.element.find('input').prop('value',this.format.call(this));}
this.element.data('color',this.format.call(this));}else{this.element.prop('value',this.format.call(this));}
this.element.trigger({type:'hide',color:this.color});},place:function(){var offset=this.component?this.component.offset():this.element.offset();this.picker.css({top:offset.top+this.height,left:offset.left});},previewColor:function(){this.preview.backgroundColor=this.format.call(this);this.base.backgroundColor=this.color.toHex(this.color.value.h,1,1,1);if(this.alpha){this.alpha.backgroundColor=this.color.toHex();}},pointer:null,slider:null,mousedown:function(e){e.stopPropagation();e.preventDefault();var target=$(e.target);var zone=target.closest('div');if(!zone.is('.colorpicker')){if(zone.is('.colorpicker-saturation')){this.slider=$.extend({},CPGlobal.sliders['saturation']);}
else if(zone.is('.colorpicker-hue')){this.slider=$.extend({},CPGlobal.sliders['hue']);}
else if(zone.is('.colorpicker-alpha')){this.slider=$.extend({},CPGlobal.sliders['alpha']);}
var offset=zone.offset();this.slider.knob=zone.find('i')[0].style;this.slider.left=e.pageX-offset.left;this.slider.top=e.pageY-offset.top;this.pointer={left:e.pageX,top:e.pageY};$(document).on({mousemove:$.proxy(this.mousemove,this),mouseup:$.proxy(this.mouseup,this)}).trigger('mousemove');}
return false;},mousemove:function(e){e.stopPropagation();e.preventDefault();var left=Math.max(0,Math.min(this.slider.maxLeft,this.slider.left+((e.pageX||this.pointer.left)-this.pointer.left)));var top=Math.max(0,Math.min(this.slider.maxTop,this.slider.top+((e.pageY||this.pointer.top)-this.pointer.top)));this.slider.knob.left=left+'px';this.slider.knob.top=top+'px';if(this.slider.callLeft){this.color[this.slider.callLeft].call(this.color,left/100);}
if(this.slider.callTop){this.color[this.slider.callTop].call(this.color,top/100);}
this.previewColor();this.element.trigger({type:'changeColor',color:this.color});return false;},mouseup:function(e){e.stopPropagation();e.preventDefault();$(document).off({mousemove:this.mousemove,mouseup:this.mouseup});return false;}}
$.fn.colorpicker=function(option){return this.each(function(){var $this=$(this),data=$this.data('colorpicker'),options=typeof option=='object'&&option;if(!data){$this.data('colorpicker',(data=new Colorpicker(this,$.extend({},$.fn.colorpicker.defaults,options))));}
if(typeof option=='string')data[option]();});};$.fn.colorpicker.defaults={};$.fn.colorpicker.Constructor=Colorpicker;var CPGlobal={translateFormats:{'rgb':function(){var rgb=this.color.toRGB();return'rgb('+rgb.r+','+rgb.g+','+rgb.b+')';},'rgba':function(){var rgb=this.color.toRGB();return'rgba('+rgb.r+','+rgb.g+','+rgb.b+','+rgb.a+')';},'hsl':function(){var hsl=this.color.toHSL();return'hsl('+Math.round(hsl.h*360)+','+Math.round(hsl.s*100)+'%,'+Math.round(hsl.l*100)+'%)';},'hsla':function(){var hsl=this.color.toHSL();return'hsla('+Math.round(hsl.h*360)+','+Math.round(hsl.s*100)+'%,'+Math.round(hsl.l*100)+'%,'+hsl.a+')';},'hex':function(){return this.color.toHex();}},sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:'setSaturation',callTop:'setLightness'},hue:{maxLeft:0,maxTop:100,callLeft:false,callTop:'setHue'},alpha:{maxLeft:0,maxTop:100,callLeft:false,callTop:'setAlpha'}},RGBtoHSB:function(r,g,b,a){r /=255;g /=255;b /=255;var H,S,V,C;V=Math.max(r,g,b);C=V-Math.min(r,g,b);H=(C==0?null:V==r?(g-b)/ C:V==g?(b-r)/ C+2:(r-g)/ C+4);H=((H+360)%6)*60 / 360;S=C==0?0:C / V;return{h:H||1,s:S,b:V,a:a||1};},HueToRGB:function(p,q,h){if(h<0)
h+=1;else if(h>1)
h-=1;if((h*6)<1)
return p+(q-p)*h*6;else if((h*2)<1)
return q;else if((h*3)<2)
return p+(q-p)*((2 / 3)-h)*6;else
return p;},HSLtoRGB:function(h,s,l,a)
{if(s<0)
s=0;if(l<=0.5)
var q=l*(1+s);else
var q=l+s-(l*s);var p=2*l-q;var tr=h+(1 / 3);var tg=h;var tb=h-(1 / 3);var r=Math.round(CPGlobal.HueToRGB(p,q,tr)*255);var g=Math.round(CPGlobal.HueToRGB(p,q,tg)*255);var b=Math.round(CPGlobal.HueToRGB(p,q,tb)*255);return[r,g,b,a||1];},stringParsers:[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1],execResult[2],execResult[3],execResult[4]];}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[2.55*execResult[1],2.55*execResult[2],2.55*execResult[3],execResult[4]];}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(execResult){return[parseInt(execResult[1],16),parseInt(execResult[2],16),parseInt(execResult[3],16)];}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(execResult){return[parseInt(execResult[1]+execResult[1],16),parseInt(execResult[2]+execResult[2],16),parseInt(execResult[3]+execResult[3],16)];}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:'hsla',parse:function(execResult){return[execResult[1]/360,execResult[2]/ 100,execResult[3]/ 100,execResult[4]];}}],template:'<div class="colorpicker dropdown-menu">'+'<div class="colorpicker-saturation"><i><b></b></i></div>'+'<div class="colorpicker-hue"><i></i></div>'+'<div class="colorpicker-alpha"><i></i></div>'+'<div class="colorpicker-color"><div /></div>'+'</div>'};}(window.jQuery)
/* End of File include/javascript/twitterbootstrap/bootstrap-colorpicker.js */

d3=function(){function o(e){return e!=null&&!isNaN(e)}function a(e){return e.length}function f(e){var t=1;while(e*t%1)t*=10;return t}function l(e,t){try{for(var n in t)Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}catch(r){e.prototype=t}}function c(){}function d(){}function v(e,t,n){return function(){var r=n.apply(t,arguments);return r===t?e:r}}function m(){}function g(e){function r(){var n=t,r=-1,i=n.length,s;while(++r<i)(s=n[r].on)&&s.apply(this,arguments);return e}var t=[],n=new c;return r.on=function(r,i){var s=n.get(r),o;return arguments.length<2?s&&s.on:(s&&(s.on=null,t=t.slice(0,o=t.indexOf(s)).concat(t.slice(o+1)),n.remove(r)),i&&t.push(n.set(r,{on:i})),e)},r}function y(){e.event.stopPropagation(),e.event.preventDefault()}function w(){var t=e.event,n;while(n=t.sourceEvent)t=n;return t}function E(e,t){function n(){e.on(t,null)}e.on(t,function(){y(),n()},!0),setTimeout(n,0)}function S(t){var n=new m,r=0,i=arguments.length;while(++r<i)n[arguments[r]]=g(n);return n.of=function(r,i){return function(s){try{var o=s.sourceEvent=e.event;s.target=t,e.event=s,n[s.type].apply(r,i)}finally{e.event=o}}},n}function T(r,i){var s=r.ownerSVGElement||r;if(s.createSVGPoint){var o=s.createSVGPoint();if(x<0&&(n.scrollX||n.scrollY)){s=e.select(t.body).append("svg").style("position","absolute").style("top",0).style("left",0);var u=s[0][0].getScreenCTM();x=!u.f&&!u.e,s.remove()}return x?(o.x=i.pageX,o.y=i.pageY):(o.x=i.clientX,o.y=i.clientY),o=o.matrixTransform(r.getScreenCTM().inverse()),[o.x,o.y]}var a=r.getBoundingClientRect();return[i.clientX-a.left-r.clientLeft,i.clientY-a.top-r.clientTop]}function C(e){var t=-1,n=e.length,r=[];while(++t<n)r.push(e[t]);return r}function k(e){return Array.prototype.slice.call(e)}function O(e){return A(e,B),e}function j(e){return function(){return M(e,this)}}function F(e){return function(){return _(e,this)}}function q(t,n){function r(){this.removeAttribute(t)}function i(){this.removeAttributeNS(t.space,t.local)}function s(){this.setAttribute(t,n)}function o(){this.setAttributeNS(t.space,t.local,n)}function u(){var e=n.apply(this,arguments);e==null?this.removeAttribute(t):this.setAttribute(t,e)}function a(){var e=n.apply(this,arguments);e==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}return t=e.ns.qualify(t),n==null?t.local?i:r:typeof n=="function"?t.local?a:u:t.local?o:s}function R(e){return e.trim().replace(/\s+/g," ")}function z(t){return new RegExp("(?:^|\\s+)"+e.requote(t)+"(?:\\s+|$)","g")}function W(e,t){function r(){var r=-1;while(++r<n)e[r](this,t)}function i(){var r=-1,i=t.apply(this,arguments);while(++r<n)e[r](this,i)}e=e.trim().split(/\s+/).map(X);var n=e.length;return typeof t=="function"?i:r}function X(e){var t=z(e);return function(n,r){if(i=n.classList)return r?i.add(e):i.remove(e);var i=n.getAttribute("class")||"";r?(t.lastIndex=0,t.test(i)||n.setAttribute("class",R(i+" "+e))):n.setAttribute("class",R(i.replace(t," ")))}}function V(e,t,n){function r(){this.style.removeProperty(e)}function i(){this.style.setProperty(e,t,n)}function s(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}return t==null?r:typeof t=="function"?s:i}function $(e,t){function n(){delete this[e]}function r(){this[e]=t}function i(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}return t==null?n:typeof t=="function"?i:r}function J(e){return{__data__:e}}function K(e){return function(){return H(this,e)}}function Q(t){return arguments.length||(t=e.ascending),function(e,n){return!e-!n||t(e.__data__,n.__data__)}}function G(){}function Y(t,n,r){function a(){var e=this[i];e&&(this.removeEventListener(t,e,e.$),delete this[i])}function f(){var e=o(n,N(arguments));a.call(this),this.addEventListener(t,this[i]=e,e.$=r),e._=n}function l(){var n=new RegExp("^__on([^.]+)"+e.requote(t)+"$"),r;for(var i in this)if(r=i.match(n)){var s=this[i];this.removeEventListener(r[1],s,s.$),delete this[i]}}var i="__on"+t,s=t.indexOf("."),o=et;s>0&&(t=t.substring(0,s));var u=Z.get(t);return u&&(t=u,o=tt),s?n?f:a:n?G:l}function et(t,n){return function(r){var i=e.event;e.event=r,n[0]=this.__data__;try{t.apply(this,n)}finally{e.event=i}}}function tt(e,t){var n=et(e,t);return function(e){var t=this,r=e.relatedTarget;(!r||r!==t&&!(r.compareDocumentPosition(t)&8))&&n.call(t,e)}}function nt(e,t){for(var n=0,r=e.length;n<r;n++)for(var i=e[n],s=0,o=i.length,u;s<o;s++)(u=i[s])&&t(u,s,n);return e}function rt(e){return A(e,it),e}function ft(){}function lt(e,t,n){return new ct(e,t,n)}function ct(e,t,n){this.h=e,this.s=t,this.l=n}function pt(e,t,n){function s(e){return e>360?e-=360:e<0&&(e+=360),e<60?r+(i-r)*e/60:e<180?i:e<240?r+(i-r)*(240-e)/60:r}function o(e){return Math.round(s(e)*255)}var r,i;return e%=360,e<0&&(e+=360),t=t<0?0:t>1?1:t,n=n<0?0:n>1?1:n,i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i,qt(o(e+120),o(e),o(e-120))}function yt(e){return e>0?1:e<0?-1:0}function bt(e){return Math.acos(Math.max(-1,Math.min(1,e)))}function wt(e){return e>1?dt/2:e<-1?-dt/2:Math.asin(e)}function Et(e){return(Math.exp(e)-Math.exp(-e))/2}function St(e){return(Math.exp(e)+Math.exp(-e))/2}function xt(e){return(e=Math.sin(e/2))*e}function Tt(e,t,n){return new Nt(e,t,n)}function Nt(e,t,n){this.h=e,this.c=t,this.l=n}function kt(e,t,n){return Lt(n,Math.cos(e*=mt)*t,Math.sin(e)*t)}function Lt(e,t,n){return new At(e,t,n)}function At(e,t,n){this.l=e,this.a=t,this.b=n}function Ht(e,t,n){var r=(e+16)/116,i=r+t/500,s=r-n/200;return i=jt(i)*Mt,r=jt(r)*_t,s=jt(s)*Dt,qt(It(3.2404542*i-1.5371385*r-.4985314*s),It(-0.969266*i+1.8760108*r+.041556*s),It(.0556434*i-.2040259*r+1.0572252*s))}function Bt(e,t,n){return Tt(Math.atan2(n,t)*gt,Math.sqrt(t*t+n*n),e)}function jt(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function Ft(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function It(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}function qt(e,t,n){return new Rt(e,t,n)}function Rt(e,t,n){this.r=e,this.g=t,this.b=n}function zt(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function Wt(e,t,n){var r=0,i=0,s=0,o,u,a;o=/([a-z]+)\((.*)\)/i.exec(e);if(o){u=o[2].split(",");switch(o[1]){case"hsl":return n(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(Jt(u[0]),Jt(u[1]),Jt(u[2]))}}return(a=Kt.get(e))?t(a.r,a.g,a.b):(e!=null&&e.charAt(0)==="#"&&(e.length===4?(r=e.charAt(1),r+=r,i=e.charAt(2),i+=i,s=e.charAt(3),s+=s):e.length===7&&(r=e.substring(1,3),i=e.substring(3,5),s=e.substring(5,7)),r=parseInt(r,16),i=parseInt(i,16),s=parseInt(s,16)),t(r,i,s))}function Xt(e,t,n){var r=Math.min(e/=255,t/=255,n/=255),i=Math.max(e,t,n),s=i-r,o,u,a=(i+r)/2;return s?(u=a<.5?s/(i+r):s/(2-i-r),e==i?o=(t-n)/s+(t<n?6:0):t==i?o=(n-e)/s+2:o=(e-t)/s+4,o*=60):u=o=0,lt(o,u,a)}function Vt(e,t,n){e=$t(e),t=$t(t),n=$t(n);var r=Ft((.4124564*e+.3575761*t+.1804375*n)/Mt),i=Ft((.2126729*e+.7151522*t+.072175*n)/_t),s=Ft((.0193339*e+.119192*t+.9503041*n)/Dt);return Lt(116*i-16,500*(r-i),200*(i-s))}function $t(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Jt(e){var t=parseFloat(e);return e.charAt(e.length-1)==="%"?Math.round(t*2.55):t}function Qt(e){return typeof e=="function"?e:function(){return e}}function Gt(e){return e}function Yt(e){return e.length===1?function(t,n){e(t==null?n:null)}:e}function Zt(t,n){function s(t,r,i){arguments.length<3&&(i=r,r=null);var s=e.xhr(t,n,i);return s.row=function(e){return arguments.length?s.response((r=e)==null?o:u(e)):r},s.row(r)}function o(e){return s.parse(e.responseText)}function u(e){return function(t){return s.parse(t.responseText,e)}}function a(e){return e.map(f).join(t)}function f(e){return r.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}var r=new RegExp('["'+t+"\n]"),i=t.charCodeAt(0);return s.parse=function(e,t){var n;return s.parseRows(e,function(e,r){if(n)return n(e,r-1);var i=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");n=t?function(e,n){return t(i(e),n)}:i})},s.parseRows=function(e,t){function c(){if(u>=o)return r;if(l)return l=!1,n;var t=u;if(e.charCodeAt(t)===34){var s=t;while(s++<o)if(e.charCodeAt(s)===34){if(e.charCodeAt(s+1)!==34)break;++s}u=s+2;var a=e.charCodeAt(s+1);return a===13?(l=!0,e.charCodeAt(s+2)===10&&++u):a===10&&(l=!0),e.substring(t+1,s).replace(/""/g,'"')}while(u<o){var a=e.charCodeAt(u++),f=1;if(a===10)l=!0;else if(a===13)l=!0,e.charCodeAt(u)===10&&(++u,++f);else if(a!==i)continue;return e.substring(t,u-f)}return e.substring(t)}var n={},r={},s=[],o=e.length,u=0,a=0,f,l;while((f=c())!==r){var h=[];while(f!==n&&f!==r)h.push(f),f=c();if(t&&!(h=t(h,a++)))continue;s.push(h)}return s},s.format=function(e){if(Array.isArray(e[0]))return s.formatRows(e);var n=new d,r=[];return e.forEach(function(e){for(var t in e)n.has(t)||r.push(n.add(t))}),[r.map(f).join(t)].concat(e.map(function(e){return r.map(function(t){return f(e[t])}).join(t)})).join("\n")},s.formatRows=function(e){return e.map(a).join("\n")},s}function on(){var e,t=Date.now(),n=nn;while(n)e=t-n.then,e>=n.delay&&(n.flush=n.callback(e)),n=n.next;var r=un()-t;r>24?(isFinite(r)&&(clearTimeout(sn),sn=setTimeout(on,r)),rn=0):(rn=1,an(on))}function un(){var e=null,t=nn,n=Infinity;while(t)t.flush?(delete tn[t.callback.id],t=e?e.next=t.next:nn=t.next):(n=Math.min(n,t.then+t.delay),t=(e=t).next);return n}function pn(e,t){var n=Math.pow(10,Math.abs(8-t)*3);return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}function mn(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)}function gn(e){return e+""}function wn(e,t){e&&Sn.hasOwnProperty(e.type)&&Sn[e.type](e,t)}function xn(e,t,n){var r=-1,i=e.length-n,s;t.lineStart();while(++r<i)s=e[r],t.point(s[0],s[1]);t.lineEnd()}function Tn(e,t){var n=-1,r=e.length;t.polygonStart();while(++n<r)xn(e[n],t,1);t.polygonEnd()}function An(){function s(e,t){e*=mt,t=t*mt/2+dt/4;var s=e-n,o=Math.cos(t),u=Math.sin(t),a=i*u,f=Cn,l=kn,c=r*o+a*Math.cos(s),h=a*Math.sin(s);Cn=f*c-l*h,kn=l*c+f*h,n=e,r=o,i=u}var e,t,n,r,i;Ln.point=function(o,u){Ln.point=s,n=(e=o)*mt,r=Math.cos(u=(t=u)*mt/2+dt/4),i=Math.sin(u)},Ln.lineEnd=function(){s(e,t)}}function On(t){function u(e,t){e<n&&(n=e),e>i&&(i=e),t<r&&(r=t),t>s&&(s=t)}function a(){o.point=o.lineEnd=G}var n,r,i,s,o={point:u,lineStart:G,lineEnd:G,polygonStart:function(){o.lineEnd=a},polygonEnd:function(){o.point=u}};return function(u){return s=i=-(n=r=Infinity),e.geo.stream(u,t(o)),[[n,r],[i,s]]}}function jn(e,t){if(Mn)return;++_n,e*=mt;var n=Math.cos(t*=mt);Dn+=(n*Math.cos(e)-Dn)/_n,Pn+=(n*Math.sin(e)-Pn)/_n,Hn+=(Math.sin(t)-Hn)/_n}function Fn(){var e,t;Mn=1,In(),Mn=2;var n=Bn.point;Bn.point=function(r,i){n(e=r,t=i)},Bn.lineEnd=function(){Bn.point(e,t),qn(),Bn.lineEnd=qn}}function In(){function r(r,i){r*=mt;var s=Math.cos(i*=mt),o=s*Math.cos(r),u=s*Math.sin(r),a=Math.sin(i),f=Math.atan2(Math.sqrt((f=t*a-n*u)*f+(f=n*o-e*a)*f+(f=e*u-t*o)*f),e*o+t*u+n*a);_n+=f,Dn+=f*(e+(e=o)),Pn+=f*(t+(t=u)),Hn+=f*(n+(n=a))}var e,t,n;if(Mn>1)return;Mn<1&&(Mn=1,_n=Dn=Pn=Hn=0),Bn.point=function(i,s){i*=mt;var o=Math.cos(s*=mt);e=o*Math.cos(i),t=o*Math.sin(i),n=Math.sin(s),Bn.point=r}}function qn(){Bn.point=jn}function Rn(e){var t=e[0],n=e[1],r=Math.cos(n);return[r*Math.cos(t),r*Math.sin(t),Math.sin(n)]}function Un(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function zn(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Wn(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Xn(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Vn(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function $n(){return!0}function Jn(e){return[Math.atan2(e[1],e[0]),Math.asin(Math.max(-1,Math.min(1,e[2])))]}function Kn(e,t){return Math.abs(e[0]-t[0])<vt&&Math.abs(e[1]-t[1])<vt}function Qn(e,t,n,r,i){var s=[],o=[];e.forEach(function(e){if((t=e.length-1)<=0)return;var t,n=e[0],r=e[t];if(Kn(n,r)){i.lineStart();for(var u=0;u<t;++u)i.point((n=e[u])[0],n[1]);i.lineEnd();return}var a={point:n,points:e,other:null,visited:!1,entry:!0,subject:!0},f={point:n,points:[n],other:a,visited:!1,entry:!1,subject:!1};a.other=f,s.push(a),o.push(f),a={point:r,points:[r],other:null,visited:!1,entry:!1,subject:!0},f={point:r,points:[r],other:a,visited:!1,entry:!0,subject:!1},a.other=f,s.push(a),o.push(f)}),o.sort(t),Gn(s),Gn(o);if(!s.length)return;if(n)for(var u=1,a=!n(o[0].point),f=o.length;u<f;++u)o[u].entry=a=!a;var l=s[0],c,h,p;for(;;){c=l;while(c.visited)if((c=c.next)===l)return;h=c.points,i.lineStart();do{c.visited=c.other.visited=!0;if(c.entry){if(c.subject)for(var u=0;u<h.length;u++)i.point((p=h[u])[0],p[1]);else r(c.point,c.next.point,1,i);c=c.next}else{if(c.subject){h=c.prev.points;for(var u=h.length;--u>=0;)i.point((p=h[u])[0],p[1])}else r(c.point,c.prev.point,-1,i);c=c.prev}c=c.other,h=c.points}while(!c.visited);i.lineEnd()}}function Gn(e){if(!(t=e.length))return;var t,n=0,r=e[0],i;while(++n<t)r.next=i=e[n],i.prev=r,r=i;r.next=i=e[0],i.prev=r}function Yn(t,n,r){return function(i){function u(e,n){t(e,n)&&i.point(e,n)}function a(e,t){s.point(e,t)}function f(){o.point=a,s.lineStart()}function l(){o.point=u,s.lineEnd()}function y(e,t){m.point(e,t),g.push([e,t])}function b(){m.lineStart(),g=[]}function w(){y(g[0][0],g[0][1]),m.lineEnd();var e=m.clean(),t=v.buffer(),n,r=t.length;if(!r){d=!0,p+=tr(g,-1),g=null;return}g=null;if(e&1){n=t[0],h+=tr(n,1);var r=n.length-1,s=-1,o;i.lineStart();while(++s<r)i.point((o=n[s])[0],o[1]);i.lineEnd();return}r>1&&e&2&&t.push(t.pop().concat(t.shift())),c.push(t.filter(Zn))}var s=n(i),o={point:u,lineStart:f,lineEnd:l,polygonStart:function(){o.point=y,o.lineStart=b,o.lineEnd=w,d=!1,p=h=0,c=[],i.polygonStart()},polygonEnd:function(){o.point=u,o.lineStart=f,o.lineEnd=l,c=e.merge(c);if(c.length)Qn(c,nr,null,r,i);else if(h<-vt||d&&p<-vt)i.lineStart(),r(null,null,1,i),i.lineEnd();i.polygonEnd(),c=null},sphere:function(){i.polygonStart(),i.lineStart(),r(null,null,1,i),i.lineEnd(),i.polygonEnd()}},c,h,p,d,v=er(),m=n(v),g;return o}}function Zn(e){return e.length>1}function er(){var e=[],t;return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:G,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function tr(e,t){if(!(n=e.length))return 0;var n,r=0,i=0,s=e[0],o=s[0],u=s[1],a=Math.cos(u),f=Math.atan2(t*Math.sin(o)*a,Math.sin(u)),l=1-t*Math.cos(o)*a,c=f,h,p;while(++r<n){s=e[r],a=Math.cos(u=s[1]),h=Math.atan2(t*Math.sin(o=s[0])*a,Math.sin(u)),p=1-t*Math.cos(o)*a;if(Math.abs(l-2)<vt&&Math.abs(p-2)<vt)continue;Math.abs(p)<vt||Math.abs(l)<vt||(Math.abs(Math.abs(h-f)-dt)<vt?p+l>2&&(i+=4*(h-f)):Math.abs(l-2)<vt?i+=4*(h-c):i+=((3*dt+h-f)%(2*dt)-dt)*(l+p)),c=f,f=h,l=p}return i}function nr(e,t){return((e=e.point)[0]<0?e[1]-dt/2-vt:dt/2-e[1])-((t=t.point)[0]<0?t[1]-dt/2-vt:dt/2-t[1])}function ir(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,o){var u=s>0?dt:-dt,a=Math.abs(s-t);Math.abs(a-dt)<vt?(e.point(t,n=(n+o)/2>0?dt/2:-dt/2),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),e.point(s,n),i=0):r!==u&&a>=dt&&(Math.abs(t-r)<vt&&(t-=r*vt),Math.abs(s-u)<vt&&(s-=u*vt),n=sr(t,n,s,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),i=0),e.point(t=s,n=o),r=u},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function sr(e,t,n,r){var i,s,o=Math.sin(e-n);return Math.abs(o)>vt?Math.atan((Math.sin(t)*(s=Math.cos(r))*Math.sin(n)-Math.sin(r)*(i=Math.cos(t))*Math.sin(e))/(i*s*o)):(t+r)/2}function or(e,t,n,r){var i;if(e==null)i=n*dt/2,r.point(-dt,i),r.point(0,i),r.point(dt,i),r.point(dt,0),r.point(dt,-i),r.point(0,-i),r.point(-dt,-i),r.point(-dt,0),r.point(-dt,i);else if(Math.abs(e[0]-t[0])>vt){var s=(e[0]<t[0]?1:-1)*dt;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function ur(e){function s(e,n){return Math.cos(e)*Math.cos(n)>t}function o(e){var t,i,o,f,l;return{lineStart:function(){f=o=!1,l=1},point:function(c,h){var p=[c,h],d,v=s(c,h),m=n?v?0:a(c,h):v?a(c+(c<0?dt:-dt),h):0;!t&&(f=o=v)&&e.lineStart();if(v!==o){d=u(t,p);if(Kn(t,d)||Kn(p,d))p[0]+=vt,p[1]+=vt,v=s(p[0],p[1])}if(v!==o)l=0,v?(e.lineStart(),d=u(p,t),e.point(d[0],d[1])):(d=u(t,p),e.point(d[0],d[1]),e.lineEnd()),t=d;else if(r&&t&&n^v){var g;!(m&i)&&(g=u(p,t,!0))&&(l=0,n?(e.lineStart(),e.point(g[0][0],g[0][1]),e.point(g[1][0],g[1][1]),e.lineEnd()):(e.point(g[1][0],g[1][1]),e.lineEnd(),e.lineStart(),e.point(g[0][0],g[0][1])))}v&&(!t||!Kn(t,p))&&e.point(p[0],p[1]),t=p,o=v,i=m},lineEnd:function(){o&&e.lineEnd(),t=null},clean:function(){return l|(f&&o)<<1}}}function u(e,n,r){var i=Rn(e),s=Rn(n),o=[1,0,0],u=zn(i,s),a=Un(u,u),f=u[0],l=a-f*f;if(!l)return!r&&e;var c=t*a/l,h=-t*f/l,p=zn(o,u),d=Xn(o,c),v=Xn(u,h);Wn(d,v);var m=p,g=Un(d,m),y=Un(m,m),b=g*g-y*(Un(d,d)-1);if(b<0)return;var w=Math.sqrt(b),E=Xn(m,(-g-w)/y);Wn(E,d),E=Jn(E);if(!r)return E;var S=e[0],x=n[0],T=e[1],N=n[1],C;x<S&&(C=S,S=x,x=C);var k=x-S,L=Math.abs(k-dt)<vt,A=L||k<vt;!L&&N<T&&(C=T,T=N,N=C);if(A?L?T+N>0^E[1]<(Math.abs(E[0]-S)<vt?T:N):T<=E[1]&&E[1]<=N:k>dt^(S<=E[0]&&E[0]<=x)){var O=Xn(m,(-g+w)/y);return Wn(O,d),[E,Jn(O)]}}function a(t,r){var i=n?e:dt-e,s=0;return t<-i?s|=1:t>i&&(s|=2),r<-i?s|=4:r>i&&(s|=8),s}var t=Math.cos(e),n=t>0,r=Math.abs(t)>vt,i=Er(e,6*mt);return Yn(s,o,i)}function fr(t,n,r,i){function s(e,i){return Math.abs(e[0]-t)<vt?i>0?0:3:Math.abs(e[0]-r)<vt?i>0?2:1:Math.abs(e[1]-n)<vt?i>0?1:0:i>0?3:2}function o(e,t){return u(e.point,t.point)}function u(e,t){var n=s(e,1),r=s(t,1);return n!==r?n-r:n===0?t[1]-e[1]:n===1?e[0]-t[0]:n===2?e[1]-t[1]:t[0]-e[0]}function a(e,s){var o=s[0]-e[0],u=s[1]-e[1],a=[0,1];return Math.abs(o)<vt&&Math.abs(u)<vt?t<=e[0]&&e[0]<=r&&n<=e[1]&&e[1]<=i:lr(t-e[0],o,a)&&lr(e[0]-r,-o,a)&&lr(n-e[1],u,a)&&lr(e[1]-i,-u,a)?(a[1]<1&&(s[0]=e[0]+a[1]*o,s[1]=e[1]+a[1]*u),a[0]>0&&(e[0]+=a[0]*o,e[1]+=a[0]*u),!0):!1}return function(f){function m(e){var o=s(e,-1),u=g([o===0||o===3?t:r,o>1?i:n]);return u}function g(e){var t=0,n=p.length,r=e[1];for(var i=0;i<n;++i)for(var s=1,o=p[i],u=o.length,a=o[0];s<u;++s)b=o[s],a[1]<=r?b[1]>r&&y(a,b,e)>0&&++t:b[1]<=r&&y(a,b,e)<0&&--t,a=b;return t!==0}function y(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])}function w(e,o,a,f){var l=0,c=0;if(e==null||(l=s(e,a))!==(c=s(o,a))||u(e,o)<0^a>0){do f.point(l===0||l===3?t:r,l>1?i:n);while((l=(l+a+4)%4)!==c)}else f.point(o[0],o[1])}function E(e,s){return t<=e&&e<=r&&n<=s&&s<=i}function S(e,t){E(e,t)&&f.point(e,t)}function O(){v.point=_,p&&p.push(d=[]),A=!0,L=!1,C=k=NaN}function M(){h&&(_(x,T),N&&L&&c.rejoin(),h.push(c.buffer())),v.point=S,L&&f.lineEnd()}function _(e,t){e=Math.max(-ar,Math.min(ar,e)),t=Math.max(-ar,Math.min(ar,t));var n=E(e,t);p&&d.push([e,t]);if(A)x=e,T=t,N=n,A=!1,n&&(f.lineStart(),f.point(e,t));else if(n&&L)f.point(e,t);else{var r=[C,k],i=[e,t];a(r,i)?(L||(f.lineStart(),f.point(r[0],r[1])),f.point(i[0],i[1]),n||f.lineEnd()):(f.lineStart(),f.point(e,t))}C=e,k=t,L=n}var l=f,c=er(),h,p,d,v={point:S,lineStart:O,lineEnd:M,polygonStart:function(){f=c,h=[],p=[]},polygonEnd:function(){f=l,(h=e.merge(h)).length?(f.polygonStart(),Qn(h,o,m,w,f),f.polygonEnd()):g([t,n])&&(f.polygonStart(),f.lineStart(),w(null,null,1,f),f.lineEnd(),f.polygonEnd()),h=p=d=null}},x,T,N,C,k,L,A;return v}}function lr(e,t,n){if(Math.abs(t)<vt)return e<=0;var r=e/t;if(t>0){if(r>n[1])return!1;r>n[0]&&(n[0]=r)}else{if(r<n[0])return!1;r<n[1]&&(n[1]=r)}return!0}function cr(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return n=t.invert(n,r),n&&e.invert(n[0],n[1])}),n}function hr(e){function r(t){function c(n,r){n=e(n,r),t.point(n[0],n[1])}function h(){s=NaN,l.point=p,t.lineStart()}function p(l,c){var h=Rn([l,c]),p=e(l,c);i(s,o,r,u,a,f,s=p[0],o=p[1],r=l,u=h[0],a=h[1],f=h[2],n,t),t.point(s,o)}function d(){l.point=c,t.lineEnd()}function v(){var e,c,v,m,g,y,b;h(),l.point=function(t,n){p(e=t,c=n),v=s,m=o,g=u,y=a,b=f,l.point=p},l.lineEnd=function(){i(s,o,r,u,a,f,v,m,e,g,y,b,n,t),l.lineEnd=d,d()}}var r,s,o,u,a,f,l={point:c,lineStart:h,lineEnd:d,polygonStart:function(){t.polygonStart(),l.lineStart=v},polygonEnd:function(){t.polygonEnd(),l.lineStart=h}};return l}function i(n,r,s,o,u,a,f,l,c,h,p,d,v,m){var g=f-n,y=l-r,b=g*g+y*y;if(b>4*t&&v--){var w=o+h,E=u+p,S=a+d,x=Math.sqrt(w*w+E*E+S*S),T=Math.asin(S/=x),N=Math.abs(Math.abs(S)-1)<vt?(s+c)/2:Math.atan2(E,w),C=e(N,T),k=C[0],L=C[1],A=k-n,O=L-r,M=y*A-g*O;if(M*M/b>t||Math.abs((g*A+y*O)/b-.5)>.3)i(n,r,s,o,u,a,k,L,N,w/=x,E/=x,S,v,m),m.point(k,L),i(k,L,N,w,E,S,f,l,c,h,p,d,v,m)}}var t=.5,n=16;return r.precision=function(e){return arguments.length?(n=(t=e*e)>0&&16,r):Math.sqrt(t)},r}function pr(e){return dr(function(){return e})()}function dr(t){function w(e){return e=i(e[0]*mt,e[1]*mt),[e[0]*o+d,v-e[1]*o]}function E(e){return e=i.invert((e[0]-d)/o,(v-e[1])/o),e&&[e[0]*gt,e[1]*gt]}function S(){i=cr(r=gr(c,h,p),n);var e=n(f,l);return d=u-e[0]*o,v=a+e[1]*o,w}var n,r,i,s=hr(function(e,t){return e=n(e,t),[e[0]*o+d,v-e[1]*o]}),o=150,u=480,a=250,f=0,l=0,c=0,h=0,p=0,d,v,m=rr,g=Gt,y=null,b=null;return w.stream=function(e){return vr(r,m(s(g(e))))},w.clipAngle=function(e){return arguments.length?(m=e==null?(y=e,rr):ur((y=+e)*mt),w):y},w.clipExtent=function(e){return arguments.length?(b=e,g=e==null?Gt:fr(e[0][0],e[0][1],e[1][0],e[1][1]),w):b},w.scale=function(e){return arguments.length?(o=+e,S()):o},w.translate=function(e){return arguments.length?(u=+e[0],a=+e[1],S()):[u,a]},w.center=function(e){return arguments.length?(f=e[0]%360*mt,l=e[1]%360*mt,S()):[f*gt,l*gt]},w.rotate=function(e){return arguments.length?(c=e[0]%360*mt,h=e[1]%360*mt,p=e.length>2?e[2]%360*mt:0,S()):[c*gt,h*gt,p*gt]},e.rebind(w,s,"precision"),function(){return n=t.apply(this,arguments),w.invert=n.invert&&E,S()}}function vr(e,t){return{point:function(n,r){r=e(n*mt,r*mt),n=r[0],t.point(n>dt?n-2*dt:n<-dt?n+2*dt:n,r[1])},sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function mr(e,t){return[e,t]}function gr(e,t,n){return e?t||n?cr(br(e),wr(t,n)):br(e):t||n?wr(t,n):mr}function yr(e){return function(t,n){return t+=e,[t>dt?t-2*dt:t<-dt?t+2*dt:t,n]}}function br(e){var t=yr(e);return t.invert=yr(-e),t}function wr(e,t){function o(e,t){var o=Math.cos(t),u=Math.cos(e)*o,a=Math.sin(e)*o,f=Math.sin(t),l=f*n+u*r;return[Math.atan2(a*i-l*s,u*n-f*r),Math.asin(Math.max(-1,Math.min(1,l*i+a*s)))]}var n=Math.cos(e),r=Math.sin(e),i=Math.cos(t),s=Math.sin(t);return o.invert=function(e,t){var o=Math.cos(t),u=Math.cos(e)*o,a=Math.sin(e)*o,f=Math.sin(t),l=f*i-a*s;return[Math.atan2(a*i+f*s,u*n+l*r),Math.asin(Math.max(-1,Math.min(1,l*n-u*r)))]},o}function Er(e,t){var n=Math.cos(e),r=Math.sin(e);return function(i,s,o,u){if(i!=null){i=Sr(n,i),s=Sr(n,s);if(o>0?i<s:i>s)i+=o*2*dt}else i=e+o*2*dt,s=e;var a;for(var f=o*t,l=i;o>0?l>s:l<s;l-=f)u.point((a=Jn([n,-r*Math.cos(l),-r*Math.sin(l)]))[0],a[1])}}function Sr(e,t){var n=Rn(t);n[0]-=e,Vn(n);var r=bt(-n[1]);return((-n[2]<0?-r:r)+2*Math.PI-vt)%(2*Math.PI)}function xr(t,n,r){var i=e.range(t,n-vt,r).concat(n);return function(e){return i.map(function(t){return[e,t]})}}function Tr(t,n,r){var i=e.range(t,n-vt,r).concat(n);return function(e){return i.map(function(t){return[t,e]})}}function Nr(e){return e.source}function Cr(e){return e.target}function kr(e,t,n,r){var i=Math.cos(t),s=Math.sin(t),o=Math.cos(r),u=Math.sin(r),a=i*Math.cos(e),f=i*Math.sin(e),l=o*Math.cos(n),c=o*Math.sin(n),h=2*Math.asin(Math.sqrt(xt(r-t)+i*o*xt(n-e))),p=1/Math.sin(h),d=h?function(e){var t=Math.sin(e*=h)*p,n=Math.sin(h-e)*p,r=n*a+t*l,i=n*f+t*c,o=n*s+t*u;return[Math.atan2(i,r)*gt,Math.atan2(o,Math.sqrt(r*r+i*i))*gt]}:function(){return[e*gt,t*gt]};return d.distance=h,d}function Or(){function r(r,i){var s=Math.sin(i*=mt),o=Math.cos(i),u=Math.abs((r*=mt)-e),a=Math.cos(u);Lr+=Math.atan2(Math.sqrt((u=o*Math.sin(u))*u+(u=n*s-t*o*a)*u),t*s+n*o*a),e=r,t=s,n=o}var e,t,n;Ar.point=function(i,s){e=i*mt,t=Math.sin(s*=mt),n=Math.cos(s),Ar.point=r},Ar.lineEnd=function(){Ar.point=Ar.lineEnd=G}}function Mr(e){var t=0,n=dt/3,r=dr(e),i=r(t,n);return i.parallels=function(e){return arguments.length?r(t=e[0]*dt/180,n=e[1]*dt/180):[t/dt*180,n/dt*180]},i}function _r(e,t){function o(e,t){var n=Math.sqrt(i-2*r*Math.sin(t))/r;return[n*Math.sin(e*=r),s-n*Math.cos(e)]}var n=Math.sin(e),r=(n+Math.sin(t))/2,i=1+n*(2*r-n),s=Math.sqrt(i)/r;return o.invert=function(e,t){var n=s-t;return[Math.atan2(e,n)/r,Math.asin((i-(e*e+n*n)*r*r)/(2*r))]},o}function Dr(e,t){var n=e(t[0]),r=e([.5*(t[0][0]+t[1][0]),t[0][1]]),i=e([t[1][0],t[0][1]]),s=e(t[1]),o=r[1]-n[1],u=r[0]-n[0],a=i[1]-r[1],f=i[0]-r[0],l=o/u,c=a/f,h=.5*(l*c*(n[1]-i[1])+c*(n[0]+r[0])-l*(r[0]+i[0]))/(c-l),p=(.5*(n[0]+r[0])-h)/l+.5*(n[1]+r[1]),d=s[0]-h,v=s[1]-p,m=n[0]-h,g=n[1]-p,y=d*d+v*v,b=m*m+g*g,w=Math.atan2(v,d),E=Math.atan2(g,m);return function(t){var n=t[0]-h,r=t[1]-p,i=n*n+r*r,s=Math.atan2(r,n);if(y<i&&i<b&&w<s&&s<E)return e.invert(t)}}function jr(){function i(e,t){Hr+=r*e-n*t,n=e,r=t}var e,t,n,r;Br.point=function(s,o){Br.point=i,e=n=s,t=r=o},Br.lineEnd=function(){i(e,t)}}function Fr(){function r(n,r){t.push("M",n,",",r,e)}function i(e,r){t.push("M",e,",",r),n.point=s}function s(e,n){t.push("L",e,",",n)}function o(){n.point=r}function u(){t.push("Z")}var e=Xr(4.5),t=[],n={point:r,lineStart:function(){n.point=i},lineEnd:o,polygonStart:function(){n.lineEnd=u},polygonEnd:function(){n.lineEnd=o,n.point=r},pointRadius:function(t){return e=Xr(t),n},result:function(){if(t.length){var e=t.join("");return t=[],e}}};return n}function qr(e,t){if(Mn)return;Dn+=e,Pn+=t,++Hn}function Rr(){function n(n,r){var i=n-e,s=r-t,o=Math.sqrt(i*i+s*s);Dn+=o*(e+n)/2,Pn+=o*(t+r)/2,Hn+=o,e=n,t=r}var e,t;if(Mn!==1){if(!(Mn<1))return;Mn=1,Dn=Pn=Hn=0}Ir.point=function(r,i){Ir.point=n,e=r,t=i}}function Ur(){Ir.point=qr}function zr(){function i(e,t){var i=r*e-n*t;Dn+=i*(n+e),Pn+=i*(r+t),Hn+=i*3,n=e,r=t}var e,t,n,r;Mn<2&&(Mn=2,Dn=Pn=Hn=0),Ir.point=function(s,o){Ir.point=i,e=n=s,t=r=o},Ir.lineEnd=function(){i(e,t)}}function Wr(e){function r(n,r){e.moveTo(n,r),e.arc(n,r,t,0,2*dt)}function i(t,r){e.moveTo(t,r),n.point=s}function s(t,n){e.lineTo(t,n)}function o(){n.point=r}function u(){e.closePath()}var t=4.5,n={point:r,lineStart:function(){n.point=i},lineEnd:o,polygonStart:function(){n.lineEnd=u},polygonEnd:function(){n.lineEnd=o,n.point=r},pointRadius:function(e){return t=e,n},result:G};return n}function Xr(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+ -2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Vr(e){var t=hr(function(t,n){return e([t*gt,n*gt])});return function(e){return e=t(e),{point:function(t,n){e.point(t*mt,n*mt)},sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}}function $r(e,t){function n(t,n){var r=Math.cos(t),i=Math.cos(n),s=e(r*i);return[s*i*Math.sin(t),s*Math.sin(n)]}return n.invert=function(e,n){var r=Math.sqrt(e*e+n*n),i=t(r),s=Math.sin(i),o=Math.cos(i);return[Math.atan2(e*s,r*o),Math.asin(r&&n*s/r)]},n}function Qr(e,t){function o(e,t){var n=Math.abs(Math.abs(t)-dt/2)<vt?0:s/Math.pow(r(t),i);return[n*Math.sin(i*e),s-n*Math.cos(i*e)]}var n=Math.cos(e),r=function(e){return Math.tan(dt/4+e/2)},i=e===t?Math.sin(e):Math.log(n/Math.cos(t))/Math.log(r(t)/r(e)),s=n*Math.pow(r(e),i)/i;return i?(o.invert=function(e,t){var n=s-t,r=yt(i)*Math.sqrt(e*e+n*n);return[Math.atan2(e,n)/i,2*Math.atan(Math.pow(s/r,1/i))-dt/2]},o):Zr}function Gr(e,t){function s(e,t){var n=i-t;return[n*Math.sin(r*e),i-n*Math.cos(r*e)]}var n=Math.cos(e),r=e===t?Math.sin(e):(n-Math.cos(t))/(t-e),i=n/r+e;return Math.abs(r)<vt?mr:(s.invert=function(e,t){var n=i-t;return[Math.atan2(e,n)/r,i-yt(r)*Math.sqrt(e*e+n*n)]},s)}function Zr(e,t){return[e,Math.log(Math.tan(dt/4+t/2))]}function ei(e){var t=pr(e),n=t.scale,r=t.translate,i=t.clipExtent,s;return t.scale=function(){var e=n.apply(t,arguments);return e===t?s?t.clipExtent(null):t:e},t.translate=function(){var e=r.apply(t,arguments);return e===t?s?t.clipExtent(null):t:e},t.clipExtent=function(e){var o=i.apply(t,arguments);if(o===t){if(s=e==null){var u=dt*n(),a=r();i([[a[0]-u,a[1]-u],[a[0]+u,a[1]+u]])}}else s&&(o=null);return o},t.clipExtent(null)}function ri(e,t){var n=Math.cos(t)*Math.sin(e);return[Math.log((1+n)/(1-n))/2,Math.atan2(Math.tan(t),Math.cos(e))]}function ii(e){function u(s){function d(){u.push("M",i(e(a),o))}var u=[],a=[],f=-1,l=s.length,c,h=Qt(t),p=Qt(n);while(++f<l)r.call(this,c=s[f],f)?a.push([+h.call(this,c,f),+p.call(this,c,f)]):a.length&&(d(),a=[]);return a.length&&d(),u.length?u.join(""):null}var t=si,n=oi,r=$n,i=ai,s=i.key,o=.7;return u.x=function(e){return arguments.length?(t=e,u):t},u.y=function(e){return arguments.length?(n=e,u):n},u.defined=function(e){return arguments.length?(r=e,u):r},u.interpolate=function(e){return arguments.length?(typeof e=="function"?s=i=e:s=(i=ui.get(e)||ai).key,u):s},u.tension=function(e){return arguments.length?(o=e,u):o},u}function si(e){return e[0]}function oi(e){return e[1]}function ai(e){return e.join("L")}function fi(e){return ai(e)+"Z"}function li(e){var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];while(++t<n)i.push("V",(r=e[t])[1],"H",r[0]);return i.join("")}function ci(e){var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];while(++t<n)i.push("H",(r=e[t])[0],"V",r[1]);return i.join("")}function hi(e,t){return e.length<4?ai(e):e[1]+vi(e.slice(1,e.length-1),mi(e,t))}function pi(e,t){return e.length<3?ai(e):e[0]+vi((e.push(e[0]),e),mi([e[e.length-2]].concat(e,[e[1]]),t))}function di(e,t){return e.length<3?ai(e):e[0]+vi(e,mi(e,t))}function vi(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2)return ai(e);var n=e.length!=t.length,r="",i=e[0],s=e[1],o=t[0],u=o,a=1;n&&(r+="Q"+(s[0]-o[0]*2/3)+","+(s[1]-o[1]*2/3)+","+s[0]+","+s[1],i=e[1],a=2);if(t.length>1){u=t[1],s=e[a],a++,r+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1];for(var f=2;f<t.length;f++,a++)s=e[a],u=t[f],r+="S"+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1]}if(n){var l=e[a];r+="Q"+(s[0]+u[0]*2/3)+","+(s[1]+u[1]*2/3)+","+l[0]+","+l[1]}return r}function mi(e,t){var n=[],r=(1-t)/2,i,s=e[0],o=e[1],u=1,a=e.length;while(++u<a)i=s,s=o,o=e[u],n.push([r*(o[0]-i[0]),r*(o[1]-i[1])]);return n}function gi(e){if(e.length<3)return ai(e);var t=1,n=e.length,r=e[0],i=r[0],s=r[1],o=[i,i,i,(r=e[1])[0]],u=[s,s,s,r[1]],a=[i,",",s];Ni(a,o,u);while(++t<n)r=e[t],o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),Ni(a,o,u);t=-1;while(++t<2)o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),Ni(a,o,u);return a.join("")}function yi(e){if(e.length<4)return ai(e);var t=[],n=-1,r=e.length,i,s=[0],o=[0];while(++n<3)i=e[n],s.push(i[0]),o.push(i[1]);t.push(Ei(Ti,s)+","+Ei(Ti,o)),--n;while(++n<r)i=e[n],s.shift(),s.push(i[0]),o.shift(),o.push(i[1]),Ni(t,s,o);return t.join("")}function bi(e){var t,n=-1,r=e.length,i=r+4,s,o=[],u=[];while(++n<4)s=e[n%r],o.push(s[0]),u.push(s[1]);t=[Ei(Ti,o),",",Ei(Ti,u)],--n;while(++n<i)s=e[n%r],o.shift(),o.push(s[0]),u.shift(),u.push(s[1]),Ni(t,o,u);return t.join("")}function wi(e,t){var n=e.length-1;if(n){var r=e[0][0],i=e[0][1],s=e[n][0]-r,o=e[n][1]-i,u=-1,a,f;while(++u<=n)a=e[u],f=u/n,a[0]=t*a[0]+(1-t)*(r+f*s),a[1]=t*a[1]+(1-t)*(i+f*o)}return gi(e)}function Ei(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Ni(e,t,n){e.push("C",Ei(Si,t),",",Ei(Si,n),",",Ei(xi,t),",",Ei(xi,n),",",Ei(Ti,t),",",Ei(Ti,n))}function Ci(e,t){return(t[1]-e[1])/(t[0]-e[0])}function ki(e){var t=0,n=e.length-1,r=[],i=e[0],s=e[1],o=r[0]=Ci(i,s);while(++t<n)r[t]=(o+(o=Ci(i=s,s=e[t+1])))/2;return r[t]=o,r}function Li(e){var t=[],n,r,i,s,o=ki(e),u=-1,a=e.length-1;while(++u<a)n=Ci(e[u],e[u+1]),Math.abs(n)<1e-6?o[u]=o[u+1]=0:(r=o[u]/n,i=o[u+1]/n,s=r*r+i*i,s>9&&(s=n*3/Math.sqrt(s),o[u]=s*r,o[u+1]=s*i));u=-1;while(++u<=a)s=(e[Math.min(a,u+1)][0]-e[Math.max(0,u-1)][0])/(6*(1+o[u]*o[u])),t.push([s||0,o[u]*s||0]);return t}function Ai(e){return e.length<3?ai(e):e[0]+vi(e,Li(e))}function Oi(e,t,n,r){var i,s,o,u,a,f,l;return i=r[e],s=i[0],o=i[1],i=r[t],u=i[0],a=i[1],i=r[n],f=i[0],l=i[1],(l-o)*(u-s)-(a-o)*(f-s)>0}function Mi(e,t,n){return(n[0]-t[0])*(e[1]-t[1])<(n[1]-t[1])*(e[0]-t[0])}function _i(e,t,n,r){var i=e[0],s=n[0],o=t[0]-i,u=r[0]-s,a=e[1],f=n[1],l=t[1]-a,c=r[1]-f,h=(u*(a-f)-c*(i-s))/(c*o-u*l);return[i+h*o,a+h*l]}function Pi(e,t){var n={list:e.map(function(e,t){return{index:t,x:e[0],y:e[1]}}).sort(function(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}),bottomSite:null},r={list:[],leftEnd:null,rightEnd:null,init:function(){r.leftEnd=r.createHalfEdge(null,"l"),r.rightEnd=r.createHalfEdge(null,"l"),r.leftEnd.r=r.rightEnd,r.rightEnd.l=r.leftEnd,r.list.unshift(r.leftEnd,r.rightEnd)},createHalfEdge:function(e,t){return{edge:e,side:t,vertex:null,l:null,r:null}},insert:function(e,t){t.l=e,t.r=e.r,e.r.l=t,e.r=t},leftBound
:function(e){var t=r.leftEnd;do t=t.r;while(t!=r.rightEnd&&i.rightOf(t,e));return t=t.l,t},del:function(e){e.l.r=e.r,e.r.l=e.l,e.edge=null},right:function(e){return e.r},left:function(e){return e.l},leftRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[e.side]},rightRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[Di[e.side]]}},i={bisect:function(e,t){var n={region:{l:e,r:t},ep:{l:null,r:null}},r=t.x-e.x,i=t.y-e.y,s=r>0?r:-r,o=i>0?i:-i;return n.c=e.x*r+e.y*i+(r*r+i*i)*.5,s>o?(n.a=1,n.b=i/r,n.c/=r):(n.b=1,n.a=r/i,n.c/=i),n},intersect:function(e,t){var n=e.edge,r=t.edge;if(!n||!r||n.region.r==r.region.r)return null;var i=n.a*r.b-n.b*r.a;if(Math.abs(i)<1e-10)return null;var s=(n.c*r.b-r.c*n.b)/i,o=(r.c*n.a-n.c*r.a)/i,u=n.region.r,a=r.region.r,f,l;u.y<a.y||u.y==a.y&&u.x<a.x?(f=e,l=n):(f=t,l=r);var c=s>=l.region.r.x;return c&&f.side==="l"||!c&&f.side==="r"?null:{x:s,y:o}},rightOf:function(e,t){var n=e.edge,r=n.region.r,i=t.x>r.x;if(i&&e.side==="l")return 1;if(!i&&e.side==="r")return 0;if(n.a===1){var s=t.y-r.y,o=t.x-r.x,u=0,a=0;!i&&n.b<0||i&&n.b>=0?a=u=s>=n.b*o:(a=t.x+t.y*n.b>n.c,n.b<0&&(a=!a),a||(u=1));if(!u){var f=r.x-n.region.l.x;a=n.b*(o*o-s*s)<f*s*(1+2*o/f+n.b*n.b),n.b<0&&(a=!a)}}else{var l=n.c-n.a*t.x,c=t.y-l,h=t.x-r.x,p=l-r.y;a=c*c>h*h+p*p}return e.side==="l"?a:!a},endPoint:function(e,n,r){e.ep[n]=r;if(!e.ep[Di[n]])return;t(e)},distance:function(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}},s={list:[],insert:function(e,t,n){e.vertex=t,e.ystar=t.y+n;for(var r=0,i=s.list,o=i.length;r<o;r++){var u=i[r];if(e.ystar>u.ystar||e.ystar==u.ystar&&t.x>u.vertex.x)continue;break}i.splice(r,0,e)},del:function(e){for(var t=0,n=s.list,r=n.length;t<r&&n[t]!=e;++t);n.splice(t,1)},empty:function(){return s.list.length===0},nextEvent:function(e){for(var t=0,n=s.list,r=n.length;t<r;++t)if(n[t]==e)return n[t+1];return null},min:function(){var e=s.list[0];return{x:e.vertex.x,y:e.ystar}},extractMin:function(){return s.list.shift()}};r.init(),n.bottomSite=n.list.shift();var o=n.list.shift(),u,a,f,l,c,h,p,d,v,m,g,y,b;for(;;){s.empty()||(u=s.min());if(o&&(s.empty()||o.y<u.y||o.y==u.y&&o.x<u.x))a=r.leftBound(o),f=r.right(a),p=r.rightRegion(a),y=i.bisect(p,o),h=r.createHalfEdge(y,"l"),r.insert(a,h),m=i.intersect(a,h),m&&(s.del(a),s.insert(a,m,i.distance(m,o))),a=h,h=r.createHalfEdge(y,"r"),r.insert(a,h),m=i.intersect(h,f),m&&s.insert(h,m,i.distance(m,o)),o=n.list.shift();else{if(!!s.empty())break;a=s.extractMin(),l=r.left(a),f=r.right(a),c=r.right(f),p=r.leftRegion(a),d=r.rightRegion(f),g=a.vertex,i.endPoint(a.edge,a.side,g),i.endPoint(f.edge,f.side,g),r.del(a),s.del(f),r.del(f),b="l",p.y>d.y&&(v=p,p=d,d=v,b="r"),y=i.bisect(p,d),h=r.createHalfEdge(y,b),r.insert(l,h),i.endPoint(y,Di[b],g),m=i.intersect(l,h),m&&(s.del(l),s.insert(l,m,i.distance(m,p))),m=i.intersect(h,c),m&&s.insert(h,m,i.distance(m,p))}}for(a=r.right(r.leftEnd);a!=r.rightEnd;a=r.right(a))t(a.edge)}function Hi(e){return e.x}function Bi(e){return e.y}function ji(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Fi(e,t,n,r,i,s){if(!e(t,n,r,i,s)){var o=(n+i)*.5,u=(r+s)*.5,a=t.nodes;a[0]&&Fi(e,a[0],n,r,o,u),a[1]&&Fi(e,a[1],o,r,i,u),a[2]&&Fi(e,a[2],n,u,o,s),a[3]&&Fi(e,a[3],o,u,i,s)}}function Ii(t,n){t=e.rgb(t),n=e.rgb(n);var r=t.r,i=t.g,s=t.b,o=n.r-r,u=n.g-i,a=n.b-s;return function(e){return"#"+zt(Math.round(r+o*e))+zt(Math.round(i+u*e))+zt(Math.round(s+a*e))}}function qi(e){var t=[e.a,e.b],n=[e.c,e.d],r=Ui(t),i=Ri(t,n),s=Ui(zi(n,t,-i))||0;t[0]*n[1]<n[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-n[0],n[1]))*gt,this.translate=[e.e,e.f],this.scale=[r,s],this.skew=s?Math.atan2(i,s)*gt:0}function Ri(e,t){return e[0]*t[0]+e[1]*t[1]}function Ui(e){var t=Math.sqrt(Ri(e,e));return t&&(e[0]/=t,e[1]/=t),t}function zi(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function Xi(e,t){return t-=e=+e,function(n){return e+t*n}}function Vi(t,n){var r=[],i=[],s,o=e.transform(t),u=e.transform(n),a=o.translate,f=u.translate,l=o.rotate,c=u.rotate,h=o.skew,p=u.skew,d=o.scale,v=u.scale;return a[0]!=f[0]||a[1]!=f[1]?(r.push("translate(",null,",",null,")"),i.push({i:1,x:Xi(a[0],f[0])},{i:3,x:Xi(a[1],f[1])})):f[0]||f[1]?r.push("translate("+f+")"):r.push(""),l!=c?(l-c>180?c+=360:c-l>180&&(l+=360),i.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:Xi(l,c)})):c&&r.push(r.pop()+"rotate("+c+")"),h!=p?i.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:Xi(h,p)}):p&&r.push(r.pop()+"skewX("+p+")"),d[0]!=v[0]||d[1]!=v[1]?(s=r.push(r.pop()+"scale(",null,",",null,")"),i.push({i:s-4,x:Xi(d[0],v[0])},{i:s-2,x:Xi(d[1],v[1])})):(v[0]!=1||v[1]!=1)&&r.push(r.pop()+"scale("+v+")"),s=i.length,function(e){var t=-1,n;while(++t<s)r[(n=i[t]).i]=n.x(e);return r.join("")}}function $i(e,t){var n={},r={},i;for(i in e)i in t?n[i]=Gi(i)(e[i],t[i]):r[i]=e[i];for(i in t)i in e||(r[i]=t[i]);return function(e){for(i in n)r[i]=n[i](e);return r}}function Ji(e,t){var n,r,i,s=0,o=0,u=[],a=[],f,l;e+="",t+="",Ki.lastIndex=0;for(r=0;n=Ki.exec(t);++r)n.index&&u.push(t.substring(s,o=n.index)),a.push({i:u.length,x:n[0]}),u.push(null),s=Ki.lastIndex;s<t.length&&u.push(t.substring(s));for(r=0,f=a.length;(n=Ki.exec(e))&&r<f;++r){l=a[r];if(l.x==n[0]){if(l.i)if(u[l.i+1]==null){u[l.i-1]+=l.x,u.splice(l.i,1);for(i=r+1;i<f;++i)a[i].i--}else{u[l.i-1]+=l.x+u[l.i+1],u.splice(l.i,2);for(i=r+1;i<f;++i)a[i].i-=2}else if(u[l.i+1]==null)u[l.i]=l.x;else{u[l.i]=l.x+u[l.i+1],u.splice(l.i+1,1);for(i=r+1;i<f;++i)a[i].i--}a.splice(r,1),f--,r--}else l.x=Xi(parseFloat(n[0]),parseFloat(l.x))}while(r<f)l=a.pop(),u[l.i+1]==null?u[l.i]=l.x:(u[l.i]=l.x+u[l.i+1],u.splice(l.i+1,1)),f--;return u.length===1?u[0]==null?a[0].x:function(){return t}:function(e){for(r=0;r<f;++r)u[(l=a[r]).i]=l.x(e);return u.join("")}}function Qi(t,n){var r=e.interpolators.length,i;while(--r>=0&&!(i=e.interpolators[r](t,n)));return i}function Gi(e){return e=="transform"?Vi:Qi}function Yi(e,t){var n=[],r=[],i=e.length,s=t.length,o=Math.min(e.length,t.length),u;for(u=0;u<o;++u)n.push(Qi(e[u],t[u]));for(;u<i;++u)r[u]=e[u];for(;u<s;++u)r[u]=t[u];return function(e){for(u=0;u<o;++u)r[u]=n[u](e);return r}}function ns(e){return function(t){return t<=0?0:t>=1?1:e(t)}}function rs(e){return function(t){return 1-e(1-t)}}function is(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function ss(e){return e*e}function os(e){return e*e*e}function us(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)}function as(e){return function(t){return Math.pow(t,e)}}function fs(e){return 1-Math.cos(e*dt/2)}function ls(e){return Math.pow(2,10*(e-1))}function cs(e){return 1-Math.sqrt(1-e*e)}function hs(e,t){var n;return arguments.length<2&&(t=.45),arguments.length?n=t/(2*dt)*Math.asin(1/e):(e=1,n=t/4),function(r){return 1+e*Math.pow(2,10*-r)*Math.sin((r-n)*2*dt/t)}}function ps(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function ds(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function vs(t,n){t=e.hcl(t),n=e.hcl(n);var r=t.h,i=t.c,s=t.l,o=n.h-r,u=n.c-i,a=n.l-s;return o>180?o-=360:o<-180&&(o+=360),function(e){return kt(r+o*e,i+u*e,s+a*e)+""}}function ms(t,n){t=e.hsl(t),n=e.hsl(n);var r=t.h,i=t.s,s=t.l,o=n.h-r,u=n.s-i,a=n.l-s;return o>180?o-=360:o<-180&&(o+=360),function(e){return pt(r+o*e,i+u*e,s+a*e)+""}}function gs(t,n){t=e.lab(t),n=e.lab(n);var r=t.l,i=t.a,s=t.b,o=n.l-r,u=n.a-i,a=n.b-s;return function(e){return Ht(r+o*e,i+u*e,s+a*e)+""}}function ys(e,t){return t-=e,function(n){return Math.round(e+t*n)}}function bs(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return(n-e)*t}}function ws(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return Math.max(0,Math.min(1,(n-e)*t))}}function Es(e){var t=e.source,n=e.target,r=xs(t,n),i=[t];while(t!==r)t=t.parent,i.push(t);var s=i.length;while(n!==r)i.splice(s,0,n),n=n.parent;return i}function Ss(e){var t=[],n=e.parent;while(n!=null)t.push(e),e=n,n=n.parent;return t.push(e),t}function xs(e,t){if(e===t)return e;var n=Ss(e),r=Ss(t),i=n.pop(),s=r.pop(),o=null;while(i===s)o=i,i=n.pop(),s=r.pop();return o}function Ts(e){e.fixed|=2}function Ns(e){e.fixed&=-7}function Cs(e){e.fixed|=4,e.px=e.x,e.py=e.y}function ks(e){e.fixed&=-5}function Ls(e,t,n){var r=0,i=0;e.charge=0;if(!e.leaf){var s=e.nodes,o=s.length,u=-1,a;while(++u<o){a=s[u];if(a==null)continue;Ls(a,t,n),e.charge+=a.charge,r+=a.charge*a.cx,i+=a.charge*a.cy}}if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var f=t*n[e.point.index];e.charge+=e.pointCharge=f,r+=f*e.point.x,i+=f*e.point.y}e.cx=r/e.charge,e.cy=i/e.charge}function Ms(t,n){return e.rebind(t,n,"sort","children","value"),t.nodes=t,t.links=Hs,t}function _s(e){return e.children}function Ds(e){return e.value}function Ps(e,t){return t.value-e.value}function Hs(t){return e.merge(t.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function js(e){return e.x}function Fs(e){return e.y}function Is(e,t,n){e.y0=t,e.y=n}function Us(t){return e.range(t.length)}function zs(e){var t=-1,n=e[0].length,r=[];while(++t<n)r[t]=0;return r}function Ws(e){var t=1,n=0,r=e[0][1],i,s=e.length;for(;t<s;++t)(i=e[t][1])>r&&(n=t,r=i);return n}function Xs(e){return e.reduce(Vs,0)}function Vs(e,t){return e+t[1]}function $s(e,t){return Js(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function Js(e,t){var n=-1,r=+e[0],i=(e[1]-r)/t,s=[];while(++n<=t)s[n]=i*n+r;return s}function Ks(t){return[e.min(t),e.max(t)]}function Qs(e,t){return e.parent==t.parent?1:2}function Gs(e){var t=e.children;return t&&t.length?t[0]:e._tree.thread}function Ys(e){var t=e.children,n;return t&&(n=t.length)?t[n-1]:e._tree.thread}function Zs(e,t){var n=e.children;if(n&&(i=n.length)){var r,i,s=-1;while(++s<i)t(r=Zs(n[s],t),e)>0&&(e=r)}return e}function eo(e,t){return e.x-t.x}function to(e,t){return t.x-e.x}function no(e,t){return e.depth-t.depth}function ro(e,t){function n(e,r){var i=e.children;if(i&&(a=i.length)){var s,o=null,u=-1,a;while(++u<a)s=i[u],n(s,o),o=s}t(e,r)}n(e,null)}function io(e){var t=0,n=0,r=e.children,i=r.length,s;while(--i>=0)s=r[i]._tree,s.prelim+=t,s.mod+=t,t+=s.shift+(n+=s.change)}function so(e,t,n){e=e._tree,t=t._tree;var r=n/(t.number-e.number);e.change+=r,t.change-=r,t.shift+=n,t.prelim+=n,t.mod+=n}function oo(e,t,n){return e._tree.ancestor.parent==t.parent?e._tree.ancestor:n}function uo(e,t){return e.value-t.value}function ao(e,t){var n=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=n,n._pack_prev=t}function fo(e,t){e._pack_next=t,t._pack_prev=e}function lo(e,t){var n=t.x-e.x,r=t.y-e.y,i=e.r+t.r;return i*i-n*n-r*r>.001}function co(e){function p(e){n=Math.min(e.x-e.r,n),r=Math.max(e.x+e.r,r),i=Math.min(e.y-e.r,i),s=Math.max(e.y+e.r,s)}if(!(t=e.children)||!(h=t.length))return;var t,n=Infinity,r=-Infinity,i=Infinity,s=-Infinity,o,u,a,f,l,c,h;t.forEach(ho),o=t[0],o.x=-o.r,o.y=0,p(o);if(h>1){u=t[1],u.x=u.r,u.y=0,p(u);if(h>2){a=t[2],mo(o,u,a),p(a),ao(o,a),o._pack_prev=a,ao(a,u),u=o._pack_next;for(f=3;f<h;f++){mo(o,u,a=t[f]);var d=0,v=1,m=1;for(l=u._pack_next;l!==u;l=l._pack_next,v++)if(lo(l,a)){d=1;break}if(d==1)for(c=o._pack_prev;c!==l._pack_prev;c=c._pack_prev,m++)if(lo(c,a))break;d?(v<m||v==m&&u.r<o.r?fo(o,u=l):fo(o=c,u),f--):(ao(o,a),u=a,p(a))}}}var g=(n+r)/2,y=(i+s)/2,b=0;for(f=0;f<h;f++)a=t[f],a.x-=g,a.y-=y,b=Math.max(b,a.r+Math.sqrt(a.x*a.x+a.y*a.y));e.r=b,t.forEach(po)}function ho(e){e._pack_next=e._pack_prev=e}function po(e){delete e._pack_next,delete e._pack_prev}function vo(e,t,n,r){var i=e.children;e.x=t+=r*e.x,e.y=n+=r*e.y,e.r*=r;if(i){var s=-1,o=i.length;while(++s<o)vo(i[s],t,n,r)}}function mo(e,t,n){var r=e.r+n.r,i=t.x-e.x,s=t.y-e.y;if(r&&(i||s)){var o=t.r+n.r,u=i*i+s*s;o*=o,r*=r;var a=.5+(r-o)/(2*u),f=Math.sqrt(Math.max(0,2*o*(r+u)-(r-=u)*r-o*o))/(2*u);n.x=e.x+a*i+f*s,n.y=e.y+a*s-f*i}else n.x=e.x+r,n.y=e.y}function go(t){return 1+e.max(t,function(e){return e.y})}function yo(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function bo(e){var t=e.children;return t&&t.length?bo(t[0]):e}function wo(e){var t=e.children,n;return t&&(n=t.length)?wo(t[n-1]):e}function Eo(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function So(e,t){var n=e.x+t[3],r=e.y+t[0],i=e.dx-t[1]-t[3],s=e.dy-t[0]-t[2];return i<0&&(n+=i/2,i=0),s<0&&(r+=s/2,s=0),{x:n,y:r,dx:i,dy:s}}function xo(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function To(e){return e.rangeExtent?e.rangeExtent():xo(e.range())}function No(e,t,n,r){var i=n(e[0],e[1]),s=r(t[0],t[1]);return function(e){return s(i(e))}}function Co(e,t){var n=0,r=e.length-1,i=e[n],s=e[r],o;s<i&&(o=n,n=r,r=o,o=i,i=s,s=o);if(t=t(s-i))e[n]=t.floor(i),e[r]=t.ceil(s);return e}function ko(t,n,r,i){var s=[],o=[],u=0,a=Math.min(t.length,n.length)-1;t[a]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());while(++u<=a)s.push(r(t[u-1],t[u])),o.push(i(n[u-1],n[u]));return function(n){var r=e.bisect(t,n,1,a)-1;return o[r](s[r](n))}}function Lo(e,t,n,r){function o(){var o=Math.min(e.length,t.length)>2?ko:No,a=r?ws:bs;return i=o(e,t,a,n),s=o(t,e,a,Qi),u}function u(e){return i(e)}var i,s;return u.invert=function(e){return s(e)},u.domain=function(t){return arguments.length?(e=t.map(Number),o()):e},u.range=function(e){return arguments.length?(t=e,o()):t},u.rangeRound=function(e){return u.range(e).interpolate(ys)},u.clamp=function(e){return arguments.length?(r=e,o()):r},u.interpolate=function(e){return arguments.length?(n=e,o()):n},u.ticks=function(t){return _o(e,t)},u.tickFormat=function(t,n){return Do(e,t,n)},u.nice=function(){return Co(e,Oo),o()},u.copy=function(){return Lo(e,t,n,r)},o()}function Ao(t,n){return e.rebind(t,n,"range","rangeRound","interpolate","clamp")}function Oo(e){return e=Math.pow(10,Math.round(Math.log(e)/Math.LN10)-1),e&&{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}}function Mo(e,t){var n=xo(e),r=n[1]-n[0],i=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),s=t/r*i;return s<=.15?i*=10:s<=.35?i*=5:s<=.75&&(i*=2),n[0]=Math.ceil(n[0]/i)*i,n[1]=Math.floor(n[1]/i)*i+i*.5,n[2]=i,n}function _o(t,n){return e.range.apply(e,Mo(t,n))}function Do(t,n,r){var i=-Math.floor(Math.log(Mo(t,n)[2])/Math.LN10+.01);return e.format(r?r.replace(dn,function(e,t,n,r,s,o,u,a,f,l){return[t,n,r,s,o,u,a,f||"."+(i-(l==="%")*2),l].join("")}):",."+i+"f")}function Po(e,t,n,r){function i(t){return e(n(t))}return i.invert=function(t){return r(e.invert(t))},i.domain=function(t){return arguments.length?(t[0]<0?(n=Fo,r=Io):(n=Bo,r=jo),e.domain(t.map(n)),i):e.domain().map(r)},i.base=function(e){return arguments.length?(t=+e,i):t},i.nice=function(){return e.domain(Co(e.domain(),qo(t))),i},i.ticks=function(){var i=xo(e.domain()),s=[];if(i.every(isFinite)){var o=Math.log(t),u=Math.floor(i[0]/o),a=Math.ceil(i[1]/o),f=r(i[0]),l=r(i[1]),c=t%1?2:t;if(n===Fo){s.push(-Math.pow(t,-u));for(;u++<a;)for(var h=c-1;h>0;h--)s.push(-Math.pow(t,-u)*h)}else{for(;u<a;u++)for(var h=1;h<c;h++)s.push(Math.pow(t,u)*h);s.push(Math.pow(t,u))}for(u=0;s[u]<f;u++);for(a=s.length;s[a-1]>l;a--);s=s.slice(u,a)}return s},i.tickFormat=function(e,s){arguments.length<2&&(s=Ho);if(!arguments.length)return s;var o=Math.log(t),u=Math.max(.1,e/i.ticks().length),a=n===Fo?(f=-1e-12,Math.floor):(f=1e-12,Math.ceil),f;return function(e){return e/r(o*a(n(e)/o+f))<=u?s(e):""}},i.copy=function(){return Po(e.copy(),t,n,r)},Ao(i,e)}function Bo(e){return Math.log(e<0?0:e)}function jo(e){return Math.exp(e)}function Fo(e){return-Math.log(e>0?0:-e)}function Io(e){return-Math.exp(-e)}function qo(e){e=Math.log(e);var t={floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}};return function(){return t}}function Ro(e,t){function i(t){return e(n(t))}var n=Uo(t),r=Uo(1/t);return i.invert=function(t){return r(e.invert(t))},i.domain=function(t){return arguments.length?(e.domain(t.map(n)),i):e.domain().map(r)},i.ticks=function(e){return _o(i.domain(),e)},i.tickFormat=function(e,t){return Do(i.domain(),e,t)},i.nice=function(){return i.domain(Co(i.domain(),Oo))},i.exponent=function(e){if(!arguments.length)return t;var s=i.domain();return n=Uo(t=e),r=Uo(1/t),i.domain(s)},i.copy=function(){return Ro(e.copy(),t)},Ao(i,e)}function Uo(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function zo(t,n){function o(e){return i[((r.get(e)||r.set(e,t.push(e)))-1)%i.length]}function u(n,r){return e.range(t.length).map(function(e){return n+r*e})}var r,i,s;return o.domain=function(e){if(!arguments.length)return t;t=[],r=new c;var i=-1,s=e.length,u;while(++i<s)r.has(u=e[i])||r.set(u,t.push(u));return o[n.t].apply(o,n.a)},o.range=function(e){return arguments.length?(i=e,s=0,n={t:"range",a:arguments},o):i},o.rangePoints=function(e,r){arguments.length<2&&(r=0);var a=e[0],f=e[1],l=(f-a)/(Math.max(1,t.length-1)+r);return i=u(t.length<2?(a+f)/2:a+l*r/2,l),s=0,n={t:"rangePoints",a:arguments},o},o.rangeBands=function(e,r,a){arguments.length<2&&(r=0),arguments.length<3&&(a=r);var f=e[1]<e[0],l=e[f-0],c=e[1-f],h=(c-l)/(t.length-r+2*a);return i=u(l+h*a,h),f&&i.reverse(),s=h*(1-r),n={t:"rangeBands",a:arguments},o},o.rangeRoundBands=function(e,r,a){arguments.length<2&&(r=0),arguments.length<3&&(a=r);var f=e[1]<e[0],l=e[f-0],c=e[1-f],h=Math.floor((c-l)/(t.length-r+2*a)),p=c-l-(t.length-r)*h;return i=u(l+Math.round(p/2),h),f&&i.reverse(),s=Math.round(h*(1-r)),n={t:"rangeRoundBands",a:arguments},o},o.rangeBand=function(){return s},o.rangeExtent=function(){return xo(n.a[0])},o.copy=function(){return zo(t,n)},o.domain(t)}function Jo(t,n){function i(){var i=0,o=n.length;r=[];while(++i<o)r[i-1]=e.quantile(t,i/o);return s}function s(t){return isNaN(t=+t)?NaN:n[e.bisect(r,t)]}var r;return s.domain=function(n){return arguments.length?(t=n.filter(function(e){return!isNaN(e)}).sort(e.ascending),i()):t},s.range=function(e){return arguments.length?(n=e,i()):n},s.quantiles=function(){return r},s.copy=function(){return Jo(t,n)},i()}function Ko(e,t,n){function s(t){return n[Math.max(0,Math.min(i,Math.floor(r*(t-e))))]}function o(){return r=n.length/(t-e),i=n.length-1,s}var r,i;return s.domain=function(n){return arguments.length?(e=+n[0],t=+n[n.length-1],o()):[e,t]},s.range=function(e){return arguments.length?(n=e,o()):n},s.copy=function(){return Ko(e,t,n)},o()}function Qo(t,n){function r(r){return n[e.bisect(t,r)]}return r.domain=function(e){return arguments.length?(t=e,r):t},r.range=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return Qo(t,n)},r}function Go(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e},t.ticks=function(t){return _o(e,t)},t.tickFormat=function(t,n){return Do(e,t,n)},t.copy=function(){return Go(e)},t}function eu(e){return e.innerRadius}function tu(e){return e.outerRadius}function nu(e){return e.startAngle}function ru(e){return e.endAngle}function iu(e){var t,n=-1,r=e.length,i,s;while(++n<r)t=e[n],i=t[0],s=t[1]+Yo,t[0]=i*Math.cos(s),t[1]=i*Math.sin(s);return e}function su(e){function c(u){function x(){c.push("M",o(e(p),l),f,a(e(h.reverse()),l),"Z")}var c=[],h=[],p=[],d=-1,v=u.length,m,g=Qt(t),y=Qt(r),b=t===n?function(){return E}:Qt(n),w=r===i?function(){return S}:Qt(i),E,S;while(++d<v)s.call(this,m=u[d],d)?(h.push([E=+g.call(this,m,d),S=+y.call(this,m,d)]),p.push([+b.call(this,m,d),+w.call(this,m,d)])):h.length&&(x(),h=[],p=[]);return h.length&&x(),c.length?c.join(""):null}var t=si,n=si,r=0,i=oi,s=$n,o=ai,u=o.key,a=o,f="L",l=.7;return c.x=function(e){return arguments.length?(t=n=e,c):n},c.x0=function(e){return arguments.length?(t=e,c):t},c.x1=function(e){return arguments.length?(n=e,c):n},c.y=function(e){return arguments.length?(r=i=e,c):i},c.y0=function(e){return arguments.length?(r=e,c):r},c.y1=function(e){return arguments.length?(i=e,c):i},c.defined=function(e){return arguments.length?(s=e,c):s},c.interpolate=function(e){return arguments.length?(typeof e=="function"?u=o=e:u=(o=ui.get(e)||ai).key,a=o.reverse||o,f=o.closed?"M":"L",c):u},c.tension=function(e){return arguments.length?(l=e,c):l},c}function ou(e){return e.radius}function uu(e){return[e.x,e.y]}function au(e){return function(){var t=e.apply(this,arguments),n=t[0],r=t[1]+Yo;return[n*Math.cos(r),n*Math.sin(r)]}}function fu(){return 64}function lu(){return"circle"}function cu(e){var t=Math.sqrt(e/dt);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+ -t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function vu(e,t){return A(e,mu),e.id=t,e}function wu(e,t,n,r){var i=e.id;return nt(e,typeof n=="function"?function(e,s,o){e.__transition__[i].tween.set(t,r(n.call(e,e.__data__,s,o)))}:(n=r(n),function(e){e.__transition__[i].tween.set(t,n)}))}function Eu(e){return e==null&&(e=""),function(){this.textContent=e}}function Su(t,n,r,i){var s=t.__transition__||(t.__transition__={active:0,count:0}),o=s[r];if(!o){var u=i.time;return o=s[r]={tween:new c,event:e.dispatch("start","end"),time:u,ease:i.ease,delay:i.delay,duration:i.duration},++s.count,e.timer(function(i){function d(i){return s.active>r?m():(s.active=r,l.start.call(t,a,n),o.tween.forEach(function(e,r){(r=r.call(t,a,n))&&p.push(r)}),v(i)||e.timer(v,0,u),1)}function v(e){if(s.active!==r)return m();var i=(e-c)/h,o=f(i),u=p.length;while(u>0)p[--u].call(t,o);if(i>=1)return m(),l.end.call(t,a,n),1}function m(){return--s.count?delete s[r]:delete t.__transition__,1}var a=t.__data__,f=o.ease,l=o.event,c=o.delay,h=o.duration,p=[];return c<=i?d(i):e.timer(d,c,u),1},0,u),o}}function Nu(e,t){e.attr("transform",function(e){return"translate("+t(e)+",0)"})}function Cu(e,t){e.attr("transform",function(e){return"translate(0,"+t(e)+")"})}function ku(e,t,n){i=[];if(n&&t.length>1){var r=xo(e.domain()),i,s=-1,o=t.length,u=(t[1]-t[0])/++n,a,f;while(++s<o)for(a=n;--a>0;)(f=+t[s]-a*u)>=r[0]&&i.push(f);for(--s,a=0;++a<n&&(f=+t[s]+a*u)<r[1];)i.push(f)}return i}function _u(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Ru(e,t,n){function r(t){var n=e(t),r=s(n,1);return t-n<r-t?n:r}function i(n){return t(n=e(new Ou(n-1)),1),n}function s(e,n){return t(e=new Ou(+e),n),e}function o(e,r,s){var o=i(e),u=[];if(s>1)while(o<r)n(o)%s||u.push(new Date(+o)),t(o,1);else while(o<r)u.push(new Date(+o)),t(o,1);return u}function u(e,t,n){try{Ou=_u;var r=new _u;return r._=e,o(r,t,n)}finally{Ou=Date}}e.floor=e,e.round=r,e.ceil=i,e.offset=s,e.range=o;var a=e.utc=Uu(e);return a.floor=a,a.round=Uu(r),a.ceil=Uu(i),a.offset=Uu(s),a.range=u,e}function Uu(e){return function(t,n){try{Ou=_u;var r=new _u;return r._=t,e(r,n)._}finally{Ou=Date}}}function zu(e,t,n,r){var i,s,o=0,u=t.length,a=n.length;while(o<u){if(r>=a)return-1;i=t.charCodeAt(o++);if(i===37){s=ta[t.charAt(o++)];if(!s||(r=s(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function Wu(t){return new RegExp("^(?:"+t.map(e.requote).join("|")+")","i")}function Xu(e){var t=new c,n=-1,r=e.length;while(++n<r)t.set(e[n].toLowerCase(),n);return t}function Vu(e,t,n){e+="";var r=e.length;return r<n?(new Array(n-r+1)).join(t)+e:e}function na(e,t,n){Ju.lastIndex=0;var r=Ju.exec(t.substring(n));return r?n+=r[0].length:-1}function ra(e,t,n){$u.lastIndex=0;var r=$u.exec(t.substring(n));return r?n+=r[0].length:-1}function ia(e,t,n){Gu.lastIndex=0;var r=Gu.exec(t.substring(n));return r?(e.m=Yu.get(r[0].toLowerCase()),n+=r[0].length):-1}function sa(e,t,n){Ku.lastIndex=0;var r=Ku.exec(t.substring(n));return r?(e.m=Qu.get(r[0].toLowerCase()),n+=r[0].length):-1}function oa(e,t,n){return zu(e,ea.c.toString(),t,n)}function ua(e,t,n){return zu(e,ea.x.toString(),t,n)}function aa(e,t,n){return zu(e,ea.X.toString(),t,n)}function fa(e,t,n){ya.lastIndex=0;var r=ya.exec(t.substring(n,n+4));return r?(e.y=+r[0],n+=r[0].length):-1}function la(e,t,n){ya.lastIndex=0;var r=ya.exec(t.substring(n,n+2));return r?(e.y=ca(+r[0]),n+=r[0].length):-1}function ca(e){return e+(e>68?1900:2e3)}function ha(e,t,n){ya.lastIndex=0;var r=ya.exec(t.substring(n,n+2));return r?(e.m=r[0]-1,n+=r[0].length):-1}function pa(e,t,n){ya.lastIndex=0;var r=ya.exec(t.substring(n,n+2));return r?(e.d=+r[0],n+=r[0].length):-1}function da(e,t,n){ya.lastIndex=0;var r=ya.exec(t.substring(n,n+2));return r?(e.H=+r[0],n+=r[0].length):-1}function va(e,t,n){ya.lastIndex=0;var r=ya.exec(t.substring(n,n+2));return r?(e.M=+r[0],n+=r[0].length):-1}function ma(e,t,n){ya.lastIndex=0;var r=ya.exec(t.substring(n,n+2));return r?(e.S=+r[0],n+=r[0].length):-1}function ga(e,t,n){ya.lastIndex=0;var r=ya.exec(t.substring(n,n+3));return r?(e.L=+r[0],n+=r[0].length):-1}function ba(e,t,n){var r=wa.get(t.substring(n,n+=2).toLowerCase());return r==null?-1:(e.p=r,n)}function Ea(e){var t=e.getTimezoneOffset(),n=t>0?"-":"+",r=~~(Math.abs(t)/60),i=Math.abs(t)%60;return n+Vu(r,"0",2)+Vu(i,"0",2)}function xa(e){return e.toISOString()}function Ta(t,n,r){function i(e){return t(e)}return i.invert=function(e){return Ca(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain().map(Ca)},i.nice=function(e){return i.domain(Co(i.domain(),function(){return e}))},i.ticks=function(r,s){var o=Na(i.domain());if(typeof r!="function"){var u=o[1]-o[0],a=u/r,f=e.bisect(Oa,a);if(f==Oa.length)return n.year(o,r);if(!f)return t.ticks(r).map(Ca);Math.log(a/Oa[f-1])<Math.log(Oa[f]/a)&&--f,r=n[f],s=r[1],r=r[0].range}return r(o[0],new Date(+o[1]+1),s)},i.tickFormat=function(){return r},i.copy=function(){return Ta(t.copy(),n,r)},e.rebind(i,t,"range","rangeRound","interpolate","clamp")}function Na(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function Ca(e){return new Date(e)}function ka(e){return function(t){var n=e.length-1,r=e[n];while(!r[1](t))r=e[--n];return r[0](t)}}function La(e){var t=new Date(e,0,1);return t.setFullYear(e),t}function Aa(e){var t=e.getFullYear(),n=La(t),r=La(t+1);return t+(e-n)/(r-n)}function Fa(e){var t=new Date(Date.UTC(e,0,1));return t.setUTCFullYear(e),t}function Ia(e){var t=e.getUTCFullYear(),n=Fa(t),r=Fa(t+1);return t+(e-n)/(r-n)}function qa(e){return e.responseText}function Ra(e){return JSON.parse(e.responseText)}function Ua(e){var n=t.createRange();return n.selectNode(t.body),n.createContextualFragment(e.responseText)}function za(e){return e.responseXML}var e={version:"3.1.5"};Date.now||(Date.now=function(){return+(new Date)});var t=document,n=window;try{t.createElement("div").style.setProperty("opacity",0,"")}catch(r){var i=n.CSSStyleDeclaration.prototype,s=i.setProperty;i.setProperty=function(e,t,n){s.call(this,e,t+"",n)}}e.ascending=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},e.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},e.min=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i))i=undefined;while(++n<r)(s=e[n])!=null&&i>s&&(i=s)}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&i>s&&(i=s)}return i},e.max=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i))i=undefined;while(++n<r)(s=e[n])!=null&&s>i&&(i=s)}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&s>i&&(i=s)}return i},e.extent=function(e,t){var n=-1,r=e.length,i,s,o;if(arguments.length===1){while(++n<r&&((i=o=e[n])==null||i!=i))i=o=undefined;while(++n<r)(s=e[n])!=null&&(i>s&&(i=s),o<s&&(o=s))}else{while(++n<r&&((i=o=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&(i>s&&(i=s),o<s&&(o=s))}return[i,o]},e.sum=function(e,t){var n=0,r=e.length,i,s=-1;if(arguments.length===1)while(++s<r)isNaN(i=+e[s])||(n+=i);else while(++s<r)isNaN(i=+t.call(e,e[s],s))||(n+=i);return n},e.mean=function(e,t){var n=e.length,r,i=0,s=-1,u=0;if(arguments.length===1)while(++s<n)o(r=e[s])&&(i+=(r-i)/++u);else while(++s<n)o(r=t.call(e,e[s],s))&&(i+=(r-i)/++u);return u?i:undefined},e.quantile=function(e,t){var n=(e.length-1)*t+1,r=Math.floor(n),i=+e[r-1],s=n-r;return s?i+s*(e[r]-i):i},e.median=function(t,n){return arguments.length>1&&(t=t.map(n)),t=t.filter(o),t.length?e.quantile(t.sort(e.ascending),.5):undefined},e.bisector=function(e){return{left:function(t,n,r,i){arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);while(r<i){var s=r+i>>>1;e.call(t,t[s],s)<n?r=s+1:i=s}return r},right:function(t,n,r,i){arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);while(r<i){var s=r+i>>>1;n<e.call(t,t[s],s)?i=s:r=s+1}return r}}};var u=e.bisector(function(e){return e});e.bisectLeft=u.left,e.bisect=e.bisectRight=u.right,e.shuffle=function(e){var t=e.length,n,r;while(t)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e},e.permute=function(e,t){var n=[],r=-1,i=t.length;while(++r<i)n[r]=e[t[r]];return n},e.zip=function(){if(!(s=arguments.length))return[];for(var t=-1,n=e.min(arguments,a),r=new Array(n);++t<n;)for(var i=-1,s,o=r[t]=new Array(s);++i<s;)o[i]=arguments[i][t];return r},e.transpose=function(t){return e.zip.apply(e,t)},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t},e.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},e.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},e.merge=function(e){return Array.prototype.concat.apply([],e)},e.range=function(e,t,n){arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0));if((t-e)/n===Infinity)throw new Error("infinite range");var r=[],i=f(Math.abs(n)),s=-1,o;e*=i,t*=i,n*=i;if(n<0)while((o=e+n*++s)>t)r.push(o/i);else while((o=e+n*++s)<t)r.push(o/i);return r},e.map=function(e){var t=new c;for(var n in e)t.set(n,e[n]);return t},l(c,{has:function(e){return h+e in this},get:function(e){return this[h+e]},set:function(e,t){return this[h+e]=t},remove:function(e){return e=h+e,e in this&&delete this[e]},keys:function(){var e=[];return this.forEach(function(t){e.push(t)}),e},values:function(){var e=[];return this.forEach(function(t,n){e.push(n)}),e},entries:function(){var e=[];return this.forEach(function(t,n){e.push({key:t,value:n})}),e},forEach:function(e){for(var t in this)t.charCodeAt(0)===p&&e.call(this,t.substring(1),this[t])}});var h="\0",p=h.charCodeAt(0);e.nest=function(){function o(e,r,u){if(u>=n.length)return s?s.call(t,r):i?r.sort(i):r;var a=-1,f=r.length,l=n[u++],h,p,d,v=new c,m;while(++a<f)(m=v.get(h=l(p=r[a])))?m.push(p):v.set(h,[p]);return e?(p=e(),d=function(t,n){p.set(t,o(e,n,u))}):(p={},d=function(t,n){p[t]=o(e,n,u)}),v.forEach(d),p}function u(e,t){if(t>=n.length)return e;var i=[],s=r[t++];return e.forEach(function(e,n){i.push({key:e,values:u(n,t)})}),s?i.sort(function(e,t){return s(e.key,t.key)}):i}var t={},n=[],r=[],i,s;return t.map=function(e,t){return o(t,e,0)},t.entries=function(t){return u(o(e.map,t,0),0)},t.key=function(e){return n.push(e),t},t.sortKeys=function(e){return r[n.length-1]=e,t},t.sortValues=function(e){return i=e,t},t.rollup=function(e){return s=e,t},t},e.set=function(e){var t=new d;if(e)for(var n=0;n<e.length;n++)t.add(e[n]);return t},l(d,{has:function(e){return h+e in this},add:function(e){return this[h+e]=!0,e},remove:function(e){return e=h+e,e in this&&delete this[e]},values:function(){var e=[];return this.forEach(function(t){e.push(t)}),e},forEach:function(e){for(var t in this)t.charCodeAt(0)===p&&e.call(this,t.substring(1))}}),e.behavior={},e.rebind=function(e,t){var n=1,r=arguments.length,i;while(++n<r)e[i=arguments[n]]=v(e,t,t[i]);return e},e.dispatch=function(){var e=new m,t=-1,n=arguments.length;while(++t<n)e[arguments[t]]=g(e);return e},m.prototype.on=function(e,t){var n=e.indexOf("."),r="";n>=0&&(r=e.substring(n+1),e=e.substring(0,n));if(e)return arguments.length<2?this[e].on(r):this[e].on(r,t);if(arguments.length===2){if(t==null)for(e in this)this.hasOwnProperty(e)&&this[e].on(r,null);return this}},e.event=null,e.mouse=function(e){return T(e,w())};var x=/WebKit/.test(n.navigator.userAgent)?-1:0,N=k;try{N(t.documentElement.childNodes)[0].nodeType}catch(L){N=C}var A=[].__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)e[n]=t[n]};e.touches=function(e,t){return arguments.length<2&&(t=w().touches),t?N(t).map(function(t){var n=T(e,t);return n.identifier=t.identifier,n}):[]},e.behavior.drag=function(){function i(){this.on("mousedown.drag",s).on("touchstart.drag",s)}function s(){function h(){var t=i.parentNode;return u!=null?e.touches(t).filter(function(e){return e.identifier===u})[0]:e.mouse(t)}function p(){if(!i.parentNode)return d();var e=h(),t=e[0]-f[0],n=e[1]-f[1];l|=t|n,f=e,y(),s({type:"drag",x:e[0]+a[0],y:e[1]+a[1],dx:t,dy:n})}function d(){s({type:"dragend"}),l&&(y(),e.event.target===o&&E(c,"click")),c.on(u!=null?"touchmove.drag-"+u:"mousemove.drag",null).on(u!=null?"touchend.drag-"+u:"mouseup.drag",null)}var i=this,s=t.of(i,arguments),o=e.event.target,u=e.event.touches?e.event.changedTouches[0].identifier:null,a,f=h(),l=0,c=e.select(n).on(u!=null?"touchmove.drag-"+u:"mousemove.drag",p).on(u!=null?"touchend.drag-"+u:"mouseup.drag",d,!0);r?(a=r.apply(i,arguments),a=[a.x-f[0],a.y-f[1]]):a=[0,0],u==null&&y(),s({type:"dragstart"})}var t=
S(i,"drag","dragstart","dragend"),r=null;return i.origin=function(e){return arguments.length?(r=e,i):r},e.rebind(i,t,"on")};var M=function(e,t){return t.querySelector(e)},_=function(e,t){return t.querySelectorAll(e)},D=t.documentElement,P=D.matchesSelector||D.webkitMatchesSelector||D.mozMatchesSelector||D.msMatchesSelector||D.oMatchesSelector,H=function(e,t){return P.call(e,t)};typeof Sizzle=="function"&&(M=function(e,t){return Sizzle(e,t)[0]||null},_=function(e,t){return Sizzle.uniqueSort(Sizzle(e,t))},H=Sizzle.matchesSelector);var B=[];e.selection=function(){return st},e.selection.prototype=B,B.select=function(e){var t=[],n,r,i,s;typeof e!="function"&&(e=j(e));for(var o=-1,u=this.length;++o<u;){t.push(n=[]),n.parentNode=(i=this[o]).parentNode;for(var a=-1,f=i.length;++a<f;)(s=i[a])?(n.push(r=e.call(s,s.__data__,a)),r&&"__data__"in s&&(r.__data__=s.__data__)):n.push(null)}return O(t)},B.selectAll=function(e){var t=[],n,r;typeof e!="function"&&(e=F(e));for(var i=-1,s=this.length;++i<s;)for(var o=this[i],u=-1,a=o.length;++u<a;)if(r=o[u])t.push(n=N(e.call(r,r.__data__,u))),n.parentNode=r;return O(t)};var I={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};e.ns={prefix:I,qualify:function(e){var t=e.indexOf(":"),n=e;return t>=0&&(n=e.substring(0,t),e=e.substring(t+1)),I.hasOwnProperty(n)?{space:I[n],local:e}:e}},B.attr=function(t,n){if(arguments.length<2){if(typeof t=="string"){var r=this.node();return t=e.ns.qualify(t),t.local?r.getAttributeNS(t.space,t.local):r.getAttribute(t)}for(n in t)this.each(q(n,t[n]));return this}return this.each(q(t,n))},e.requote=function(e){return e.replace(U,"\\$&")};var U=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;B.classed=function(e,t){if(arguments.length<2){if(typeof e=="string"){var n=this.node(),r=(e=e.trim().split(/^|\s+/g)).length,i=-1;if(t=n.classList){while(++i<r)if(!t.contains(e[i]))return!1}else{t=n.getAttribute("class");while(++i<r)if(!z(e[i]).test(t))return!1}return!0}for(t in e)this.each(W(t,e[t]));return this}return this.each(W(e,t))},B.style=function(e,t,r){var i=arguments.length;if(i<3){if(typeof e!="string"){i<2&&(t="");for(r in e)this.each(V(r,e[r],t));return this}if(i<2)return n.getComputedStyle(this.node(),null).getPropertyValue(e);r=""}return this.each(V(e,t,r))},B.property=function(e,t){if(arguments.length<2){if(typeof e=="string")return this.node()[e];for(t in e)this.each($(t,e[t]));return this}return this.each($(e,t))},B.text=function(e){return arguments.length?this.each(typeof e=="function"?function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}:e==null?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},B.html=function(e){return arguments.length?this.each(typeof e=="function"?function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}:e==null?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},B.append=function(n){function r(){return this.appendChild(t.createElementNS(this.namespaceURI,n))}function i(){return this.appendChild(t.createElementNS(n.space,n.local))}return n=e.ns.qualify(n),this.select(n.local?i:r)},B.insert=function(n,r){function i(e,i){return this.insertBefore(t.createElementNS(this.namespaceURI,n),r.call(this,e,i))}function s(e,i){return this.insertBefore(t.createElementNS(n.space,n.local),r.call(this,e,i))}return n=e.ns.qualify(n),typeof r!="function"&&(r=j(r)),this.select(n.local?s:i)},B.remove=function(){return this.each(function(){var e=this.parentNode;e&&e.removeChild(this)})},B.data=function(e,t){function o(e,n){var r,i=e.length,s=n.length,o=Math.min(i,s),l=new Array(s),h=new Array(s),p=new Array(i),d,v;if(t){var m=new c,g=new c,y=[],b;for(r=-1;++r<i;)b=t.call(d=e[r],d.__data__,r),m.has(b)?p[r]=d:m.set(b,d),y.push(b);for(r=-1;++r<s;)b=t.call(n,v=n[r],r),(d=m.get(b))?(l[r]=d,d.__data__=v):g.has(b)||(h[r]=J(v)),g.set(b,v),m.remove(b);for(r=-1;++r<i;)m.has(y[r])&&(p[r]=e[r])}else{for(r=-1;++r<o;)d=e[r],v=n[r],d?(d.__data__=v,l[r]=d):h[r]=J(v);for(;r<s;++r)h[r]=J(n[r]);for(;r<i;++r)p[r]=e[r]}h.update=l,h.parentNode=l.parentNode=p.parentNode=e.parentNode,u.push(h),a.push(l),f.push(p)}var n=-1,r=this.length,i,s;if(!arguments.length){e=new Array(r=(i=this[0]).length);while(++n<r)if(s=i[n])e[n]=s.__data__;return e}var u=rt([]),a=O([]),f=O([]);if(typeof e=="function")while(++n<r)o(i=this[n],e.call(i,i.parentNode.__data__,n));else while(++n<r)o(i=this[n],e);return a.enter=function(){return u},a.exit=function(){return f},a},B.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")},B.filter=function(e){var t=[],n,r,i;typeof e!="function"&&(e=K(e));for(var s=0,o=this.length;s<o;s++){t.push(n=[]),n.parentNode=(r=this[s]).parentNode;for(var u=0,a=r.length;u<a;u++)(i=r[u])&&e.call(i,i.__data__,u)&&n.push(i)}return O(t)},B.order=function(){for(var e=-1,t=this.length;++e<t;)for(var n=this[e],r=n.length-1,i=n[r],s;--r>=0;)if(s=n[r])i&&i!==s.nextSibling&&i.parentNode.insertBefore(s,i),i=s;return this},B.sort=function(e){e=Q.apply(this,arguments);for(var t=-1,n=this.length;++t<n;)this[t].sort(e);return this.order()},B.on=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t=!1);for(n in e)this.each(Y(n,e[n],t));return this}if(r<2)return(r=this.node()["__on"+e])&&r._;n=!1}return this.each(Y(e,t,n))};var Z=e.map({mouseenter:"mouseover",mouseleave:"mouseout"});Z.forEach(function(e){"on"+e in t&&Z.remove(e)}),B.each=function(e){return nt(this,function(t,n,r){e.call(t,t.__data__,n,r)})},B.call=function(e){var t=N(arguments);return e.apply(t[0]=this,t),this},B.empty=function(){return!this.node()},B.node=function(){for(var e=0,t=this.length;e<t;e++)for(var n=this[e],r=0,i=n.length;r<i;r++){var s=n[r];if(s)return s}return null};var it=[];e.selection.enter=rt,e.selection.enter.prototype=it,it.append=B.append,it.insert=B.insert,it.empty=B.empty,it.node=B.node,it.select=function(e){var t=[],n,r,i,s,o;for(var u=-1,a=this.length;++u<a;){i=(s=this[u]).update,t.push(n=[]),n.parentNode=s.parentNode;for(var f=-1,l=s.length;++f<l;)(o=s[f])?(n.push(i[f]=r=e.call(s.parentNode,o.__data__,f)),r.__data__=o.__data__):n.push(null)}return O(t)},B.transition=function(){var e=yu||++gu,t=[],n,r,i=Object.create(bu);i.time=Date.now();for(var s=-1,o=this.length;++s<o;){t.push(n=[]);for(var u=this[s],a=-1,f=u.length;++a<f;)(r=u[a])&&Su(r,a,e,i),n.push(r)}return vu(t,e)};var st=O([[t]]);st[0].parentNode=D,e.select=function(e){return typeof e=="string"?st.select(e):O([[e]])},e.selectAll=function(e){return typeof e=="string"?st.selectAll(e):O([N(e)])},e.behavior.zoom=function(){function p(){this.on("mousedown.zoom",x).on("mousemove.zoom",N).on(at+".zoom",T).on("dblclick.zoom",C).on("touchstart.zoom",k).on("touchmove.zoom",L).on("touchend.zoom",k)}function d(e){return[(e[0]-t[0])/i,(e[1]-t[1])/i]}function v(e){return[e[0]*i+t[0],e[1]*i+t[1]]}function m(e){i=Math.max(o[0],Math.min(o[1],e))}function g(e,n){n=v(n),t[0]+=e[0]-n[0],t[1]+=e[1]-n[1]}function b(){f&&f.domain(a.range().map(function(e){return(e-t[0])/i}).map(a.invert)),c&&c.domain(l.range().map(function(e){return(e-t[1])/i}).map(l.invert))}function w(n){b(),e.event.preventDefault(),n({type:"zoom",scale:i,translate:t})}function x(){function f(){s=1,g(e.mouse(t),a),w(r)}function l(){s&&y(),o.on("mousemove.zoom",null).on("mouseup.zoom",null),s&&e.event.target===i&&E(o,"click.zoom")}var t=this,r=u.of(t,arguments),i=e.event.target,s=0,o=e.select(n).on("mousemove.zoom",f).on("mouseup.zoom",l),a=d(e.mouse(t));n.focus(),y()}function T(){r||(r=d(e.mouse(this))),m(Math.pow(2,ut()*.002)*i),g(e.mouse(this),r),w(u.of(this,arguments))}function N(){r=null}function C(){var t=e.mouse(this),n=d(t),r=Math.log(i)/Math.LN2;m(Math.pow(2,e.event.shiftKey?Math.ceil(r)-1:Math.floor(r)+1)),g(t,n),w(u.of(this,arguments))}function k(){var t=e.touches(this),n=Date.now();s=i,r={},t.forEach(function(e){r[e.identifier]=d(e)}),y();if(t.length===1){if(n-h<500){var o=t[0],a=d(t[0]);m(i*2),g(o,a),w(u.of(this,arguments))}h=n}}function L(){var t=e.touches(this),n=t[0],i=r[n.identifier];if(o=t[1]){var o,a=r[o.identifier];n=[(n[0]+o[0])/2,(n[1]+o[1])/2],i=[(i[0]+a[0])/2,(i[1]+a[1])/2],m(e.event.scale*s)}g(n,i),h=null,w(u.of(this,arguments))}var t=[0,0],r,i=1,s,o=ot,u=S(p,"zoom"),a,f,l,c,h;return p.translate=function(e){return arguments.length?(t=e.map(Number),b(),p):t},p.scale=function(e){return arguments.length?(i=+e,b(),p):i},p.scaleExtent=function(e){return arguments.length?(o=e==null?ot:e.map(Number),p):o},p.x=function(e){return arguments.length?(f=e,a=e.copy(),t=[0,0],i=1,p):f},p.y=function(e){return arguments.length?(c=e,l=e.copy(),t=[0,0],i=1,p):c},e.rebind(p,u,"on")};var ot=[0,Infinity],ut,at="onwheel"in t?(ut=function(){return-e.event.deltaY*(e.event.deltaMode?120:1)},"wheel"):"onmousewheel"in t?(ut=function(){return e.event.wheelDelta},"mousewheel"):(ut=function(){return-e.event.detail},"MozMousePixelScroll");ft.prototype.toString=function(){return this.rgb()+""},e.hsl=function(e,t,n){return arguments.length===1?e instanceof ct?lt(e.h,e.s,e.l):Wt(""+e,Xt,lt):lt(+e,+t,+n)};var ht=ct.prototype=new ft;ht.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),lt(this.h,this.s,this.l/e)},ht.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),lt(this.h,this.s,e*this.l)},ht.rgb=function(){return pt(this.h,this.s,this.l)};var dt=Math.PI,vt=1e-6,mt=dt/180,gt=180/dt;e.hcl=function(t,n,r){return arguments.length===1?t instanceof Nt?Tt(t.h,t.c,t.l):t instanceof At?Bt(t.l,t.a,t.b):Bt((t=Vt((t=e.rgb(t)).r,t.g,t.b)).l,t.a,t.b):Tt(+t,+n,+r)};var Ct=Nt.prototype=new ft;Ct.brighter=function(e){return Tt(this.h,this.c,Math.min(100,this.l+Ot*(arguments.length?e:1)))},Ct.darker=function(e){return Tt(this.h,this.c,Math.max(0,this.l-Ot*(arguments.length?e:1)))},Ct.rgb=function(){return kt(this.h,this.c,this.l).rgb()},e.lab=function(t,n,r){return arguments.length===1?t instanceof At?Lt(t.l,t.a,t.b):t instanceof Nt?kt(t.l,t.c,t.h):Vt((t=e.rgb(t)).r,t.g,t.b):Lt(+t,+n,+r)};var Ot=18,Mt=.95047,_t=1,Dt=1.08883,Pt=At.prototype=new ft;Pt.brighter=function(e){return Lt(Math.min(100,this.l+Ot*(arguments.length?e:1)),this.a,this.b)},Pt.darker=function(e){return Lt(Math.max(0,this.l-Ot*(arguments.length?e:1)),this.a,this.b)},Pt.rgb=function(){return Ht(this.l,this.a,this.b)},e.rgb=function(e,t,n){return arguments.length===1?e instanceof Rt?qt(e.r,e.g,e.b):Wt(""+e,qt,pt):qt(~~e,~~t,~~n)};var Ut=Rt.prototype=new ft;Ut.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,n=this.g,r=this.b,i=30;return!t&&!n&&!r?qt(i,i,i):(t&&t<i&&(t=i),n&&n<i&&(n=i),r&&r<i&&(r=i),qt(Math.min(255,Math.floor(t/e)),Math.min(255,Math.floor(n/e)),Math.min(255,Math.floor(r/e))))},Ut.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),qt(Math.floor(e*this.r),Math.floor(e*this.g),Math.floor(e*this.b))},Ut.hsl=function(){return Xt(this.r,this.g,this.b)},Ut.toString=function(){return"#"+zt(this.r)+zt(this.g)+zt(this.b)};var Kt=e.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});Kt.forEach(function(e,t){Kt.set(e,Wt(t,qt,pt))}),e.functor=Qt,e.xhr=function(t,r,i){function l(){var e=f.status;!e&&f.responseText||e>=200&&e<300||e===304?o.load.call(s,a.call(s,f)):o.error.call(s,f)}var s={},o=e.dispatch("progress","load","error"),u={},a=Gt,f=new(n.XDomainRequest&&/^(http(s)?:)?\/\//.test(t)?XDomainRequest:XMLHttpRequest);return"onload"in f?f.onload=f.onerror=l:f.onreadystatechange=function(){f.readyState>3&&l()},f.onprogress=function(t){var n=e.event;e.event=t;try{o.progress.call(s,f)}finally{e.event=n}},s.header=function(e,t){return e=(e+"").toLowerCase(),arguments.length<2?u[e]:(t==null?delete u[e]:u[e]=t+"",s)},s.mimeType=function(e){return arguments.length?(r=e==null?null:e+"",s):r},s.response=function(e){return a=e,s},["get","post"].forEach(function(e){s[e]=function(){return s.send.apply(s,[e].concat(N(arguments)))}}),s.send=function(e,n,i){arguments.length===2&&typeof n=="function"&&(i=n,n=null),f.open(e,t,!0),r!=null&&!("accept"in u)&&(u.accept=r+",*/*");if(f.setRequestHeader)for(var o in u)f.setRequestHeader(o,u[o]);return r!=null&&f.overrideMimeType&&f.overrideMimeType(r),i!=null&&s.on("error",i).on("load",function(e){i(null,e)}),f.send(n==null?null:n),s},s.abort=function(){return f.abort(),s},e.rebind(s,o,"on"),arguments.length===2&&typeof r=="function"&&(i=r,r=null),i==null?s:s.get(Yt(i))},e.csv=Zt(",","text/csv"),e.tsv=Zt("	","text/tab-separated-values");var en=0,tn={},nn=null,rn,sn;e.timer=function(e,t,n){if(arguments.length<3){if(arguments.length<2)t=0;else if(!isFinite(t))return;n=Date.now()}var r=tn[e.id];r&&r.callback===e?(r.then=n,r.delay=t):tn[e.id=++en]=nn={callback:e,then:n,delay:t,next:nn},rn||(sn=clearTimeout(sn),rn=1,an(on))},e.timer.flush=function(){var e,t=Date.now(),n=nn;while(n)e=t-n.then,n.delay||(n.flush=n.callback(e)),n=n.next;un()};var an=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(e){setTimeout(e,17)},fn=".",ln=",",cn=[3,3],hn=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(pn);e.formatPrefix=function(t,n){var r=0;return t&&(t<0&&(t*=-1),n&&(t=e.round(t,mn(t,n))),r=1+Math.floor(1e-12+Math.log(t)/Math.LN10),r=Math.max(-24,Math.min(24,Math.floor((r<=0?r+1:r-1)/3)*3))),hn[8+r/3]},e.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)},e.format=function(t){var n=dn.exec(t),r=n[1]||" ",i=n[2]||">",s=n[3]||"",o=n[4]||"",u=n[5],a=+n[6],f=n[7],l=n[8],c=n[9],h=1,p="",d=!1;l&&(l=+l.substring(1));if(u||r==="0"&&i==="=")u=r="0",i="=",f&&(a-=Math.floor((a-1)/4));switch(c){case"n":f=!0,c="g";break;case"%":h=100,p="%",c="f";break;case"p":h=100,p="%",c="r";break;case"b":case"o":case"x":case"X":o&&(o="0"+c.toLowerCase());case"c":case"d":d=!0,l=0;break;case"s":h=-1,c="r"}o==="#"&&(o=""),c=="r"&&!l&&(c="g");if(l!=null)if(c=="g")l=Math.max(1,Math.min(21,l));else if(c=="e"||c=="f")l=Math.max(0,Math.min(20,l));c=vn.get(c)||gn;var v=u&&f;return function(t){if(d&&t%1)return"";var n=t<0||t===0&&1/t<0?(t=-t,"-"):s;if(h<0){var m=e.formatPrefix(t,l);t=m.scale(t),p=m.symbol}else t*=h;t=c(t,l),!u&&f&&(t=yn(t));var g=o.length+t.length+(v?0:n.length),y=g<a?(new Array(g=a-g+1)).join(r):"";return v&&(t=yn(y+t)),fn&&t.replace(".",fn),n+=o,(i==="<"?n+t+y:i===">"?y+n+t:i==="^"?y.substring(0,g>>=1)+n+t+y.substring(g):n+(v?t:y+t))+p}};var dn=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,vn=e.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(t,n){return(t=e.round(t,mn(t,n))).toFixed(Math.max(0,Math.min(20,mn(t*(1+1e-15),n))))}}),yn=Gt;if(cn){var bn=cn.length;yn=function(e){var t=e.lastIndexOf("."),n=t>=0?"."+e.substring(t+1):(t=e.length,""),r=[],i=0,s=cn[0];while(t>0&&s>0)r.push(e.substring(t-=s,t+s)),s=cn[i=(i+1)%bn];return r.reverse().join(ln||"")+n}}e.geo={},e.geo.stream=function(e,t){e&&En.hasOwnProperty(e.type)?En[e.type](e,t):wn(e,t)};var En={Feature:function(e,t){wn(e.geometry,t)},FeatureCollection:function(e,t){var n=e.features,r=-1,i=n.length;while(++r<i)wn(n[r].geometry,t)}},Sn={Sphere:function(e,t){t.sphere()},Point:function(e,t){var n=e.coordinates;t.point(n[0],n[1])},MultiPoint:function(e,t){var n=e.coordinates,r=-1,i=n.length,s;while(++r<i)s=n[r],t.point(s[0],s[1])},LineString:function(e,t){xn(e.coordinates,t,0)},MultiLineString:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)xn(n[r],t,0)},Polygon:function(e,t){Tn(e.coordinates,t)},MultiPolygon:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)Tn(n[r],t)},GeometryCollection:function(e,t){var n=e.geometries,r=-1,i=n.length;while(++r<i)wn(n[r],t)}};e.geo.area=function(t){return Nn=0,e.geo.stream(t,Ln),Nn};var Nn,Cn,kn,Ln={sphere:function(){Nn+=4*dt},point:G,lineStart:G,lineEnd:G,polygonStart:function(){Cn=1,kn=0,Ln.lineStart=An},polygonEnd:function(){var e=2*Math.atan2(kn,Cn);Nn+=e<0?4*dt+e:e,Ln.lineStart=Ln.lineEnd=Ln.point=G}};e.geo.bounds=On(Gt),e.geo.centroid=function(t){Mn=_n=Dn=Pn=Hn=0,e.geo.stream(t,Bn);var n;if(_n&&Math.abs(n=Math.sqrt(Dn*Dn+Pn*Pn+Hn*Hn))>vt)return[Math.atan2(Pn,Dn)*gt,Math.asin(Math.max(-1,Math.min(1,Hn/n)))*gt]};var Mn,_n,Dn,Pn,Hn,Bn={sphere:function(){Mn<2&&(Mn=2,_n=Dn=Pn=Hn=0)},point:jn,lineStart:In,lineEnd:qn,polygonStart:function(){Mn<2&&(Mn=2,_n=Dn=Pn=Hn=0),Bn.lineStart=Fn},polygonEnd:function(){Bn.lineStart=In}},rr=Yn($n,ir,or),ar=1e9;e.geo.projection=pr,e.geo.projectionMutator=dr,(e.geo.equirectangular=function(){return pr(mr)}).raw=mr.invert=mr,e.geo.rotation=function(e){function t(t){return t=e(t[0]*mt,t[1]*mt),t[0]*=gt,t[1]*=gt,t}return e=gr(e[0]%360*mt,e[1]*mt,e.length>2?e[2]*mt:0),t.invert=function(t){return t=e.invert(t[0]*mt,t[1]*mt),t[0]*=gt,t[1]*=gt,t},t},e.geo.circle=function(){function i(){var t=typeof e=="function"?e.apply(this,arguments):e,n=gr(-t[0]*mt,-t[1]*mt,0).invert,i=[];return r(null,null,1,{point:function(e,t){i.push(e=n(e,t)),e[0]*=gt,e[1]*=gt}}),{type:"Polygon",coordinates:[i]}}var e=[0,0],t,n=6,r;return i.origin=function(t){return arguments.length?(e=t,i):e},i.angle=function(e){return arguments.length?(r=Er((t=+e)*mt,n*mt),i):t},i.precision=function(e){return arguments.length?(r=Er(t*mt,(n=+e)*mt),i):n},i.angle(90)},e.geo.distance=function(e,t){var n=(t[0]-e[0])*mt,r=e[1]*mt,i=t[1]*mt,s=Math.sin(n),o=Math.cos(n),u=Math.sin(r),a=Math.cos(r),f=Math.sin(i),l=Math.cos(i),c;return Math.atan2(Math.sqrt((c=l*s)*c+(c=a*f-u*l*o)*c),u*f+a*l*o)},e.geo.graticule=function(){function y(){return{type:"MultiLineString",coordinates:b()}}function b(){return e.range(Math.ceil(i/c)*c,r,c).map(v).concat(e.range(Math.ceil(a/h)*h,u,h).map(m)).concat(e.range(Math.ceil(n/f)*f,t,f).filter(function(e){return Math.abs(e%c)>vt}).map(p)).concat(e.range(Math.ceil(o/l)*l,s,l).filter(function(e){return Math.abs(e%h)>vt}).map(d))}var t,n,r,i,s,o,u,a,f=10,l=f,c=90,h=360,p,d,v,m,g=2.5;return y.lines=function(){return b().map(function(e){return{type:"LineString",coordinates:e}})},y.outline=function(){return{type:"Polygon",coordinates:[v(i).concat(m(u).slice(1),v(r).reverse().slice(1),m(a).reverse().slice(1))]}},y.extent=function(e){return arguments.length?y.majorExtent(e).minorExtent(e):y.minorExtent()},y.majorExtent=function(e){return arguments.length?(i=+e[0][0],r=+e[1][0],a=+e[0][1],u=+e[1][1],i>r&&(e=i,i=r,r=e),a>u&&(e=a,a=u,u=e),y.precision(g)):[[i,a],[r,u]]},y.minorExtent=function(e){return arguments.length?(n=+e[0][0],t=+e[1][0],o=+e[0][1],s=+e[1][1],n>t&&(e=n,n=t,t=e),o>s&&(e=o,o=s,s=e),y.precision(g)):[[n,o],[t,s]]},y.step=function(e){return arguments.length?y.majorStep(e).minorStep(e):y.minorStep()},y.majorStep=function(e){return arguments.length?(c=+e[0],h=+e[1],y):[c,h]},y.minorStep=function(e){return arguments.length?(f=+e[0],l=+e[1],y):[f,l]},y.precision=function(e){return arguments.length?(g=+e,p=xr(o,s,90),d=Tr(n,t,g),v=xr(a,u,90),m=Tr(i,r,g),y):g},y.majorExtent([[-180,-90+vt],[180,90-vt]]).minorExtent([[-180,-80-vt],[180,80+vt]])},e.geo.greatArc=function(){function s(){return{type:"LineString",coordinates:[n||t.apply(this,arguments),i||r.apply(this,arguments)]}}var t=Nr,n,r=Cr,i;return s.distance=function(){return e.geo.distance(n||t.apply(this,arguments),i||r.apply(this,arguments))},s.source=function(e){return arguments.length?(t=e,n=typeof e=="function"?null:e,s):t},s.target=function(e){return arguments.length?(r=e,i=typeof e=="function"?null:e,s):r},s.precision=function(){return arguments.length?s:0},s},e.geo.interpolate=function(e,t){return kr(e[0]*mt,e[1]*mt,t[0]*mt,t[1]*mt)},e.geo.length=function(t){return Lr=0,e.geo.stream(t,Ar),Lr};var Lr,Ar={sphere:G,point:G,lineStart:Or,lineEnd:G,polygonStart:G,polygonEnd:G};(e.geo.conicEqualArea=function(){return Mr(_r)}).raw=_r,e.geo.albersUsa=function(){function a(e){return f(e)(e)}function f(e){var s=e[0],o=e[1];return o>50?n:s<-140?r:o<21?i:t}var t=e.geo.conicEqualArea().rotate([98,0]).center([0,38]).parallels([29.5,45.5]),n=e.geo.conicEqualArea().rotate([160,0]).center([0,60]).parallels([55,65]),r=e.geo.conicEqualArea().rotate([160,0]).center([0,20]).parallels([8,18]),i=e.geo.conicEqualArea().rotate([60,0]).center([0,10]).parallels([8,18]),s,o,u;return a.invert=function(e){return s(e)||o(e)||u(e)||t.invert(e)},a.scale=function(e){return arguments.length?(t.scale(e),n.scale(e*.6),r.scale(e),i.scale(e*1.5),a.translate(t.translate())):t.scale()},a.translate=function(e){if(!arguments.length)return t.translate();var f=t.scale(),l=e[0],c=e[1];return t.translate(e),n.translate([l-.4*f,c+.17*f]),r.translate([l-.19*f,c+.2*f]),i.translate([l+.58*f,c+.43*f]),s=Dr(n,[[-180,50],[-130,72]]),o=Dr(r,[[-164,18],[-154,24]]),u=Dr(i,[[-67.5,17.5],[-65,19]]),a},a.scale(1e3)};var Pr,Hr,Br={point:G,lineStart:G,lineEnd:G,polygonStart:function(){Hr=0,Br.lineStart=jr},polygonEnd:function(){Br.lineStart=Br.lineEnd=Br.point=G,Pr+=Math.abs(Hr/2)}},Ir={point:qr,lineStart:Rr,lineEnd:Ur,polygonStart:function(){Ir.lineStart=zr},polygonEnd:function(){Ir.point=qr,Ir.lineStart=Rr,Ir.lineEnd=Ur}};e.geo.path=function(){function o(n){return n&&e.geo.stream(n,i(s.pointRadius(typeof t=="function"?+t.apply(this,arguments):t))),s.result()}var t=4.5,n,r,i,s;return o.area=function(t){return Pr=0,e.geo.stream(t,i(Br)),Pr},o.centroid=function(t){return Mn=Dn=Pn=Hn=0,e.geo.stream(t,i(Ir)),Hn?[Dn/Hn,Pn/Hn]:undefined},o.bounds=function(e){return On(i)(e)},o.projection=function(e){return arguments.length?(i=(n=e)?e.stream||Vr(e):Gt,o):n},o.context=function(e){return arguments.length?(s=(r=e)==null?new Fr:new Wr(e),o):r},o.pointRadius=function(e){return arguments.length?(t=typeof e=="function"?e:+e,o):t},o.projection(e.geo.albersUsa()).context(null)},e.geo.albers=function(){return e.geo.conicEqualArea().parallels([29.5,45.5]).rotate([98,0]).center([0,38]).scale(1e3)};var Jr=$r(function(e){return Math.sqrt(2/(1+e))},function(e){return 2*Math.asin(e/2)});(e.geo.azimuthalEqualArea=function(){return pr(Jr)}).raw=Jr;var Kr=$r(function(e){var t=Math.acos(e);return t&&t/Math.sin(t)},Gt);(e.geo.azimuthalEquidistant=function(){return pr(Kr)}).raw=Kr,(e.geo.conicConformal=function(){return Mr(Qr)}).raw=Qr,(e.geo.conicEquidistant=function(){return Mr(Gr)}).raw=Gr;var Yr=$r(function(e){return 1/e},Math.atan);(e.geo.gnomonic=function(){return pr(Yr)}).raw=Yr,Zr.invert=function(e,t){return[e,2*Math.atan(Math.exp(t))-dt/2]},(e.geo.mercator=function(){return ei(Zr)}).raw=Zr;var ti=$r(function(){return 1},Math.asin);(e.geo.orthographic=function(){return pr(ti)}).raw=ti;var ni=$r(function(e){return 1/(1+e)},function(e){return 2*Math.atan(e)});(e.geo.stereographic=function(){return pr(ni)}).raw=ni,ri.invert=function(e,t){return[Math.atan2(Et(e),Math.cos(t)),wt(Math.sin(t)/St(e))]},(e.geo.transverseMercator=function(){return ei(ri)}).raw=ri,e.geom={},e.svg={},e.svg.line=function(){return ii(Gt)};var ui=e.map({linear:ai,"linear-closed":fi,"step-before":li,"step-after":ci,basis:gi,"basis-open":yi,"basis-closed":bi,bundle:wi,cardinal:di,"cardinal-open":hi,"cardinal-closed":pi,monotone:Ai});ui.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var Si=[0,2/3,1/3,0],xi=[0,1/3,2/3,0],Ti=[0,1/6,2/3,1/6];e.geom.hull=function(e){function r(e){if(e.length<3)return[];var r=Qt(t),i=Qt(n),s=e.length,o,u=s-1,a=[],f=[],l,c,h,p=0,d,v,m,g,y,b,w,E;if(r===si&&n===oi)o=e;else for(c=0,o=[];c<s;++c)o.push([+r.call(this,l=e[c],c),+i.call(this,l,c)]);for(c=1;c<s;++c)o[c][1]<o[p][1]?p=c:o[c][1]==o[p][1]&&(p=o[c][0]<o[p][0]?c:p);for(c=0;c<s;++c){if(c===p)continue;v=o[c][1]-o[p][1],d=o[c][0]-o[p][0],a.push({angle:Math.atan2(v,d),index:c})}a.sort(function(e,t){return e.angle-t.angle}),w=a[0].angle,b=a[0].index,y=0;for(c=1;c<u;++c)h=a[c].index,w==a[c].angle?(d=o[b][0]-o[p][0],v=o[b][1]-o[p][1],m=o[h][0]-o[p][0],g=o[h][1]-o[p][1],d*d+v*v>=m*m+g*g?a[c].index=-1:(a[y].index=-1,w=a[c].angle,y=c,b=h)):(w=a[c].angle,y=c,b=h);f.push(p);for(c=0,h=0;c<2;++h)a[h].index!==-1&&(f.push(a[h].index),c++);E=f.length;for(;h<u;++h){if(a[h].index===-1)continue;while(!Oi(f[E-2],f[E-1],a[h].index,o))--E;f[E++]=a[h].index}var S=[];for(c=0;c<E;++c)S.push(e[f[c]]);return S}var t=si,n=oi;return arguments.length?r(e):(r.x=function(e){return arguments.length?(t=e,r):t},r.y=function(e){return arguments.length?(n=e,r):n},r)},e.geom.polygon=function(e){return e.area=function(){var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];while(++t<n)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r*.5},e.centroid=function(t){var n=-1,r=e.length,i=0,s=0,o,u=e[r-1],a;arguments.length||(t=-1/(6*e.area()));while(++n<r)o=u,u=e[n],a=o[0]*u[1]-u[0]*o[1],i+=(o[0]+u[0])*a,s+=(o[1]+u[1])*a;return[i*t,s*t]},e.clip=function(t){var n,r=-1,i=e.length,s,o,u=e[i-1],a,f,l;while(++r<i){n=t.slice(),t.length=0,a=e[r],f=n[(o=n.length)-1],s=-1;while(++s<o)l=n[s],Mi(l,u,a)?(Mi(f,u,a)||t.push(_i(f,l,u,a)),t.push(l)):Mi(f,u,a)&&t.push(_i(f,l,u,a)),f=l;u=a}return t},e},e.geom.delaunay=function(e){var t=e.map(function(){return[]}),n=[];return Pi(e,function(n){t[n.region.l.index].push(e[n.region.r.index])}),t.forEach(function(t,r){var i=e[r],s=i[0],o=i[1];t.forEach(function(e){e.angle=Math.atan2(e[0]-s,e[1]-o)}),t.sort(function(e,t){return e.angle-t.angle});for(var u=0,a=t.length-1;u<a;u++)n.push([i,t[u],t[u+1]])}),n},e.geom.voronoi=function(t){function o(t){var n,o=t.map(function(){return[]}),u=Qt(r),a=Qt(i),f,l,c=t.length,h=1e6;if(u===si&&a===oi)n=t;else for(n=[],l=0;l<c;++l)n.push([+u.call(this,f=t[l],l),+a.call(this,f,l)]);Pi(n,function(e){var t,n,r,i,s,u;e.a===1&&e.b>=0?(t=e.ep.r,n=e.ep.l):(t=e.ep.l,n=e.ep.r),e.a===1?(s=t?t.y:-h,r=e.c-e.b*s,u=n?n.y:h,i=e.c-e.b*u):(r=t?t.x:-h,s=e.c-e.a*r,i=n?n.x:h,u=e.c-e.a*i);var a=[r,s],f=[i,u];o[e.region.l.index].push(a,f),o[e.region.r.index].push(a,f)}),o=o.map(function(t,r){var i=n[r][0],s=n[r][1],o=t.map(function(e){return Math.atan2(e[0]-i,e[1]-s)}),u=e.range(t.length).sort(function(e,t){return o[e]-o[t]});return u.filter(function(e,t){return!t||o[e]-o[u[t-1]]>vt}).map(function(e){return t[e]})}),o.forEach(function(e,t){var r=e.length;if(!r)return e.push([-h,-h],[-h,h],[h,h],[h,-h]);if(r>2)return;var i=n[t],s=e[0],o=e[1],u=i[0],a=i[1],f=s[0],l=s[1],c=o[0],p=o[1],d=Math.abs(c-f),v=p-l;if(Math.abs(v)<vt){var m=a<l?-h:h;e.push([-h,m],[h,m])}else if(d<vt){var g=u<f?-h:h;e.push([g,-h],[g,h])}else{var m=(c-f)*(l-a)<(f-u)*(p-l)?h:-h,y=Math.abs(v)-d;Math.abs(y)<vt?e.push([v<0?m:-m,m]):(y>0&&(m*=-1),e.push([-h,m],[h,m]))}});if(s)for(l=0;l<c;++l)s(o[l]);for(l=0;l<c;++l)o[l].point=t[l];return o}var n=null,r=si,i=oi,s;return arguments.length?o(t):(o.x=function(e){return arguments.length?(r=e,o):r},o.y=function(e){return arguments.length?(i=e,o):i},o.size=function(t){return arguments.length?(t==null?s=null:(n=[+t[0],+t[1]],s=e.geom.polygon([[0,0],[0,n[1]],n,[n[0],0]]).clip),o):n},o.links=function(e){var t,n=e.map(function(){return[]}),s=[],o=Qt(r),u=Qt(i),a,f,l=e.length;if(o===si&&u===oi)t=e;else for(f=0;f<l;++f)t.push([+o.call(this,a=e[f],f),+u.call(this,a,f)]);return Pi(t,function(t){var r=t.region.l.index,i=t.region.r.index;if(n[r][i])return;n[r][i]=n[i][r]=!0,s.push({source:e[r],target:e[i]})}),s},o.triangles=function(t){if(r===si&&i===oi)return e.geom.delaunay(t);var n,s,o=Qt(r),u=Qt(i),a,f,l;for(f=0,n=[],l=t.length;f<l;++f)s=[+o.call(this,a=t[f],f),+u.call(this,a,f)],s.data=a,n.push(s);return e.geom.delaunay(n).map(function(e){return e.map(function(e){return e.data})})},o)};var Di={l:"r",r:"l"};e.geom.quadtree=function(e,t,n,r,i){function a(e){function x(e,t,n,r,i,s,o,u){if(isNaN(n)||isNaN(r))return;if(e.leaf){var a=e.x,f=e.y;if(a!=null)if(Math.abs(a-n)+Math.abs(f-r)<.01)T(e,t,n,r,i,s,o,u);else{var l=e.point;e.x=e.y=e.point=null,T(e,l,a,f,i,s,o,u),T(e,t,n,r,i,s,o,u)}else e.x=n,e.y=r,e.point=t}else T(e,t,n,r,i,s,o,u)}function T(e,t,n,r,i,s,o,u){var a=(i+o)*.5,f=(s+u)*.5,l=n>=a,c=r>=f,h=(c<<1)+l;e.leaf=!1,e=e.nodes[h]||(e.nodes[h]=ji()),l?i=a:o=a,c?s=f:u=f,x(e,t,n,r,i,s,o,u)}var a,f=Qt(s),l=Qt(o),c,h,p,d,v,m,g,y;if(t!=null)v=t,m=n,g=r,y=i;else{g=y=-(v=m=Infinity),c=[],h=[],d=e.length;if(u)for(p=0;p<d;++p)a=e[p],a.x<v&&(v=a.x),a.y<m&&(m=a.y),a.x>g&&(g=a.x),a.y>y&&(y=a.y),c.push(a.x),h.push(a.y);else for(p=0;p<d;++p){var b=+f(a=e[p],p),w=+l(a,p);b<v&&(v=b),w<m&&(m=w),b>g&&(g=b),w>y&&(y=w),c.push(b),h.push(w)}}var E=g-v,S=y-m;E>S?y=m+E:g=v+S;var N=ji();N.add=function(e){x(N,e,+f(e,++p),+l(e,p),v,m,g,y)},N.visit=function(e){Fi(e,N,v,m,g,y)},p=-1;if(t==null){while(++p<d)x(N,e[p],c[p],h[p],v,m,g,y);--p}else e.forEach(N.add);return c=h=e=a=null,N}var s=si,o=oi,u;return(u=arguments.length)?(s=Hi,o=Bi,u===3&&(i=n,r=t,n=t=0),a(e)):(a.x=function(e){return arguments.length?(s=e,a):s},a.y=function(e){return arguments.length?(o=e,a):o},a.size=function(e){return arguments.length?(e==null?t=n=r=i=null:(t=n=0,r=+e[0],i=+e[1]),a):t==null?null:[r,i]},a)},e.interpolateRgb=Ii,e.transform=function(n){var r=t.createElementNS(e.ns.prefix.svg,"g");return(e.transform=function(e){r.setAttribute("transform",e);var t=r.transform.baseVal.consolidate();return new qi(t?t.matrix:Wi)})(n)},qi.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Wi={a:1,b:0,c:0,d:1,e:0,f:0};e.interpolateNumber=Xi,e.interpolateTransform=Vi,e.interpolateObject=$i,e.interpolateString=Ji;var Ki=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;e.interpolate=Qi,e.interpolators=[function(e,t){var n=typeof t;return(n==="string"||n!==typeof e?Kt.has(t)||/^(#|rgb\(|hsl\()/.test(t)?Ii:Ji:t instanceof ft?Ii:n==="object"?Array.isArray(t)?Yi:$i:Xi)(e,t)}],e.interpolateArray=Yi;var Zi=function(){return Gt},es=e.map({linear:Zi,poly:as,quad:function(){return ss},cubic:function(){return os
},sin:function(){return fs},exp:function(){return ls},circle:function(){return cs},elastic:hs,back:ps,bounce:function(){return ds}}),ts=e.map({"in":Gt,out:rs,"in-out":is,"out-in":function(e){return is(rs(e))}});e.ease=function(e){var t=e.indexOf("-"),n=t>=0?e.substring(0,t):e,r=t>=0?e.substring(t+1):"in";return n=es.get(n)||Zi,r=ts.get(r)||Gt,ns(r(n.apply(null,Array.prototype.slice.call(arguments,1))))},e.interpolateHcl=vs,e.interpolateHsl=ms,e.interpolateLab=gs,e.interpolateRound=ys,e.layout={},e.layout.bundle=function(){return function(e){var t=[],n=-1,r=e.length;while(++n<r)t.push(Es(e[n]));return t}},e.layout.chord=function(){function l(){var t={},l=[],h=e.range(s),p=[],d,v,m,g,y;n=[],r=[],d=0,g=-1;while(++g<s){v=0,y=-1;while(++y<s)v+=i[g][y];l.push(v),p.push(e.range(s)),d+=v}u&&h.sort(function(e,t){return u(l[e],l[t])}),a&&p.forEach(function(e,t){e.sort(function(e,n){return a(i[t][e],i[t][n])})}),d=(2*dt-o*s)/d,v=0,g=-1;while(++g<s){m=v,y=-1;while(++y<s){var b=h[g],w=p[b][y],E=i[b][w],S=v,x=v+=E*d;t[b+"-"+w]={index:b,subindex:w,startAngle:S,endAngle:x,value:E}}r[b]={index:b,startAngle:m,endAngle:v,value:(v-m)/d},v+=o}g=-1;while(++g<s){y=g-1;while(++y<s){var T=t[g+"-"+y],N=t[y+"-"+g];(T.value||N.value)&&n.push(T.value<N.value?{source:N,target:T}:{source:T,target:N})}}f&&c()}function c(){n.sort(function(e,t){return f((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var t={},n,r,i,s,o=0,u,a,f;return t.matrix=function(e){return arguments.length?(s=(i=e)&&i.length,n=r=null,t):i},t.padding=function(e){return arguments.length?(o=e,n=r=null,t):o},t.sortGroups=function(e){return arguments.length?(u=e,n=r=null,t):u},t.sortSubgroups=function(e){return arguments.length?(a=e,n=null,t):a},t.sortChords=function(e){return arguments.length?(f=e,n&&c(),t):f},t.chords=function(){return n||l(),n},t.groups=function(){return r||l(),r},t},e.layout.force=function(){function g(e){return function(t,n,r,i){if(t.point!==e){var s=t.cx-e.x,o=t.cy-e.y,u=1/Math.sqrt(s*s+o*o);if((i-n)*u<c){var a=t.charge*u*u;return e.px-=s*a,e.py-=o*a,!0}if(t.point&&isFinite(u)){var a=t.pointCharge*u*u;e.px-=s*a,e.py-=o*a}}return!t.charge}}function y(n){n.px=e.event.x,n.py=e.event.y,t.resume()}var t={},n=e.dispatch("start","tick","end"),r=[1,1],i,s,o=.9,u=As,a=Os,f=-30,l=.1,c=.8,h=[],p=[],d,v,m;return t.tick=function(){if((s*=.99)<.005)return n.end({type:"end",alpha:s=0}),!0;var t=h.length,i=p.length,u,a,c,y,b,w,E,S,x;for(a=0;a<i;++a){c=p[a],y=c.source,b=c.target,S=b.x-y.x,x=b.y-y.y;if(w=S*S+x*x)w=s*v[a]*((w=Math.sqrt(w))-d[a])/w,S*=w,x*=w,b.x-=S*(E=y.weight/(b.weight+y.weight)),b.y-=x*E,y.x+=S*(E=1-E),y.y+=x*E}if(E=s*l){S=r[0]/2,x=r[1]/2,a=-1;if(E)while(++a<t)c=h[a],c.x+=(S-c.x)*E,c.y+=(x-c.y)*E}if(f){Ls(u=e.geom.quadtree(h),s,m),a=-1;while(++a<t)(c=h[a]).fixed||u.visit(g(c))}a=-1;while(++a<t)c=h[a],c.fixed?(c.x=c.px,c.y=c.py):(c.x-=(c.px-(c.px=c.x))*o,c.y-=(c.py-(c.py=c.y))*o);n.tick({type:"tick",alpha:s})},t.nodes=function(e){return arguments.length?(h=e,t):h},t.links=function(e){return arguments.length?(p=e,t):p},t.size=function(e){return arguments.length?(r=e,t):r},t.linkDistance=function(e){return arguments.length?(u=typeof e=="function"?e:+e,t):u},t.distance=t.linkDistance,t.linkStrength=function(e){return arguments.length?(a=typeof e=="function"?e:+e,t):a},t.friction=function(e){return arguments.length?(o=+e,t):o},t.charge=function(e){return arguments.length?(f=typeof e=="function"?e:+e,t):f},t.gravity=function(e){return arguments.length?(l=+e,t):l},t.theta=function(e){return arguments.length?(c=+e,t):c},t.alpha=function(r){return arguments.length?(r=+r,s?r>0?s=r:s=0:r>0&&(n.start({type:"start",alpha:s=r}),e.timer(t.tick)),t):s},t.start=function(){function y(t,n){var r=b(e),i=-1,s=r.length,o;while(++i<s)if(!isNaN(o=r[i][t]))return o;return Math.random()*n}function b(){if(!c){c=[];for(n=0;n<i;++n)c[n]=[];for(n=0;n<s;++n){var t=p[n];c[t.source.index].push(t.target),c[t.target.index].push(t.source)}}return c[e]}var e,n,i=h.length,s=p.length,o=r[0],l=r[1],c,g;for(e=0;e<i;++e)(g=h[e]).index=e,g.weight=0;for(e=0;e<s;++e)g=p[e],typeof g.source=="number"&&(g.source=h[g.source]),typeof g.target=="number"&&(g.target=h[g.target]),++g.source.weight,++g.target.weight;for(e=0;e<i;++e)g=h[e],isNaN(g.x)&&(g.x=y("x",o)),isNaN(g.y)&&(g.y=y("y",l)),isNaN(g.px)&&(g.px=g.x),isNaN(g.py)&&(g.py=g.y);d=[];if(typeof u=="function")for(e=0;e<s;++e)d[e]=+u.call(this,p[e],e);else for(e=0;e<s;++e)d[e]=u;v=[];if(typeof a=="function")for(e=0;e<s;++e)v[e]=+a.call(this,p[e],e);else for(e=0;e<s;++e)v[e]=a;m=[];if(typeof f=="function")for(e=0;e<i;++e)m[e]=+f.call(this,h[e],e);else for(e=0;e<i;++e)m[e]=f;return t.resume()},t.resume=function(){return t.alpha(.1)},t.stop=function(){return t.alpha(0)},t.drag=function(){i||(i=e.behavior.drag().origin(Gt).on("dragstart.force",Ts).on("drag.force",y).on("dragend.force",Ns));if(!arguments.length)return i;this.on("mouseover.force",Cs).on("mouseout.force",ks).call(i)},e.rebind(t,n,"on")};var As=20,Os=1;e.layout.hierarchy=function(){function r(i,o,u){var a=t.call(s,i,o);i.depth=o,u.push(i);if(a&&(l=a.length)){var f=-1,l,c=i.children=[],h=0,p=o+1,d;while(++f<l)d=r(a[f],p,u),d.parent=i,c.push(d),h+=d.value;e&&c.sort(e),n&&(i.value=h)}else n&&(i.value=+n.call(s,i,o)||0);return i}function i(e,t){var r=e.children,o=0;if(r&&(a=r.length)){var u=-1,a,f=t+1;while(++u<a)o+=i(r[u],f)}else n&&(o=+n.call(s,e,t)||0);return n&&(e.value=o),o}function s(e){var t=[];return r(e,0,t),t}var e=Ps,t=_s,n=Ds;return s.sort=function(t){return arguments.length?(e=t,s):e},s.children=function(e){return arguments.length?(t=e,s):t},s.value=function(e){return arguments.length?(n=e,s):n},s.revalue=function(e){return i(e,0),e},s},e.layout.partition=function(){function r(e,t,n,i){var s=e.children;e.x=t,e.y=e.depth*i,e.dx=n,e.dy=i;if(s&&(u=s.length)){var o=-1,u,a,f;n=e.value?n/e.value:0;while(++o<u)r(a=s[o],t,f=a.value*n,i),t+=f}}function i(e){var t=e.children,n=0;if(t&&(s=t.length)){var r=-1,s;while(++r<s)n=Math.max(n,i(t[r]))}return 1+n}function s(e,s){var o=t.call(this,e,s);return r(o[0],0,n[0],n[1]/i(o[0])),o}var t=e.layout.hierarchy(),n=[1,1];return s.size=function(e){return arguments.length?(n=e,s):n},Ms(s,t)},e.layout.pie=function(){function s(o){var u=o.map(function(e,n){return+t.call(s,e,n)}),a=+(typeof r=="function"?r.apply(this,arguments):r),f=((typeof i=="function"?i.apply(this,arguments):i)-a)/e.sum(u),l=e.range(o.length);n!=null&&l.sort(n===Bs?function(e,t){return u[t]-u[e]}:function(e,t){return n(o[e],o[t])});var c=[];return l.forEach(function(e){var t;c[e]={data:o[e],value:t=u[e],startAngle:a,endAngle:a+=t*f}}),c}var t=Number,n=Bs,r=0,i=2*dt;return s.value=function(e){return arguments.length?(t=e,s):t},s.sort=function(e){return arguments.length?(n=e,s):n},s.startAngle=function(e){return arguments.length?(r=e,s):r},s.endAngle=function(e){return arguments.length?(i=e,s):i},s};var Bs={};e.layout.stack=function(){function u(a,f){var l=a.map(function(e,n){return t.call(u,e,n)}),c=l.map(function(e){return e.map(function(e,t){return[s.call(u,e,t),o.call(u,e,t)]})}),h=n.call(u,c,f);l=e.permute(l,h),c=e.permute(c,h);var p=r.call(u,c,f),d=l.length,v=l[0].length,m,g,y;for(g=0;g<v;++g){i.call(u,l[0][g],y=p[g],c[0][g][1]);for(m=1;m<d;++m)i.call(u,l[m][g],y+=c[m-1][g][1],c[m][g][1])}return a}var t=Gt,n=Us,r=zs,i=Is,s=js,o=Fs;return u.values=function(e){return arguments.length?(t=e,u):t},u.order=function(e){return arguments.length?(n=typeof e=="function"?e:qs.get(e)||Us,u):n},u.offset=function(e){return arguments.length?(r=typeof e=="function"?e:Rs.get(e)||zs,u):r},u.x=function(e){return arguments.length?(s=e,u):s},u.y=function(e){return arguments.length?(o=e,u):o},u.out=function(e){return arguments.length?(i=e,u):i},u};var qs=e.map({"inside-out":function(t){var n=t.length,r,i,s=t.map(Ws),o=t.map(Xs),u=e.range(n).sort(function(e,t){return s[e]-s[t]}),a=0,f=0,l=[],c=[];for(r=0;r<n;++r)i=u[r],a<f?(a+=o[i],l.push(i)):(f+=o[i],c.push(i));return c.reverse().concat(l)},reverse:function(t){return e.range(t.length).reverse()},"default":Us}),Rs=e.map({silhouette:function(e){var t=e.length,n=e[0].length,r=[],i=0,s,o,u,a=[];for(o=0;o<n;++o){for(s=0,u=0;s<t;s++)u+=e[s][o][1];u>i&&(i=u),r.push(u)}for(o=0;o<n;++o)a[o]=(i-r[o])/2;return a},wiggle:function(e){var t=e.length,n=e[0],r=n.length,i,s,o,u,a,f,l,c,h,p=[];p[0]=c=h=0;for(s=1;s<r;++s){for(i=0,u=0;i<t;++i)u+=e[i][s][1];for(i=0,a=0,l=n[s][0]-n[s-1][0];i<t;++i){for(o=0,f=(e[i][s][1]-e[i][s-1][1])/(2*l);o<i;++o)f+=(e[o][s][1]-e[o][s-1][1])/l;a+=f*e[i][s][1]}p[s]=c-=u?a/u*l:0,c<h&&(h=c)}for(s=0;s<r;++s)p[s]-=h;return p},expand:function(e){var t=e.length,n=e[0].length,r=1/t,i,s,o,u=[];for(s=0;s<n;++s){for(i=0,o=0;i<t;i++)o+=e[i][s][1];if(o)for(i=0;i<t;i++)e[i][s][1]/=o;else for(i=0;i<t;i++)e[i][s][1]=r}for(s=0;s<n;++s)u[s]=0;return u},zero:zs});e.layout.histogram=function(){function s(s,o){var u=[],a=s.map(n,this),f=r.call(this,a,o),l=i.call(this,f,a,o),c,o=-1,h=a.length,p=l.length-1,d=t?1:1/h,v;while(++o<p)c=u[o]=[],c.dx=l[o+1]-(c.x=l[o]),c.y=0;if(p>0){o=-1;while(++o<h)v=a[o],v>=f[0]&&v<=f[1]&&(c=u[e.bisect(l,v,1,p)-1],c.y+=d,c.push(s[o]))}return u}var t=!0,n=Number,r=Ks,i=$s;return s.value=function(e){return arguments.length?(n=e,s):n},s.range=function(e){return arguments.length?(r=Qt(e),s):r},s.bins=function(e){return arguments.length?(i=typeof e=="number"?function(t){return Js(t,e)}:Qt(e),s):i},s.frequency=function(e){return arguments.length?(t=!!e,s):t},s},e.layout.tree=function(){function i(e,i){function u(e,t){var r=e.children,i=e._tree;if(r&&(s=r.length)){var s,o=r[0],a,l=o,c,h=-1;while(++h<s)c=r[h],u(c,a),l=f(c,a,l),a=c;io(e);var p=.5*(o._tree.prelim+c._tree.prelim);t?(i.prelim=t._tree.prelim+n(e,t),i.mod=i.prelim-p):i.prelim=p}else t&&(i.prelim=t._tree.prelim+n(e,t))}function a(e,t){e.x=e._tree.prelim+t;var n=e.children;if(n&&(i=n.length)){var r=-1,i;t+=e._tree.mod;while(++r<i)a(n[r],t)}}function f(e,t,r){if(t){var i=e,s=e,o=t,u=e.parent.children[0],a=i._tree.mod,f=s._tree.mod,l=o._tree.mod,c=u._tree.mod,h;while(o=Ys(o),i=Gs(i),o&&i)u=Gs(u),s=Ys(s),s._tree.ancestor=e,h=o._tree.prelim+l-i._tree.prelim-a+n(o,i),h>0&&(so(oo(o,e,r),e,h),a+=h,f+=h),l+=o._tree.mod,a+=i._tree.mod,c+=u._tree.mod,f+=s._tree.mod;o&&!Ys(s)&&(s._tree.thread=o,s._tree.mod+=l-f),i&&!Gs(u)&&(u._tree.thread=i,u._tree.mod+=a-c,r=e)}return r}var s=t.call(this,e,i),o=s[0];ro(o,function(e,t){e._tree={ancestor:e,prelim:0,mod:0,change:0,shift:0,number:t?t._tree.number+1:0}}),u(o),a(o,-o._tree.prelim);var l=Zs(o,to),c=Zs(o,eo),h=Zs(o,no),p=l.x-n(l,c)/2,d=c.x+n(c,l)/2,v=h.depth||1;return ro(o,function(e){r===undefined||r==null?(e.x=(e.x-p)*elementsize[0],e.y=e.depth*elementsize[1]):(e.x=(e.x-p)/(d-p)*r[0],e.y=e.depth/v*r[1]),delete e._tree}),s}var t=e.layout.hierarchy().sort(null).value(null),n=Qs,r=[1,1];return i.separation=function(e){return arguments.length?(n=e,i):n},i.size=function(e){return arguments.length?(r=e,i):r},i.elementsize=function(e){return arguments.length?(elementsize=e,i):elementsize},Ms(i,t)},e.layout.pack=function(){function i(e,i){var s=t.call(this,e,i),o=s[0];o.x=0,o.y=0,ro(o,function(e){e.r=Math.sqrt(e.value)}),ro(o,co);var u=r[0],a=r[1],f=Math.max(2*o.r/u,2*o.r/a);if(n>0){var l=n*f/2;ro(o,function(e){e.r+=l}),ro(o,co),ro(o,function(e){e.r-=l}),f=Math.max(2*o.r/u,2*o.r/a)}return vo(o,u/2,a/2,1/f),s}var t=e.layout.hierarchy().sort(uo),n=0,r=[1,1];return i.size=function(e){return arguments.length?(r=e,i):r},i.padding=function(e){return arguments.length?(n=+e,i):n},Ms(i,t)},e.layout.cluster=function(){function i(e,i){var s=t.call(this,e,i),o=s[0],u,a=0;ro(o,function(e){var t=e.children;t&&t.length?(e.x=yo(t),e.y=go(t)):(e.x=u?a+=n(e,u):0,e.y=0,u=e)});var f=bo(o),l=wo(o),c=f.x-n(f,l)/2,h=l.x+n(l,f)/2;return ro(o,function(e){e.x=(e.x-c)/(h-c)*r[0],e.y=(1-(o.y?e.y/o.y:1))*r[1]}),s}var t=e.layout.hierarchy().sort(null).value(null),n=Qs,r=[1,1];return i.separation=function(e){return arguments.length?(n=e,i):n},i.size=function(e){return arguments.length?(r=e,i):r},Ms(i,t)},e.layout.treemap=function(){function l(e,t){var n=-1,r=e.length,i,s;while(++n<r)s=(i=e[n]).value*(t<0?0:t),i.area=isNaN(s)||s<=0?0:s}function c(e){var t=e.children;if(t&&t.length){var n=s(e),r=[],i=t.slice(),o,u=Infinity,f,h=a==="slice"?n.dx:a==="dice"?n.dy:a==="slice-dice"?e.depth&1?n.dy:n.dx:Math.min(n.dx,n.dy),v;l(i,n.dx*n.dy/e.value),r.area=0;while((v=i.length)>0)r.push(o=i[v-1]),r.area+=o.area,a!=="squarify"||(f=p(r,h))<=u?(i.pop(),u=f):(r.area-=r.pop().area,d(r,h,n,!1),h=Math.min(n.dx,n.dy),r.length=r.area=0,u=Infinity);r.length&&(d(r,h,n,!0),r.length=r.area=0),t.forEach(c)}}function h(e){var t=e.children;if(t&&t.length){var n=s(e),r=t.slice(),i,o=[];l(r,n.dx*n.dy/e.value),o.area=0;while(i=r.pop())o.push(i),o.area+=i.area,i.z!=null&&(d(o,i.z?n.dx:n.dy,n,!r.length),o.length=o.area=0);t.forEach(h)}}function p(e,t){var n=e.area,r,i=0,s=Infinity,o=-1,u=e.length;while(++o<u){if(!(r=e[o].area))continue;r<s&&(s=r),r>i&&(i=r)}return n*=n,t*=t,n?Math.max(t*i*f/n,n/(t*s*f)):Infinity}function d(e,t,r,i){var s=-1,o=e.length,u=r.x,a=r.y,f=t?n(e.area/t):0,l;if(t==r.dx){if(i||f>r.dy)f=r.dy;while(++s<o)l=e[s],l.x=u,l.y=a,l.dy=f,u+=l.dx=Math.min(r.x+r.dx-u,f?n(l.area/f):0);l.z=!0,l.dx+=r.x+r.dx-u,r.y+=f,r.dy-=f}else{if(i||f>r.dx)f=r.dx;while(++s<o)l=e[s],l.x=u,l.y=a,l.dx=f,a+=l.dy=Math.min(r.y+r.dy-a,f?n(l.area/f):0);l.z=!1,l.dy+=r.y+r.dy-a,r.x+=f,r.dx-=f}}function v(e){var n=u||t(e),i=n[0];return i.x=0,i.y=0,i.dx=r[0],i.dy=r[1],u&&t.revalue(i),l([i],i.dx*i.dy/i.value),(u?h:c)(i),o&&(u=n),n}var t=e.layout.hierarchy(),n=Math.round,r=[1,1],i=null,s=Eo,o=!1,u,a="squarify",f=.5*(1+Math.sqrt(5));return v.size=function(e){return arguments.length?(r=e,v):r},v.padding=function(e){function t(t){var n=e.call(v,t,t.depth);return n==null?Eo(t):So(t,typeof n=="number"?[n,n,n,n]:n)}function n(t){return So(t,e)}if(!arguments.length)return i;var r;return s=(i=e)==null?Eo:(r=typeof e)==="function"?t:r==="number"?(e=[e,e,e,e],n):n,v},v.round=function(e){return arguments.length?(n=e?Math.round:Number,v):n!=Number},v.sticky=function(e){return arguments.length?(o=e,u=null,v):o},v.ratio=function(e){return arguments.length?(f=e,v):f},v.mode=function(e){return arguments.length?(a=e+"",v):a},Ms(v,t)},e.random={normal:function(e,t){var n=arguments.length;return n<2&&(t=1),n<1&&(e=0),function(){var n,r,i;do n=Math.random()*2-1,r=Math.random()*2-1,i=n*n+r*r;while(!i||i>1);return e+t*n*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var t=e.random.normal.apply(e,arguments);return function(){return Math.exp(t())}},irwinHall:function(e){return function(){for(var t=0,n=0;n<e;n++)t+=Math.random();return t/e}}},e.scale={},e.scale.linear=function(){return Lo([0,1],[0,1],Qi,!1)},e.scale.log=function(){return Po(e.scale.linear().domain([0,Math.LN10]),10,Bo,jo)};var Ho=e.format(".0e");e.scale.pow=function(){return Ro(e.scale.linear(),1)},e.scale.sqrt=function(){return e.scale.pow().exponent(.5)},e.scale.ordinal=function(){return zo([],{t:"range",a:[[]]})},e.scale.category10=function(){return e.scale.ordinal().range(Wo)},e.scale.category20=function(){return e.scale.ordinal().range(Xo)},e.scale.category20b=function(){return e.scale.ordinal().range(Vo)},e.scale.category20c=function(){return e.scale.ordinal().range($o)};var Wo=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],Xo=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],Vo=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],$o=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];e.scale.quantile=function(){return Jo([],[])},e.scale.quantize=function(){return Ko(0,1,[0,1])},e.scale.threshold=function(){return Qo([.5],[0,1])},e.scale.identity=function(){return Go([0,1])},e.svg.arc=function(){function i(){var i=e.apply(this,arguments),s=t.apply(this,arguments),o=n.apply(this,arguments)+Yo,u=r.apply(this,arguments)+Yo,a=(u<o&&(a=o,o=u,u=a),u-o),f=a<dt?"0":"1",l=Math.cos(o),c=Math.sin(o),h=Math.cos(u),p=Math.sin(u);return a>=Zo?i?"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+ -s+"A"+s+","+s+" 0 1,1 0,"+s+"M0,"+i+"A"+i+","+i+" 0 1,0 0,"+ -i+"A"+i+","+i+" 0 1,0 0,"+i+"Z":"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+ -s+"A"+s+","+s+" 0 1,1 0,"+s+"Z":i?"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L"+i*h+","+i*p+"A"+i+","+i+" 0 "+f+",0 "+i*l+","+i*c+"Z":"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L0,0"+"Z"}var e=eu,t=tu,n=nu,r=ru;return i.innerRadius=function(t){return arguments.length?(e=Qt(t),i):e},i.outerRadius=function(e){return arguments.length?(t=Qt(e),i):t},i.startAngle=function(e){return arguments.length?(n=Qt(e),i):n},i.endAngle=function(e){return arguments.length?(r=Qt(e),i):r},i.centroid=function(){var i=(e.apply(this,arguments)+t.apply(this,arguments))/2,s=(n.apply(this,arguments)+r.apply(this,arguments))/2+Yo;return[Math.cos(s)*i,Math.sin(s)*i]},i};var Yo=-dt/2,Zo=2*dt-1e-6;e.svg.line.radial=function(){var e=ii(iu);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},li.reverse=ci,ci.reverse=li,e.svg.area=function(){return su(Gt)},e.svg.area.radial=function(){var e=su(iu);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},e.svg.chord=function(){function s(n,r){var i=o(this,e,n,r),s=o(this,t,n,r);return"M"+i.p0+a(i.r,i.p1,i.a1-i.a0)+(u(i,s)?f(i.r,i.p1,i.r,i.p0):f(i.r,i.p1,s.r,s.p0)+a(s.r,s.p1,s.a1-s.a0)+f(s.r,s.p1,i.r,i.p0))+"Z"}function o(e,t,s,o){var u=t.call(e,s,o),a=n.call(e,u,o),f=r.call(e,u,o)+Yo,l=i.call(e,u,o)+Yo;return{r:a,a0:f,a1:l,p0:[a*Math.cos(f),a*Math.sin(f)],p1:[a*Math.cos(l),a*Math.sin(l)]}}function u(e,t){return e.a0==t.a0&&e.a1==t.a1}function a(e,t,n){return"A"+e+","+e+" 0 "+ +(n>dt)+",1 "+t}function f(e,t,n,r){return"Q 0,0 "+r}var e=Nr,t=Cr,n=ou,r=nu,i=ru;return s.radius=function(e){return arguments.length?(n=Qt(e),s):n},s.source=function(t){return arguments.length?(e=Qt(t),s):e},s.target=function(e){return arguments.length?(t=Qt(e),s):t},s.startAngle=function(e){return arguments.length?(r=Qt(e),s):r},s.endAngle=function(e){return arguments.length?(i=Qt(e),s):i},s},e.svg.diagonal=function(){function r(r,i){var s=e.call(this,r,i),o=t.call(this,r,i),u=(s.y+o.y)/2,a=[s,{x:s.x,y:u},{x:o.x,y:u},o];return a=a.map(n),"M"+a[0]+"C"+a[1]+" "+a[2]+" "+a[3]}var e=Nr,t=Cr,n=uu;return r.source=function(t){return arguments.length?(e=Qt(t),r):e},r.target=function(e){return arguments.length?(t=Qt(e),r):t},r.projection=function(e){return arguments.length?(n=e,r):n},r},e.svg.diagonal.radial=function(){var t=e.svg.diagonal(),n=uu,r=t.projection;return t.projection=function(e){return arguments.length?r(au(n=e)):n},t},e.svg.symbol=function(){function n(n,r){return(hu.get(e.call(this,n,r))||cu)(t.call(this,n,r))}var e=lu,t=fu;return n.type=function(t){return arguments.length?(e=Qt(t),n):e},n.size=function(e){return arguments.length?(t=Qt(e),n):t},n};var hu=e.map({circle:cu,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+ -3*t+","+ -t+"H"+ -t+"V"+ -3*t+"H"+t+"V"+ -t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+ -t+"V"+t+"H"+ -3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*du)),n=t*du;return"M0,"+ -t+"L"+n+",0"+" 0,"+t+" "+ -n+",0"+"Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+ -t+","+ -t+"L"+t+","+ -t+" "+t+","+t+" "+ -t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/pu),n=t*pu/2;return"M0,"+n+"L"+t+","+ -n+" "+ -t+","+ -n+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/pu),n=t*pu/2;return"M0,"+ -n+"L"+t+","+n+" "+ -t+","+n+"Z"}});e.svg.symbolTypes=hu.keys();var pu=Math.sqrt(3),du=Math.tan(30*mt),mu=[],gu=0,yu,bu={ease:us,delay:0,duration:250};mu.call=B.call,mu.empty=B.empty,mu.node=B.node,e.transition=function(e){return arguments.length?yu?e.transition():e:st.transition()},e.transition.prototype=mu,mu.select=function(e){var t=this.id,n=[],r,i,s;typeof e!="function"&&(e=j(e));for(var o=-1,u=this.length;++o<u;){n.push(r=[]);for(var a=this[o],f=-1,l=a.length;++f<l;)(s=a[f])&&(i=e.call(s,s.__data__,f))?("__data__"in s&&(i.__data__=s.__data__),Su(i,f,t,s.__transition__[t]),r.push(i)):r.push(null)}return vu(n,t)},mu.selectAll=function(e){var t=this.id,n=[],r,i,s,o,u;typeof e!="function"&&(e=F(e));for(var a=-1,f=this.length;++a<f;)for(var l=this[a],c=-1,h=l.length;++c<h;)if(s=l[c]){u=s.__transition__[t],i=e.call(s,s.__data__,c),n.push(r=[]);for(var p=-1,d=i.length;++p<d;)Su(o=i[p],p,t,u),r.push(o)}return vu(n,t)},mu.filter=function(e){var t=[],n,r,i;typeof e!="function"&&(e=K(e));for(var s=0,o=this.length;s<o;s++){t.push(n=[]);for(var r=this[s],u=0,a=r.length;u<a;u++)(i=r[u])&&e.call(i,i.__data__,u)&&n.push(i)}return vu(t,this.id,this.time).ease(this.ease())},mu.tween=function(e,t){var n=this.id;return arguments.length<2?this.node().__transition__[n].tween.get(e):nt(this,t==null?function(t){t.__transition__[n].tween.remove(e)}:function(r){r.__transition__[n].tween.set(e,t)})},mu.attr=function(t,n){function s(){this.removeAttribute(i)}function o(){this.removeAttributeNS(i.space,i.local)}if(arguments.length<2){for(n in t)this.attr(n,t[n]);return this}var r=Gi(t),i=e.ns.qualify(t);return wu(this,"attr."+t,n,function(e){function t(){var t=this.getAttribute(i),n;return t!==e&&(n=r(t,e),function(e){this.setAttribute(i,n(e))})}function n(){var t=this.getAttributeNS(i.space,i.local),n;return t!==e&&(n=r(t,e),function(e){this.setAttributeNS(i.space,i.local,n(e))})}return e==null?i.local?o:s:(e+="",i.local?n:t)})},mu.attrTween=function(t,n){function i(e,t){var i=n.call(this,e,t,this.getAttribute(r));return i&&function(e){this.setAttribute(r,i(e))}}function s(e,t){var i=n.call(this,e,t,this.getAttributeNS(r.space,r.local));return i&&function(e){this.setAttributeNS(r.space,r.local,i(e))}}var r=e.ns.qualify(t);return this.tween("attr."+t,r.local?s:i)},mu.style=function(e,t,r){function o(){this.style.removeProperty(e)}var i=arguments.length;if(i<3){if(typeof e!="string"){i<2&&(t="");for(r in e)this.style(r,e[r],t);return this}r=""}var s=Gi(e);return wu(this,"style."+e,t,function(t){function i(){var i=n.getComputedStyle(this,null).getPropertyValue(e),o;return i!==t&&(o=s(i,t),function(t){this.style.setProperty(e,o(t),r)})}return t==null?o:(t+="",i)})},mu.styleTween=function(e,t,r){return arguments.length<3&&(r=""),this.tween("style."+e,function(i,s){var o=t.call(this,i,s,n.getComputedStyle(this,null).getPropertyValue(e));return o&&function(t){this.style.setProperty(e,o(t),r)}})},mu.text=function(e){return wu(this,"text",e,Eu)},mu.remove=function(){return this.each("end.transition",function(){var e;!this.__transition__&&(e=this.parentNode)&&e.removeChild(this)})},mu.ease=function(t){var n=this.id;return arguments.length<1?this.node().__transition__[n].ease:(typeof t!="function"&&(t=e.ease.apply(e,arguments)),nt(this,function(e){e.__transition__[n].ease=t}))},mu.delay=function(e){var t=this.id;return nt(this,typeof e=="function"?function(n,r,i){n.__transition__[t].delay=e.call(n,n.__data__,r,i)|0}:(e|=0,function(n){n.__transition__[t].delay=e}))},mu.duration=function(e){var t=this.id;return nt(this,typeof e=="function"?function(n,r,i){n.__transition__[t].duration=Math.max(1,e.call(n,n.__data__,r,i)|0)}:(e=Math.max(1,e|0),function(n){n.__transition__[t].duration=e}))},mu.each=function(e,t){var n=this.id;if(arguments.length<2){var r=bu,i=yu;yu=n,nt(this,function(t,r,i){bu=t.__transition__[n],e.call(t,t.__data__,r,i)}),bu=r,yu=i}else nt(this,function(r){r.__transition__[n].event.on(e,t)});return this},mu.transition=function(){var e=this.id,t=++gu,n=[],r,i,s,o;for(var u=0,a=this.length;u<a;u++){n.push(r=[]);for(var i=this[u],f=0,l=i.length;f<l;f++){if(s=i[f])o=Object.create(s.__transition__[e]),o.delay+=o.duration,Su(s,f,t,o);r.push(s)}}return vu(n,t)},e.svg.axis=function(){function c(c){c.each(function(){var c=e.select(this),h=a==null?t.ticks?t.ticks.apply(t,u):t.domain():a,p=f==null?t.tickFormat?t.tickFormat.apply(t,u):String:f,d=ku(t,h,l),v=c.selectAll(".tick.minor").data(d,String),m=v.enter().insert("line",".tick").attr("class","tick minor").style("opacity",1e-6),g=e.transition(v.exit()).style("opacity",1e-6).remove(),y=e.transition(v).style("opacity",1),b=c.selectAll(".tick.major").data(h,String),w=b.enter().insert("g","path").attr("class","tick major").style("opacity",1e-6),E=e.transition(b.exit()).style("opacity",1e-6).remove(),S=e.transition(b).style("opacity",1),x,T=To(t),N=c.selectAll(".domain").data([0]),C=(N.enter().append("path").attr("class","domain"),e.transition(N)),k=t.copy(),L=this.__chart__||k;this.__chart__=k,w.append("line"),w.append("text");var A=w.select("line"),O=S.select("line"),M=b.select("text").text(p),_=w.select("text"),D=S.select("text");switch(n){case"bottom":x=Nu,m.attr("y2",i),y.attr("x2",0).attr("y2",i),A.attr("y2",r),_.attr("y",Math.max(r,0)+o),O.attr("x2",0).attr("y2",r),D.attr("x",0).attr("y",Math.max(r,0)+o),M.attr("dy",".71em").style("text-anchor","middle"),C.attr("d","M"+T[0]+","+s+"V0H"+T[1]+"V"+s);break;case"top":x=Nu,m.attr("y2",-i),y.attr("x2",0).attr("y2",-i),A.attr("y2",-r),_.attr("y",-(Math.max(r,0)+o)),O.attr("x2",0).attr("y2",-r),D.attr("x",0).attr("y",-(Math.max(r,0)+o)),M.attr("dy","0em").style("text-anchor","middle"),C.attr("d","M"+T[0]+","+ -s+"V0H"+T[1]+"V"+ -s);break;case"left":x=Cu,m.attr("x2",-i),y.attr("x2",-i).attr("y2",0),A.attr("x2",-r),_.attr("x",-(Math.max(r,0)+o)),O.attr("x2",-r).attr("y2",0),D.attr("x",-(Math.max(r,0)+o)).attr("y",0),M.attr("dy",".32em").style("text-anchor","end"),C.attr("d","M"+ -s+","+T[0]+"H0V"+T[1]+"H"+ -s);break;case"right":x=Cu,m.attr("x2",i),y.attr("x2",i).attr("y2",0),A.attr("x2",r),_.attr("x",Math.max(r,0)+o),O.attr("x2",r).attr("y2",0),D.attr("x",Math.max(r,0)+o).attr("y",0),M.attr("dy",".32em").style("text-anchor","start"),C.attr("d","M"+s+","+T[0]+"H0V"+T[1]+"H"+s)}if(t.ticks)w.call(x,L),S.call(x,k),E.call(x,k),m.call(x,L),y.call(x,k),g.call(x,k);else{var P=k.rangeBand()/2,H=function(e){return k(e)+P};w.call(x,H),S.call(x,H)}})}var t=e.scale.linear(),n=xu,r=6,i=6,s=6,o=3,u=[10],a=null,f,l=0;return c.scale=function(e){return arguments.length?(t=e,c):t},c.orient=function(e){return arguments.length?(n=e in Tu?e+"":xu,c):n},c.ticks=function(){return arguments.length?(u=arguments,c):u},c.tickValues=function(e){return arguments.length?(a=e,c):a},c.tickFormat=function(e){return arguments.length?(f=e,c):f},c.tickSize=function(e,t){if(!arguments.length)return r;var n=arguments.length-1;return r=+e,i=n>1?+t:r,s=n>0?+arguments[n]:r,c},c.tickPadding=function(e){return arguments.length?(o=+e,c):o},c.tickSubdivide=function(e){return arguments.length?(l=+e,c):l},c};var xu="bottom",Tu={top:1,right:1,bottom:1,left:1};e.svg.brush=function(){function a(t){t.each(function(){var t=e.select(this),n=t.selectAll(".background").data([0]),o=t.selectAll(".extent").data([0]),u=t.selectAll(".resize").data(s,String),p;t.style("pointer-events","all").on("mousedown.brush",h).on("touchstart.brush",h),n.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),o.enter().append("rect").attr("class","extent").style("cursor","move"),u.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return Lu[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),u.style("display",a.empty()?"none":null),u.exit().remove(),r&&(p=To(r),n.attr("x",p[0]).attr("width",p[1]-p[0]),l(t)),i&&(p=To(i),n.attr("y",p[0]).attr("height",p[1]-p[0]),c(t)),f(t)})}function f(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+o[+/e$/.test(e)][0]+","+o[+/^s/.test(e)][1]+")"})}function l(e){e.select(".extent").attr("x",o[0][0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",o[1][0]-o[0][0])}function c(e){e.select(".extent").attr("y",o[0][1]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",o[1][1]-o[0][1])}function h(){function C(){var t=e.event.changedTouches;return t?e.touches(s,t)[0]:e.mouse(s)}function k(){e.event.keyCode==32&&(b||(w=null,E[0]-=o[1][0],E[1]-=o[1][1],b=2),y())}function L(){e.event.keyCode==32&&b==2&&(E[0]+=o[1][0],E[1]+=o[1][1],b=0,y())}function A(){var t=C(),n=!1;S&&(t[0]+=S[0],t[1]+=S[1]),b||(e.event.altKey?(w||(w=[(o[0][0]+o[1][0])/2,(o[0][1]+o[1][1])/2]),E[0]=o[+(t[0]<w[0])][0],E[1]=o[+(t[1]<w[1])][1]):w=null),m&&O(t,r,0)&&(l(d),n=!0),g&&O(t,i,1)&&(c(d),n=!0),n&&(f(d),p({type:"brush",mode:b?"move":"resize"}))}function O(e,t,n){var r=To(t),i=r[0],s=r[1],a=E[n],f=o[1][n]-o[0][n],l,c;b&&(i-=a,s-=f+a),l=Math.max(i,Math.min(s,e[n])),b?c=(l+=a)+f:(w&&(a=Math.max(i,Math.min(s,2*w[n]-l))),a<l?(c=l,l=a):c=a);if(o[0][n]!==l||o[1][n]!==c)return u=null,o[0][n]=l,o[1][n]=c,!0}function M(){A(),d.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null),e.select("body").style("cursor",null),x.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),p({type:"brushend"}),y()}var s=this,h=e.select(e.event.target),p=t.of(s,arguments),d=e.select(s),v=h.datum(),m=!/^(n|s)$/.test(v)&&r,g=!/^(e|w)$/.test(v)&&i,b=h.classed("extent"),w,E=C(),S,x=e.select(n).on("mousemove.brush",A).on("mouseup.brush",M).on("touchmove.brush",A).on("touchend.brush",M).on("keydown.brush",k).on("keyup.brush",L);if(b)E[0]=o[0][0]-E[0],E[1]=o[0][1]-E[1];else if(v){var T=+/w$/.test(v),N=+/^n/.test(v);S=[o[1-T][0]-E[0],o[1-N][1]-E[1]],E[0]=o[T][0],E[1]=o[N][1]}else e.event.altKey&&(w=E.slice());d.style("pointer-events","none").selectAll(".resize").style("display",null),e.select("body").style("cursor",h.style("cursor")),p({type:"brushstart"}),A(),y()}var t=S(a,"brushstart","brush","brushend"),r=null,i=null,s=Au[0],o=[[0,0],[0,0]],u;return a.x=function(e){return arguments.length?(r=e,s=Au[!r<<1|!i],a):r},a.y=function(e){return arguments.length?(i=e,s=Au[!r<<1|!i],a):i},a.extent=function(e){var t,n,s,f,l;return arguments.length?(u=[[0,0],[0,0]],r&&(t=e[0],n=e[1],i&&(t=t[0],n=n[0]),u[0][0]=t,u[1][0]=n,r.invert&&(t=r(t),n=r(n)),n<t&&(l=t,t=n,n=l),o[0][0]=t|0,o[1][0]=n|0),i&&(s=e[0],f=e[1],r&&(s=s[1],f=f[1]),u[0][1]=s,u[1][1]=f,i.invert&&(s=i(s),f=i(f)),f<s&&(l=s,s=f,f=l),o[0][1]=s|0,o[1][1]=f|0),a):(e=u||o,r&&(t=e[0][0],n=e[1][0],u||(t=o[0][0],n=o[1][0],r.invert&&(t=r.invert(t),n=r.invert(n)),n<t&&(l=t,t=n,n=l))),i&&(s=e[0][1],f=e[1][1],u||(s=o[0][1],f=o[1][1],i.invert&&(s=i.invert(s),f=i.invert(f)),f<s&&(l=s,s=f,f=l))),r&&i?[[t,s],[n,f]]:r?[t,n]:i&&[s,f])},a.clear=function(){return u=null,o[0][0]=o[0][1]=o[1][0]=o[1][1]=0,a},a.empty=function(){return r&&o[0][0]===o[1][0]||i&&o[0][1]===o[1][1]},e.rebind(a,t,"on")};var Lu={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Au=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];e.time={};var Ou=Date,Mu=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];_u.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Du.setUTCDate.apply(this._,arguments)},setDay:function(){Du.setUTCDay.apply(this._,arguments)},setFullYear:function(){Du.setUTCFullYear.apply(this._,arguments)},setHours:function(){Du.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Du.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Du.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Du.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Du.setUTCSeconds.apply(this._,arguments)},setTime:function(){Du.setTime.apply(this._,arguments)}};var Du=Date.prototype,Pu="%a %b %e %X %Y",Hu="%m/%d/%Y",Bu="%H:%M:%S",ju=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Fu=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Iu=["January","February","March","April","May","June","July","August","September","October","November","December"],qu=["Jan","Feb","Mar"
,"Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.time.year=Ru(function(t){return t=e.time.day(t),t.setMonth(0,1),t},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),e.time.years=e.time.year.range,e.time.years.utc=e.time.year.utc.range,e.time.day=Ru(function(e){var t=new Ou(1970,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),e.time.days=e.time.day.range,e.time.days.utc=e.time.day.utc.range,e.time.dayOfYear=function(t){var n=e.time.year(t);return Math.floor((t-n-(t.getTimezoneOffset()-n.getTimezoneOffset())*6e4)/864e5)},Mu.forEach(function(t,n){t=t.toLowerCase(),n=7-n;var r=e.time[t]=Ru(function(t){return(t=e.time.day(t)).setDate(t.getDate()-(t.getDay()+n)%7),t},function(e,t){e.setDate(e.getDate()+Math.floor(t)*7)},function(t){var r=e.time.year(t).getDay();return Math.floor((e.time.dayOfYear(t)+(r+n)%7)/7)-(r!==n)});e.time[t+"s"]=r.range,e.time[t+"s"].utc=r.utc.range,e.time[t+"OfYear"]=function(t){var r=e.time.year(t).getDay();return Math.floor((e.time.dayOfYear(t)+(r+n)%7)/7)}}),e.time.week=e.time.sunday,e.time.weeks=e.time.sunday.range,e.time.weeks.utc=e.time.sunday.utc.range,e.time.weekOfYear=e.time.sundayOfYear,e.time.format=function(e){function n(n){var r=[],i=-1,s=0,o,u,a;while(++i<t)if(e.charCodeAt(i)===37){r.push(e.substring(s,i)),(u=Zu[o=e.charAt(++i)])!=null&&(o=e.charAt(++i));if(a=ea[o])o=a(n,u==null?o==="e"?" ":"0":u);r.push(o),s=i+1}return r.push(e.substring(s,i)),r.join("")}var t=e.length;return n.parse=function(t){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},r=zu(n,e,t,0);if(r!=t.length)return null;"p"in n&&(n.H=n.H%12+n.p*12);var i=new Ou;return i.setFullYear(n.y,n.m,n.d),i.setHours(n.H,n.M,n.S,n.L),i},n.toString=function(){return e},n};var $u=Wu(ju),Ju=Wu(Fu),Ku=Wu(Iu),Qu=Xu(Iu),Gu=Wu(qu),Yu=Xu(qu),Zu={"-":"",_:" ",0:"0"},ea={a:function(e){return Fu[e.getDay()]},A:function(e){return ju[e.getDay()]},b:function(e){return qu[e.getMonth()]},B:function(e){return Iu[e.getMonth()]},c:e.time.format(Pu),d:function(e,t){return Vu(e.getDate(),t,2)},e:function(e,t){return Vu(e.getDate(),t,2)},H:function(e,t){return Vu(e.getHours(),t,2)},I:function(e,t){return Vu(e.getHours()%12||12,t,2)},j:function(t,n){return Vu(1+e.time.dayOfYear(t),n,3)},L:function(e,t){return Vu(e.getMilliseconds(),t,3)},m:function(e,t){return Vu(e.getMonth()+1,t,2)},M:function(e,t){return Vu(e.getMinutes(),t,2)},p:function(e){return e.getHours()>=12?"PM":"AM"},S:function(e,t){return Vu(e.getSeconds(),t,2)},U:function(t,n){return Vu(e.time.sundayOfYear(t),n,2)},w:function(e){return e.getDay()},W:function(t,n){return Vu(e.time.mondayOfYear(t),n,2)},x:e.time.format(Hu),X:e.time.format(Bu),y:function(e,t){return Vu(e.getFullYear()%100,t,2)},Y:function(e,t){return Vu(e.getFullYear()%1e4,t,4)},Z:Ea,"%":function(){return"%"}},ta={a:na,A:ra,b:ia,B:sa,c:oa,d:pa,e:pa,H:da,I:da,L:ga,m:ha,M:va,p:ba,S:ma,x:ua,X:aa,y:la,Y:fa},ya=/^\s*\d+/,wa=e.map({am:0,pm:1});e.time.format.utc=function(t){function r(e){try{Ou=_u;var t=new Ou;return t._=e,n(t)}finally{Ou=Date}}var n=e.time.format(t);return r.parse=function(e){try{Ou=_u;var t=n.parse(e);return t&&t._}finally{Ou=Date}},r.toString=n.toString,r};var Sa=e.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");e.time.format.iso=Date.prototype.toISOString&&+(new Date("2000-01-01T00:00:00.000Z"))?xa:Sa,xa.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},xa.toString=Sa.toString,e.time.second=Ru(function(e){return new Ou(Math.floor(e/1e3)*1e3)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*1e3)},function(e){return e.getSeconds()}),e.time.seconds=e.time.second.range,e.time.seconds.utc=e.time.second.utc.range,e.time.minute=Ru(function(e){return new Ou(Math.floor(e/6e4)*6e4)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*6e4)},function(e){return e.getMinutes()}),e.time.minutes=e.time.minute.range,e.time.minutes.utc=e.time.minute.utc.range,e.time.hour=Ru(function(e){var t=e.getTimezoneOffset()/60;return new Ou((Math.floor(e/36e5-t)+t)*36e5)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*36e5)},function(e){return e.getHours()}),e.time.hours=e.time.hour.range,e.time.hours.utc=e.time.hour.utc.range,e.time.month=Ru(function(t){return t=e.time.day(t),t.setDate(1),t},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),e.time.months=e.time.month.range,e.time.months.utc=e.time.month.utc.range;var Oa=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Ma=[[e.time.second,1],[e.time.second,5],[e.time.second,15],[e.time.second,30],[e.time.minute,1],[e.time.minute,5],[e.time.minute,15],[e.time.minute,30],[e.time.hour,1],[e.time.hour,3],[e.time.hour,6],[e.time.hour,12],[e.time.day,1],[e.time.day,2],[e.time.week,1],[e.time.month,1],[e.time.month,3],[e.time.year,1]],_a=[[e.time.format("%Y"),$n],[e.time.format("%B"),function(e){return e.getMonth()}],[e.time.format("%b %d"),function(e){return e.getDate()!=1}],[e.time.format("%a %d"),function(e){return e.getDay()&&e.getDate()!=1}],[e.time.format("%I %p"),function(e){return e.getHours()}],[e.time.format("%I:%M"),function(e){return e.getMinutes()}],[e.time.format(":%S"),function(e){return e.getSeconds()}],[e.time.format(".%L"),function(e){return e.getMilliseconds()}]],Da=e.scale.linear(),Pa=ka(_a);Ma.year=function(e,t){return Da.domain(e.map(Aa)).ticks(t).map(La)},e.time.scale=function(){return Ta(e.scale.linear(),Ma,Pa)};var Ha=Ma.map(function(e){return[e[0].utc,e[1]]}),Ba=[[e.time.format.utc("%Y"),$n],[e.time.format.utc("%B"),function(e){return e.getUTCMonth()}],[e.time.format.utc("%b %d"),function(e){return e.getUTCDate()!=1}],[e.time.format.utc("%a %d"),function(e){return e.getUTCDay()&&e.getUTCDate()!=1}],[e.time.format.utc("%I %p"),function(e){return e.getUTCHours()}],[e.time.format.utc("%I:%M"),function(e){return e.getUTCMinutes()}],[e.time.format.utc(":%S"),function(e){return e.getUTCSeconds()}],[e.time.format.utc(".%L"),function(e){return e.getUTCMilliseconds()}]],ja=ka(Ba);return Ha.year=function(e,t){return Da.domain(e.map(Ia)).ticks(t).map(Fa)},e.time.scale.utc=function(){return Ta(e.scale.linear(),Ha,ja)},e.text=function(){return e.xhr.apply(e,arguments).response(qa)},e.json=function(t,n){return e.xhr(t,"application/json",n).response(Ra)},e.html=function(t,n){return e.xhr(t,"text/html",n).response(Ua)},e.xml=function(){return e.xhr.apply(e,arguments).response(za)},e}();
/* End of File include/javascript/nvd3/lib/d3.min.js */


function loadSugarChart(chartId,jsonFilename,css,chartConfig,chartParams,callback){this.chartObject='';var d3ChartId='d3_'+chartId||'d3_c3090c86-2b12-a65e-967f-51b642ac6165';var canvasChartId='canvas_'+chartId||'canvas_c3090c86-2b12-a65e-967f-51b642ac6165';if(document.getElementById(d3ChartId)===null){return false;}
var labelType='Native',useGradients=false,animate=false,that=this,contentEl='content',minColumnWidth=40;var params=_.extend({show_title:true,show_legend:true,show_controls:false,show_tooltips:true,show_y_label:false,y_axis_label:'',show_x_label:false,x_axis_label:'',vertical:true,wrapTicks:true,staggerTicks:true,rotateTicks:true,reduceXTicks:false,allowScroll:false,overflowHandler:false,showValues:false,hideEmptyGroups:true,stacked:true,colorData:'default',margin:{top:10,right:10,bottom:10,left:10},direction:chartConfig['direction']||'ltr'},chartParams);contentEl=params.contentEl||contentEl;minColumnWidth=params.minColumnWidth||minColumnWidth;switch(chartConfig['chartType']){case'paretoChart':SUGAR.charts.get(jsonFilename,params,function(data){if(SUGAR.charts.isDataEmpty(data)){var json=SUGAR.charts.translateParetoDataToD3(data,params,chartConfig);var paretoChart=nv.models.paretoChart().margin(params.margin).showTitle(false).tooltips(true).direction(params.direction).tooltipLine(function(key,x,y,e,graph){var val=App.currency.formatAmountLocale(e.point.y);return'<p>'+key+': <b>'+val+'</b></p>';}).tooltipBar(function(key,x,y,e,graph){var val=App.currency.formatAmountLocale(e.value);return'<p>'+SUGAR.charts.translateString('LBL_SALES_STAGE','Forecasts')+': <b>'+key+'</b></p>'+'<p>'+SUGAR.charts.translateString('LBL_AMOUNT','Forecasts')+': <b>'+val+'</b></p>'+'<p>'+SUGAR.charts.translateString('LBL_PERCENT','Forecasts')+': <b>'+x+'%</b></p>';}).showControls(false).colorData('default').colorFill('default').allowScroll(false).stacked(!params.display_manager).id(chartId).strings({legend:{close:SUGAR.charts.translateString('LBL_CHART_LEGEND_CLOSE'),open:SUGAR.charts.translateString('LBL_CHART_LEGEND_OPEN')},noData:SUGAR.charts.translateString('LBL_CHART_NO_DATA')});d3ChartId=params.chartId||'db620e51-8350-c596-06d1-4f866bfcfd5b';var completeCallback=function(){SUGAR.charts.renderChart(chartId,paretoChart,json);d3.select('#'+d3ChartId).selectAll('.nv-y.nv-axis text').text(function(d){return App.user.get('preferences').currency_symbol+d3.format(',.2s')(d);});};that.chartObject=paretoChart;if(chartConfig['ReportModule']){paretoChart.legend.showAll(true);SUGAR.charts.trackWindowResize(paretoChart);if(chartConfig['imageExportType']){SUGAR.charts.saveImageFile(chartId,paretoChart,json,jsonFilename,chartConfig['imageExportType'],completeCallback);}else{SUGAR.charts.renderChart(chartId,paretoChart,json);}}else{d3.select('#'+d3ChartId).append('svg').datum(json).transition().duration(500).call(paretoChart).selectAll('.nv-y.nv-axis text').text(function(d){return App.user.get('preferences').currency_symbol+d3.format(',.2s')(d);});}
SUGAR.charts.callback(callback,paretoChart);}});break;case'barChart':SUGAR.charts.get(jsonFilename,params,function(data){if(SUGAR.charts.isDataEmpty(data)){var json=SUGAR.charts.translateDataToD3(data,params,chartConfig);if(json.properties&&json.properties.labels&&json.properties.labels.length>50){SUGAR.charts.renderError(chartId,SUGAR.charts.translateString('LBL_CANNOT_DISPLAY_CHART_MESSAGE','Reports'));return;}
params.vertical=chartConfig['orientation']==='vertical'?true:false;var barChart=nv.models.multiBarChart().id(d3ChartId).vertical(params.vertical).margin(params.margin).showTitle(params.show_title).tooltips(params.show_tooltips).tooltipContent(function(key,x,y,e,graph){return'<h3>'+key+'</h3>'+'<p>'+y+'</p>';}).direction(params.direction).showLegend(params.show_legend).showControls(params.show_controls).wrapTicks(params.wrapTicks).staggerTicks(params.staggerTicks).rotateTicks(params.rotateTicks).reduceXTicks(params.reduceXTicks).colorData(params.colorData).stacked(params.stacked).allowScroll(params.allowScroll).overflowHandler(params.overflowHandler).showValues(params.showValues).strings({legend:{close:SUGAR.charts.translateString('LBL_CHART_LEGEND_CLOSE'),open:SUGAR.charts.translateString('LBL_CHART_LEGEND_OPEN')},noData:SUGAR.charts.translateString('LBL_CHART_NO_DATA')});barChart.yAxis.tickSize(0).axisLabel(params.show_y_label).tickFormat(d3.format('s'));if(params.show_x_label){barChart.xAxis.axisLabel(params.x_axis_label);}
if(params.show_y_label){barChart.yAxis.axisLabel(params.y_axis_label);}
that.chartObject=barChart;if(chartConfig['ReportModule']){if(chartConfig['orientation']==='vertical'){barChart.legend.rowsCount(5);barChart.legend.showAll(false);}
else{barChart.legend.showAll(true);}
SUGAR.charts.trackWindowResize(barChart);if(chartConfig['imageExportType']){SUGAR.charts.saveImageFile(chartId,barChart,json,jsonFilename,chartConfig['imageExportType']);}else{SUGAR.charts.renderChart(chartId,barChart,json);}}else{SUGAR.charts.renderChart(chartId,barChart,json);}
SUGAR.charts.callback(callback,barChart);}});break;case'lineChart':SUGAR.charts.get(jsonFilename,params,function(data){if(SUGAR.charts.isDataEmpty(data)){var json=SUGAR.charts.translateDataToD3(data,params,chartConfig);var xLabels=data.label;var lineChart=nv.models.lineChart().id(d3ChartId).x(function(d){return d[0];}).y(function(d){return d[1];}).size(function(){return 123;}).margin(params.margin).tooltips(params.show_tooltips).tooltipContent(function(key,x,y,e,graph){return'<h3>'+key+'</h3>'+'<p>'+y+'</p>';}).direction(params.direction).showTitle(params.show_title).showLegend(params.show_legend).showControls(params.show_controls).rotateTicks(params.rotateTicks).colorData(params.colorData).strings({legend:{close:SUGAR.charts.translateString('LBL_CHART_LEGEND_CLOSE'),open:SUGAR.charts.translateString('LBL_CHART_LEGEND_OPEN')},noData:SUGAR.charts.translateString('LBL_CHART_NO_DATA')});if(params.show_x_label){lineChart.xAxis.axisLabel(params.x_axis_label);}
if(params.show_y_label){lineChart.yAxis.axisLabel(params.y_axis_label);}
lineChart.xAxis.showMaxMin(false).highlightZero(false).tickFormat(function(d,i){return xLabels[d];});lineChart.yAxis.tickFormat(d3.format('s'));that.chartObject=lineChart;if(chartConfig['ReportModule']){lineChart.legend.showAll(true);SUGAR.charts.trackWindowResize(lineChart);if(chartConfig['imageExportType']){SUGAR.charts.saveImageFile(chartId,lineChart,json,jsonFilename,chartConfig['imageExportType']);}else{SUGAR.charts.renderChart(chartId,lineChart,json);}}else{SUGAR.charts.renderChart(chartId,lineChart,json);}
SUGAR.charts.callback(callback,lineChart);}});break;case'pieChart':SUGAR.charts.get(jsonFilename,params,function(data){if(SUGAR.charts.isDataEmpty(data)){var json=SUGAR.charts.translateDataToD3(data,params,chartConfig);if(json.properties&&json.properties.labels&&json.properties.labels.length>50){SUGAR.charts.renderError(chartId,SUGAR.charts.translateString('LBL_CANNOT_DISPLAY_CHART_MESSAGE','Reports'));return;}
var pieChart=nv.models.pieChart().id(d3ChartId).margin(params.margin).tooltips(params.show_tooltips).showTitle(params.show_title).showLegend(params.show_legend).colorData(params.colorData).direction(params.direction).strings({legend:{close:SUGAR.charts.translateString('LBL_CHART_LEGEND_CLOSE'),open:SUGAR.charts.translateString('LBL_CHART_LEGEND_OPEN')},noData:SUGAR.charts.translateString('LBL_CHART_NO_DATA')});that.chartObject=pieChart;if(chartConfig['ReportModule']){pieChart.legend.showAll(true);SUGAR.charts.trackWindowResize(pieChart);if(chartConfig['imageExportType']){SUGAR.charts.saveImageFile(chartId,pieChart,json,jsonFilename,chartConfig['imageExportType']);}else{SUGAR.charts.renderChart(chartId,pieChart,json);}}else{SUGAR.charts.renderChart(chartId,pieChart,json);}
SUGAR.charts.callback(callback,pieChart);}});break;case'funnelChart':SUGAR.charts.get(jsonFilename,params,function(data){if(SUGAR.charts.isDataEmpty(data)){var json=SUGAR.charts.translateDataToD3(data,params,chartConfig);if(json.properties&&json.properties.labels&&json.properties.labels.length>16){SUGAR.charts.renderError(chartId,SUGAR.charts.translateString('LBL_CANNOT_DISPLAY_CHART_MESSAGE','Reports'));return;}
var funnelChart=nv.models.funnelChart().id(d3ChartId).margin(params.margin).showTitle(params.show_title).tooltips(params.show_tooltips).tooltipContent(function(key,x,y,e,graph){return'<h3>'+key+'</h3>'+'<p>'+(e.label||e.value)+'</p>';}).direction(params.direction).colorData(params.colorData).fmtValueLabel(function(d){return d.label||d.value||d;}).clipEdge(false).delay(1).strings({legend:{close:SUGAR.charts.translateString('LBL_CHART_LEGEND_CLOSE'),open:SUGAR.charts.translateString('LBL_CHART_LEGEND_OPEN')},noData:SUGAR.charts.translateString('LBL_CHART_NO_DATA')});that.chartObject=funnelChart;if(chartConfig['ReportModule']){funnelChart.legend.showAll(true);SUGAR.charts.trackWindowResize(funnelChart,chartId,data);if(chartConfig['imageExportType']){SUGAR.charts.saveImageFile(chartId,funnelChart,json,jsonFilename,chartConfig['imageExportType']);}else{SUGAR.charts.renderChart(chartId,funnelChart,json);}}else{SUGAR.charts.renderChart(chartId,funnelChart,json);}
SUGAR.charts.callback(callback,funnelChart);}});break;case'gaugeChart':SUGAR.charts.get(jsonFilename,params,function(data){if(SUGAR.charts.isDataEmpty(data)){var json=SUGAR.charts.translateDataToD3(data,params,chartConfig);var maxValue=d3.max(json.data.map(function(d){return d.y;}));if(maxValue===0){json.data[0].y=1;maxValue=1;}
json.data.map(function(d,i){d.classes='nv-fill0'+(i+1);});var gaugeChart=nv.models.gaugeChart().id(d3ChartId).x(function(d){return d.key;}).y(function(d){return d.y;}).direction(params.direction).showLabels(true).showTitle(true).colorData('class').ringWidth(50).maxValue(maxValue).transitionMs(4000);that.chartObject=gaugeChart;if(chartConfig['ReportModule']){gaugeChart.legend.showAll(true);SUGAR.charts.trackWindowResize(gaugeChart);if(chartConfig['imageExportType']){SUGAR.charts.saveImageFile(chartId,gaugeChart,json,jsonFilename,chartConfig['imageExportType']);}else{SUGAR.charts.renderChart(chartId,gaugeChart,json);}}else{SUGAR.charts.renderChart(chartId,gaugeChart,json);}
SUGAR.charts.callback(callback,gaugeChart);}});break;}}
function swapChart(chartId,jsonFilename,css,chartConfig){$('#d3_'+chartId).empty();var chart=new loadSugarChart(chartId,jsonFilename,css,chartConfig);return chart;}
(function($){if(typeof SUGAR=='undefined'||!SUGAR){SUGAR={};}
SUGAR.charts={chart:null,callback:function(callback,chart){if(callback){callback(chart||this.chart);}},renderChart:function(id,chart,json){$('#d3_'+id).empty();d3.select('#d3_'+id).append('svg').datum(json).transition().duration(500).call(chart);},renderError:function(id,str){$('#d3_'+id).empty();d3.select('.reportChartContainer').style('height','auto');d3.select('.reportChartContainer .chartContainer').style('float','none').style('position','relative').style('width','100%');d3.select('#d3_'+id).style('height','auto').append('div').attr('class','nv-data-error').attr('align','center').style('padding','12px').text(str);},generateLegend:function(chart,chartId){var list=$jit.id('legend'+chartId);var legend=chart.getLegend();var table,i;if(typeof legend['wmlegend']!='undefined'&&legend['wmlegend']['name'].length>0){table='<div class="col">';}else{table='<div class="row">';}
for(i=0;i<legend['name'].length;i++){table+='<div class="legendGroup">';table+='<div class="query-color" style="background-color:'+legend['color'][i]+'"></div>';table+='<div class="label">';table+=legend['name'][i];table+='</div>';table+='</div>';}
table+='</div>';if(typeof legend['wmlegend']!='undefined'&&legend['wmlegend']['name'].length>0){table+='<div class="col2">';for(i=0;i<legend['wmlegend']['name'].length;i++){table+='<div class="legendGroup">';table+='<div class="waterMark  '+legend['wmlegend']['type'][i]+'" style="background-color:'+legend['wmlegend']['color'][i]+'"></div>';table+='<div class="label">'+legend['wmlegend']['name'][i]+'</div>';table+='</div>';}
table+='</div>';}
list.innerHTML=table;jQuery('#legend'+chartId).ready(function(){var chartWidth=jQuery('#'+chartId).width();var sel;chartWidth=chartWidth-20;$('#legend'+chartId).width(chartWidth);var legendGroupWidth=[];if(typeof legend['wmlegend']!='undefined'&&legend['wmlegend']['name'].length>0){sel='.col .legendGroup';}else{sel='.row .legendGroup';}
$(sel).each(function(index){legendGroupWidth[index]=$(this).width();});var largest=Math.max.apply(Math,legendGroupWidth);$(sel).width(largest+2);});return list;},get:function(urlordata,params,success){if(typeof urlordata==='string'){var data={r:new Date().getTime()};$.extend(data,params);$.ajax({url:urlordata,data:data,dataType:'json',async:false,success:success});}else{success(urlordata);}},translateString:function(appString,module){if(SUGAR.language){if(module){return SUGAR.language.get(module,appString);}else{return SUGAR.language.get('app_strings',appString);}}else if(SUGAR.App){if(module){return SUGAR.App.lang.get(appString,module);}else{return SUGAR.App.lang.get(appString);}}else{return appString;}},translateDataToD3:function(json,params,chartConfig){var data=[],value=0,strUndefined=SUGAR.charts.translateString('LBL_CHART_UNDEFINED');if(json.values.filter(function(d){return d.values&&d.values.length;}).length){switch(chartConfig['chartType']){case'barChart':data=chartConfig.barType==='stacked'||chartConfig.barType==='grouped'?json.label.map(function(d,i){return{'key':d!==''?d:strUndefined,'type':'bar','values':json.values.map(function(e,j){return{'series':i,'x':j+1,'y':parseFloat(e.values[i])||0,'y0':0};})};}):json.values.map(function(d,i){return{'key':d.values.length>1?d.label:d.label[0]!==''?d.label[0]:strUndefined,'type':'bar','values':json.values.map(function(e,j){return{'series':i,'x':j+1,'y':i===j?e.values.length>1?e.values.reduce(function(a,b){return parseFloat(a)+parseFloat(b);}):parseFloat(e.values[0]):0,'y0':0};})};});break;case'pieChart':data=json.values.map(function(d,i){var data={'key':[].concat(d.label)[0]!==''?[].concat(d.label)[0]:strUndefined,'value':parseFloat(d.values.reduce(function(a,b){return a+b;},0))};if(d.color!==undefined){data.color=d.color;}
if(d.classes!==undefined){data.classes=d.classes;}
return data;});break;case'funnelChart':data=json.values.reverse().map(function(d,i){return{'key':[].concat(d.label)[0]!==''?[].concat(d.label)[0]:strUndefined,'values':[{'series':i,'label':d.valuelabels[0]?d.valuelabels[0]:d.values[0],'x':0,'y':parseFloat(d.values.reduce(function(a,b){return a+b;},0))||0,'y0':0}]};});break;case'lineChart':data=json.values.map(function(d,i){return{'key':d.label!==''?d.label:strUndefined,'values':d.values.map(function(e,j){return[j,parseFloat(e)];})};});break;case'gaugeChart':value=json.values.shift().gvalue;var y0=0;data=json.values.map(function(d,i){var values={'key':d.label!==''?d.label:strUndefined,'y':parseFloat(d.values[0])+y0};y0+=parseFloat(d.values[0]);return values;});break;}}
return{'properties':{'title':json.properties[0].title,'labels':!json.values.filter(function(d){return d.values.length;}).length?[]:json.values.map(function(d,i){return{'group':i+1,'l':d.label!==''?d.label:strUndefined};}),'values':chartConfig['chartType']==='gaugeChart'?[{'group':1,'t':value}]:json.values.filter(function(d){return d.values.length;}).length?json.values.map(function(d,i){return{'group':i+1,'t':d.values.reduce(function(a,b){return parseFloat(a)+parseFloat(b);})};}):[]},'data':data};},translateParetoDataToD3:function(json,params){return{'properties':{'title':json.properties[0].title,'quota':parseInt(json.values[0].goalmarkervalue[0],10),'groupData':(!json.values.filter(function(d){return d.values.length;}).length)?[]:json.values.map(function(d,i){return{'group':i,'l':json.values[i].label,'t':json.values[i].values.reduce(function(p,c,i,a){return parseInt(p,10)+parseInt(c,10);})};})},'data':(!json.values.filter(function(d){return d.values.length;}).length)?[]:json.label.map(function(d,i){return{'key':d,'type':'bar','series':i,'values':json.values.map(function(e,j){return{'series':i,'x':j+1,'y':parseInt(e.values[i],10),y0:0};}),'valuesOrig':json.values.map(function(e,j){return{'series':i,'x':j+1,'y':parseInt(e.values[i],10),y0:0};})};}).concat(json.properties[0].goal_marker_label.filter(function(d,i){return d!=='Quota';}).map(function(d,i){return{'key':d,'type':'line','series':i,'values':json.values.map(function(e,j){return{'series':i,'x':j+1,'y':parseInt(e.goalmarkervalue[i+1],10)};}),'valuesOrig':json.values.map(function(e,j){return{'series':i,'x':j+1,'y':parseInt(e.goalmarkervalue[i+1],10)};})};}))};},isDataEmpty:function(data){if(data!==undefined&&data!=='No Data'&&data!==''){return true;}else{return false;}},trackWindowResize:function(chart){var timeout,delay=500,origWindowWidth=document.documentElement.scrollWidth;$(window).resize(function(){if(timeout){clearTimeout(timeout);}
timeout=setTimeout(function(){var newWindowWidth=document.documentElement.scrollWidth;if(newWindowWidth!==origWindowWidth){chart.update();origWindowWidth=newWindowWidth;}},delay);});},update:function(chart,url,params,callback){var self=this;params=params?params:{};self.chart=chart;this.get(url,params,function(data){if(self.isDataEmpty(data)){self.chart.busy=false;self.chart.updateJSON(data);self.callback(callback);}});},saveImageFile:function(id,chart,json,jsonfilename,imageExt,saveTo,complete){var self=this;var d3ChartId='#d3_'+id+'_print'||'d3_c3090c86-2b12-a65e-967f-51b642ac6165_print';var canvasChartId='canvas_'+id||'canvas_c3090c86-2b12-a65e-967f-51b642ac6165';var svgChartId='svg_'+id||'canvas_c3090c86-2b12-a65e-967f-51b642ac6165';var legendShowState=chart.legend.showAll();chart.legend.showAll(true);var completeCallback=complete||function(){chart.legend.showAll(legendShowState);self.renderChart(id,chart,json);};d3.select(d3ChartId+' svg').remove();d3.select(d3ChartId).append('svg').attr('id',svgChartId).datum(json).call(chart);d3.select(d3ChartId).selectAll('.nv-axis line').style('stroke','#DDD').style('stroke-width',1).style('stroke-opacity',1);var parts=jsonfilename.split('/'),filename=parts[parts.length-1].replace('.js','.'+imageExt),oCanvas=document.getElementById(canvasChartId),d3Container=document.getElementById(svgChartId),serializer=new XMLSerializer(),saveToUrl=saveTo||'index.php?action=DynamicAction&DynamicAction=saveImage&module=Charts&to_pdf=1';if(!oCanvas){return;}
$.ajax({url:'styleguide/assets/css/nvd3_print.css',dataType:'text',success:function(css){var canvgOptions={ignoreMouse:true,ignoreAnimation:false,ignoreClear:true,ignoreDimensions:true,scaleWidth:1440,scaleHeight:960,renderCallback:function(){var uri=oCanvas.toDataURL((imageExt==='jpg'?'image/jpeg':'image/png'));$.post(saveToUrl,{imageStr:uri,filename:filename});var ctx=oCanvas.getContext('2d');ctx.clearRect(0,0,1440,960);completeCallback();}};setTimeout(function(){var svg=serializer.serializeToString(d3Container),svgAttr=' xmlns:xlink="http://www.w3.org/1999/xlink" width="720" height="480" viewBox="0 0 1440 960">',cssCdata='<style type="text/css"><![CDATA['+css.trim()+']]></style>',d3Chart=svg.replace(/><g class="nvd3/,(svgAttr+cssCdata+'<g class="nvd3'));canvg(canvasChartId,d3Chart,canvgOptions);},1000);}});}};})(jQuery);
/* End of File include/SugarCharts/nvd3/js/sugarCharts.js */

(function(){var nv=window.nv||{};nv.version="0.0.1a";nv.dev=false;window.nv=nv;nv.tooltip={};nv.utils={};nv.models={};nv.charts={};nv.graphs=[];nv.logs={};nv.dispatch=d3.dispatch("render_start","render_end");if(nv.dev){nv.dispatch.on("render_start",function(e){nv.logs.startTime=+new Date});nv.dispatch.on("render_end",function(e){nv.logs.endTime=+new Date;nv.logs.totalTime=nv.logs.endTime-nv.logs.startTime;nv.log("total",nv.logs.totalTime)})}nv.log=function(){if(nv.dev&&console.log&&console.log.apply)console.log.apply(console,arguments);else if(nv.dev&&console.log&&Function.prototype.bind){var log=Function.prototype.bind.call(console.log,console);log.apply(console,arguments)}return arguments[arguments.length-1]};nv.render=function render(step){step=step||1;nv.render.active=true;nv.dispatch.render_start();setTimeout(function(){var chart,graph;for(var i=0;i<step&&(graph=nv.render.queue[i]);i++){chart=graph.generate();if(typeof graph.callback==typeof Function)graph.callback(chart);nv.graphs.push(chart)}nv.render.queue.splice(0,i);if(nv.render.queue.length)setTimeout(arguments.callee,0);else{nv.render.active=false;nv.dispatch.render_end()}},0)};nv.render.active=false;nv.render.queue=[];nv.addGraph=function(obj){if(typeof arguments[0]===typeof Function)obj={generate:arguments[0],callback:arguments[1]};nv.render.queue.push(obj);if(!nv.render.active)nv.render()};nv.identity=function(d){return d};nv.strip=function(s){return s.replace(/(\s|&)/g,"")};function daysInMonth(month,year){return new Date(year,month+1,0).getDate()}function d3_time_range(floor,step,number){return function(t0,t1,dt){var time=floor(t0),times=[];if(time<t0)step(time);if(dt>1){while(time<t1){var date=new Date(+time);if(number(date)%dt===0)times.push(date);step(time)}}else{while(time<t1){times.push(new Date(+time));step(time)}}return times}}d3.time.monthEnd=function(date){return new Date(date.getFullYear(),date.getMonth(),0)};d3.time.monthEnds=d3_time_range(d3.time.monthEnd,function(date){date.setUTCDate(date.getUTCDate()+1);date.setDate(daysInMonth(date.getMonth()+1,date.getFullYear()))},function(date){return date.getMonth()});d3.svg.axisStatic=function(){var scale=d3.scale.linear(),orient=d3_svg_axisDefaultOrient,tickMajorSize=6,tickMinorSize=6,tickEndSize=6,tickPadding=3,tickArguments_=[10],tickValues=null,tickFormat_,tickSubdivide=0;var d3_svg_axisDefaultOrient="bottom",d3_svg_axisOrients={top:1,right:1,bottom:1,left:1};function d3_scaleExtent(domain){var start=domain[0],stop=domain[domain.length-1];return start<stop?[start,stop]:[stop,start]}function d3_scaleRange(scale){return scale.rangeExtent?scale.rangeExtent():d3_scaleExtent(scale.range())}function d3_svg_axisX(selection,x){selection.attr("transform",function(d){return"translate("+x(d)+",0)"})}function d3_svg_axisY(selection,y){selection.attr("transform",function(d){return"translate(0,"+y(d)+")"})}function d3_svg_axisSubdivide(scale,ticks,m){subticks=[];if(m&&ticks.length>1){var extent=d3_scaleExtent(scale.domain()),subticks,i=-1,n=ticks.length,d=(ticks[1]-ticks[0])/++m,j,v;while(++i<n){for(j=m;--j>0;){if((v=+ticks[i]-j*d)>=extent[0]){subticks.push(v)}}}for(--i,j=0;++j<m&&(v=+ticks[i]+j*d)<extent[1];){subticks.push(v)}}return subticks}function axis(g){g.each(function(){var g=d3.select(this);var ticks=tickValues==null?scale.ticks?scale.ticks.apply(scale,tickArguments_):scale.domain():tickValues,tickFormat=tickFormat_==null?scale.tickFormat?scale.tickFormat.apply(scale,tickArguments_):String:tickFormat_;var subticks=d3_svg_axisSubdivide(scale,ticks,tickSubdivide),subtick=g.selectAll(".tick.minor").data(subticks,String),subtickEnter=subtick.enter().insert("line",".tick").attr("class","tick minor").style("opacity",1),subtickExit=subtick.exit().remove(),subtickUpdate=subtick.style("opacity",1);var tick=g.selectAll(".tick.major").data(ticks,String),tickEnter=tick.enter().insert("g","path").attr("class","tick major").style("opacity",1),tickExit=tick.exit().remove(),tickUpdate=tick.style("opacity",1),tickTransform;var range=d3_scaleRange(scale),path=g.selectAll(".domain").data([0]),pathUpdate=(path.enter().append("path").attr("class","domain"),path);var scale1=scale.copy();tickEnter.append("line");tickEnter.append("text");var lineEnter=tickEnter.select("line"),lineUpdate=tickUpdate.select("line"),text=tick.select("text").text(tickFormat),textEnter=tickEnter.select("text"),textUpdate=tickUpdate.select("text");switch(orient){case"bottom":{tickTransform=d3_svg_axisX;subtickEnter.attr("y2",tickMinorSize);subtickUpdate.attr("x2",0).attr("y2",tickMinorSize);lineEnter.attr("y2",tickMajorSize);textEnter.attr("y",Math.max(tickMajorSize,0)+tickPadding);lineUpdate.attr("x2",0).attr("y2",tickMajorSize);textUpdate.attr("x",0).attr("y",Math.max(tickMajorSize,0)+tickPadding);text.attr("dy",".71em").style("text-anchor","middle");pathUpdate.attr("d","M"+range[0]+","+tickEndSize+"V0H"+range[1]+"V"+tickEndSize);break}case"top":{tickTransform=d3_svg_axisX;subtickEnter.attr("y2",-tickMinorSize);subtickUpdate.attr("x2",0).attr("y2",-tickMinorSize);lineEnter.attr("y2",-tickMajorSize);textEnter.attr("y",-(Math.max(tickMajorSize,0)+tickPadding));lineUpdate.attr("x2",0).attr("y2",-tickMajorSize);textUpdate.attr("x",0).attr("y",-(Math.max(tickMajorSize,0)+tickPadding));text.attr("dy","0em").style("text-anchor","middle");pathUpdate.attr("d","M"+range[0]+","+-tickEndSize+"V0H"+range[1]+"V"+-tickEndSize);break}case"left":{tickTransform=d3_svg_axisY;subtickEnter.attr("x2",-tickMinorSize);subtickUpdate.attr("x2",-tickMinorSize).attr("y2",0);lineEnter.attr("x2",-tickMajorSize);textEnter.attr("x",-(Math.max(tickMajorSize,0)+tickPadding));lineUpdate.attr("x2",-tickMajorSize).attr("y2",0);textUpdate.attr("x",-(Math.max(tickMajorSize,0)+tickPadding)).attr("y",0);text.attr("dy",".32em").style("text-anchor","end");pathUpdate.attr("d","M"+-tickEndSize+","+range[0]+"H0V"+range[1]+"H"+-tickEndSize);break}case"right":{tickTransform=d3_svg_axisY;subtickEnter.attr("x2",tickMinorSize);subtickUpdate.attr("x2",tickMinorSize).attr("y2",0);lineEnter.attr("x2",tickMajorSize);textEnter.attr("x",Math.max(tickMajorSize,0)+tickPadding);lineUpdate.attr("x2",tickMajorSize).attr("y2",0);textUpdate.attr("x",Math.max(tickMajorSize,0)+tickPadding).attr("y",0);text.attr("dy",".32em").style("text-anchor","start");pathUpdate.attr("d","M"+tickEndSize+","+range[0]+"H0V"+range[1]+"H"+tickEndSize);break}}if(scale.ticks){tickEnter.call(tickTransform,scale1);tickUpdate.call(tickTransform,scale1);tickExit.call(tickTransform,scale1);subtickEnter.call(tickTransform,scale1);subtickUpdate.call(tickTransform,scale1);subtickExit.call(tickTransform,scale1)}else{var dx=scale1.rangeBand()/2,x=function(d){return scale1(d)+dx};tickEnter.call(tickTransform,x);tickUpdate.call(tickTransform,x)}})}axis.scale=function(x){if(!arguments.length)return scale;scale=x;return axis};axis.orient=function(x){if(!arguments.length)return orient;orient=x in d3_svg_axisOrients?x+"":d3_svg_axisDefaultOrient;return axis};axis.ticks=function(){if(!arguments.length)return tickArguments_;tickArguments_=arguments;return axis};axis.tickValues=function(x){if(!arguments.length)return tickValues;tickValues=x;return axis};axis.tickFormat=function(x){if(!arguments.length)return tickFormat_;tickFormat_=x;return axis};axis.tickSize=function(x,y){if(!arguments.length)return tickMajorSize;var n=arguments.length-1;tickMajorSize=+x;tickMinorSize=n>1?+y:tickMajorSize;tickEndSize=n>0?+arguments[n]:tickMajorSize;return axis};axis.tickPadding=function(x){if(!arguments.length)return tickPadding;tickPadding=+x;return axis};axis.tickSubdivide=function(x){if(!arguments.length)return tickSubdivide;tickSubdivide=+x;return axis};return axis};(function(){var nvtooltip=window.nv.tooltip={};nvtooltip.show=function(pos,content,gravity,dist,parentContainer,classes){var container=document.createElement("div"),inner=document.createElement("div"),arrow=document.createElement("div"),body=document.getElementsByTagName("body")[0];gravity=gravity||"s";dist=dist||10;inner.className="tooltip-inner";arrow.className="tooltip-arrow";inner.innerHTML=content;container.style.left=0;container.style.top=-1e3;container.style.opacity=0;container.className="tooltip xy-tooltip in";container.appendChild(inner);container.appendChild(arrow);body.appendChild(container);nvtooltip.position(container,pos,gravity,dist);container.style.opacity=1;return container};nvtooltip.cleanup=function(){var tooltips=document.getElementsByClassName("tooltip"),purging=[],i=0;while(i<tooltips.length){if(tooltips[i].className.indexOf("xy-tooltip")!==-1){purging.push(tooltips[i]);tooltips[i].style.transitionDelay="0 !important";tooltips[i].style.opacity=0;tooltips[i].className="nvtooltip-pending-removal out"}i+=1}setTimeout(function(){var removeMe;while(purging.length){removeMe=purging.pop();removeMe.parentNode.removeChild(removeMe)}},500)};nvtooltip.position=function(container,pos,gravity,dist){var body=document.getElementsByTagName("body")[0];gravity=gravity||"s";dist=dist||10;var height=parseInt(container.offsetHeight,10),width=parseInt(container.offsetWidth,10),windowWidth=nv.utils.windowSize().width,windowHeight=nv.utils.windowSize().height,scrollTop=body.scrollTop,scrollLeft=body.scrollLeft,class_name=container.className.replace(/ top| right| bottom| left/g,""),left,top;function alignCenter(){var left=pos[0]-width/2;if(left<scrollLeft)left=scrollLeft+5;if(left+width>windowWidth)left=windowWidth-width-5;return left}function alignMiddle(){var top=pos[1]-height/2;if(top<scrollTop)top=scrollTop+5;if(top+height>scrollTop+windowHeight)top=scrollTop-height-5;return top}switch(gravity){case"e":top=alignMiddle();left=pos[0]-width-dist;if(left<scrollLeft){left=pos[0]+dist;class_name+=" right"}else{class_name+=" left"}break;case"w":top=alignMiddle();left=pos[0]+dist;if(left+width>windowWidth){left=pos[0]-width-dist;class_name+=" left"}else{class_name+=" right"}break;case"n":left=alignCenter();top=pos[1]+dist;if(top+height>scrollTop+windowHeight){top=pos[1]-height-dist;class_name+=" top"}else{class_name+=" bottom"}break;case"s":left=alignCenter();top=pos[1]-height-dist;if(scrollTop>top){top=pos[1]+10;class_name+=" bottom"}else{class_name+=" top"}break}container.style.left=left+"px";container.style.top=top+"px";container.className=class_name}})();nv.utils.windowSize=function(){var size={width:640,height:480};if(document.body&&document.body.offsetWidth){size.width=document.body.offsetWidth;size.height=document.body.offsetHeight}if(document.compatMode==="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth){size.width=document.documentElement.offsetWidth;size.height=document.documentElement.offsetHeight}if(window.innerWidth&&window.innerHeight){size.width=window.innerWidth;size.height=window.innerHeight}return size};nv.utils.windowResize=function(fun){if(window.attachEvent){window.attachEvent("onresize",fun)}else if(window.addEventListener){window.addEventListener("resize",fun,true)}else{}};nv.utils.windowUnResize=function(fun){if(window.detachEvent){window.detachEvent("onresize",fun)}else if(window.removeEventListener){window.removeEventListener("resize",fun,true)}else{}};nv.utils.resizeOnPrint=function(fn){if(window.matchMedia){var mediaQueryList=window.matchMedia("print");mediaQueryList.addListener(function(mql){if(mql.matches){fn()}})}else if(window.attachEvent){window.attachEvent("onbeforeprint",fn)}else{window.onbeforeprint=fn}};nv.utils.unResizeOnPrint=function(fn){if(window.matchMedia){var mediaQueryList=window.matchMedia("print");mediaQueryList.removeListener(function(mql){if(mql.matches){fn()}})}else if(window.detachEvent){window.detachEvent("onbeforeprint",fn)}else{window.onbeforeprint=null}};nv.utils.getColor=function(color){if(!arguments.length){return nv.utils.defaultColor()}if(Object.prototype.toString.call(color)==="[object Array]"){return function(d,i){return d.color||color[i%color.length]}}else{return color}};nv.utils.defaultColor=function(){var colors=d3.scale.category20().range();return function(d,i){return d.color||colors[i%colors.length]}};nv.utils.customTheme=function(dictionary,getKey,defaultColors){getKey=getKey||function(series){return series.key};defaultColors=defaultColors||d3.scale.category20().range();var defIndex=defaultColors.length;return function(series,index){var key=getKey(series);if(!defIndex)defIndex=defaultColors.length;if(typeof dictionary[key]!=="undefined"){return typeof dictionary[key]==="function"?dictionary[key]():dictionary[key]}else{return defaultColors[--defIndex]}}};nv.utils.pjax=function(links,content){d3.selectAll(links).on("click",function(){history.pushState(this.href,this.textContent,this.href);load(this.href);d3.event.preventDefault()});function load(href){d3.html(href,function(fragment){var target=d3.select(content).node();target.parentNode.replaceChild(d3.select(fragment).select(content).node(),target);nv.utils.pjax(links,content)})}d3.select(window).on("popstate",function(){if(d3.event.state){load(d3.event.state)}})};nv.utils.colorLinearGradient=function(d,i,p,c,defs){var id="lg_gradient_"+i,grad=defs.select("#"+id);if(grad.empty()){if(p.position==="middle"){nv.utils.createLinearGradient(id,p,defs,[{offset:"0%","stop-color":d3.rgb(c).darker().toString(),"stop-opacity":1},{offset:"20%","stop-color":d3.rgb(c).toString(),"stop-opacity":1},{offset:"50%","stop-color":d3.rgb(c).brighter().toString(),"stop-opacity":1},{offset:"80%","stop-color":d3.rgb(c).toString(),"stop-opacity":1},{offset:"100%","stop-color":d3.rgb(c).darker().toString(),"stop-opacity":1}])}else{nv.utils.createLinearGradient(id,p,defs,[{offset:"0%","stop-color":d3.rgb(c).darker().toString(),"stop-opacity":1},{offset:"50%","stop-color":d3.rgb(c).toString(),"stop-opacity":1},{offset:"100%","stop-color":d3.rgb(c).brighter().toString(),"stop-opacity":1}])}}return"url(#"+id+")"};nv.utils.createLinearGradient=function(id,params,defs,stops){var x2=params.orientation==="horizontal"?"0%":"100%",y2=params.orientation==="horizontal"?"100%":"0%",grad=defs.append("linearGradient").attr("id",id).attr("x1","0%").attr("y1","0%").attr("x2",x2).attr("y2",y2).attr("spreadMethod","pad");for(var i=0;i<stops.length;i+=1){var attrs=stops[i],stop=grad.append("stop");for(var a in attrs){if(attrs.hasOwnProperty(a)){stop.attr(a,attrs[a])}}}};nv.utils.colorRadialGradient=function(d,i,p,c,defs){var id="rg_gradient_"+i,grad=defs.select("#"+id);if(grad.empty()){nv.utils.createRadialGradient(id,p,defs,[{offset:p.s,"stop-color":d3.rgb(c).brighter().toString(),"stop-opacity":1},{offset:"100%","stop-color":d3.rgb(c).darker().toString(),"stop-opacity":1}])}return"url(#"+id+")"};nv.utils.createRadialGradient=function(id,params,defs,stops){var grad=defs.append("radialGradient").attr("id",id).attr("r",params.r).attr("cx",params.x).attr("cy",params.y).attr("gradientUnits",params.u).attr("spreadMethod","pad");for(var i=0;i<stops.length;i+=1){var attrs=stops[i],stop=grad.append("stop");for(var a in attrs){if(attrs.hasOwnProperty(a)){stop.attr(a,attrs[a])}}}};nv.utils.getAbsoluteXY=function(element){var viewportElement=document.documentElement,box=element.getBoundingClientRect(),scrollLeft=viewportElement.scrollLeft+document.body.scrollLeft,scrollTop=viewportElement.scrollTop+document.body.scrollTop,x=box.left+scrollLeft,y=box.top+scrollTop;return{left:x,top:y}};nv.utils.roundedRectangle=function(x,y,width,height,radius){return"M"+x+","+y+"h"+(width-radius*2)+"a"+radius+","+radius+" 0 0 1 "+radius+","+radius+"v"+(height-2-radius*2)+"a"+radius+","+radius+" 0 0 1 "+-radius+","+radius+"h"+(radius*2-width)+"a"+-radius+","+radius+" 0 0 1 "+-radius+","+-radius+"v"+(-height+radius*2+2)+"a"+radius+","+radius+" 0 0 1 "+radius+","+-radius+"z"};nv.utils.dropShadow=function(id,defs,options){var opt=options||{},h=opt.height||"130%",o=opt.offset||2,b=opt.blur||1;var filter=defs.append("filter").attr("id",id).attr("height",h);var offset=filter.append("feOffset").attr("in","SourceGraphic").attr("result","offsetBlur").attr("dx",o).attr("dy",o);var color=filter.append("feColorMatrix").attr("in","offsetBlur").attr("result","matrixOut").attr("type","matrix").attr("values","1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 1 0");var blur=filter.append("feGaussianBlur").attr("in","matrixOut").attr("result","blurOut").attr("stdDeviation",b);var merge=filter.append("feMerge");merge.append("feMergeNode");merge.append("feMergeNode").attr("in","SourceGraphic");return"url(#"+id+")"};nv.utils.stringSetLengths=function(_data,_container,_format){var lengths=[];_container.append("g").attr("class","tmp-text-strings");var calcContainers=_container.select(".tmp-text-strings").selectAll("text").data(_data).enter().append("text").text(_format);calcContainers.each(function(d,i){lengths.push(this.getBoundingClientRect().width)});_container.select(".tmp-text-strings").remove();return lengths};nv.utils.maxStringSetLength=function(_data,_container,_format){var maxLength=0;_container.append("g").attr("class","tmp-text-strings");var calcContainers=_container.select(".tmp-text-strings").selectAll("text").data(_data).enter().append("text").text(_format);calcContainers.each(function(d,i){maxLength=Math.max(this.getBoundingClientRect().width,maxLength)});_container.select(".tmp-text-strings").remove();return maxLength};nv.utils.getTextContrast=function(c,i,callback){var back=c,backLab=d3.lab(back),backLumen=backLab.l,textLumen=backLumen>50?backLab.darker(4+(backLumen-75)/25).l:backLab.brighter(4+(25-backLumen)/25).l,textLab=d3.lab(textLumen,0,0),text=textLab.toString();if(callback){callback(backLab,textLab)}return text};nv.utils.isRTLChar=function(c){var rtlChars_="---",rtlCharReg_=new RegExp("["+rtlChars_+"]");return rtlCharReg_.test(c)};nv.utils.polarToCartesian=function(centerX,centerY,radius,angleInDegrees){var angleInRadians=angleInDegrees*Math.PI/180;var x=centerX+radius*Math.cos(angleInRadians);var y=centerY+radius*Math.sin(angleInRadians);return[x,y]};nv.models.axis=function(){var axis=d3.svg.axisStatic();var margin={top:0,right:0,bottom:0,left:0},thickness=0,scale=d3.scale.linear(),axisLabelText=null,showMaxMin=true,highlightZero=true,direction="ltr",wrapTicks=false,staggerTicks=false,rotateTicks=0,reduceXTicks=false,rotateYLabel=true,isOrdinal=false,textAnchor=null,ticks=null,axisLabelDistance=8;axis.scale(scale).orient("bottom").tickFormat(function(d){return d});var scale0;function chart(selection){selection.each(function(data){var container=d3.select(this);var wrap=container.selectAll("g.nv-wrap.nv-axis").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-axis").append("g").attr("class","nv-axis-inner"),g=wrap.select(".nv-axis-inner");var orientation=axis.orient()==="left"||axis.orient()==="right"?"vertical":"horizontal",labelThickness=null,textAnchorString="";var fmt=axis.tickFormat(),w=typeof scale.rangeExtent==="function"?scale.rangeExtent()[1]:Math.abs(scale.range()[0]-scale.range()[1]),label={y:0,dy:0,x:0,a:"middle",t:""},maxmin={};if(ticks!==null){axis.ticks(ticks)}else if(axis.orient()==="top"||axis.orient()==="bottom"){axis.ticks(Math.ceil(Math.abs(scale.range()[1]-scale.range()[0])/100))}if(rotateTicks&&!isFinite(String(rotateTicks))){rotateTicks=30}var myTicks=g.selectAll(".tick").data(data,function(d){return d});myTicks.exit().remove();g.call(axis);scale0=scale0||axis.scale();if(fmt===null){fmt=scale0.tickFormat()}thickness=defaultThickness();var tickText=g.selectAll("g.tick").select("text");var tickValueArray=tickText[0].map(function(d,i,j){return d3.select(d).text()});var maxTickWidth=0,maxTickHeight=0;calculateMax();function calculateMax(){var maxW=0,maxH=0;tickText.each(function(d,i){var bbox=this.getBoundingClientRect(),w=parseInt(bbox.width,10),h=parseInt(bbox.height/1.15,10);if(w>maxW){maxW=w}if(h>maxH){maxH=h}});maxTickWidth=maxW;maxTickHeight=maxH}function labelCollision(s){if(axis.scale().rangeBand){return axis.scale().rangeBand()*s<maxTickWidth}else{return false}}function tickRotation(a){var tickAnchor=direction==="rtl"?a%360>0?"end":"start":a%360>0?"start":"end",sin=Math.abs(Math.sin(a*Math.PI/180));thickness=defaultThickness()+2;thickness+=sin?sin*maxTickWidth:maxTickWidth;thickness+=sin?sin*maxTickHeight:0;tickText.attr("transform",function(d,i,j){return"translate(0,"+axis.tickPadding()+") rotate("+a+")"}).attr("y","0").style("text-anchor",tickAnchor)}function resetTicks(){tickText.selectAll("tspan").remove();tickText.attr("dy",".71em").attr("y",axis.tickPadding()).attr("transform","translate(0,0)").text(function(d,i){return tickValueArray[i]});calculateMax()}function defaultThickness(){return axis.tickPadding()+(!!axisLabelText?axisLabelDistance:0)}switch(axis.orient()){case"top":if(axisLabelText){label.y=-thickness;label.dy="-.71em";label.x=w/2}if(showMaxMin){maxmin={data:scale.domain(),translate:function(d,i){return"translate("+scale(d)+",0)"},dy:"0em",x:0,y:-axis.tickPadding(),transform:"",anchor:rotateTicks?rotateTicks%360>0?"start":"end":"middle"}}break;case"bottom":var wrapSucceeded=false,staggerSucceeded=false,rotateSucceeded=false;if(wrapTicks&&labelCollision(1.25)){tickText.each(function(d){var textContent=this.textContent,textNode=d3.select(this),textArray=textContent.replace("/","/ ").split(" "),i=0,l=textArray.length,dy=.71,maxWidth=axis.scale().rangeBand();if(this.getBoundingClientRect().width>maxWidth){this.textContent="";do{var textString,textSpan=textNode.append("tspan").text(textArray[i]+" ").attr("dy",dy+"em").attr("x",0+"px");if(i===0){dy=1}i+=1;while(i<l){textString=textSpan.text();textSpan.text(textString+" "+textArray[i]);if(this.getBoundingClientRect().width<=maxWidth){i+=1}else{textSpan.text(textString);break}}}while(i<l)}});calculateMax();if(labelCollision(1.25)){resetTicks()}else{wrapSucceeded=true;thickness=1}}if(!wrapSucceeded&&staggerTicks&&labelCollision(1.25)){tickText.text(function(d,i){return tickValueArray[i]});calculateMax();tickText.attr("transform",function(d,i){return"translate(0,"+i%2*(maxTickHeight+2)+")"});if(labelCollision(2.5)){resetTicks()}else{staggerSucceeded=true;thickness=maxTickHeight+2}}if(!wrapSucceeded&&!staggerSucceeded&&rotateTicks%360&&labelCollision(1.25)){tickRotation(rotateTicks);rotateSucceeded=true}else{textAnchorString="middle";thickness+=defaultThickness()+maxTickHeight}if(axisLabelText){label.y=thickness;label.dy=".71em";label.x=w/2}if(reduceXTicks){g.selectAll(".tick").each(function(d,i){d3.select(this).selectAll("text,line").style("opacity",i%Math.ceil(data[0].values.length/(w/100))!==0?0:1)})}if(showMaxMin){maxmin={data:[scale.domain()[0],scale.domain()[scale.domain().length-1]],translate:function(d,i){return"translate("+(scale(d)+(isOrdinal?scale.rangeBand()/2:d>0?-8:+4))+",0)"},dy:".71em",x:0,y:axis.tickPadding(),rotate:function(d){return"rotate("+rotateTicks+" 0,0)"},anchor:rotateTicks?rotateTicks%360>0?"start":"end":"middle"}}break;case"right":thickness+=maxTickWidth;if(axisLabelText){label={y:rotateYLabel?-(thickness+2):-10,dy:0,x:rotateYLabel?w/2:axis.tickPadding(),a:rotateYLabel?"middle":"begin",t:rotateYLabel?"rotate(90)":""}}if(showMaxMin){maxmin={data:scale.domain(),translate:function(d,i){return"translate(0,"+scale(d)+")"},dy:".32em",x:axis.tickPadding(),y:0,rotate:"",anchor:direction==="rtl"?"end":"start"}}if(textAnchor){if(direction==="rtl"){if(textAnchor==="start"){textAnchorString="end"}else if(textAnchor==="end"){textAnchorString="start"}else{textAnchorString=textAnchor}}else{textAnchorString=textAnchor}}else{textAnchorString=direction==="rtl"?"end":"start"}break;case"left":thickness+=maxTickWidth+2;if(axisLabelText){label={y:rotateYLabel?-(thickness+2):-10,dy:0,x:rotateYLabel?-w/2:-axis.tickPadding(),a:rotateYLabel?"middle":"end",t:rotateYLabel?"rotate(-90)":""}}if(showMaxMin){maxmin={data:scale.domain(),translate:function(d,i){return"translate(0,"+scale(d)+")"},dy:".32em",x:-axis.tickPadding(),y:0,rotate:"",anchor:direction==="rtl"?"start":"end"}}if(textAnchor){if(direction==="rtl"){if(textAnchor==="start"){textAnchorString="end"}else if(textAnchor==="end"){textAnchorString="start"}else{textAnchorString=textAnchor}}else{textAnchorString=textAnchor}}else{textAnchorString=direction==="rtl"?"start":"end"}break}var axisLabel=g.selectAll("text.nv-axislabel").data([axisLabelText]);if(textAnchorString!==""){g.selectAll("g.tick").each(function(d,i){d3.select(this).select("text").style("text-anchor",textAnchorString)})}axisLabel.exit().remove();axisLabel.enter().append("text").attr("class","nv-axislabel");if(axisLabelText){axisLabel.text(function(d){return d}).attr("y",label.y).attr("dy",label.dy).attr("x",label.x).attr("transform",label.t).style("text-anchor",label.a);axisLabel.each(function(d,i){labelThickness+=axis.orient()==="left"||axis.orient()==="right"?parseInt(this.getBoundingClientRect().width/1.15,10):parseInt(this.getBoundingClientRect().height/1.15,10)});thickness+=labelThickness}if(showMaxMin){var axisMaxMin=wrap.selectAll("g.nv-axisMaxMin").data(maxmin.data);axisMaxMin.enter().append("g").attr("class","nv-axisMaxMin").append("text").style("opacity",0);axisMaxMin.exit().remove();axisMaxMin.attr("transform",maxmin.translate).select("text").text(function(d,i){var v=fmt(d);return(""+v).match("NaN")?"":v}).attr("dy",maxmin.dy).attr("x",maxmin.x).attr("y",maxmin.y).attr("transform",maxmin.rotate).style("text-anchor",maxmin.anchor);axisMaxMin.attr("transform",maxmin.translate).select("text").style("opacity",1)}if(showMaxMin&&(axis.orient()==="left"||axis.orient()==="right")){g.selectAll("g.tick").each(function(d,i){d3.select(this).select("text").style("opacity",1);if(scale(d)>scale.range()[0]-10||scale(d)<scale.range()[1]+10){if(d<1e-10&&d>-1e-10){d3.select(this).select("text").style("opacity",0);d3.select(this).select("line").style("opacity",0)}d3.select(this).select("text").style("opacity",0)}});if(scale.domain()[0]===scale.domain()[1]&&scale.domain()[0]===0){wrap.selectAll("g.nv-axisMaxMin").style("opacity",function(d,i){return!i?1:0})}}if(showMaxMin&&(axis.orient()==="top"||axis.orient()==="bottom")){var maxMinRange=[];wrap.selectAll("g.nv-axisMaxMin").each(function(d,i){try{if(i){maxMinRange.push(scale(d)-this.getBoundingClientRect().width-4)}else{maxMinRange.push(scale(d)+this.getBoundingClientRect().width+4)}}catch(err){if(i){maxMinRange.push(scale(d)-4)}else{maxMinRange.push(scale(d)+4)}}});g.selectAll("g.tick").each(function(d,i){d3.select(this).select("text").style("opacity",1);if(scale(d)<maxMinRange[0]||scale(d)>maxMinRange[1]){if(d<1e-10&&d>-1e-10){d3.select(this).select("text").style("opacity",0);d3.select(this).select("line").style("opacity",0)}d3.select(this).select("text").style("opacity",0)}})}if(highlightZero){g.selectAll("line.tick").filter(function(d){return!parseFloat(Math.round(d*1e5)/1e6)}).classed("zero",true)}scale0=scale.copy();chart.labelThickness=function(){return labelThickness}});return chart}chart.axis=axis;d3.rebind(chart,axis,"orient","tickValues","tickSubdivide","tickSize","tickPadding","tickFormat");d3.rebind(chart,scale,"domain","range","rangeBand","rangeBands");chart.margin=function(_){if(!arguments.length){return margin}for(var prop in _){if(_.hasOwnProperty(prop)){margin[prop]=_[prop]}}return chart};chart.width=function(_){if(!arguments.length){return thickness}thickness=_;return chart};chart.height=function(_){if(!arguments.length){return thickness}thickness=_;return chart};chart.ticks=function(_){if(!arguments.length){return ticks}ticks=_;return chart};chart.axisLabel=function(_){if(!arguments.length){return axisLabelText}axisLabelText=_;return chart};chart.showMaxMin=function(_){if(!arguments.length){return showMaxMin}showMaxMin=_;return chart};chart.highlightZero=function(_){if(!arguments.length){return highlightZero}highlightZero=_;return chart};chart.scale=function(_){if(!arguments.length){return scale}scale=_;axis.scale(scale);isOrdinal=typeof scale.rangeBands==="function";d3.rebind(chart,scale,"domain","range","rangeBand","rangeBands");return chart};chart.wrapTicks=function(_){if(!arguments.length){return wrapTicks}wrapTicks=_;return chart};chart.rotateTicks=function(_){if(!arguments.length){return rotateTicks}rotateTicks=_;return chart};chart.staggerTicks=function(_){if(!arguments.length){return staggerTicks}staggerTicks=_;return chart};chart.reduceXTicks=function(_){if(!arguments.length){return reduceXTicks}reduceXTicks=_;return chart};chart.rotateYLabel=function(_){if(!arguments.length){return rotateYLabel}rotateYLabel=_;return chart};chart.axisLabelDistance=function(_){if(!arguments.length){return axisLabelDistance}axisLabelDistance=_;return chart};chart.maxTickWidth=function(_){if(!arguments.length){return maxTickWidth}maxTickWidth=_;return chart};chart.textAnchor=function(_){if(!arguments.length){return textAnchor}textAnchor=_;return chart};chart.direction=function(_){if(!arguments.length){return direction}direction=_;return chart};return chart};nv.models.legend=function(){var margin={top:0,right:0,bottom:0,left:0},width=0,height=0,align="right",direction="ltr",position="start",radius=5,gutter=10,equalColumns=true,showAll=false,collapsed=false,rowsCount=3,enabled=false,strings={close:"Hide legend",type:"Show legend"},id=Math.floor(Math.random()*1e4),getKey=function(d){return d.key.length>0||!isNaN(parseFloat(d.key))&&isFinite(d.key)?d.key:"undefined"},color=function(d,i){return nv.utils.defaultColor()(d,i)},classes=function(d,i){return""},dispatch=d3.dispatch("legendClick","legendMouseover","legendMouseout","toggleMenu","closeMenu");var legendOpen=0;function legend(selection){selection.each(function(data){var container=d3.select(this),containerWidth=width,containerHeight=height,keyWidths=[],legendHeight=0,dropdownHeight=0,type="";if(!data||!data.length||!data.filter(function(d){return!d.values||d.values.length}).length){return legend}enabled=true;type=!data[0].type||data[0].type==="bar"?"bar":"line";if(direction==="rtl"){if(align==="left"){align="right"}else if(align==="right"){align="left"}}var wrap=container.selectAll("g.nv-chart-legend").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nv-chart-legend");wrapEnter.append("defs").append("clipPath").attr("id","nv-edge-clip-"+id).append("rect");var defs=wrap.select("defs");var clip=wrap.select("#nv-edge-clip-"+id+" rect");wrapEnter.append("rect").attr("class","nv-legend-background");var back=container.select(".nv-legend-background");wrapEnter.append("text").attr("class","nv-legend-link");var link=container.select(".nv-legend-link");wrapEnter.append("g").attr("class","nv-legend-mask").append("g").attr("class","nv-legend");var mask=container.select(".nv-legend-mask");var g=container.select("g.nv-legend");g.attr("transform","translate(0,0)");var series=g.selectAll(".nv-series").data(function(d){return d},function(d){return d.key});var seriesEnter=series.enter().append("g").attr("class","nv-series");series.exit().remove();var zoom=d3.behavior.zoom();function zoomLegend(d){var trans=d3.transform(g.attr("transform")).translate,transX=trans[0],transY=trans[1]+d3.event.sourceEvent.wheelDelta/4,diffY=dropdownHeight-legendHeight,upMax=Math.max(transY,diffY);if(upMax){g.attr("transform","translate("+transX+","+Math.min(upMax,0)+")")}}clip.attr("x",.5).attr("y",.5).attr("width",0).attr("height",0);back.attr("x",.5).attr("y",.5).attr("width",0).attr("height",0).style("opacity",0).style("pointer-events","all");link.text(legendOpen===1?legend.strings().close:legend.strings().open).attr("text-anchor",align==="left"?direction==="rtl"?"end":"start":direction==="rtl"?"start":"end").attr("dy",".32em").attr("dx",0).style("opacity",0).on("click",function(d,i){dispatch.toggleMenu(d,i)});seriesEnter.on("mouseover",function(d,i){dispatch.legendMouseover(d,i)}).on("mouseout",function(d,i){dispatch.legendMouseout(d,i)}).on("click",function(d,i){dispatch.legendClick(d,i);d3.event.stopPropagation()});if(type==="bar"){seriesEnter.append("circle").attr("r",radius).style("stroke-width",2);series.selectAll("circle").attr("class",function(d,i){return classes(d,d.hasOwnProperty("series")?d.series:i)}).attr("fill",function(d,i){return color(d,d.hasOwnProperty("series")?d.series:i)}).attr("stroke",function(d,i){
return color(d,d.hasOwnProperty("series")?d.series:i)});seriesEnter.append("text").attr("dy",".36em");series.select("text").text(getKey)}else{seriesEnter.append("circle").style("stroke-width",0);seriesEnter.append("line").attr("x0",0).attr("y0",0).attr("y1",0).style("stroke-width","4px");seriesEnter.append("circle").style("stroke-width",0);series.select("line").attr("class",function(d,i){return classes(d,d.hasOwnProperty("series")?d.series:i)}).attr("stroke",function(d,i){return color(d,d.hasOwnProperty("series")?d.series:i)});series.selectAll("circle").attr("r",function(d,i){return d.type==="dash"?0:radius}).attr("class",function(d,i){return classes(d,d.hasOwnProperty("series")?d.series:i)}).attr("fill",function(d,i){return color(d,d.hasOwnProperty("series")?d.series:i)});seriesEnter.append("text").attr("dy",".32em").attr("dx",0);series.select("text").text(getKey).attr("text-anchor",position)}series.classed("disabled",function(d){return d.disabled});legend.calculateWidth=function(){var padding=gutter+(position==="start"?2*radius+3:0);keyWidths=[];g.style("display","inline");series.select("text").each(function(d,i){var textWidth=d3.select(this).node().getBoundingClientRect().width;keyWidths.push(Math.max(Math.floor(textWidth)+padding,50))});legend.width(d3.sum(keyWidths)-gutter);return legend.width()};legend.getLineHeight=function(){g.style("display","inline");var lineHeightBB=Math.floor(series.select("text").node().getBoundingClientRect().height);return lineHeightBB};legend.arrange=function(containerWidth){if(keyWidths.length===0){this.calculateWidth()}var keys=keyWidths.length,rows=1,cols=keys,columnWidths=[],keyPositions=[],maxWidth=containerWidth-margin.left-margin.right,maxRowWidth=0,minRowWidth=0,lineSpacing=position==="start"?10:6,textHeight=this.getLineHeight(),lineHeight=lineSpacing+radius*2+(position==="start"?0:textHeight),xpos=0,ypos=0,i,mod,shift,padding=radius+radius*2;if(equalColumns){while(cols>0){columnWidths=[];for(i=0;i<keys;i+=1){if(keyWidths[i]>(columnWidths[i%cols]||0)){columnWidths[i%cols]=keyWidths[i]}}if(d3.sum(columnWidths)-gutter<maxWidth){break}cols-=1}cols=cols||1;rows=Math.ceil(keys/cols);maxRowWidth=d3.sum(columnWidths)-gutter;for(i=0;i<keys;i+=1){mod=i%cols;if(position==="start"){if(mod===0){xpos=direction==="rtl"?maxRowWidth:0}else{xpos+=columnWidths[mod-1]*(direction==="rtl"?-1:1)}}else{if(mod===0){xpos=(direction==="rtl"?maxRowWidth:0)+(columnWidths[mod]-gutter)/2*(direction==="rtl"?-1:1)}else{xpos+=(columnWidths[mod-1]+columnWidths[mod])/2*(direction==="rtl"?-1:1)}}ypos=Math.floor(i/cols)*lineHeight;keyPositions[i]={x:xpos,y:ypos}}}else{if(direction==="rtl"){xpos=maxWidth;for(i=0;i<keys;i+=1){if(xpos-keyWidths[i]+gutter<0){maxRowWidth=Math.max(maxRowWidth,keyWidths[i]-gutter);xpos=maxWidth;if(i){rows+=1}}if(xpos-keyWidths[i]+gutter>maxRowWidth){maxRowWidth=xpos-keyWidths[i]+gutter}keyPositions[i]={x:xpos,y:(rows-1)*(lineSpacing+radius*2)};xpos-=keyWidths[i]}}else{xpos=0;for(i=0;i<keys;i+=1){if(i&&xpos+keyWidths[i]-gutter>maxWidth){xpos=0;rows+=1}if(xpos+keyWidths[i]-gutter>maxRowWidth){maxRowWidth=xpos+keyWidths[i]-gutter}keyPositions[i]={x:xpos,y:(rows-1)*(lineSpacing+radius*2)};xpos+=keyWidths[i]}}}if(showAll||rows<rowsCount+1){legendOpen=0;collapsed=false;legend.width(margin.left+maxRowWidth+margin.right).height(margin.top+rows*lineHeight-lineSpacing+margin.bottom+1);switch(align){case"left":shift=0;break;case"center":shift=(containerWidth-legend.width())/2;break;case"right":shift=0;break}zoom.on("zoom",null);clip.attr("y",0).attr("width",legend.width()).attr("height",legend.height());back.attr("x",shift).attr("width",legend.width()).attr("height",legend.height()).attr("rx",0).attr("ry",0).attr("filter","none").style("display","inline").style("opacity",0);mask.attr("clip-path","none").attr("transform",function(d,i){var xpos=shift+margin.left+(position==="start"?direction==="rtl"?-5:5:0);return"translate("+xpos+","+(1+margin.top+radius)+")"});g.style("opacity",1).style("display","inline");series.attr("transform",function(d,i){var pos=keyPositions[i];return"translate("+pos.x+","+pos.y+")"});series.selectAll("text").attr("text-anchor",position).attr("transform",function(d,i){var xpos=position==="start"?direction==="rtl"?-8:8:0,ypos=position==="start"?0:textHeight;return"translate("+xpos+","+ypos+")"});series.selectAll("circle").attr("transform",function(d,i){var xpos=position==="start"||type==="bar"?0:i?15:-15;return"translate("+xpos+",0)"});series.selectAll("line").attr("x1",function(d,i){return d.type==="dash"?40:30}).attr("transform",function(d,i){return d.type==="dash"?"translate(-20,0)":"translate(-15,0)"}).style("stroke-dasharray",function(d,i){return d.type==="dash"?"8, 8":"0,0"})}else{collapsed=true;legend.width(radius*2+d3.max(keyWidths)-gutter+(position==="start"?0:radius*2+3)+radius*2).height(radius*2+radius*2+radius*2);legendHeight=radius*2+radius*2*keys+(keys-1)*10+radius*2;dropdownHeight=Math.min(containerHeight-legend.height(),legendHeight);zoom.on("zoom",zoomLegend);clip.attr("x",.5-padding).attr("y",.5-padding).attr("width",legend.width()).attr("height",dropdownHeight);back.attr("x",.5).attr("y",.5+legend.height()).attr("width",legend.width()).attr("height",dropdownHeight).attr("rx",2).attr("ry",2).attr("filter",nv.utils.dropShadow("legend_back_"+id,defs,{blur:2})).style("opacity",legendOpen*.9).style("display",legendOpen?"inline":"none").call(zoom);link.attr("transform",function(d,i){var xpos=align==="left"?.5:.5+legend.width(),ypos=margin.top+radius;return"translate("+xpos+","+ypos+")"}).style("opacity",1);mask.attr("clip-path","url(#nv-edge-clip-"+id+")").attr("transform",function(d,i){var xpos=padding,ypos=.5+legend.height()+margin.top+radius;return"translate("+xpos+","+ypos+")"});g.style("opacity",legendOpen).style("display",legendOpen?"inline":"none").attr("transform",function(d,i){var xpos=direction==="rtl"?legend.width()-padding*2:0;return"translate("+xpos+",0)"}).call(zoom);series.attr("transform",function(d,i){return"translate(0,"+i*(10+radius*2)+")"});series.selectAll("circle").attr("transform","");series.selectAll("line").attr("x1",16).attr("transform","translate(-8,0)").style("stroke-dasharray","inherit");series.selectAll("text").attr("text-anchor","start").attr("transform",function(d,i){var xpos=direction==="rtl"?-8:8;return"translate("+xpos+",0)"})}};function displayMenu(){back.style("opacity",legendOpen*.9).style("display",legendOpen?"inline":"none");g.style("opacity",legendOpen).style("display",legendOpen?"inline":"none");link.text(legendOpen===1?legend.strings().close:legend.strings().open)}dispatch.on("toggleMenu",function(d){d3.event.stopPropagation();legendOpen=1-legendOpen;displayMenu()});dispatch.on("closeMenu",function(d){if(legendOpen===1){legendOpen=0;displayMenu()}})});return legend}legend.dispatch=dispatch;legend.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!=="undefined"?_.top:margin.top;margin.right=typeof _.right!=="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!=="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!=="undefined"?_.left:margin.left;return legend};legend.width=function(_){if(!arguments.length){return width}width=Math.round(_);return legend};legend.height=function(_){if(!arguments.length){return height}height=Math.round(_);return legend};legend.id=function(_){if(!arguments.length){return id}id=_;return legend};legend.key=function(_){if(!arguments.length){return getKey}getKey=_;return legend};legend.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return legend};legend.classes=function(_){if(!arguments.length){return classes}classes=_;return legend};legend.align=function(_){if(!arguments.length){return align}align=_;return legend};legend.position=function(_){if(!arguments.length){return position}position=_;return legend};legend.showAll=function(_){if(!arguments.length){return showAll}showAll=_;return legend};legend.collapsed=function(_){return collapsed};legend.rowsCount=function(_){if(!arguments.length){return rowsCount}rowsCount=_;return legend};legend.lineSpacing=function(_){if(!arguments.length){return lineSpacing}lineSpacing=_;return legend};legend.strings=function(_){if(!arguments.length){return strings}strings=_;return legend};legend.equalColumns=function(_){if(!arguments.length){return equalColumns}equalColumns=_;return legend};legend.enabled=function(_){if(!arguments.length){return enabled}enabled=_;return legend};legend.direction=function(_){if(!arguments.length){return direction}direction=_;return legend};return legend};nv.models.scroll=function(){var id,margin={},vertical,width,height,minDimension,panHandler,overflowHandler,enable;function scroll(g,gEnter,scrollWrap,xAxis){var defs=g.select("defs"),defsEnter=gEnter.select("defs"),scrollMask,scrollTarget,xAxisWrap=scrollWrap.select(".nv-x.nv-axis"),barsWrap=scrollWrap.select(".nv-barsWrap"),backShadows,foreShadows;var scrollOffset=0;scroll.init=function(offset,overflow){scrollOffset=offset;overflowHandler=overflow;this.gradients(enable);this.mask(enable);this.scrollTarget(enable);this.backShadows(enable);this.foreShadows(enable);this.assignEvents(enable);this.resize(enable)};scroll.pan=function(diff){var distance=0,overflowDistance=0,translate="",x=0,y=0;if(d3.event){if(d3.event.type==="zoom"){x=d3.event.sourceEvent.deltaX||0;y=d3.event.sourceEvent.deltaY||0;distance=(Math.abs(x)>Math.abs(y)?x:y)*-1}else if(d3.event.type==="drag"){x=d3.event.dx||0;y=d3.event.dy||0;distance=vertical?x:y}else if(d3.event.type!=="click"){return 0}overflowDistance=Math.abs(y)>Math.abs(x)?y:0}scrollOffset=Math.min(Math.max(scrollOffset+distance,diff),-1);translate="translate("+(vertical?scrollOffset+",0":"0,"+scrollOffset)+")";if(scrollOffset+distance>0||scrollOffset+distance<diff){overflowHandler(overflowDistance)}foreShadows.attr("transform",translate);barsWrap.attr("transform",translate);xAxisWrap.select(".nv-wrap.nv-axis").attr("transform",translate);return scrollOffset};scroll.assignEvents=function(enable){var pan=enable?panHandler:null;var zoom=d3.behavior.zoom().on("zoom",pan);var drag=d3.behavior.drag().origin(function(d){return d}).on("drag",pan);scrollWrap.call(zoom);scrollTarget.call(zoom);scrollWrap.call(drag);scrollTarget.call(drag)};scroll.resize=function(enable){if(!enable){return}var labelOffset=xAxis.labelThickness()+xAxis.tickPadding()/2,v=vertical,x=v?margin.left:labelOffset,y=margin.top,scrollWidth=width+(v?0:margin[xAxis.orient()]-labelOffset),scrollHeight=height+(v?margin[xAxis.orient()]-labelOffset:0),dim=v?"height":"width",val=v?scrollHeight:scrollWidth;scrollMask.attr("x",v?0:-margin.left).attr("y",0).attr("width",width+(v?0:margin.left)).attr("height",height+(v?margin.bottom:0));scrollTarget.attr("x",x).attr("y",y).attr("width",scrollWidth).attr("height",scrollHeight);backShadows.select(".nv-back-shadow-prev").attr("x",x).attr("y",y).attr(dim,val);backShadows.select(".nv-back-shadow-more").attr("x",x+(v?width-5:1)).attr("y",y+(v?0:height-4)).attr(dim,val);foreShadows.select(".nv-fore-shadow-prev").attr("x",x+(v?1:0)).attr("y",y+(v?0:1)).attr(dim,val);foreShadows.select(".nv-fore-shadow-more").attr("x",x+(v?minDimension-20:0)).attr("y",y+(v?0:minDimension-19)).attr(dim,val)};scroll.gradients=function(enable){defsEnter.append("linearGradient").attr("class","nv-scroll-gradient").attr("id","nv-back-gradient-prev-"+id);var bgpEnter=defsEnter.select("#nv-back-gradient-prev-"+id);defsEnter.append("linearGradient").attr("class","nv-scroll-gradient").attr("id","nv-back-gradient-more-"+id);var bgmEnter=defsEnter.select("#nv-back-gradient-more-"+id);defsEnter.append("linearGradient").attr("class","nv-scroll-gradient").attr("id","nv-fore-gradient-prev-"+id);var fgpEnter=defsEnter.select("#nv-fore-gradient-prev-"+id);defsEnter.append("linearGradient").attr("class","nv-scroll-gradient").attr("id","nv-fore-gradient-more-"+id);var fgmEnter=defsEnter.select("#nv-fore-gradient-more-"+id);defs.selectAll(".nv-scroll-gradient").attr("gradientUnits","objectBoundingBox").attr("x1",0).attr("y1",0).attr("x2",vertical?1:0).attr("y2",vertical?0:1);bgpEnter.append("stop").attr("stop-color","#000").attr("stop-opacity","0.3").attr("offset",0);bgpEnter.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",1);bgmEnter.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",0);bgmEnter.append("stop").attr("stop-color","#000").attr("stop-opacity","0.3").attr("offset",1);fgpEnter.append("stop").attr("stop-color","#FFF").attr("stop-opacity","1").attr("offset",0);fgpEnter.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",1);fgmEnter.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",0);fgmEnter.append("stop").attr("stop-color","#FFF").attr("stop-opacity","1").attr("offset",1)};scroll.mask=function(enable){defsEnter.append("clipPath").attr("class","nv-scroll-mask").attr("id","nv-edge-clip-"+id).append("rect");scrollMask=defs.select(".nv-scroll-mask rect");scrollWrap.attr("clip-path",enable?"url(#nv-edge-clip-"+id+")":"")};scroll.scrollTarget=function(enable){gEnter.select(".nv-scroll-background").append("rect").attr("class","nv-scroll-target").attr("fill","transparent");scrollTarget=g.select(".nv-scroll-target")};scroll.backShadows=function(enable){var shadowWrap=gEnter.select(".nv-scroll-background").append("g").attr("class","nv-back-shadow-wrap");shadowWrap.append("rect").attr("class","nv-back-shadow-prev");shadowWrap.append("rect").attr("class","nv-back-shadow-more");backShadows=g.select(".nv-back-shadow-wrap");if(enable){var dimension=vertical?"width":"height";backShadows.select("rect.nv-back-shadow-prev").attr("fill","url(#nv-back-gradient-prev-"+id+")").attr(dimension,7);backShadows.select("rect.nv-back-shadow-more").attr("fill","url(#nv-back-gradient-more-"+id+")").attr(dimension,7)}else{backShadows.selectAll("rect").attr("fill","transparent")}};scroll.foreShadows=function(enable){var shadowWrap=gEnter.select(".nv-scroll-background").insert("g").attr("class","nv-fore-shadow-wrap");shadowWrap.append("rect").attr("class","nv-fore-shadow-prev");shadowWrap.append("rect").attr("class","nv-fore-shadow-more");foreShadows=g.select(".nv-fore-shadow-wrap");if(enable){var dimension=vertical?"width":"height";foreShadows.select("rect.nv-fore-shadow-prev").attr("fill","url(#nv-fore-gradient-prev-"+id+")").attr(dimension,20);foreShadows.select("rect.nv-fore-shadow-more").attr("fill","url(#nv-fore-gradient-more-"+id+")").attr(dimension,20)}else{foreShadows.selectAll("rect").attr("fill","transparent")}};return scroll}scroll.id=function(_){if(!arguments.length){return id}id=_;return scroll};scroll.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return scroll};scroll.width=function(_){if(!arguments.length){return width}width=_;return scroll};scroll.height=function(_){if(!arguments.length){return height}height=_;return scroll};scroll.vertical=function(_){if(!arguments.length){return vertical}vertical=_;return scroll};scroll.minDimension=function(_){if(!arguments.length){return minDimension}minDimension=_;return scroll};scroll.panHandler=function(_){if(!arguments.length){return panHandler}panHandler=d3.functor(_);return scroll};scroll.enable=function(_){if(!arguments.length){return enable}enable=_;return scroll};return scroll};nv.models.scatter=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,color=function(d,i){return nv.utils.defaultColor()(d,d.series)},fill=color,classes=function(d,i){return"nv-group nv-series-"+d.series},id=Math.floor(Math.random()*1e5),x=d3.scale.linear(),y=d3.scale.linear(),z=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},getSize=function(d){return d.size||1},getShape=function(d){return d.shape||"circle"},onlyCircles=true,forceX=[],forceY=[],forceSize=[],interactive=true,pointActive=function(d){return!d.notActive},padData=false,padDataOuter=.1,clipEdge=false,clipVoronoi=true,clipRadius=function(){return 10},xDomain=null,yDomain=null,sizeDomain=null,sizeRange=[16,256],singlePoint=false,dispatch=d3.dispatch("elementClick","elementMouseover","elementMouseout","elementMousemove"),useVoronoi=true;var x0,y0,z0,timeoutID,needsUpdate=false;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);data=data.map(function(series,i){series.values=series.values.map(function(point){point.series=i;return point});return series});var seriesData=xDomain&&yDomain&&sizeDomain?[]:d3.merge(data.map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),size:getSize(d,i)}})}));x.domain(xDomain||d3.extent(seriesData.map(function(d){return d.x}).concat(forceX)));if(padData&&data[0])if(padDataOuter!==0){x.range([(availableWidth*padDataOuter+availableWidth)/(2*data[0].values.length),availableWidth-availableWidth*(1+padDataOuter)/(2*data[0].values.length)])}else{x.range([0+Math.sqrt(sizeRange[1]/Math.PI),availableWidth-Math.sqrt(sizeRange[1]/Math.PI)])}else x.range([0,availableWidth]);y.domain(yDomain||d3.extent(seriesData.map(function(d){return d.y}).concat(forceY))).range([availableHeight,0]);z.domain(sizeDomain||d3.extent(seriesData.map(function(d){return d.size}).concat(forceSize))).range(sizeRange);if(x.domain()[0]===x.domain()[1]||y.domain()[0]===y.domain()[1])singlePoint=true;if(x.domain()[0]===x.domain()[1])x.domain()[0]?x.domain([x.domain()[0]-x.domain()[0]*.01,x.domain()[1]+x.domain()[1]*.01]):x.domain([-1,1]);if(y.domain()[0]===y.domain()[1])y.domain()[0]?y.domain([y.domain()[0]+y.domain()[0]*.01,y.domain()[1]-y.domain()[1]*.01]):y.domain([-1,1]);x0=x0||x;y0=y0||y;z0=z0||z;var wrap=container.selectAll("g.nv-wrap.nv-scatter").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-scatter nv-chart-"+id+(singlePoint?" nv-single-point":""));var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");chart.gradient=function(d,i){return nv.utils.colorRadialGradient(d,id+"-"+i,{x:.5,y:.5,r:.5,s:0,u:"objectBoundingBox"},color(d,i),wrap.select("defs"))};gEnter.append("g").attr("class","nv-groups");gEnter.append("g").attr("class","nv-point-paths");wrap.attr("transform","translate("+margin.left+","+margin.top+")");defsEnter.append("clipPath").attr("id","nv-edge-clip-"+id).append("rect");wrap.select("#nv-edge-clip-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":"");function updateInteractiveLayer(){if(!interactive)return false;var eventElements;var vertices=d3.merge(data.map(function(group,groupIndex){return group.values.map(function(point,pointIndex){return[x(getX(point,pointIndex))*(Math.random()/1e12+1),y(getY(point,pointIndex))*(Math.random()/1e12+1),groupIndex,pointIndex,point]}).filter(function(pointArray,pointIndex){return pointActive(pointArray[4],pointIndex)})}));if(useVoronoi===true){if(clipVoronoi){var pointClipsEnter=wrap.select("defs").selectAll(".nv-point-clips").data([id]).enter();pointClipsEnter.append("clipPath").attr("class","nv-point-clips").attr("id","nv-points-clip-"+id);var pointClips=wrap.select("#nv-points-clip-"+id).selectAll("circle").data(vertices);pointClips.enter().append("circle").attr("r",clipRadius);pointClips.exit().remove();pointClips.attr("cx",function(d){return d[0]}).attr("cy",function(d){return d[1]});wrap.select(".nv-point-paths").attr("clip-path","url(#nv-points-clip-"+id+")")}if(vertices.length<3){vertices.push([x.range()[0]-20,y.range()[0]-20,null,null]);vertices.push([x.range()[1]+20,y.range()[1]+20,null,null]);vertices.push([x.range()[0]-20,y.range()[0]+20,null,null]);vertices.push([x.range()[1]+20,y.range()[1]-20,null,null])}var bounds=d3.geom.polygon([[-10,-10],[-10,height+10],[width+10,height+10],[width+10,-10]]);var voronoi=d3.geom.voronoi(vertices).map(function(d,i){return{data:bounds.clip(d),series:vertices[i][2],point:vertices[i][3]}}).filter(function(d){return d.series!==null});var pointPaths=wrap.select(".nv-point-paths").selectAll("path").data(voronoi);pointPaths.enter().append("path").attr("class",function(d,i){return"nv-path-"+i});pointPaths.exit().remove();pointPaths.attr("d",function(d){return"M"+d.data.join("L")+"Z"});pointPaths.on("click",function(d){if(needsUpdate)return 0;var series=data[d.series],point=series.values[d.point];dispatch.elementClick({point:point,series:series,pos:[x(getX(point,d.point))+margin.left,y(getY(point,d.point))+margin.top],seriesIndex:d.series,pointIndex:d.point})}).on("mouseover",function(d){if(needsUpdate)return 0;var series=data[d.series],point=series.values[d.point];dispatch.elementMouseover({point:point,series:series,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:d.series,pointIndex:d.point})}).on("mouseout",function(d,i){if(needsUpdate)return 0;var series=data[d.series],point=series.values[d.point];dispatch.elementMouseout({point:point,series:series,seriesIndex:d.series,pointIndex:d.point})}).on("mousemove",function(d,i){var series=data[d.series],point=series.values[d.point];dispatch.elementMousemove({point:point,pointIndex:d.point,pos:[d3.event.pageX,d3.event.pageY],id:id})})}else{wrap.select(".nv-groups").selectAll(".nv-group").selectAll(".nv-point").style("pointer-events","auto").on("click",function(d,i){if(needsUpdate||!data[d.series])return 0;var series=data[d.series],point=series.values[i];dispatch.elementClick({point:point,series:series,pos:[x(getX(point,i))+margin.left,y(getY(point,i))+margin.top],seriesIndex:d.series,pointIndex:i})}).on("mouseover",function(d,i){if(needsUpdate||!data[d.series])return 0;var series=data[d.series],point=series.values[i];dispatch.elementMouseover({point:point,series:series,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:d.series,pointIndex:i})}).on("mouseout",function(d,i){if(needsUpdate||!data[d.series])return 0;var series=data[d.series],point=series.values[i];dispatch.elementMouseout({point:point,series:series,seriesIndex:d.series,pointIndex:i})}).on("mousemove",function(d,i){var series=data[d.series],point=series.values[i];dispatch.elementMousemove({point:point,pointIndex:i,pos:[d3.event.pageX,d3.event.pageY],id:id})})}needsUpdate=false}needsUpdate=true;var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key});groups.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6);d3.transition(groups.exit()).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove();groups.attr("class",function(d,i){return classes(d,d.series)}).attr("fill",function(d,i){return fill(d,d.series)}).attr("stroke",function(d,i){return fill(d,d.series)}).classed("hover",function(d){return d.hover});d3.transition(groups).style("stroke-opacity",1).style("fill-opacity",.5);if(onlyCircles){var points=groups.selectAll("circle.nv-point").data(function(d){return d.values});points.enter().append("circle").attr("cx",function(d,i){return x0(getX(d,i))}).attr("cy",function(d,i){return y0(getY(d,i))}).attr("r",function(d,i){return Math.sqrt(z(getSize(d,i))/Math.PI)});points.exit().remove();d3.transition(groups.exit().selectAll("path.nv-point")).attr("cx",function(d,i){return x(getX(d,i))}).attr("cy",function(d,i){return y(getY(d,i))}).remove();points.attr("class",function(d,i){return"nv-point nv-point-"+i});d3.transition(points).attr("cx",function(d,i){return x(getX(d,i))}).attr("cy",function(d,i){return y(getY(d,i))}).attr("r",function(d,i){return Math.sqrt(z(getSize(d,i))/Math.PI)})}else{var points=groups.selectAll("path.nv-point").data(function(d){return d.values});points.enter().append("path").attr("transform",function(d,i){return"translate("+x0(getX(d,i))+","+y0(getY(d,i))+")"}).attr("d",d3.svg.symbol().type(getShape).size(function(d,i){return z(getSize(d,i))}));points.exit().remove();d3.transition(groups.exit().selectAll("path.nv-point")).attr("transform",function(d,i){return"translate("+x(getX(d,i))+","+y(getY(d,i))+")"}).remove();points.attr("class",function(d,i){return"nv-point nv-point-"+i});d3.transition(points).attr("transform",function(d,i){return"translate("+x(getX(d,i))+","+y(getY(d,i))+")"}).attr("d",d3.svg.symbol().type(getShape).size(function(d,i){return z(getSize(d,i))}))}clearTimeout(timeoutID);timeoutID=setTimeout(updateInteractiveLayer,300);x0=x.copy();y0=y.copy();z0=z.copy()});return chart}dispatch.on("elementMouseover.point",function(d){if(interactive)d3.select(".nv-chart-"+id+" .nv-series-"+d.seriesIndex+" .nv-point-"+d.pointIndex).classed("hover",true)});dispatch.on("elementMouseout.point",function(d){if(interactive)d3.select(".nv-chart-"+id+" .nv-series-"+d.seriesIndex+" .nv-point-"+d.pointIndex).classed("hover",false)});chart.dispatch=dispatch;chart.color=function(_){if(!arguments.length)return color;color=_;return chart};chart.fill=function(_){if(!arguments.length)return fill;fill=_;return chart};chart.classes=function(_){if(!arguments.length)return classes;classes=_;return chart};chart.gradient=function(_){if(!arguments.length)return gradient;gradient=_;return chart};chart.x=function(_){if(!arguments.length)return getX;getX=d3.functor(_);return chart};chart.y=function(_){if(!arguments.length)return getY;getY=d3.functor(_);return chart};chart.size=function(_){if(!arguments.length)return getSize;getSize=d3.functor(_);return chart};chart.margin=function(_){if(!arguments.length)return margin;margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length)return width;width=_;return chart};chart.height=function(_){if(!arguments.length)return height;height=_;return chart};chart.xScale=function(_){if(!arguments.length)return x;x=_;return chart};chart.yScale=function(_){if(!arguments.length)return y;y=_;return chart};chart.zScale=function(_){if(!arguments.length)return z;z=_;return chart};chart.xDomain=function(_){if(!arguments.length)return xDomain;xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length)return yDomain;yDomain=_;return chart};chart.sizeDomain=function(_){if(!arguments.length)return sizeDomain;sizeDomain=_;return chart};chart.sizeRange=function(_){if(!arguments.length)return sizeRange;sizeRange=_;return chart};chart.forceX=function(_){if(!arguments.length)return forceX;forceX=_;return chart};chart.forceY=function(_){if(!arguments.length)return forceY;forceY=_;return chart};chart.forceSize=function(_){if(!arguments.length)return forceSize;forceSize=_;return chart};chart.interactive=function(_){if(!arguments.length)return interactive;interactive=_;return chart};chart.pointActive=function(_){if(!arguments.length)return pointActive;pointActive=_;return chart};chart.padData=function(_){if(!arguments.length)return padData;padData=_;return chart};chart.padDataOuter=function(_){if(!arguments.length)return padDataOuter;padDataOuter=_;return chart};chart.clipEdge=function(_){if(!arguments.length)return clipEdge;clipEdge=_;return chart};chart.clipVoronoi=function(_){if(!arguments.length)return clipVoronoi;clipVoronoi=_;return chart};chart.useVoronoi=function(_){if(!arguments.length)return useVoronoi;useVoronoi=_;if(useVoronoi===false){clipVoronoi=false}return chart};chart.clipRadius=function(_){if(!arguments.length)return clipRadius;clipRadius=_;return chart};chart.shape=function(_){if(!arguments.length)return getShape;getShape=_;return chart};chart.onlyCircles=function(_){if(!arguments.length)return onlyCircles;onlyCircles=_;return chart};chart.id=function(_){if(!arguments.length)return id;id=_;return chart};chart.singlePoint=function(_){if(!arguments.length)return singlePoint;singlePoint=_;return chart};return chart};nv.models.bubbleChart=function(){var margin={top:10,right:10,bottom:10,left:10},width=null,height=null,showTitle=false,showControls=false,showLegend=true,direction="ltr",getX=function(d){return d.x},getY=function(d){return d.y},forceY=[0],xDomain,yDomain,delay=200,groupBy=function(d){return d.y},filterBy=function(d){return d.y},clipEdge=false,seriesLength=0,reduceYTicks=false,bubbleClick=function(e){return},format=d3.time.format("%Y-%m-%d"),tooltip=null,tooltips=true,tooltipContent=function(key,x,y,e,graph){return"<h3>"+key+"</h3>"+"<p>"+y+" on "+x+"</p>"},x,y,state={},strings={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available."},dispatch=d3.dispatch("chartClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState");var scatter=nv.models.scatter().padData(true).padDataOuter(0).size(function(d){return d.y}).sizeRange([256,1024]).singlePoint(true),xAxis=nv.models.axis().orient("bottom").tickSize(0).tickPadding(4).highlightZero(false).showMaxMin(false).ticks(d3.time.months,1).tickFormat(function(d){return d3.time.format("%b")(new Date(d))}),yAxis=nv.models.axis().orient("left").tickPadding(7).highlightZero(false).showMaxMin(false),legend=nv.models.legend().align("center");var showTooltip=function(e,offsetElement,properties){var left=e.pos[0],top=e.pos[1],x=e.point.x,y=e.point.y,content=tooltipContent(e.series.key,x,y,e,chart);tooltip=nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};function chart(selection){selection.each(function(chartData){var properties=chartData.properties,data=chartData.data,container=d3.select(this),that=this;chart.update=function(){container.transition().call(chart)};chart.container=this;if(!data||!data.length){return chart}function getTimeTicks(data){function daysInMonth(date){return 32-new Date(date.getFullYear(),date.getMonth(),32).getDate()}var timeExtent=d3.extent(d3.merge(data.map(function(d){return d.values.map(function(d,i){return d3.time.format("%Y-%m-%d").parse(getX(d))})})));var timeRange=d3.time.month.range(d3.time.month.floor(timeExtent[0]),d3.time.month.ceil(timeExtent[1]));var timeTicks=timeRange.map(function(d){return d3.time.day.offset(d3.time.month.floor(d),daysInMonth(d)/2-1)});return timeTicks}function getGroupTicks(data){var groupedData=d3.nest().key(groupBy).entries(data);var gHeight=1e3/groupedData.length,gOffset=gHeight*.25,gDomain=[0,1],gRange=[0,1],gScale=d3.scale.linear().domain(gDomain).range(gRange),yValues=[],total=0;groupedData.map(function(s,i){s.total=0;s.values=s.values.sort(function(a,b){return b.y<a.y?-1:b.y>a.y?1:0}).map(function(p){s.total+=p.y;return p});s.group=i;return s}).sort(function(a,b){return a.total<b.total?-1:a.total>b.total?1:0}).map(function(s,i){total+=s.total;gDomain=d3.extent(s.values.map(function(p){return p.y}));gRange=[gHeight*i+gOffset,gHeight*(i+1)-gOffset];gScale.domain(gDomain).range(gRange);s.values=s.values.map(function(p){p.group=s.group;p.opportunity=p.y;p.y=gScale(p.opportunity);return p});yValues.push({y:d3.min(s.values.map(function(p){return p.y})),key:s.key});return s});return yValues}state.disabled=data.map(function(d){return!!d.disabled});var filteredData=d3.nest().key(filterBy).entries(data);filteredData=filteredData.sort(function(a,b){return parseInt(a.key,10)<parseInt(b.key,10)?-1:parseInt(a.key,10)>parseInt(b.key,10)?1:0}).map(function(d,i){d.series=i;d.classes=d.values[0].classes;d.color=d.values[0].color;return d});var timeExtent=d3.extent(d3.merge(filteredData.map(function(d){return d.values.map(function(d,i){return d3.time.format("%Y-%m-%d").parse(d.x)})})));var xD=[d3.time.month.floor(timeExtent[0]),d3.time.day.offset(d3.time.month.ceil(timeExtent[1]),-1)];var yValues=getGroupTicks(data);var yD=d3.extent(d3.merge(filteredData.map(function(d){return d.values.map(function(d,i){return getY(d,i)})})).concat(forceY));x=scatter.xScale();
y=scatter.yScale();xAxis.scale(x);yAxis.scale(y);chart.render=function(){var width=width||parseInt(container.style("width"),10||960),height=height||parseInt(container.style("height"),10||400),availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,innerWidth=availableWidth,innerHeight=availableHeight,innerMargin={top:0,right:0,bottom:0,left:0},maxBubbleSize=Math.sqrt(scatter.sizeRange()[1]/Math.PI);if(!data||!data.length){var noDataText=container.selectAll(".nv-noData").data([chart.strings().noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}var wrap=container.selectAll("g.nv-wrap.nv-bubbleChart").data([filteredData]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-bubbleChart").append("g"),g=wrap.select("g").attr("class","nv-chartWrap");gEnter.append("rect").attr("class","nv-background").attr("x",-margin.left).attr("y",-margin.top).attr("width",availableWidth+margin.left+margin.right).attr("height",availableHeight+margin.top+margin.bottom).attr("fill","#FFF");gEnter.append("g").attr("class","nv-titleWrap");var titleWrap=g.select(".nv-titleWrap");gEnter.append("g").attr("class","nv-x nv-axis");var xAxisWrap=g.select(".nv-x.nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");var yAxisWrap=g.select(".nv-y.nv-axis");gEnter.append("g").attr("class","nv-bubblesWrap");var bubblesWrap=g.select(".nv-bubblesWrap");gEnter.append("g").attr("class","nv-legendWrap");var legendWrap=g.select(".nv-legendWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(showTitle&&properties.title){titleWrap.select(".nv-title").remove();titleWrap.append("text").attr("class","nv-title").attr("x",direction==="rtl"?availableWidth:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").text(properties.title).attr("stroke","none").attr("fill","black");innerMargin.top+=parseInt(g.select(".nv-title").node().getBoundingClientRect().height/1.15,10)+parseInt(g.select(".nv-title").style("margin-top"),10)+parseInt(g.select(".nv-title").style("margin-bottom"),10)}if(showLegend){legend.id("legend_"+chart.id()).strings(chart.strings().legend).margin({top:10,right:10,bottom:10,left:10}).align("center").height(availableHeight-innerMargin.top).key(function(d){return d.key+"%"});legendWrap.datum(filteredData).call(legend);legend.arrange(availableWidth);legendWrap.attr("transform","translate(0,"+innerMargin.top+")")}innerMargin.top+=legend.height();innerHeight=availableHeight-innerMargin.top-innerMargin.bottom;xAxis.tickValues(getTimeTicks(filteredData));xAxisWrap.call(xAxis);innerMargin[xAxis.orient()]+=xAxis.height();innerMargin.top+=maxBubbleSize;innerHeight=availableHeight-innerMargin.top-innerMargin.bottom;yAxis.ticks(yValues.length).tickValues(yValues.map(function(d,i){return yValues[i].y})).tickFormat(function(d,i){return yValues[i].key});yAxisWrap.call(yAxis);innerMargin[yAxis.orient()]+=yAxis.width();innerWidth=availableWidth-innerMargin.left-innerMargin.right;scatter.xDomain(xD).yDomain(yD).width(innerWidth).height(innerHeight).id(chart.id());bubblesWrap.datum(filteredData.filter(function(d){return!d.disabled})).attr("transform","translate("+innerMargin.left+","+innerMargin.top+")").transition().duration(chart.delay()).call(scatter);xAxisWrap.attr("transform","translate("+innerMargin.left+","+(xAxis.orient()==="bottom"?innerHeight+innerMargin.top:innerMargin.top)+")").transition().call(xAxis);yAxis.tickSize(-innerWidth,0);yAxisWrap.attr("transform","translate("+(yAxis.orient()==="left"?innerMargin.left:innerMargin.left+innerWidth)+","+innerMargin.top+")").transition().call(yAxis)};legend.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;if(!data.filter(function(d){return!d.disabled}).length){data.map(function(d){d.disabled=false;g.selectAll(".nv-series").classed("disabled",false);return d})}state.disabled=data.map(function(d){return!!d.disabled});dispatch.stateChange(state);container.transition().call(chart.render)});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});dispatch.on("tooltipMove",function(e){if(tooltip){nv.tooltip.position(tooltip,e.pos)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}container.transition().call(chart)});dispatch.on("chartClick",function(e){if(legend.enabled()){legend.dispatch.closeMenu(e)}});chart.render()});return chart}scatter.dispatch.on("elementMouseover.tooltip",function(e){dispatch.tooltipShow(e)});scatter.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});scatter.dispatch.on("elementMousemove.tooltip",function(e){dispatch.tooltipMove(e)});scatter.dispatch.on("elementClick",function(e){bubbleClick(e);nv.tooltip.cleanup()});chart.dispatch=dispatch;chart.scatter=scatter;chart.legend=legend;chart.xAxis=xAxis;chart.yAxis=yAxis;d3.rebind(chart,scatter,"id","x","y","xScale","yScale","xDomain","yDomain","forceX","forceY","clipEdge","delay","color","fill","classes","gradient");d3.rebind(chart,scatter,"size","zScale","sizeDomain","forceSize","interactive","clipVoronoi","clipRadius");d3.rebind(chart,xAxis,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks");chart.colorData=function(_){var type=arguments[0],params=arguments[1]||{};var color=function(d,i){return nv.utils.defaultColor()(d,d.series)};var classes=function(d,i){return"nv-group nv-series-"+d.series};switch(type){case"graduated":color=function(d,i){return d3.interpolateHsl(d3.rgb(params.c1),d3.rgb(params.c2))(d.series/params.l)};break;case"class":color=function(){return"inherit"};classes=function(d,i){var iClass=d.series*(params.step||1)%14;iClass=(iClass>9?"":"0")+iClass;return"nv-group nv-series-"+d.series+" nv-fill"+iClass};break;case"data":color=function(d,i){return d.classes?"inherit":d.color||nv.utils.defaultColor()(d,d.series)};classes=function(d,i){return"nv-group nv-series-"+d.series+(d.classes?" "+d.classes:"")};break}var fill=!params.gradient?color:function(d,i){return scatter.gradient(d,d.series)};scatter.color(color);scatter.fill(fill);scatter.classes(classes);legend.color(color);legend.classes(classes);return chart};chart.margin=function(_){if(!arguments.length){return margin}for(var prop in _){if(_.hasOwnProperty(prop)){margin[prop]=_[prop]}}return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.showTitle=function(_){if(!arguments.length){return showTitle}showTitle=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltipContent}tooltipContent=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.delay=function(_){if(!arguments.length){return delay}delay=_;return chart};chart.bubbleClick=function(_){if(!arguments.length){return bubbleClick}bubbleClick=_;return chart};chart.groupBy=function(_){if(!arguments.length){return groupBy}groupBy=_;return chart};chart.filterBy=function(_){if(!arguments.length){return filterBy}filterBy=_;return chart};chart.colorFill=function(_){return chart};chart.strings=function(_){if(!arguments.length){return strings}for(var prop in _){if(_.hasOwnProperty(prop)){strings[prop]=_[prop]}}return chart};chart.direction=function(_){if(!arguments.length){return direction}direction=_;yAxis.direction(_);legend.direction(_);return chart};return chart};nv.models.funnel=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,r=.3,y=d3.scale.linear(),id=Math.floor(Math.random()*1e4),getX=function(d){return d.x},getY=function(d){return d.y},getH=function(d){return d.height},getV=function(d){return d.value},forceY=[0],clipEdge=true,yDomain,delay=0,durationMs=0,fmtValueLabel=function(d){return d.label||d.value||d},color=function(d,i){return nv.utils.defaultColor()(d,d.series)},fill=color,classes=function(d,i){return"nv-group nv-series-"+d.series},dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove");var calculatedWidth=0,calculatedHeight=0,calculatedCenter=0;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this),labelGap=5,labelSpace=5,labelOffset=0,funnelTotal=0,funnelOffset=0;data.map(function(series,i){series.values=series.values.map(function(point){point.series=i;if(typeof point.value=="undefined"){point.value=getY(point)}funnelTotal+=point.value;return point});return series});function calcDimensions(){calculatedWidth=calcWidth(funnelOffset);calculatedHeight=calcHeight();calculatedCenter=calcCenter(funnelOffset)}function calcScales(){var funnelArea=areaTrapezoid(calculatedHeight,calculatedWidth),funnelBase=calculatedWidth-2*r*calculatedHeight,funnelShift=0,funnelMinHeight=24;data.map(function(series,i){series.values=series.values.map(function(point){point.height=0;if(funnelTotal>0){point.height=heightTrapezoid(funnelArea*point.value/funnelTotal,funnelBase)}if(point.height<funnelMinHeight/2){funnelShift+=point.height-funnelMinHeight/2;point.height=funnelMinHeight/2}else if(funnelShift<0&&point.height+funnelShift>funnelMinHeight/2){point.height+=funnelShift;funnelShift=0}funnelBase+=2*r*point.height;return point});return series});data=d3.layout.stack().offset("zero").values(function(d){return d.values}).y(getH)(data);var seriesData=yDomain?[]:d3.extent(d3.merge(data.map(function(d){return d.values.map(function(d,i){return getH(d,i)+d.y0})})).concat(forceY));y.domain(yDomain||seriesData).range([calculatedHeight,0])}calcDimensions();calcScales();var wrap=container.selectAll("g.nv-wrap.nv-funnel").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-funnel");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");chart.gradient=function(d,i,p){return nv.utils.colorLinearGradient(d,id+"-"+i,p,color(d,i),wrap.select("defs"))};gEnter.append("g").attr("class","nv-groups");wrap.attr("transform","translate("+margin.left+","+margin.top+")");defsEnter.append("clipPath").attr("id","nv-edge-clip-"+id).append("rect");wrap.select("#nv-edge-clip-"+id+" rect").attr("width",availableWidth+1).attr("height",availableHeight+1);g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":"");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key});groups.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6);groups.attr("class",classes).attr("fill",fill).classed("hover",function(d){return d.hover}).classed("nv-active",function(d){return d.active==="active"}).classed("nv-inactive",function(d){return d.active==="inactive"}).style({stroke:"#FFFFFF","stroke-width":3});groups.transition().duration(durationMs).style("stroke-opacity",1).style("fill-opacity",1);groups.exit().transition().duration(durationMs).selectAll("polygon.nv-bar").delay(function(d,i){return i*delay/data[0].values.length}).attr("points",function(d){return pointsTrapezoid(d.y,d.y0,0,calculatedWidth)}).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove();groups.exit().transition().duration(durationMs).selectAll("g.nv-label-value").delay(function(d,i){return i*delay/data[0].values.length}).attr("y",0).attr("transform","translate("+calculatedCenter+",0)").style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove();var funs=groups.selectAll("polygon.nv-bar").data(function(d){return d.values});funs.exit().remove();funs.enter().append("polygon").attr("class","nv-bar").attr("points",function(d){return pointsTrapezoid(d.y,d.y0,0,calculatedWidth)});funs.on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({value:getV(d,i),point:d,series:data[d.series],pos:[d3.event.pageX,d3.event.pageY],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout({value:getV(d,i),point:d,series:data[d.series],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("mousemove",function(d,i){dispatch.elementMousemove({point:d,pointIndex:i,pos:[d3.event.pageX,d3.event.pageY],id:id})}).on("click",function(d,i){dispatch.elementClick({value:getV(d,i),point:d,series:data[d.series],pos:[d3.event.pageX,d3.event.pageY],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({value:getV(d,i),point:d,series:data[d.series],pos:[d3.event.pageX,d3.event.pageY],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()});var labels=groups.selectAll(".nv-label-value").data(function(d){return d.values});labels.enter().append("g").attr("class","nv-label-value").attr("transform","translate("+calculatedCenter+",0)");var sideLabels=labels.filter(".nv-label-side");function renderFunnelLabels(){labels.selectAll("text").remove();labels.append("text").text(fmtKey).call(fmtLabel,"nv-label",.85,"11px","middle",fmtFill);labels.select(".nv-label").call(wrapLabel,calcFunnelWidth,function(txt,dy){fmtLabel(txt,"nv-label",dy,"11px","middle",fmtFill)});labels.append("text").text(fmtValueLabel).call(fmtLabel,"nv-value",.85,"15px","middle",fmtFill);labels.select(".nv-value").append("tspan").text(fmtCount);labels.call(positionValue);labels.call(calcFunnelLabelDimensions);labels.classed("nv-label-side",function(d){return d.tooTall||d.tooWide})}function renderSideLabels(){sideLabels=labels.filter(".nv-label-side");labels.selectAll("polyline").remove();sideLabels.selectAll(".nv-label").remove();sideLabels.append("text").text(fmtKey).call(fmtLabel,"nv-label",.85,"11px","start","#555");sideLabels.select(".nv-label").call(wrapLabel,calcSideWidth,function(txt,dy){fmtLabel(txt,"nv-label",dy,"11px","start","#555")});sideLabels.call(positionValue);sideLabels.select(".nv-value").style({"font-size":"15px","text-anchor":"start",fill:"#555"});sideLabels.call(calcSideLabelDimensions);var d0=0;sideLabels.reverse().each(function(d,i){if(!d0){d.labelBottom=d.labelTop+d.labelHeight+labelSpace;d0=d.labelBottom;return}d.labelTop=Math.max(d0,d.labelTop);d.labelBottom=d.labelTop+d.labelHeight+labelSpace;d0=d.labelBottom});sideLabels.reverse();if(d0&&d0-labelSpace>d3.max(y.range())){d0=0;sideLabels.each(function(d,i){if(!d0){d.labelBottom=d3.max(y.range())-1;d.labelTop=d.labelBottom-d.labelHeight;d0=d.labelTop;return}d.labelBottom=Math.min(d0,d.labelBottom);d.labelTop=d.labelBottom-d.labelHeight-labelSpace;d0=d.labelTop});if(d0<0){sideLabels.each(function(d,i){d.labelTop-=d0;d.labelBottom-=d0})}}d0=0;sideLabels.call(calcOffsets)}function renderLabels(){renderFunnelLabels();renderSideLabels()}renderLabels();calcDimensions();calcScales();renderLabels();calcDimensions();calcScales();renderLabels();calcDimensions();funs.attr("points",function(d){var scalar=d.active&&d.active==="active"?1.05:1;return pointsTrapezoid(d.y,d.y0,1,calculatedWidth*scalar)});labels.attr("transform",function(d){var xTrans=d.tooTall?0:calculatedCenter,yTrans=d.tooTall?0:d.labelTop;return"translate("+xTrans+","+yTrans+")"});sideLabels.attr("transform",function(d){return"translate("+labelOffset+","+d.labelTop+")"});sideLabels.append("polyline").attr("class","nv-label-leader").style({"fill-opacity":0,stroke:"#999","stroke-width":1,"stroke-opacity":.5});sideLabels.reverse();sideLabels.selectAll("polyline").call(pointsLeader);sideLabels.reverse();function wrapLabel(lbl,calcAvailableWidth,fmtLabel){lbl.each(function(d){var text=d3.select(this),maxWidth=calcAvailableWidth(d.y,d.y0,0),parent=d3.select(text.node().parentNode),words=text.text().split(/\s+/).reverse(),word,line=[],lineNumber=0,dy=parseFloat(text.attr("dy"));text.text(null);while(word=words.pop()){line.push(word);text.text(line.join(" "));if(text.node().getComputedTextLength()>maxWidth&&line.length>1){line.pop();text.text(line.join(" "));line=[word];text=parent.append("text");text.text(word).call(fmtLabel,++lineNumber*1.1+dy)}}})}function pointsTrapezoid(dy,dy0,h,w){var y0=y(dy0),y1=y(dy0+dy),w0=w/2-r*y0,w1=w/2-r*y1,c=calculatedCenter;return c-w0+","+y0*h+" "+(c-w1)+","+y1*h+" "+(c+w1)+","+y1*h+" "+(c+w0)+","+y0*h}function heightTrapezoid(a,b){var x=b/r/2;return Math.abs(Math.sqrt(a/r+x*x))-x}function areaTrapezoid(h,w){return h*(w-h*r)}function calcWidth(offset){return Math.round(Math.max(Math.min(availableHeight/1.1,availableWidth-offset),40))}function calcHeight(){return Math.min(calculatedWidth*1.1,(calculatedWidth-calculatedWidth*r)/(2*r))}function calcCenter(offset){return calculatedWidth/2+offset}function calcFunnelWidth(dy,dy0){var v=y(dy0+dy/2);return calculatedWidth-v*r*2}function calcSideWidth(dy,dy0,offset){var b=Math.max((availableWidth-calculatedWidth)/2,offset),v=y(dy0+dy);return b+v*r}function calcLabelBBox(lbl){return d3.select(lbl).node().getBoundingClientRect()}function calcFunnelLabelDimensions(lbl){lbl.each(function(d){var bbox=calcLabelBBox(this);d.labelHeight=bbox.height;d.labelWidth=bbox.width;d.labelTop=y(d.y0+d.y/2)-d.labelHeight/2;d.labelBottom=d.labelTop+d.labelHeight+labelSpace;d.tooWide=d.labelWidth>calcFunnelWidth(d.y-d.labelHeight,d.y0);d.tooTall=d.labelHeight>d.height})}function calcSideLabelDimensions(lbl){lbl.each(function(d){var bbox=calcLabelBBox(this);d.labelHeight=bbox.height;d.labelWidth=bbox.width;d.labelTop=y(d.y0+d.y);d.labelBottom=d.labelTop+d.labelHeight+labelSpace})}function pointsLeader(polylines,i){var c=polylines.length;polylines.each(function(d,i,j){var p=j?d3.select(polylines[j-1][i]).data()[0]:null,n=j<c-1?d3.select(polylines[j+1][i]).data()[0]:null,h=Math.round(d.labelHeight)+.5,t=Math.round(y(d.y0)-d.labelTop)-.5,wp=p?p.labelWidth-(d.labelBottom-p.labelBottom)*r:0,wc=d.labelWidth,wn=n&&h<t?n.labelWidth:0,w=Math.round(Math.max(wp,wc,wn))+labelGap,f=Math.round(calcSideWidth(0,d.y0,funnelOffset))-labelOffset-labelGap,p=0+","+h+" "+w+","+h+" "+(w+Math.abs(h-t)*r)+","+t+" "+f+","+t;d.labelWidth=w;d3.select(this).attr("points",p)})}function calcOffsets(lbl){var sideWidth=(availableWidth-calculatedWidth)/2,offset=0;lbl.each(function(d){var sliceBottom=y(d.y0),scalar=d.labelBottom>=sliceBottom?1:0,slope=Math.abs(d.labelBottom+labelGap-sliceBottom)*r,base=sliceBottom*r,iOffset=d.labelWidth+slope+labelGap*3-base;if(iOffset>=offset){offset=iOffset}});offset=Math.round(offset*10)/10;if(offset<=0){labelOffset=sideWidth;funnelOffset=sideWidth}else if(offset>0&&offset<sideWidth){labelOffset=sideWidth-offset;funnelOffset=sideWidth}else{labelOffset=0;funnelOffset=offset}}function fmtFill(d,i,j){var backColor=d3.select(this.parentNode).style("fill"),textColor=nv.utils.getTextContrast(backColor,i);return textColor}function fmtKey(d){return data[d.series].key}function fmtCount(d){var i=data[d.series].count;return i?" ("+i+")":""}function fmtDirection(d){var m=nv.utils.isRTLChar(d.slice(-1)),dir=m?"rtl":"ltr";return"ltr"}function fmtLabel(txt,classes,dy,fontSize,anchor,fill){txt.attr("x",0).attr("y",0).attr("dy",dy+"em").attr("class",classes).attr("direction",function(){return fmtDirection(txt.text())}).style("pointer-events","none").style("text-anchor",anchor).style("font-size",fontSize).style("fill",fill)}function positionValue(lbl){lbl.each(function(d){var lbl=d3.select(this),cnt=lbl.selectAll(".nv-label")[0].length+1,dy=.85*cnt+"em";lbl.select(".nv-value").attr("dy",dy)})}});return chart}chart.dispatch=dispatch;chart.color=function(_){if(!arguments.length)return color;color=_;return chart};chart.fill=function(_){if(!arguments.length)return fill;fill=_;return chart};chart.classes=function(_){if(!arguments.length)return classes;classes=_;return chart};chart.gradient=function(_){if(!arguments.length)return gradient;gradient=_;return chart};chart.x=function(_){if(!arguments.length)return getX;getX=_;return chart};chart.y=function(_){if(!arguments.length)return getY;getY=_;return chart};chart.margin=function(_){if(!arguments.length)return margin;margin=_;return chart};chart.width=function(_){if(!arguments.length)return width;width=_;return chart};chart.height=function(_){if(!arguments.length)return height;height=_;return chart};chart.xScale=function(_){if(!arguments.length)return x;x=_;return chart};chart.yScale=function(_){if(!arguments.length)return y;y=_;return chart};chart.yDomain=function(_){if(!arguments.length)return yDomain;yDomain=_;return chart};chart.forceY=function(_){if(!arguments.length)return forceY;forceY=_;return chart};chart.id=function(_){if(!arguments.length)return id;id=_;return chart};chart.delay=function(_){if(!arguments.length)return delay;delay=_;return chart};chart.clipEdge=function(_){if(!arguments.length)return clipEdge;clipEdge=_;return chart};chart.fmtValueLabel=function(_){if(!arguments.length)return fmtValueLabel;fmtValueLabel=d3.functor(_);return chart};return chart};nv.models.funnelChart=function(){var margin={top:10,right:10,bottom:10,left:10},width=null,height=null,showTitle=false,showLegend=true,direction="ltr",tooltip=null,tooltips=true,tooltipContent=function(key,x,y,e,graph){return"<h3>"+key+" - "+x+"</h3>"+"<p>"+y+"</p>"},x,y,durationMs=0,state={},strings={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available."},dispatch=d3.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState");var funnel=nv.models.funnel(),legend=nv.models.legend().align("center"),yScale=d3.scale.linear();var showTooltip=function(e,offsetElement,properties){var xVal=0;if(properties.total>0){xVal=(e.point.value*100/properties.total).toFixed(1)}var left=e.pos[0],top=e.pos[1],x=xVal,y=e.point.value,content=tooltipContent(e.series.key,x,y,e,chart);tooltip=nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};var seriesClick=function(data,e){return};function chart(selection){selection.each(function(chartData){var properties=chartData.properties,data=chartData.data,container=d3.select(this),that=this,availableWidth=(width||parseInt(container.style("width"),10)||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"),10)||400)-margin.top-margin.bottom,innerWidth=availableWidth,innerHeight=availableHeight,innerMargin={top:0,right:0,bottom:0,left:0},minSliceHeight=30;chart.update=function(){container.transition().duration(durationMs).call(chart)};chart.dataSeriesActivate=function(e){var series=e.series;series.active=!series.active||series.active==="inactive"?"active":"inactive";series.values[0].active=series.active;if(series.active==="active"){data.filter(function(d){return d.active!=="active"}).map(function(d){d.values[0].active="inactive";d.active="inactive";return d})}if(!data.filter(function(d){return d.active==="active"}).length){data.map(function(d){d.active="";d.values[0].active="";container.selectAll(".nv-series").classed("nv-inactive",false);return d})}container.call(chart)};chart.container=this;if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){displayNoData();return chart}data.map(function(d,i){d.series=i;d.values.map(function(v){v.series=d.series});d.total=d3.sum(d.values,function(d,i){return funnel.y()(d,i)});if(!d.total){d.disabled=true}return d});var funnelData=data.filter(function(d,i){return!d.disabled});if(!funnelData.length){funnelData=[{values:[]}]}var totalAmount=d3.sum(funnelData,function(d){return d.total});var totalCount=d3.sum(funnelData,function(d){return d.count});state.disabled=data.map(function(d){return!!d.disabled});y=funnel.yScale();if(!totalAmount){displayNoData();return chart}else{container.selectAll(".nv-noData").remove()}var wrap=container.selectAll("g.nv-wrap.nv-funnelChart").data([funnelData]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-funnelChart").append("g"),g=wrap.select("g").attr("class","nv-chartWrap");gEnter.append("rect").attr("class","nv-background").attr("x",-margin.left).attr("y",-margin.top).attr("fill","#FFF");g.select(".nv-background").attr("width",availableWidth+margin.left+margin.right).attr("height",availableHeight+margin.top+margin.bottom);gEnter.append("g").attr("class","nv-titleWrap");var titleWrap=g.select(".nv-titleWrap");gEnter.append("g").attr("class","nv-funnelWrap");var funnelWrap=g.select(".nv-funnelWrap");gEnter.append("g").attr("class","nv-legendWrap");var legendWrap=g.select(".nv-legendWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(showTitle&&properties.title){titleWrap.select(".nv-title").remove();titleWrap.append("text").attr("class","nv-title").attr("x",direction==="rtl"?availableWidth:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").text(properties.title).attr("stroke","none").attr("fill","black");innerMargin.top+=parseInt(g.select(".nv-title").node().getBoundingClientRect().height/1.15,10)+parseInt(g.select(".nv-title").style("margin-top"),10)+parseInt(g.select(".nv-title").style("margin-bottom"),10);if(!showLegend){innerMargin.top+=4}}if(showLegend){legend.id("legend_"+chart.id()).strings(chart.strings().legend).margin({top:10,right:10,bottom:10,left:10}).align("center").height(availableHeight-innerMargin.top);legendWrap.datum(data).call(legend);legend.arrange(availableWidth);legendWrap.attr("transform","translate("+(direction==="rtl"||!legend.collapsed()?0:availableWidth-legend.width())+","+innerMargin.top+")");innerMargin.top+=legend.height()+4}innerHeight=availableHeight-innerMargin.top-innerMargin.bottom;funnel.width(innerWidth).height(innerHeight);funnelWrap.datum(funnelData).attr("transform","translate("+innerMargin.left+","+innerMargin.top+")").call(funnel);var tickValues=resetScale(yScale,funnelData);function resetScale(scale,data){var series1=[0];var series2=data.filter(function(d){return!d.disabled}).map(function(d){return d.values.map(function(d,i){return d.y0+d.y})});var tickValues=d3.merge(series1.concat(series2));yScale.domain(tickValues).range(tickValues.map(function(d){return y(d)}));return tickValues}function displayNoData(){container.select(".nvd3.nv-wrap").remove();var noDataText=container.selectAll(".nv-noData").data([chart.strings().noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d})}legend.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;if(!funnelData.filter(function(d){return!d.disabled}).length){funnelData.map(function(d){d.disabled=false;wrap.selectAll(".nv-series").classed("disabled",false);return d})}state.disabled=funnelData.map(function(d){return!!d.disabled});dispatch.stateChange(state);container.transition().duration(durationMs).call(chart)});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode,properties)}});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});dispatch.on("tooltipMove",function(e){if(tooltip){nv.tooltip.position(tooltip,e.pos)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){funnelData.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}container.transition().duration(durationMs).call(chart)});dispatch.on("chartClick",function(e){if(legend.enabled()){legend.dispatch.closeMenu(e)}});funnel.dispatch.on("elementClick",function(e){seriesClick(data,e)})});return chart}funnel.dispatch.on("elementMouseover.tooltip",function(e){dispatch.tooltipShow(e)});funnel.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});funnel.dispatch.on("elementMousemove.tooltip",function(e){dispatch.tooltipMove(e)});chart.dispatch=dispatch;chart.funnel=funnel;chart.legend=legend;d3.rebind(chart,funnel,"id","x","y","xDomain","yDomain","forceX","forceY","color","fill","classes","gradient");d3.rebind(chart,funnel,"fmtValueLabel","clipEdge","delay");chart.colorData=function(_){var type=arguments[0],params=arguments[1]||{};var color=function(d,i){return nv.utils.defaultColor()(d,d.series)};var classes=function(d,i){return"nv-group nv-series-"+d.series};switch(type){case"graduated":color=function(d,i){return d3.interpolateHsl(d3.rgb(params.c1),d3.rgb(params.c2))(d.series/params.l)};break;case"class":color=function(){return"inherit"};classes=function(d,i){var iClass=d.series*(params.step||1)%14;iClass=(iClass>9?"":"0")+iClass;return"nv-group nv-series-"+d.series+" nv-fill"+iClass};break;case"data":color=function(d,i){return d.classes?"inherit":d.color||nv.utils.defaultColor()(d,d.series)};classes=function(d,i){return"nv-group nv-series-"+d.series+(d.classes?" "+d.classes:"")};break}var fill=!params.gradient?color:function(d,i){var p={orientation:params.orientation||"vertical",position:params.position||"middle"};return funnel.gradient(d,d.series,p)};funnel.color(color);funnel.fill(fill);funnel.classes(classes);legend.color(color);legend.classes(classes);return chart};chart.x=function(_){if(!arguments.length){return getX}getX=_;funnelWrap.x(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;funnel.y(_);return chart};chart.margin=function(_){if(!arguments.length){return margin}for(var prop in _){if(_.hasOwnProperty(prop)){margin[prop]=_[prop]}}return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.showTitle=function(_){if(!arguments.length){return showTitle}showTitle=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltipContent}tooltipContent=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.strings=function(_){if(!arguments.length){return strings}for(var prop in _){if(_.hasOwnProperty(prop)){strings[prop]=_[prop]}}return chart};chart.seriesClick=function(_){if(!arguments.length){return seriesClick}seriesClick=_;return chart};chart.direction=function(_){if(!arguments.length){return direction}direction=_;legend.direction(_);return chart};return chart};nv.models.gauge=function(){var margin={top:0,right:0,bottom:0,left:0},width=null,height=null,clipEdge=true,getValues=function(d){return d.values},getX=function(d){return d.key},getY=function(d){return d.y},id=Math.floor(Math.random()*1e4),labelFormat=d3.format(",g"),valueFormat=d3.format(",.f"),showLabels=true,showPointer=true,color=function(d,i){return nv.utils.defaultColor()(d,d.series)},fill=color,classes=function(d,i){return"nv-arc-path nv-series-"+d.series},dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove");var ringWidth=50,pointerWidth=5,pointerTailLength=5,pointerHeadLength=90,minValue=0,maxValue=10,minAngle=-90,maxAngle=90,transitionMs=750,labelInset=10;function chart(selection){selection.each(function(chartData){var properties=chartData.properties,data=chartData.data;var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,radius=Math.min(availableWidth/2,availableHeight)/((100+labelInset)/100),container=d3.select(this),range=maxAngle-minAngle,scale=d3.scale.linear().range([0,1]).domain([minValue,maxValue]),previousTick=0,arcData=data.map(function(d,i){
var rtn={key:d.key,series:d.series,y0:previousTick,y1:d.y,color:d.color,classes:d.classes};previousTick=d.y;return rtn}),labelData=[0].concat(data.map(function(d){return d.y})),prop=function(d){return d*radius/100},pointerValue=properties.values[0].t;var wrap=container.selectAll("g.nv-wrap.nv-gauge").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-gauge");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");chart.gradient=function(d,i){return nv.utils.colorRadialGradient(d,id+"-"+i,{x:0,y:0,r:radius,s:ringWidth/100,u:"userSpaceOnUse"},color(d,i),wrap.select("defs"))};gEnter.append("g").attr("class","nv-arc-group");gEnter.append("g").attr("class","nv-labels");gEnter.append("g").attr("class","nv-pointer");gEnter.append("g").attr("class","nv-odometer");wrap.attr("transform","translate("+(margin.left/2+margin.right/2+prop(labelInset))+","+(margin.top+prop(labelInset))+")");var arc=d3.svg.arc().innerRadius(prop(ringWidth)).outerRadius(radius).startAngle(function(d,i){return deg2rad(newAngle(d.y0))}).endAngle(function(d,i){return deg2rad(newAngle(d.y1))});var ag=g.select(".nv-arc-group").attr("transform",centerTx);ag.selectAll(".nv-arc-path").data(arcData).enter().append("path").attr("class","nv-arc-path").attr("stroke","#ffffff").attr("stroke-width",3).attr("d",arc).on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({point:d,pointIndex:i,pos:[d3.event.pageX,d3.event.pageY],id:id})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout({point:d,index:i,id:id})}).on("mousemove",function(d,i){dispatch.elementMousemove({point:d,pointIndex:i,pos:[d3.event.pageX,d3.event.pageY],id:id})}).on("click",function(d,i){dispatch.elementClick({point:d,index:i,pos:d3.event,id:id});d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({point:d,index:i,pos:d3.event,id:id});d3.event.stopPropagation()});ag.selectAll(".nv-arc-path").transition().duration(10).attr("class",classes).attr("fill",fill).attr("d",arc);var lg=g.select(".nv-labels").attr("transform",centerTx);lg.selectAll("text").transition().duration(0).attr("transform",function(d){return"rotate("+newAngle(d)+") translate(0,"+(-radius-prop(1.5))+")"}).style("font-size",prop(.6)+"em");lg.selectAll("text").data(labelData).enter().append("text").attr("transform",function(d){return"rotate("+newAngle(d)+") translate(0,"+(-radius-prop(1.5))+")"}).text(labelFormat).style("text-anchor","middle").style("font-size",prop(.6)+"em");if(showPointer){var pointerData=[[Math.round(prop(pointerWidth)/2),0],[0,-Math.round(prop(pointerHeadLength))],[-Math.round(prop(pointerWidth)/2),0],[0,Math.round(prop(pointerWidth))],[Math.round(prop(pointerWidth)/2),0]];var pg=g.select(".nv-pointer").attr("transform",centerTx);pg.selectAll("path").transition().duration(120).attr("d",d3.svg.line().interpolate("monotone"));var pointer=pg.selectAll("path").data([pointerData]).enter().append("path").attr("d",d3.svg.line().interpolate("monotone")).attr("transform","rotate("+minAngle+")");setGaugePointer(pointerValue);g.selectAll(".nv-odom").remove();g.select(".nv-odomText").transition().duration(0).style("font-size",prop(.7)+"em");g.select(".nv-odometer").append("text").attr("class","nv-odom nv-odomText").attr("x",0).attr("y",0).attr("text-anchor","middle").text(valueFormat(pointerValue)).style("stroke","none").style("fill","black").style("font-size",prop(.7)+"em");var bbox=g.select(".nv-odomText").node().getBoundingClientRect();g.select(".nv-odometer").insert("path",".nv-odomText").attr("class","nv-odom nv-odomBox").attr("d",nv.utils.roundedRectangle(-bbox.width/2,-bbox.height+prop(1.5),bbox.width+prop(4),bbox.height+prop(2),prop(2))).attr("fill","#eeffff").attr("stroke","black").attr("stroke-width","2px").attr("opacity",.8);g.select(".nv-odometer").attr("transform","translate("+radius+","+(margin.top+prop(70)+bbox.width)+")")}else{g.select(".nv-odometer").select(".nv-odomText").remove();g.select(".nv-odometer").select(".nv-odomBox").remove();g.select(".nv-pointer").selectAll("path").remove()}function setGaugePointer(d){pointer.transition().duration(transitionMs).ease("elastic").attr("transform","rotate("+newAngle(d)+")")}function deg2rad(deg){return deg*Math.PI/180}function newAngle(d){return minAngle+scale(d)*range}function centerTx(){return"translate("+radius+","+radius+")"}chart.setGaugePointer=setGaugePointer});return chart}chart.dispatch=dispatch;chart.color=function(_){if(!arguments.length)return color;color=_;return chart};chart.fill=function(_){if(!arguments.length)return fill;fill=_;return chart};chart.classes=function(_){if(!arguments.length)return classes;classes=_;return chart};chart.gradient=function(_){if(!arguments.length)return gradient;gradient=_;return chart};chart.margin=function(_){if(!arguments.length)return margin;margin=_;return chart};chart.width=function(_){if(!arguments.length)return width;width=_;return chart};chart.height=function(_){if(!arguments.length)return height;height=_;return chart};chart.values=function(_){if(!arguments.length)return getValues;getValues=_;return chart};chart.x=function(_){if(!arguments.length)return getX;getX=_;return chart};chart.y=function(_){if(!arguments.length)return getY;getY=d3.functor(_);return chart};chart.showLabels=function(_){if(!arguments.length)return showLabels;showLabels=_;return chart};chart.id=function(_){if(!arguments.length)return id;id=_;return chart};chart.valueFormat=function(_){if(!arguments.length)return valueFormat;valueFormat=_;return chart};chart.labelThreshold=function(_){if(!arguments.length)return labelThreshold;labelThreshold=_;return chart};chart.ringWidth=function(_){if(!arguments.length)return ringWidth;ringWidth=_;return chart};chart.pointerWidth=function(_){if(!arguments.length)return pointerWidth;pointerWidth=_;return chart};chart.pointerTailLength=function(_){if(!arguments.length)return pointerTailLength;pointerTailLength=_;return chart};chart.pointerHeadLength=function(_){if(!arguments.length)return pointerHeadLength;pointerHeadLength=_;return chart};chart.minValue=function(_){if(!arguments.length)return minValue;minValue=_;return chart};chart.maxValue=function(_){if(!arguments.length)return maxValue;maxValue=_;return chart};chart.minAngle=function(_){if(!arguments.length)return minAngle;minAngle=_;return chart};chart.maxAngle=function(_){if(!arguments.length)return maxAngle;maxAngle=_;return chart};chart.transitionMs=function(_){if(!arguments.length)return transitionMs;transitionMs=_;return chart};chart.labelFormat=function(_){if(!arguments.length)return labelFormat;labelFormat=_;return chart};chart.labelInset=function(_){if(!arguments.length)return labelInset;labelInset=_;return chart};chart.setPointer=function(_){if(!arguments.length)return chart.setGaugePointer;chart.setGaugePointer(_);return chart};chart.isRendered=function(_){return svg!==undefined};chart.showPointer=function(_){if(!arguments.length)return showPointer;showPointer=_;return chart};return chart};nv.models.gaugeChart=function(){var margin={top:10,right:10,bottom:10,left:10},width=null,height=null,showTitle=false,showLegend=true,direction="ltr",tooltip=null,tooltips=true,tooltipContent=function(key,y,e,graph){return"<h3>"+key+"</h3>"+"<p>"+y+"</p>"},x,y,strings={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available."},dispatch=d3.dispatch("tooltipShow","tooltipHide","tooltipMove");var gauge=nv.models.gauge(),legend=nv.models.legend().align("center");var showTooltip=function(e,offsetElement){var left=e.pos[0],top=e.pos[1],y=gauge.valueFormat()(e.point.y1-e.point.y0),content=tooltipContent(e.point.key,y,e,chart);tooltip=nv.tooltip.show([left,top],content,null,null,offsetElement)};function chart(selection){selection.each(function(chartData){var properties=chartData.properties,data=chartData.data,container=d3.select(this),that=this,availableWidth=(width||parseInt(container.style("width"),10)||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"),10)||400)-margin.top-margin.bottom,innerWidth=availableWidth,innerHeight=availableHeight,innerMargin={top:0,right:0,bottom:0,left:0};chart.update=function(){container.transition().call(chart)};chart.container=this;if(!data||!data.length){var noDataText=container.selectAll(".nv-noData").data([chart.strings().noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}data.map(function(d,i){d.series=i});var wrap=container.selectAll("g.nv-wrap.nv-gaugeChart").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-gaugeChart").append("g"),g=wrap.select("g").attr("class","nv-chartWrap");gEnter.append("rect").attr("class","nv-background").attr("x",-margin.left).attr("y",-margin.top).attr("width",availableWidth+margin.left+margin.right).attr("height",availableHeight+margin.top+margin.bottom).attr("fill","#FFF");gEnter.append("g").attr("class","nv-titleWrap");var titleWrap=g.select(".nv-titleWrap");gEnter.append("g").attr("class","nv-gaugeWrap");var gaugeWrap=g.select(".nv-gaugeWrap");gEnter.append("g").attr("class","nv-legendWrap");var legendWrap=g.select(".nv-legendWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(showTitle&&properties.title){titleWrap.select(".nv-title").remove();titleWrap.append("text").attr("class","nv-title").attr("x",direction==="rtl"?availableWidth:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").text(properties.title).attr("stroke","none").attr("fill","black");innerMargin.top+=parseInt(g.select(".nv-title").node().getBoundingClientRect().height/1.15,10)+parseInt(g.select(".nv-title").style("margin-top"),10)+parseInt(g.select(".nv-title").style("margin-bottom"),10)}if(showLegend){legend.id("legend_"+chart.id()).strings(chart.strings().legend).margin({top:10,right:10,bottom:10,left:10}).align("center").height(availableHeight-innerMargin.top);legendWrap.datum(data).call(legend);legend.arrange(availableWidth);legendWrap.attr("transform","translate(0,"+innerMargin.top+")")}innerMargin.top+=legend.height()+4;innerHeight=availableHeight-innerMargin.top-innerMargin.bottom;gauge.width(innerWidth).height(innerHeight);gaugeWrap.datum(chartData).attr("transform","translate("+innerMargin.left+","+innerMargin.top+")").transition().call(gauge);dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e)}});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});dispatch.on("tooltipMove",function(e){if(tooltip){nv.tooltip.position(tooltip,e.pos)}})});return chart}gauge.dispatch.on("elementMouseover.tooltip",function(e){dispatch.tooltipShow(e)});gauge.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});gauge.dispatch.on("elementMousemove.tooltip",function(e){dispatch.tooltipMove(e)});chart.dispatch=dispatch;chart.gauge=gauge;chart.legend=legend;d3.rebind(chart,gauge,"id","x","y","color","fill","classes","gradient");d3.rebind(chart,gauge,"valueFormat","values","showLabels","showPointer","setPointer","ringWidth","labelThreshold","maxValue","minValue","transitionMs");chart.colorData=function(_){var type=arguments[0],params=arguments[1]||{};var color=function(d,i){return nv.utils.defaultColor()(d,d.series)};var classes=function(d,i){return"nv-arc-path nv-series-"+d.series};switch(type){case"graduated":color=function(d,i){return d3.interpolateHsl(d3.rgb(params.c1),d3.rgb(params.c2))(d.series/params.l)};break;case"class":color=function(){return"inherit"};classes=function(d,i){var iClass=d.series*(params.step||1)%14;iClass=(iClass>9?"":"0")+iClass;return"nv-arc-path nv-series-"+d.series+" nv-fill"+iClass};break;case"data":color=function(d,i){return d.classes?"inherit":d.color||nv.utils.defaultColor()(d,d.series)};classes=function(d,i){return"nv-arc-path nv-series-"+d.series+(d.classes?" "+d.classes:"")};break}var fill=!params.gradient?color:function(d,i){return gauge.gradient(d,d.series)};gauge.color(color);gauge.fill(fill);gauge.classes(classes);legend.color(color);legend.classes(classes);return chart};chart.margin=function(_){if(!arguments.length){return margin}for(var prop in _){if(_.hasOwnProperty(prop)){margin[prop]=_[prop]}}return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.showTitle=function(_){if(!arguments.length){return showTitle}showTitle=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltipContent}tooltipContent=_;return chart};chart.strings=function(_){if(!arguments.length){return strings}for(var prop in _){if(_.hasOwnProperty(prop)){strings[prop]=_[prop]}}return chart};chart.direction=function(_){if(!arguments.length){return direction}direction=_;legend.direction(_);return chart};return chart};nv.models.line=function(){var scatter=nv.models.scatter();var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,getX=function(d){return d.x},getY=function(d){return d.y},defined=function(d,i){return!isNaN(getY(d,i))&&getY(d,i)!==null},isArea=function(d){return d&&d.area||false},clipEdge=false,x,y,delay=200,interpolate="linear",color=function(d,i){return nv.utils.defaultColor()(d,d.series)},fill=color,classes=function(d,i){return"nv-group nv-series-"+d.series};scatter.size(16).sizeDomain([16,256]);var x0,y0;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);x=scatter.xScale();y=scatter.yScale();x0=x0||x;y0=y0||y;var wrap=container.selectAll("g.nv-wrap.nv-line").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-line");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");chart.gradient=function(d,i,p){return nv.utils.colorLinearGradient(d,chart.id()+"-"+i,p,color(d,i),wrap.select("defs"))};gEnter.append("g").attr("class","nv-groups");gEnter.append("g").attr("class","nv-scatterWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");scatter.width(availableWidth).height(availableHeight);var scatterWrap=wrap.select(".nv-scatterWrap");d3.transition(scatterWrap).call(scatter);defsEnter.append("clipPath").attr("id","nv-edge-clip-"+scatter.id()).append("rect");wrap.select("#nv-edge-clip-"+scatter.id()+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+scatter.id()+")":"");scatterWrap.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+scatter.id()+")":"");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key});groups.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6);d3.transition(groups.exit()).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove();groups.classed("hover",function(d){return d.hover}).attr("class",classes).attr("fill",color).attr("stroke",color);d3.transition(groups).style("stroke-opacity",1).style("fill-opacity",.5);var areaPaths=groups.selectAll("path.nv-area").data(function(d){return isArea(d)?[d]:[]});areaPaths.enter().append("path").attr("class","nv-area").attr("d",function(d){return d3.svg.area().interpolate(interpolate).defined(defined).x(function(d,i){return x0(getX(d,i))}).y0(function(d,i){return y0(getY(d,i))}).y1(function(d,i){return y0(y.domain()[0]<=0?y.domain()[1]>=0?0:y.domain()[1]:y.domain()[0])}).apply(this,[d.values])});areaPaths.exit().remove();d3.transition(groups.exit().selectAll("path.nv-area")).attr("d",function(d){return d3.svg.area().interpolate(interpolate).defined(defined).x(function(d,i){return x0(getX(d,i))}).y0(function(d,i){return y0(getY(d,i))}).y1(function(d,i){return y0(y.domain()[0]<=0?y.domain()[1]>=0?0:y.domain()[1]:y.domain()[0])}).apply(this,[d.values])});d3.transition(areaPaths).attr("d",function(d){return d3.svg.area().interpolate(interpolate).defined(defined).x(function(d,i){return x(getX(d,i))}).y0(function(d,i){return y(getY(d,i))}).y1(function(d,i){return y0(y.domain()[0]<=0?y.domain()[1]>=0?0:y.domain()[1]:y.domain()[0])}).apply(this,[d.values])});var linePaths=groups.selectAll("path.nv-line").data(function(d){return[d.values]});linePaths.enter().append("path").attr("class","nv-line").attr("d",d3.svg.line().interpolate(interpolate).defined(defined).x(function(d,i){return x0(getX(d,i))}).y(function(d,i){return y0(getY(d,i))}));d3.transition(groups.exit().selectAll("path.nv-line")).attr("d",d3.svg.line().interpolate(interpolate).defined(defined).x(function(d,i){return x0(getX(d,i))}).y(function(d,i){return y0(getY(d,i))}));d3.transition(linePaths).attr("d",d3.svg.line().interpolate(interpolate).defined(defined).x(function(d,i){return x(getX(d,i))}).y(function(d,i){return y(getY(d,i))}));x0=x.copy();y0=y.copy()});return chart}chart.dispatch=scatter.dispatch;chart.scatter=scatter;d3.rebind(chart,scatter,"id","interactive","size","xScale","yScale","zScale","xDomain","yDomain","sizeDomain","forceX","forceY","forceSize","useVoronoi","clipVoronoi","clipRadius","padData");chart.color=function(_){if(!arguments.length){return color}color=_;scatter.color(color);return chart};chart.fill=function(_){if(!arguments.length){return fill}fill=_;scatter.fill(fill);return chart};chart.classes=function(_){if(!arguments.length){return classes}classes=_;scatter.classes(classes);return chart};chart.gradient=function(_){if(!arguments.length){return gradient}gradient=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.x=function(_){if(!arguments.length){return getX}getX=_;scatter.x(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;scatter.y(_);return chart};chart.delay=function(_){if(!arguments.length){return delay}delay=_;return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.interpolate=function(_){if(!arguments.length){return interpolate}interpolate=_;return chart};chart.defined=function(_){if(!arguments.length){return defined}defined=_;return chart};chart.isArea=function(_){if(!arguments.length){return isArea}isArea=d3.functor(_);return chart};return chart};nv.models.lineChart=function(){var margin={top:10,right:10,bottom:10,left:10},width=null,height=null,showTitle=false,showControls=false,showLegend=true,direction="ltr",tooltip=null,tooltips=true,tooltipContent=function(key,x,y,e,graph){return"<h3>"+key+"</h3>"+"<p>"+y+" on "+x+"</p>"},x,y,state={},strings={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available."},dispatch=d3.dispatch("chartClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState");var lines=nv.models.line().clipEdge(true),xAxis=nv.models.axis().orient("bottom").tickPadding(4).highlightZero(false).showMaxMin(false).tickFormat(function(d){return d}),yAxis=nv.models.axis().orient("left").tickPadding(4).tickFormat(d3.format("s")),legend=nv.models.legend().align("right"),controls=nv.models.legend().align("left").color(["#444"]);var showTooltip=function(e,offsetElement){var left=e.pos[0],top=e.pos[1],x=xAxis.tickFormat()(lines.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(lines.y()(e.point,e.pointIndex)),content=tooltipContent(e.series.key,x,y,e,chart);tooltip=nv.tooltip.show([left,top],content,null,null,offsetElement)};function chart(selection){selection.each(function(chartData){var properties=chartData.properties,data=chartData.data,container=d3.select(this),that=this,availableWidth=(width||parseInt(container.style("width"),10)||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"),10)||400)-margin.top-margin.bottom,innerWidth=availableWidth,innerHeight=availableHeight,innerMargin={top:0,right:0,bottom:0,left:0},maxControlsWidth=0,maxLegendWidth=0,widthRatio=0;chart.update=function(){container.transition().duration(chart.delay()).call(chart)};chart.container=this;if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){displayNoData();return chart}data.map(function(d,i){d.series=i;d.total=d3.sum(d.values,function(d,i){return lines.y()(d,i)});if(!d.total){d.disabled=true}});var dataLines=data.filter(function(d){return!d.disabled});dataLines=dataLines.length?dataLines:[{values:[]}];var totalAmount=d3.sum(dataLines,function(d){return d.total});state.disabled=data.map(function(d){return!!d.disabled});state.interpolate=lines.interpolate();state.isArea=!lines.isArea();var controlsData=[{key:"Linear",disabled:lines.interpolate()!=="linear"},{key:"Basis",disabled:lines.interpolate()!=="basis"},{key:"Monotone",disabled:lines.interpolate()!=="monotone"},{key:"Cardinal",disabled:lines.interpolate()!=="cardinal"},{key:"Line",disabled:lines.isArea()()===true},{key:"Area",disabled:lines.isArea()()===false}];x=lines.xScale();y=lines.yScale();xAxis.scale(x);yAxis.scale(y);if(!totalAmount){displayNoData();return chart}else{container.selectAll(".nv-noData").remove()}var wrap=container.selectAll("g.nv-wrap.nv-lineChart").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-lineChart").append("g"),g=wrap.select("g").attr("class","nv-chartWrap");gEnter.append("rect").attr("class","nv-background").attr("x",-margin.left).attr("y",-margin.top).attr("width",availableWidth+margin.left+margin.right).attr("height",availableHeight+margin.top+margin.bottom).attr("fill","#FFF");gEnter.append("g").attr("class","nv-titleWrap");var titleWrap=g.select(".nv-titleWrap");gEnter.append("g").attr("class","nv-x nv-axis");var xAxisWrap=g.select(".nv-x.nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");var yAxisWrap=g.select(".nv-y.nv-axis");gEnter.append("g").attr("class","nv-linesWrap");var linesWrap=g.select(".nv-linesWrap");gEnter.append("g").attr("class","nv-controlsWrap");var controlsWrap=g.select(".nv-controlsWrap");gEnter.append("g").attr("class","nv-legendWrap");var legendWrap=g.select(".nv-legendWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(showTitle&&properties.title){titleWrap.select(".nv-title").remove();titleWrap.append("text").attr("class","nv-title").attr("x",direction==="rtl"?availableWidth:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").text(properties.title).attr("stroke","none").attr("fill","black");innerMargin.top+=parseInt(g.select(".nv-title").node().getBoundingClientRect().height/1.15,10)+parseInt(g.select(".nv-title").style("margin-top"),10)+parseInt(g.select(".nv-title").style("margin-bottom"),10)}if(showControls){controls.id("controls_"+chart.id()).strings(chart.strings().controls).margin({top:10,right:10,bottom:10,left:10}).align("left").height(availableHeight-innerMargin.top);controlsWrap.datum(controlsData).call(controls);maxControlsWidth=controls.calculateWidth()}if(showLegend){legend.id("legend_"+chart.id()).strings(chart.strings().legend).margin({top:10,right:10,bottom:10,left:10}).align("right").height(availableHeight-innerMargin.top);legendWrap.datum(data).call(legend);maxLegendWidth=legend.calculateWidth()}widthRatio=availableWidth/(maxControlsWidth+maxLegendWidth);maxControlsWidth=Math.floor(maxControlsWidth*widthRatio);maxLegendWidth=Math.floor(maxLegendWidth*widthRatio);if(showControls){controls.arrange(maxControlsWidth);maxLegendWidth=availableWidth-controls.width()}if(showLegend){legend.arrange(maxLegendWidth);maxControlsWidth=availableWidth-legend.width()}if(showControls){controlsWrap.attr("transform","translate("+(direction==="rtl"?availableWidth-controls.width():0)+","+innerMargin.top+")")}if(showLegend){legendWrap.attr("transform","translate("+(direction==="rtl"?0:availableWidth-legend.width())+","+innerMargin.top+")")}innerMargin.top+=Math.max(legend.height(),controls.height())+4;innerHeight=availableHeight-innerMargin.top-innerMargin.bottom;lines.width(innerWidth).height(innerHeight).id(chart.id());linesWrap.datum(dataLines).call(lines);xAxisWrap.call(xAxis);innerMargin[xAxis.orient()]+=xAxis.height();innerHeight=availableHeight-innerMargin.top-innerMargin.bottom;yAxisWrap.call(yAxis);innerMargin[yAxis.orient()]+=yAxis.width();innerWidth=availableWidth-innerMargin.left-innerMargin.right;lines.width(innerWidth).height(innerHeight);linesWrap.attr("transform","translate("+innerMargin.left+","+innerMargin.top+")").transition().duration(chart.delay()).call(lines);xAxis.ticks(innerWidth/100).tickSize(-innerHeight,0);xAxisWrap.attr("transform","translate("+innerMargin.left+","+(xAxis.orient()==="bottom"?innerHeight+innerMargin.top:innerMargin.top)+")").transition().call(xAxis);yAxis.ticks(innerHeight/36).tickSize(-innerWidth,0);yAxisWrap.attr("transform","translate("+(yAxis.orient()==="left"?innerMargin.left:innerMargin.left+innerWidth)+","+innerMargin.top+")").transition().call(yAxis);function displayNoData(){container.select(".nvd3.nv-wrap").remove();var noDataText=container.selectAll(".nv-noData").data([chart.strings().noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d})}legend.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;if(!data.filter(function(d){return!d.disabled}).length){data.map(function(d){d.disabled=false;g.selectAll(".nv-series").classed("disabled",false);return d})}state.disabled=data.map(function(d){return!!d.disabled});dispatch.stateChange(state);container.transition().duration(chart.delay()).call(chart)});controls.dispatch.on("legendClick",function(d,i){if(!d.disabled){return}controlsData=controlsData.map(function(s){s.disabled=true;return s});d.disabled=false;switch(d.key){case"Basis":lines.interpolate("basis");break;case"Linear":lines.interpolate("linear");break;case"Monotone":lines.interpolate("monotone");break;case"Cardinal":lines.interpolate("cardinal");break;case"Line":lines.isArea(false);break;case"Area":lines.isArea(true);break}state.interpolate=lines.interpolate();state.isArea=lines.isArea();dispatch.stateChange(state);container.transition().duration(chart.delay()).call(chart)});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});dispatch.on("tooltipMove",function(e){if(tooltip){nv.tooltip.position(tooltip,e.pos,"s")}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}if(typeof e.interpolate!=="undefined"){lines.interpolate(e.interpolate);state.interpolate=e.interpolate}if(typeof e.isArea!=="undefined"){lines.isArea(e.isArea);state.isArea=e.isArea}container.transition().duration(chart.delay()).call(chart)});dispatch.on("chartClick",function(e){if(controls.enabled()){controls.dispatch.closeMenu(e)}if(legend.enabled()){legend.dispatch.closeMenu(e)}})});return chart}lines.dispatch.on("elementMouseover.tooltip",function(e){dispatch.tooltipShow(e)});lines.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});lines.dispatch.on("elementMousemove.tooltip",function(e){dispatch.tooltipMove(e)});chart.dispatch=dispatch;chart.lines=lines;chart.legend=legend;chart.controls=controls;chart.xAxis=xAxis;chart.yAxis=yAxis;d3.rebind(chart,lines,"id","x","y","xScale","yScale","xDomain","yDomain","forceX","forceY","clipEdge","delay","color","fill","classes","gradient");d3.rebind(chart,lines,"defined","isArea","interpolate","size","clipVoronoi","useVoronoi","interactive");d3.rebind(chart,xAxis,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks");chart.colorData=function(_){var type=arguments[0],params=arguments[1]||{};var color=function(d,i){return nv.utils.defaultColor()(d,d.series)};var classes=function(d,i){return"nv-group nv-series-"+d.series};switch(type){case"graduated":color=function(d,i){return d3.interpolateHsl(d3.rgb(params.c1),d3.rgb(params.c2))(d.series/params.l)};break;case"class":color=function(){return"inherit"};classes=function(d,i){var iClass=d.series*(params.step||1)%14;iClass=(iClass>9?"":"0")+iClass;return"nv-group nv-series-"+d.series+" nv-fill"+iClass+" nv-stroke"+iClass};break;case"data":color=function(d,i){return d.color||nv.utils.defaultColor()(d,d.series)};classes=function(d,i){return"nv-group nv-series-"+d.series+(d.classes?" "+d.classes:"")};break}var fill=!params.gradient?color:function(d,i){var p={orientation:params.orientation||"horizontal",position:params.position||"base"};return lines.gradient(d,d.series,p)};lines.color(color);lines.fill(fill);lines.classes(classes);legend.color(color);legend.classes(classes);return chart};chart.margin=function(_){if(!arguments.length){return margin}for(var prop in _){if(_.hasOwnProperty(prop)){margin[prop]=_[prop]}}return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.showTitle=function(_){if(!arguments.length){return showTitle}showTitle=_;return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltipContent}tooltipContent=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.strings=function(_){if(!arguments.length){return strings}for(var prop in _){if(_.hasOwnProperty(prop)){strings[prop]=_[prop]}}return chart};chart.direction=function(_){if(!arguments.length){return direction}direction=_;yAxis.direction(_);legend.direction(_);controls.direction(_);return chart};return chart};nv.models.lineWithFocusChart=function(){var lines=nv.models.line(),lines2=nv.models.line(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),x2Axis=nv.models.axis(),y2Axis=nv.models.axis(),legend=nv.models.legend(),brush=d3.svg.brush();var margin={top:30,right:30,bottom:30,left:60},margin2={top:0,right:30,bottom:20,left:60},color=nv.utils.defaultColor(),width=null,height=null,height2=100,x,y,x2,y2,showLegend=true,brushExtent=null,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3>"+"<p>"+y+" at "+x+"</p>"},noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","brush");lines.clipEdge(true);lines2.interactive(false);xAxis.orient("bottom").tickPadding(5);yAxis.orient("left");x2Axis.orient("bottom").tickPadding(5);y2Axis.orient("left");var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(lines.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(lines.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);
nv.tooltip.show([left,top],content,null,null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight1=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom-height2,availableHeight2=height2-margin2.top-margin2.bottom;chart.update=function(){chart(selection)};chart.container=this;if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight1/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=lines.xScale();y=lines.yScale();x2=lines2.xScale();y2=lines2.yScale();var wrap=container.selectAll("g.nv-wrap.nv-lineWithFocusChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-lineWithFocusChart").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-legendWrap");var focusEnter=gEnter.append("g").attr("class","nv-focus");focusEnter.append("g").attr("class","nv-x nv-axis");focusEnter.append("g").attr("class","nv-y nv-axis");focusEnter.append("g").attr("class","nv-linesWrap");var contextEnter=gEnter.append("g").attr("class","nv-context");contextEnter.append("g").attr("class","nv-x nv-axis");contextEnter.append("g").attr("class","nv-y nv-axis");contextEnter.append("g").attr("class","nv-linesWrap");contextEnter.append("g").attr("class","nv-brushBackground");contextEnter.append("g").attr("class","nv-x nv-brush");if(showLegend){legend.id("legend_"+chart.id()).margin({top:10,right:10,bottom:10,left:10}).align("right").height(availableHeight1-margin.top);g.select(".nv-legendWrap").datum(data).call(legend);legend.arrange(availableWidth);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight1=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom-height2}g.select(".nv-legendWrap").attr("transform","translate(0,"+-margin.top+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");lines.width(availableWidth).height(availableHeight1).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data[i].disabled}));lines2.defined(lines.defined()).width(availableWidth).height(availableHeight2).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data[i].disabled}));g.select(".nv-context").attr("transform","translate(0,"+(availableHeight1+margin.bottom+margin2.top)+")");var contextLinesWrap=g.select(".nv-context .nv-linesWrap").datum(data.filter(function(d){return!d.disabled}));d3.transition(contextLinesWrap).call(lines2);xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight1,0);yAxis.scale(y).ticks(availableHeight1/36).tickSize(-availableWidth,0);g.select(".nv-focus .nv-x.nv-axis").attr("transform","translate(0,"+availableHeight1+")");brush.x(x2).on("brush",onBrush);if(brushExtent)brush.extent(brushExtent);var brushBG=g.select(".nv-brushBackground").selectAll("g").data([brushExtent||brush.extent()]);var brushBGenter=brushBG.enter().append("g");brushBGenter.append("rect").attr("class","left").attr("x",0).attr("y",0).attr("height",availableHeight2);brushBGenter.append("rect").attr("class","right").attr("x",0).attr("y",0).attr("height",availableHeight2);gBrush=g.select(".nv-x.nv-brush").call(brush);gBrush.selectAll("rect").attr("height",availableHeight2);gBrush.selectAll(".resize").append("path").attr("d",resizePath);onBrush();x2Axis.scale(x2).ticks(availableWidth/100).tickSize(-availableHeight2,0);g.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+y2.range()[0]+")");d3.transition(g.select(".nv-context .nv-x.nv-axis")).call(x2Axis);y2Axis.scale(y2).ticks(availableHeight2/36).tickSize(-availableWidth,0);d3.transition(g.select(".nv-context .nv-y.nv-axis")).call(y2Axis);g.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+y2.range()[0]+")");legend.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;if(!data.filter(function(d){return!d.disabled}).length){data.map(function(d){d.disabled=false;wrap.selectAll(".nv-series").classed("disabled",false);return d})}selection.transition().call(chart)});dispatch.on("tooltipShow",function(e){if(tooltips)showTooltip(e,that.parentNode)});function resizePath(d){var e=+(d=="e"),x=e?1:-1,y=availableHeight2/3;return"M"+.5*x+","+y+"A6,6 0 0 "+e+" "+6.5*x+","+(y+6)+"V"+(2*y-6)+"A6,6 0 0 "+e+" "+.5*x+","+2*y+"Z"+"M"+2.5*x+","+(y+8)+"V"+(2*y-8)+"M"+4.5*x+","+(y+8)+"V"+(2*y-8)}function updateBrushBG(){if(!brush.empty())brush.extent(brushExtent);brushBG.data([brush.empty()?x2.domain():brushExtent]).each(function(d,i){var leftWidth=x2(d[0])-x.range()[0],rightWidth=x.range()[1]-x2(d[1]);d3.select(this).select(".left").attr("width",leftWidth<0?0:leftWidth);d3.select(this).select(".right").attr("x",x2(d[1])).attr("width",rightWidth<0?0:rightWidth)})}function onBrush(){brushExtent=brush.empty()?null:brush.extent();extent=brush.empty()?x2.domain():brush.extent();dispatch.brush({extent:extent,brush:brush});updateBrushBG();var focusLinesWrap=g.select(".nv-focus .nv-linesWrap").datum(data.filter(function(d){return!d.disabled}).map(function(d,i){return{key:d.key,values:d.values.filter(function(d,i){return lines.x()(d,i)>=extent[0]&&lines.x()(d,i)<=extent[1]})}}));d3.transition(focusLinesWrap).call(lines);d3.transition(g.select(".nv-focus .nv-x.nv-axis")).call(xAxis);d3.transition(g.select(".nv-focus .nv-y.nv-axis")).call(yAxis)}});return chart}lines.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips)nv.tooltip.cleanup()});chart.dispatch=dispatch;chart.legend=legend;chart.lines=lines;chart.lines2=lines2;chart.xAxis=xAxis;chart.yAxis=yAxis;chart.x2Axis=x2Axis;chart.y2Axis=y2Axis;d3.rebind(chart,lines,"defined","isArea","size","xDomain","yDomain","forceX","forceY","interactive","clipEdge","clipVoronoi","id");chart.x=function(_){if(!arguments.length)return lines.x;lines.x(_);lines2.x(_);return chart};chart.y=function(_){if(!arguments.length)return lines.y;lines.y(_);lines2.y(_);return chart};chart.margin=function(_){if(!arguments.length)return margin;margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.margin2=function(_){if(!arguments.length)return margin2;margin2=_;return chart};chart.width=function(_){if(!arguments.length)return width;width=_;return chart};chart.height=function(_){if(!arguments.length)return height;height=_;return chart};chart.height2=function(_){if(!arguments.length)return height2;height2=_;return chart};chart.color=function(_){if(!arguments.length)return color;color=nv.utils.getColor(_);legend.color(color);return chart};chart.showLegend=function(_){if(!arguments.length)return showLegend;showLegend=_;return chart};chart.tooltips=function(_){if(!arguments.length)return tooltips;tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length)return tooltip;tooltip=_;return chart};chart.interpolate=function(_){if(!arguments.length)return lines.interpolate();lines.interpolate(_);lines2.interpolate(_);return chart};chart.noData=function(_){if(!arguments.length)return noData;noData=_;return chart};chart.xTickFormat=function(_){if(!arguments.length)return xAxis.tickFormat();xAxis.tickFormat(_);x2Axis.tickFormat(_);return chart};chart.yTickFormat=function(_){if(!arguments.length)return yAxis.tickFormat();yAxis.tickFormat(_);y2Axis.tickFormat(_);return chart};return chart};nv.models.multiBar=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,x=d3.scale.ordinal(),y=d3.scale.linear(),id=Math.floor(Math.random()*1e4),getX=function(d){return d.x},getY=function(d){return d.y},forceY=[0],stacked=false,barColor=null,disabled,clipEdge=true,showValues=false,valueFormat=d3.format(",.2s"),withLine=false,vertical=true,baseDimension=60,direction="ltr",delay=200,xDomain,yDomain,color=function(d,i){return nv.utils.defaultColor()(d,d.series)},fill=color,barColor=null,classes=function(d,i){return"nv-group nv-series-"+d.series},dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove");var x0,y0;function chart(selection){selection.each(function(data){baseDimension=stacked?vertical?72:30:20;var container=d3.select(this),orientation=vertical?"vertical":"horizontal",availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,maxX=vertical?availableWidth:availableHeight,maxY=vertical?availableHeight:availableWidth,dimX=vertical?"width":"height",dimY=vertical?"height":"width",limDimX=0,limDimY=0,valX=vertical?"x":"y",valY=vertical?"y":"x",valuePadding=0,seriesCount=0,groupCount=0;var barLength=function(d,i){return Math.max(Math.round(Math.abs(y(getY(d,i))-y(0))),0)};var barThickness=function(){return x.rangeBand()/(stacked?1:data.length)};if(stacked){data=d3.layout.stack().offset("zero").values(function(d){return d.values}).y(getY)(data)}if(stacked){data[0].values.map(function(d,i){var posBase=0,negBase=0;data.map(function(d){var f=d.values[i];f.size=Math.abs(f.y);if(f.y<0){f.y1=negBase-(vertical?0:f.size);negBase=negBase-f.size}else{f.y1=posBase+(vertical?f.size:0);posBase=posBase+f.size}})})}var seriesData=xDomain&&yDomain?[]:d3.merge(data.map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),y0:d.y0,y1:d.y1}})}));groupCount=data[0].values.length;seriesCount=data.length;chart.resetDimensions=function(w,h){width=w;height=h;availableWidth=w-margin.left-margin.right;availableHeight=h-margin.top-margin.bottom;maxX=vertical?availableWidth:availableHeight;maxY=vertical?availableHeight:availableWidth};chart.resetScale=function(){availableWidth=width-margin.left-margin.right;availableHeight=height-margin.top-margin.bottom;limDimX=vertical?availableWidth:availableHeight;limDimY=vertical?availableHeight:availableWidth;var boundsWidth=stacked?baseDimension:baseDimension*seriesCount+baseDimension,gap=baseDimension*(stacked?.25:1),outerPadding=Math.max(.25,(maxX-(groupCount*boundsWidth+gap))/(2*boundsWidth));if(withLine){x.domain(xDomain||seriesData.map(function(d){return d.x})).rangeBands([0,maxX],.3)}else{x.domain(xDomain||seriesData.map(function(d){return d.x})).rangeRoundBands([0,maxX],.25,outerPadding)}y.domain(yDomain||d3.extent(seriesData.map(function(d){var posOffset=vertical?0:d.y,negOffset=vertical?d.y:0;return stacked?d.y>0?d.y1+posOffset:d.y1+negOffset:d.y}).concat(forceY))).range(vertical?[availableHeight,0]:[0,availableWidth]).nice();x0=x0||x;y0=y0||y;if(!stacked&&(showValues==="top"||showValues===true)){valuePadding=nv.utils.maxStringSetLength(seriesData.map(function(d){return d.y}),container,valueFormat);valuePadding+=8;if(vertical){y.range([maxY-(y.domain()[0]<0?valuePadding:0),y.domain()[1]>0?valuePadding:0])}else{y.range([y.domain()[0]<0?valuePadding:0,maxY-(y.domain()[1]>0?valuePadding:0)])}}};chart.resetScale();var wrap=container.selectAll(".nvd3.nv-wrap").data([data]);var wrapEnter=wrap.enter().append("g");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");wrap.attr("class","nvd3 nv-wrap nv-multibar"+(vertical?"":"Horizontal"));chart.gradient=function(d,i,p){return nv.utils.colorLinearGradient(d,id+"-"+i,p,color(d,i),wrap.select("defs"))};gEnter.append("g").attr("class","nv-groups");wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(clipEdge){defsEnter.append("clipPath").attr("id","nv-edge-clip-"+id).append("rect");wrap.select("#nv-edge-clip-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight)}g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":"");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key});groups.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6);groups.exit().style("stroke-opacity",1e-6).style("fill-opacity",1e-6).selectAll("g.nv-bar").attr("y",function(d){return stacked?y0(d.y0):y0(0)}).attr(dimX,0).remove();groups.attr("class",classes).attr("fill",fill).classed("hover",function(d){return d.hover}).classed("nv-active",function(d){return d.active==="active"}).classed("nv-inactive",function(d){return d.active==="inactive"}).style({"stroke-opacity":1,"fill-opacity":1});var bars=groups.selectAll("g.nv-bar").data(function(d){return d.values},function(d,i){return d.series+"-"+d.x});bars.exit().remove();var barsEnter=bars.enter().append("g").attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"}).attr("transform",function(d,i,j){var trans={x:stacked?0:j*barThickness()+x(getX(d,i)),y:y0(stacked?d.y0:0)};return"translate("+trans[valX]+","+trans[valY]+")"});barsEnter.append("rect").attr(dimX,0).attr(dimY,0);bars.on("mouseover",function(d,i,j){d3.select(this).classed("hover",true);dispatch.elementMouseover({value:getY(d,i),point:d,series:data[j],pos:[d3.event.pageX,d3.event.pageY],pointIndex:i,seriesIndex:j,e:d3.event})}).on("mouseout",function(d,i,j){d3.select(this).classed("hover",false);dispatch.elementMouseout({value:getY(d,i),point:d,series:data[j],pointIndex:i,seriesIndex:j,e:d3.event})}).on("mousemove",function(d,i,j){dispatch.elementMousemove({point:d,pointIndex:i,pos:[d3.event.pageX,d3.event.pageY],id:id})}).on("click",function(d,i,j){dispatch.elementClick({value:getY(d,i),point:d,series:data[j],pos:[x(getX(d,i))+x.rangeBand()*(stacked?data.length/2:j+.5)/data.length,y(getY(d,i)+(stacked?d.y0:0))],pointIndex:i,seriesIndex:j,e:d3.event});d3.event.stopPropagation()}).on("dblclick",function(d,i,j){dispatch.elementDblClick({value:getY(d,i),point:d,series:data[j],pos:[x(getX(d,i))+x.rangeBand()*(stacked?data.length/2:j+.5)/data.length,y(getY(d,i)+(stacked?d.y0:0))],pointIndex:i,seriesIndex:j,e:d3.event});d3.event.stopPropagation()});if(stacked){bars.attr("transform",function(d,i){var xScalar=d.active&&d.active==="active"?x.rangeBand()*.1:0;var trans={x:Math.round(x(getX(d,i))-xScalar),y:Math.round(y(d.y1))};return"translate("+trans[valX]+","+trans[valY]+")"}).select("rect").attr(valY,function(d,i){return vertical?getY(d,i)<0?2:-2:getY(d,i)<0?-2:2}).attr(valX,0).attr(dimY,barLength).attr(dimX,function(d,i){var xScalar=d.active&&d.active==="active"?1.2:1;return x.rangeBand()*xScalar})}else{bars.attr("transform",function(d,i,j){var xScalar=d.active&&d.active==="active"?x.rangeBand()*.1/data.length:0;var trans={x:Math.round(j*barThickness()+x(getX(d,i))-xScalar),y:Math.round(getY(d,i)<0?vertical?y(0):y(getY(d,i)):vertical?y(getY(d,i)):y(0))};return"translate("+trans[valX]+","+trans[valY]+")"}).select("rect").attr(valY,function(d,i){return vertical?getY(d,i)<0?2:-2:getY(d,i)<0?-2:2}).attr(valX,0).attr(dimY,barLength).attr(dimX,function(d,i){var xScalar=d.active&&d.active==="active"?1.2:1;return Math.round(x.rangeBand()*xScalar/data.length)})}barsEnter.append("text").attr("class","nv-label-value");var barText=bars.select(".nv-label-value");barText.text(function(d,i){return showValues?valueFormat(getY(d,i)):""}).attr("fill-opacity",0).attr("stroke-opacity-opacity",0);if(showValues){var valueBox=barText[0][0].getBoundingClientRect(),valueDim=vertical?valueBox.height:valueBox.width;barText.attr("text-anchor",function(d,i){var anchor="middle",negative=getY(d,i)<0;if(vertical&&stacked){anchor="middle"}else{switch(showValues){case"start":anchor=negative?"end":"start";break;case"middle":anchor="middle";break;case"end":anchor=negative?"start":"end";break;case"top":default:anchor=vertical?negative?"end":"start":stacked?negative?"start":"end":negative?"end":"start";break}anchor=direction==="rtl"&&anchor!=="middle"?anchor==="start"?"end":"start":anchor}return anchor}).attr("dy",function(d,i){var dy=0,negative=getY(d,i)<0;if(stacked&&vertical){switch(showValues){case"start":dy=negative?"0.71em":0;break;case"middle":dy="0.35em";break;case"top":case"end":default:dy=negative?0:"0.71em";break}}else{dy="0.35em"}return dy}).attr("x",function(d,i){var offset=0,negative=getY(d,i)<0;if(vertical&&stacked){offset=barThickness()/2}else{switch(showValues){case"start":offset=barLength(d,i)*(negative?0:-1)+6*(negative?-1:1);break;case"middle":offset=-barLength(d,i)/2;break;case"end":offset=barLength(d,i)*(negative?-1:0)+4*(negative?1:-1);break;case"top":default:offset=barLength(d,i)*(negative?-1:0)+4*(negative?-1:1)*(stacked?-1:1);break}if(!vertical){offset+=barLength(d,i)}}return offset}).attr("y",function(d,i){var offset=0,negative=getY(d,i)<0;if(vertical&&stacked){switch(showValues){case"start":offset=barLength(d,i)*(negative?0:1)+6*(negative?1:-1);break;case"middle":offset=barLength(d,i)/2+(negative?1:-1);break;case"end":case"top":default:offset=barLength(d,i)*(negative?1:0)+4*(negative?-1:1);break}}else{offset=barThickness()/2}return offset}).attr("transform","rotate("+(!stacked&&vertical?-90:0)+" 0,0)").style("fill",function(d,i,j){if(!stacked&&(showValues==="top"||showValues===true)){return"#000"}var backColor=d3.select(this.previousSibling).style("fill"),textColor=nv.utils.getTextContrast(backColor,i);return textColor}).attr("fill-opacity",function(d,i){var barHeight=barLength(d,i);return getY(d,i)===0||barHeight<valueDim?0:1}).attr("stroke-opacity",function(d,i){var barHeight=barLength(d,i);return getY(d,i)===0||barHeight<valueDim?0:1})}x0=x.copy();y0=y.copy()});return chart}chart.dispatch=dispatch;chart.color=function(_){if(!arguments.length){return color}color=_;return chart};chart.fill=function(_){if(!arguments.length){return fill}fill=_;return chart};chart.classes=function(_){if(!arguments.length){return classes}classes=_;return chart};chart.gradient=function(_){if(!arguments.length){return gradient}gradient=_;return chart};chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}for(var prop in _){if(_.hasOwnProperty(prop)){margin[prop]=_[prop]}}return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.forceY=function(_){if(!arguments.length){return forceY}forceY=_;return chart};chart.stacked=function(_){if(!arguments.length){return stacked}stacked=_;return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.barColor=function(_){if(!arguments.length){return barColor}barColor=nv.utils.getColor(_);return chart};chart.disabled=function(_){if(!arguments.length){return disabled}disabled=_;return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.delay=function(_){if(!arguments.length){return delay}delay=_;return chart};chart.showValues=function(_){if(!arguments.length){return showValues}showValues=_;return chart};chart.valueFormat=function(_){if(!arguments.length){return valueFormat}valueFormat=_;return chart};chart.withLine=function(_){if(!arguments.length){return withLine}withLine=_;return chart};chart.vertical=function(_){if(!arguments.length){return vertical}vertical=_;return chart};chart.baseDimension=function(_){if(!arguments.length){return baseDimension}baseDimension=_;return chart};chart.direction=function(_){if(!arguments.length){return direction}direction=_;return chart};return chart};nv.models.multiBarChart=function(){var vertical=true,margin={top:10,right:10,bottom:10,left:10},width=null,height=null,showTitle=false,showControls=false,showLegend=true,direction="ltr",tooltip=null,tooltips=true,scrollEnabled=true,overflowHandler=function(d){return},x,y,state={},strings={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available."},hideEmptyGroups=true,dispatch=d3.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState");var useScroll=false,scrollOffset=0;var multibar=nv.models.multiBar().stacked(false),xAxis=nv.models.axis().tickSize(0).tickPadding(4).highlightZero(false).showMaxMin(false).tickFormat(function(d){return d}),yAxis=nv.models.axis().tickPadding(4).tickFormat(d3.format("s")),legend=nv.models.legend(),controls=nv.models.legend().color(["#444"]),scroll=nv.models.scroll();var tooltipContent=function(key,x,y,e,graph){return"<h3>"+key+"</h3>"+"<p>"+y+" on "+x+"</p>"};var showTooltip=function(e,offsetElement,groupTotals){var left=e.pos[0],top=e.pos[1],x=groupTotals?(e.point.y*100/groupTotals[e.pointIndex].t).toFixed(1):xAxis.tickFormat()(multibar.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(multibar.y()(e.point,e.pointIndex)),content=tooltipContent(e.series.key,x,y,e,chart),gravity=e.value<0?vertical?"n":"e":vertical?"s":"w";tooltip=nv.tooltip.show([left,top],content,gravity,null,offsetElement)};var seriesClick=function(data,e){return};function chart(selection){selection.each(function(chartData){var that=this,className=vertical?"multibarChart":"multiBarHorizontalChart";var properties=chartData?chartData.properties:{},data=chartData?chartData.data:null,groupLabels=[],groupTotals=[],totalAmount=0,dataBars=[],seriesCount=0,groupCount=0;var container=d3.select(this),availableWidth=(width||parseInt(container.style("width"),10)||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"),10)||400)-margin.top-margin.bottom,innerWidth=innerWidth||availableWidth,innerHeight=innerHeight||availableHeight,innerMargin={top:0,right:0,bottom:0,left:0},trans="";var maxControlsWidth=0,maxLegendWidth=0,widthRatio=0;var minDimension=0,boundsWidth=0,baseDimension=multibar.stacked()?vertical?60:30:20,gap=0;chart.update=function(){container.transition().call(chart)};chart.dataSeriesActivate=function(e){var series=e.series;series.active=!series.active||series.active==="inactive"?"active":"inactive";series.values.map(function(d){d.active=series.active});if(series.active==="active"){data.filter(function(d){return d.active!=="active"}).map(function(d){d.active="inactive";d.values.map(function(d){d.active="inactive"});return d})}if(!data.filter(function(d){return d.active==="active"}).length){data.map(function(d){d.active="";d.values.map(function(d){d.active=""});container.selectAll(".nv-series").classed("nv-inactive",false);return d})}container.call(chart)};chart.container=this;if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){displayNoData();return chart}showTitle=showTitle&&properties.title;var controlsData=[{key:"Grouped",disabled:state.stacked},{key:"Stacked",disabled:!state.stacked}];if(hideEmptyGroups){data.map(function(d){if(!d._values){d._values=d.values}return d})}data.map(function(d,i){d.series=i;d.total=d3.sum(d.values,function(d){return d.y});if(!d.total){d.disabled=true}});groupTotals=properties.values.map(function(d,i){d.t=d3.sum(data.map(function(m,j){if(m.disabled){return 0}return(hideEmptyGroups?m._values:m.values).filter(function(v,k){return multibar.x()(v,k)===d.group}).map(function(v,k){return multibar.y()(v,k)})}));return d});totalAmount=d3.sum(groupTotals,function(d){return d.t});groupLabels=properties.labels.filter(function(d,i){return hideEmptyGroups?groupTotals[i].t!==0:true}).map(function(d){return d.l});dataBars=data.filter(function(d,i){return!d.disabled&&(!d.type||d.type==="bar")});if(hideEmptyGroups){dataBars.map(function(d,i){d.values=d._values.filter(function(d,i){return groupTotals[i].t!==0}).map(function(m,j){return{series:d.series,x:j+1,y:m.y,y0:m.y0,active:typeof d.active!=="undefined"?d.active:""}});return d})}if(!totalAmount){displayNoData();return chart}else{container.selectAll(".nv-noData").remove()}if(!dataBars.length){dataBars=[{values:[]}]}state.disabled=data.map(function(d){return!!d.disabled});state.stacked=multibar.stacked();groupCount=groupLabels.length;seriesCount=dataBars.length;boundsWidth=state.stacked?baseDimension:baseDimension*seriesCount+baseDimension,gap=baseDimension*(state.stacked?.25:1);minDimension=groupCount*boundsWidth+gap;useScroll=minDimension>(vertical?innerWidth:innerHeight);x=multibar.xScale();y=multibar.yScale();xAxis.orient(vertical?"bottom":"left").scale(x).tickFormat(function(d,i){return groupLabels[i]||"undefined"});yAxis.orient(vertical?"left":"bottom").scale(y);var wrap=container.selectAll(".nvd3.nv-wrap").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap").append("g"),g=wrap.select("g").attr("class","nv-chartWrap");wrap.attr("class","nvd3 nv-wrap nv-"+className);gEnter.append("defs");gEnter.append("g").attr("class","nv-scroll-background");gEnter.append("g").attr("class","nv-titleWrap");var titleWrap=g.select(".nv-titleWrap");gEnter.append("g").attr("class","nv-y nv-axis");var yAxisWrap=g.select(".nv-y.nv-axis");gEnter.append("g").attr("class","nv-scroll-wrap");var scrollWrap=g.select(".nv-scroll-wrap");gEnter.select(".nv-scroll-wrap").append("g").attr("class","nv-x nv-axis");var xAxisWrap=g.select(".nv-x.nv-axis");gEnter.select(".nv-scroll-wrap").append("g").attr("class","nv-barsWrap");var barsWrap=g.select(".nv-barsWrap");gEnter.append("g").attr("class","nv-controlsWrap");var controlsWrap=g.select(".nv-controlsWrap");gEnter.append("g").attr("class","nv-legendWrap");var legendWrap=g.select(".nv-legendWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(showTitle){titleWrap.select(".nv-title").remove();titleWrap.append("text").attr("class","nv-title").attr("x",direction==="rtl"?availableWidth:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").text(properties.title).attr("stroke","none").attr("fill","black");innerMargin.top+=parseInt(g.select(".nv-title").node().getBoundingClientRect().height/1.15,10)+parseInt(g.select(".nv-title").style("margin-top"),10)+parseInt(g.select(".nv-title").style("margin-bottom"),10)}if(showControls){controls.id("controls_"+chart.id()).strings(chart.strings().controls).margin({top:10,right:10,bottom:10,left:10}).align("left").height(availableHeight-innerMargin.top);controlsWrap.datum(controlsData).call(controls);maxControlsWidth=controls.calculateWidth()}if(showLegend){if(multibar.barColor()){data.forEach(function(series,i){series.color=d3.rgb("#ccc").darker(i*1.5).toString()})}legend.id("legend_"+chart.id()).strings(chart.strings().legend).margin({top:10,right:10,bottom:10,left:10}).align("right").height(availableHeight-innerMargin.top);legendWrap.datum(data).call(legend);maxLegendWidth=legend.calculateWidth()}widthRatio=availableWidth/(maxControlsWidth+maxLegendWidth);maxControlsWidth=Math.floor(maxControlsWidth*widthRatio);maxLegendWidth=Math.floor(maxLegendWidth*widthRatio);if(showControls){controls.arrange(maxControlsWidth);maxLegendWidth=availableWidth-controls.width()}if(showLegend){legend.arrange(maxLegendWidth);maxControlsWidth=availableWidth-legend.width()}if(showControls){controlsWrap.attr("transform","translate("+(direction==="rtl"?availableWidth-controls.width():0)+","+innerMargin.top+")")}if(showLegend){legendWrap.attr("transform","translate("+(direction==="rtl"?0:availableWidth-legend.width())+","+innerMargin.top+")")}innerMargin.top+=Math.max(legend.height(),controls.height())+4;innerHeight=availableHeight-innerMargin.top-innerMargin.bottom;function getDimension(d){if(d==="width"){return vertical&&scrollEnabled?Math.max(innerWidth,minDimension):innerWidth}else if(d==="height"){return!vertical&&scrollEnabled?Math.max(innerHeight,minDimension):innerHeight}else{return 0}}function displayNoData(){container.select(".nvd3.nv-wrap").remove();var noDataText=container.selectAll(".nv-noData").data([chart.strings().noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d})}multibar.vertical(vertical).baseDimension(baseDimension).disabled(data.map(function(series){return series.disabled})).width(getDimension("width")).height(getDimension("height")).clipEdge(false);barsWrap.data([dataBars]).call(multibar);yAxisWrap.call(yAxis);innerMargin[yAxis.orient()]+=vertical?yAxis.width():yAxis.height();innerWidth=availableWidth-innerMargin.left-innerMargin.right;innerHeight=availableHeight-innerMargin.top-innerMargin.bottom;multibar.resetDimensions(getDimension("width"),getDimension("height"));multibar.resetScale();xAxisWrap.call(xAxis);innerMargin[xAxis.orient()]+=vertical?xAxis.height():xAxis.width();innerWidth=availableWidth-innerMargin.left-innerMargin.right;innerHeight=availableHeight-innerMargin.top-innerMargin.bottom;multibar.resetDimensions(getDimension("width"),getDimension("height"));multibar.resetScale();scrollWrap.attr("transform","translate("+innerMargin.left+","+innerMargin.top+")");barsWrap.transition().call(multibar);trans="translate(";trans+=vertical?0:xAxis.orient()==="left"?0:innerWidth;trans+=",";trans+=vertical?xAxis.orient()==="bottom"?innerHeight:0:0;trans+=")";xAxisWrap.attr("transform",trans).transition().call(xAxis);xAxisWrap.select(".nv-axislabel").attr("x",(vertical?innerWidth:-innerHeight)/2);trans="translate(";trans+=innerMargin.left+(vertical?yAxis.orient()==="left"?0:innerWidth:0);trans+=",";trans+=innerMargin.top+(vertical?0:yAxis.orient()==="bottom"?innerHeight:0);trans+=")";yAxis.tickSize(vertical?-innerWidth:-innerHeight,0);yAxisWrap.attr("transform",trans).transition().call(yAxis);if(scrollEnabled){var diff=(vertical?innerWidth:innerHeight)-minDimension,panMultibar=function(){dispatch.tooltipHide(d3.event);scrollOffset=scroll.pan(diff);xAxisWrap.select(".nv-axislabel").attr("x",(vertical?innerWidth-scrollOffset*2:scrollOffset*2-innerHeight)/2)};scroll.id(chart.id()).enable(useScroll).vertical(vertical).width(innerWidth).height(innerHeight).margin(innerMargin).minDimension(minDimension).panHandler(panMultibar);scroll(g,gEnter,scrollWrap,xAxis);scroll.init(scrollOffset,overflowHandler);scroll.panHandler()()}legend.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;if(hideEmptyGroups){data.map(function(m,j){m._values.map(function(v,k){v.disabled=k===i?d.disabled:v.disabled?true:false;return v});return m})}if(!data.filter(function(d){return!d.disabled}).length){data.map(function(d){d.disabled=false;g.selectAll(".nv-series").classed("disabled",false);return d})}state.disabled=data.map(function(d){return!!d.disabled});dispatch.stateChange(state);container.transition().call(chart)});controls.dispatch.on("legendClick",function(d,i){if(!d.disabled){return}controlsData=controlsData.map(function(s){s.disabled=true;return s});d.disabled=false;switch(d.key){case"Grouped":multibar.stacked(false);break;case"Stacked":multibar.stacked(true);break}state.stacked=multibar.stacked();dispatch.stateChange(state);container.transition().call(chart)});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode,groupTotals)}});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});dispatch.on("tooltipMove",function(e){if(tooltip){nv.tooltip.position(tooltip,e.pos,vertical?"s":"w")}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i];
});state.disabled=e.disabled}if(typeof e.stacked!=="undefined"){multibar.stacked(e.stacked);state.stacked=e.stacked}container.transition().call(chart)});dispatch.on("chartClick",function(e){if(controls.enabled()){controls.dispatch.closeMenu(e)}if(legend.enabled()){legend.dispatch.closeMenu(e)}});multibar.dispatch.on("elementClick",function(e){seriesClick(data,e)})});return chart}multibar.dispatch.on("elementMouseover.tooltip",function(e){dispatch.tooltipShow(e)});multibar.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});multibar.dispatch.on("elementMousemove.tooltip",function(e){dispatch.tooltipMove(e)});chart.dispatch=dispatch;chart.multibar=multibar;chart.legend=legend;chart.controls=controls;chart.xAxis=xAxis;chart.yAxis=yAxis;d3.rebind(chart,multibar,"id","x","y","xScale","yScale","xDomain","yDomain","forceX","forceY","clipEdge","delay","color","fill","classes","gradient");d3.rebind(chart,multibar,"stacked","showValues","valueFormat");d3.rebind(chart,xAxis,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks");chart.colorData=function(_){var type=arguments[0],params=arguments[1]||{};var color=function(d,i){return nv.utils.defaultColor()(d,d.series)};var classes=function(d,i){return"nv-group nv-series-"+d.series};switch(type){case"graduated":color=function(d,i){return d3.interpolateHsl(d3.rgb(params.c1),d3.rgb(params.c2))(d.series/params.l)};break;case"class":color=function(){return"inherit"};classes=function(d,i){var iClass=d.series*(params.step||1)%14;iClass=(iClass>9?"":"0")+iClass;return"nv-group nv-series-"+d.series+" nv-fill"+iClass};break;case"data":color=function(d,i){return d.classes?"inherit":d.color||nv.utils.defaultColor()(d,d.series)};classes=function(d,i){return"nv-group nv-series-"+d.series+(d.classes?" "+d.classes:"")};break}var fill=!params.gradient?color:function(d,i){var p={orientation:params.orientation||(vertical?"vertical":"horizontal"),position:params.position||"middle"};return multibar.gradient(d,d.series,p)};multibar.color(color);multibar.fill(fill);multibar.classes(classes);legend.color(color);legend.classes(classes);return chart};chart.margin=function(_){if(!arguments.length){return margin}for(var prop in _){if(_.hasOwnProperty(prop)){margin[prop]=_[prop]}}return chart};chart.vertical=function(_){if(!arguments.length){return vertical}vertical=_;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.showTitle=function(_){if(!arguments.length){return showTitle}showTitle=_;return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltipContent}tooltipContent=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.strings=function(_){if(!arguments.length){return strings}for(var prop in _){if(_.hasOwnProperty(prop)){strings[prop]=_[prop]}}return chart};chart.allowScroll=function(_){if(!arguments.length){return scrollEnabled}scrollEnabled=_;return chart};chart.overflowHandler=function(_){if(!arguments.length){return overflowHandler}overflowHandler=d3.functor(_);return chart};chart.seriesClick=function(_){if(!arguments.length){return seriesClick}seriesClick=_;return chart};chart.hideEmptyGroups=function(_){if(!arguments.length){return hideEmptyGroups}hideEmptyGroups=_;return chart};chart.direction=function(_){if(!arguments.length){return direction}direction=_;multibar.direction(_);xAxis.direction(_);yAxis.direction(_);legend.direction(_);controls.direction(_);return chart};return chart};nv.models.paretoChart=function(){var margin={top:10,right:10,bottom:10,left:10},width=null,height=null,getX=function(d){return d.x},getY=function(d){return d.y},showTitle=false,showLegend=true,tooltip=null,tooltips=true,direction="ltr",tooltipBar=function(key,x,y,e,graph){return"<p><b>"+key+"</b></p>"+"<p><b>"+y+"</b></p>"+"<p><b>"+x+"%</b></p>"},tooltipLine=function(key,x,y,e,graph){return"<p><p>"+key+": <b>"+y+"</b></p>"},tooltipQuota=function(key,x,y,e,graph){return"<p>"+e.key+": <b>"+y+"</b></p>"},yAxisTickFormat=function(d){return d3.format(",.2s")(d)},quotaTickFormat=function(d){return d3.format(",.3s")(d)},x,y,strings={barlegend:{close:"Hide bar legend",open:"Show bar legend"},linelegend:{close:"Hide line legend",open:"Show line legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available."},dispatch=d3.dispatch("chartClick","tooltipShow","tooltipHide","tooltipMove");var multibar=nv.models.multiBar().stacked(true).clipEdge(false).withLine(true),lines1=nv.models.line().color(function(d,i){return"#FFF"}).fill(function(d,i){return"#FFF"}).useVoronoi(false),lines2=nv.models.line().useVoronoi(false),xAxis=nv.models.axis().orient("bottom").tickSize(0).tickPadding(4).wrapTicks(true).highlightZero(false).showMaxMin(false).tickFormat(function(d){return d}),yAxis=nv.models.axis().orient("left").tickPadding(7).showMaxMin(false),barLegend=nv.models.legend().align("left").position("middle"),lineLegend=nv.models.legend().align("right").position("middle");var showTooltip=function(e,offsetElement,dataGroup){var left=e.pos[0],top=e.pos[1],per=(e.point.y*100/dataGroup[e.pointIndex].t).toFixed(1),amt=yAxis.tickFormat()(lines2.y()(e.point,e.pointIndex)),content=e.series.type==="bar"?tooltipBar(e.series.key,per,amt,e,chart):tooltipLine(e.series.key,per,amt,e,chart);tooltip=nv.tooltip.show([left,top],content,"s",null,offsetElement)};var showQuotaTooltip=function(e,offsetElement){var left=e.pos[0],top=e.pos[1],amt=d3.format(",.2s")(e.val),content=tooltipQuota(e.key,0,amt,e,chart);tooltip=nv.tooltip.show([left,top],content,"s",null,offsetElement)};var barClick=function(data,e,container){var d=e.series,selectedSeries=e.seriesIndex;d.disabled=!d.disabled;if(!chart.stacked()){data.filter(function(d){return d.series===selectedSeries&&d.type==="line"}).map(function(d){d.disabled=!d.disabled;return d})}if(!data.filter(function(d){return!d.disabled&&d.type==="bar"}).length){data.map(function(d){d.disabled=false;container.selectAll(".nv-series").classed("disabled",false);return d})}container.call(chart)};var getAbsoluteXY=function(element){var viewportElement=document.documentElement,box=element.getBoundingClientRect(),scrollLeft=viewportElement.scrollLeft+document.body.scrollLeft,scrollTop=viewportElement.scrollTop+document.body.scrollTop,x=box.left+scrollLeft,y=box.top+scrollTop;return{x:x,y:y}};function chart(selection){selection.each(function(chartData){var properties=chartData.properties,data=chartData.data,container=d3.select(this),that=this,availableWidth=(width||parseInt(container.style("width"),10)||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"),10)||400)-margin.top-margin.bottom,innerWidth=availableWidth,innerHeight=availableHeight,innerMargin={top:0,right:0,bottom:0,left:0},maxBarLegendWidth=0,maxLineLegendWidth=0,widthRatio=0;chart.update=function(){container.call(chart)};chart.container=this;if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([chart.strings().noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}var dataBars=data.filter(function(d){return!d.disabled&&(!d.type||d.type==="bar")}),dataLines=data.filter(function(d){return!d.disabled&&d.type==="line"}).map(function(lineData){if(!multibar.stacked()){lineData.values=lineData.valuesOrig.map(function(v,i){return{series:v.series,x:v.x+v.series*.25-i*.25,y:v.y}})}else{lineData.values.map(function(v){v.y=0});dataBars.map(function(v,i){v.values.map(function(v,i){lineData.values[i].y+=v.y})});lineData.values.map(function(v,i){if(i>0){v.y+=lineData.values[i-1].y}})}return lineData}),dataGroup=properties.groupData,quotaValue=properties.quota||0,quotaLabel=properties.quotaLabel||"",targetQuotaValue=properties.targetQuota||0,targetQuotaLabel=properties.targetQuotaLabel||"";dataBars=dataBars.length?dataBars:[{values:[]}];dataLines=dataLines.length?dataLines:[{values:[]}];var lineLegendData=[{key:quotaLabel,type:"dash",color:"#444",values:{series:0,x:0,y:0}}];if(targetQuotaValue>0){lineLegendData.push({key:targetQuotaLabel,type:"dash",color:"#777",values:{series:0,x:0,y:0}})}var seriesX=data.filter(function(d){return!d.disabled}).map(function(d){return d.valuesOrig.map(function(d,i){return getX(d,i)})});var seriesY=data.map(function(d){return d.valuesOrig.map(function(d,i){return getY(d,i)})});x=multibar.xScale();y=multibar.yScale();xAxis.scale(x);yAxis.scale(y).tickFormat(yAxisTickFormat);if(dataGroup.length){xAxis.tickFormat(function(d,i){return dataGroup[i]?dataGroup[i].l:"asfd"})}var wrap=container.selectAll("g.nv-wrap.nv-multiBarWithLegend").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarWithLegend").append("g"),g=wrap.select("g").attr("class","nv-chartWrap");gEnter.append("rect").attr("class","nv-background").attr("x",-margin.left).attr("y",-margin.top).attr("width",availableWidth+margin.left+margin.right).attr("height",availableHeight+margin.top+margin.bottom).attr("fill","#FFF");gEnter.append("g").attr("class","nv-titleWrap");var titleWrap=g.select(".nv-titleWrap");gEnter.append("g").attr("class","nv-x nv-axis");var xAxisWrap=g.select(".nv-x.nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");var yAxisWrap=g.select(".nv-y.nv-axis");gEnter.append("g").attr("class","nv-barsWrap");var barsWrap=g.select(".nv-barsWrap");gEnter.append("g").attr("class","nv-quotaWrap");var quotaWrap=g.select(".nv-quotaWrap");gEnter.append("g").attr("class","nv-linesWrap1");var linesWrap1=g.select(".nv-linesWrap1");gEnter.append("g").attr("class","nv-linesWrap2");var linesWrap2=g.select(".nv-linesWrap2");gEnter.append("g").attr("class","nv-legendWrap nv-barLegend");var barLegendWrap=g.select(".nv-legendWrap.nv-barLegend");gEnter.append("g").attr("class","nv-legendWrap nv-lineLegend");var lineLegendWrap=g.select(".nv-legendWrap.nv-lineLegend");wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(showTitle&&properties.title){titleWrap.select(".nv-title").remove();titleWrap.append("text").text(properties.title).attr("class","nv-title").attr("x",direction==="rtl"?availableWidth:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").attr("stroke","none").attr("fill","black");innerMargin.top+=parseInt(g.select(".nv-title").node().getBoundingClientRect().height/1.15,10)+parseInt(g.select(".nv-title").style("margin-top"),10)+parseInt(g.select(".nv-title").style("margin-bottom"),10)}if(showLegend){barLegend.id("barlegend_"+chart.id()).strings(chart.strings().barlegend).margin({top:10,right:10,bottom:10,left:10}).align("left").height(availableHeight-innerMargin.top);barLegendWrap.datum(data.filter(function(d){return d.type==="bar"})).call(barLegend);maxBarLegendWidth=barLegend.calculateWidth();lineLegend.id("linelegend_"+chart.id()).strings(chart.strings().linelegend).margin({top:10,right:10,bottom:10,left:10}).align("right").height(availableHeight-innerMargin.top);lineLegendWrap.datum(data.filter(function(d){return d.type==="line"}).concat(lineLegendData)).call(lineLegend);maxLineLegendWidth=lineLegend.calculateWidth();widthRatio=availableWidth/(maxBarLegendWidth+maxLineLegendWidth);barLegend.arrange(Math.floor(widthRatio*maxBarLegendWidth));lineLegend.arrange(Math.floor(widthRatio*maxLineLegendWidth));barLegendWrap.attr("transform","translate("+(direction==="rtl"?availableWidth-barLegend.width():0)+","+innerMargin.top+")");lineLegendWrap.attr("transform","translate("+(direction==="rtl"?0:availableWidth-lineLegend.width())+","+innerMargin.top+")")}innerMargin.top+=Math.max(barLegend.height(),lineLegend.height())+4;innerHeight=availableHeight-innerMargin.top-innerMargin.bottom;var lx=x.domain(d3.merge(seriesX)).rangeBands([0,availableWidth-margin.left-margin.right],.3),ly=Math.max(d3.max(d3.merge(seriesY)),quotaValue,targetQuotaValue||0),forceY=Math.round(ly*.1)*10,lOffset=lx(1)+lx.rangeBand()/(multibar.stacked()||dataLines.length===1?2:4);multibar.width(innerWidth).height(innerHeight).forceY([0,forceY]).id(chart.id());barsWrap.datum(dataBars).call(multibar);lines1.margin({top:0,right:lOffset,bottom:0,left:lOffset}).width(innerWidth).height(innerHeight).forceY([0,forceY]).useVoronoi(false).id("outline_"+chart.id());lines2.margin({top:0,right:lOffset,bottom:0,left:lOffset}).width(innerWidth).height(innerHeight).forceY([0,forceY]).useVoronoi(false).size(function(){return Math.pow(6,2)*Math.PI}).id("foreground_"+chart.id());linesWrap1.datum(dataLines).call(lines1);linesWrap2.datum(dataLines).call(lines2);xAxisWrap.call(xAxis);yAxisWrap.style("opacity",dataBars.length?1:0).call(yAxis);innerWidth=availableWidth-innerMargin.left-innerMargin.right-yAxis.width();innerHeight=availableHeight-innerMargin.top-innerMargin.bottom-xAxis.height();multibar.width(innerWidth).height(innerHeight);barsWrap.call(multibar);xAxisWrap.call(xAxis);yAxisWrap.call(yAxis);innerMargin[yAxis.orient()]+=yAxis.width();innerWidth=availableWidth-innerMargin.left-innerMargin.right;innerMargin[xAxis.orient()]+=xAxis.height();innerHeight=availableHeight-innerMargin.top-innerMargin.bottom;multibar.width(innerWidth).height(innerHeight);barsWrap.attr("transform","translate("+innerMargin.left+","+innerMargin.top+")").call(multibar);lines1.width(innerWidth).height(innerHeight);lines2.width(innerWidth).height(innerHeight);linesWrap1.attr("transform","translate("+innerMargin.left+","+innerMargin.top+")").call(lines1);linesWrap2.attr("transform","translate("+innerMargin.left+","+innerMargin.top+")").call(lines2);quotaWrap.attr("transform","translate("+innerMargin.left+","+innerMargin.top+")");xAxisWrap.attr("transform","translate("+innerMargin.left+","+(xAxis.orient()==="bottom"?innerHeight+innerMargin.top:innerMargin.top)+")").call(xAxis);yAxis.ticks(innerHeight/100).tickSize(-innerWidth,0);yAxisWrap.attr("transform","translate("+(yAxis.orient()==="left"?innerMargin.left:innerMargin.left+innerWidth)+","+innerMargin.top+")").call(yAxis);quotaWrap.selectAll("line").remove();yAxisWrap.selectAll("text.nv-quotaValue").remove();yAxisWrap.selectAll("text.nv-targetQuotaValue").remove();var tickTextHeight=14;if(targetQuotaValue>0){quotaWrap.append("line").attr("class","nv-quotaLineTarget").attr("x1",0).attr("y1",0).attr("x2",innerWidth).attr("y2",0).attr("transform","translate(0,"+y(targetQuotaValue)+")").style("stroke-dasharray","8, 8");quotaWrap.append("line").datum({key:targetQuotaLabel,val:targetQuotaValue}).attr("class","nv-quotaLineTarget nv-quotaLineBackground").attr("x1",0).attr("y1",0).attr("x2",innerWidth).attr("y2",0).attr("transform","translate(0,"+y(targetQuotaValue)+")");yAxisWrap.append("text").text(chart.quotaTickFormat()(targetQuotaValue)).attr("class","nv-targetQuotaValue").attr("dy",".36em").attr("dx","0").attr("text-anchor",direction==="rtl"?"start":"end").attr("transform","translate("+-yAxis.tickPadding()+","+y(targetQuotaValue)+")");tickTextHeight=Math.round(parseInt(g.select("text.nv-targetQuotaValue").node().getBoundingClientRect().height,10)/1.15);yAxisWrap.selectAll("g.tick").each(function(d,i){if(y(d)<=y(targetQuotaValue)+tickTextHeight&&y(d)>=y(targetQuotaValue)-tickTextHeight){d3.select(this).select("text").style("opacity",0);d3.select(this).select("line").style("opacity",0)}});if(yAxis.showMaxMin){yAxisWrap.selectAll("g.nv-axisMaxMin").each(function(d,i){if(Math.abs(y(d)-y(targetQuotaValue))<=tickTextHeight){d3.select(this).select("text").style("opacity",0)}})}}if(quotaValue>0){quotaWrap.append("line").attr("class","nv-quotaLine").attr("x1",0).attr("y1",0).attr("x2",innerWidth).attr("y2",0).attr("transform","translate(0,"+y(quotaValue)+")").style("stroke-dasharray","8, 8");quotaWrap.append("line").datum({key:quotaLabel,val:quotaValue}).attr("class","nv-quotaLine nv-quotaLineBackground").attr("x1",0).attr("y1",0).attr("x2",innerWidth).attr("y2",0).attr("transform","translate(0,"+y(quotaValue)+")");yAxisWrap.append("text").text(chart.quotaTickFormat()(quotaValue)).attr("class","nv-quotaValue").attr("dy",".36em").attr("dx","0").attr("text-anchor",direction==="rtl"?"start":"end").attr("transform","translate("+-yAxis.tickPadding()+","+y(quotaValue)+")");tickTextHeight=Math.round(parseInt(g.select("text.nv-quotaValue").node().getBoundingClientRect().height,10)/1.15);yAxisWrap.selectAll("g.tick").each(function(d,i){if(y(d)<=y(quotaValue)+tickTextHeight&&y(d)>=y(quotaValue)-tickTextHeight){d3.select(this).select("line").style("opacity",0);d3.select(this).select("text").style("opacity",0)}});if(yAxis.showMaxMin){yAxisWrap.selectAll("g.nv-axisMaxMin").each(function(d,i){if(Math.abs(y(d)-y(quotaValue))<=tickTextHeight){d3.select(this).select("text").style("opacity",0)}})}if(targetQuotaValue>0){if(Math.abs(y(quotaValue)-y(targetQuotaValue))<=tickTextHeight){yAxisWrap.select(".nv-targetQuotaValue").style("opacity",0)}}}quotaWrap.selectAll("line.nv-quotaLineBackground").on("mouseover",function(d){var e={pos:[d3.event.pageX,d3.event.pageY],val:d.val,key:d.key};showQuotaTooltip(e,that.parentNode)}).on("mouseout",function(){dispatch.tooltipHide()}).on("mousemove",function(){dispatch.tooltipMove({pos:[d3.event.pageX,d3.event.pageY]})});barLegend.dispatch.on("legendClick",function(d,i){var selectedSeries=d.series;d.disabled=!d.disabled;if(!chart.stacked()){data.filter(function(d){return d.series===selectedSeries&&d.type==="line"}).map(function(d){d.disabled=!d.disabled;return d})}if(!data.filter(function(d){return!d.disabled&&d.type==="bar"}).length){data.map(function(d){d.disabled=false;g.selectAll(".nv-series").classed("disabled",false);return d})}container.call(chart)});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode,dataGroup)}});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});dispatch.on("tooltipMove",function(e){if(tooltip){nv.tooltip.position(tooltip,e.pos,"s")}});dispatch.on("chartClick",function(e){if(barLegend.enabled()){barLegend.dispatch.closeMenu(e)}if(lineLegend.enabled()){lineLegend.dispatch.closeMenu(e)}});multibar.dispatch.on("elementClick",function(e){barClick(data,e,container)})});return chart}lines2.dispatch.on("elementMouseover.tooltip",function(e){dispatch.tooltipShow(e)});lines2.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});lines2.dispatch.on("elementMousemove",function(e){dispatch.tooltipMove(e)});multibar.dispatch.on("elementMouseover.tooltip",function(e){dispatch.tooltipShow(e)});multibar.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});multibar.dispatch.on("elementMousemove",function(e){dispatch.tooltipMove(e)});chart.dispatch=dispatch;chart.lines1=lines1;chart.lines2=lines2;chart.multibar=multibar;chart.barLegend=barLegend;chart.lineLegend=lineLegend;chart.xAxis=xAxis;chart.yAxis=yAxis;d3.rebind(chart,multibar,"id","x","y","xScale","yScale","xDomain","yDomain","forceX","forceY","clipEdge","color","fill","classes","gradient");d3.rebind(chart,multibar,"stacked","showValues","valueFormat");d3.rebind(chart,xAxis,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks");chart.colorData=function(_){var type=arguments[0],params=arguments[1]||{};var barColor=function(d,i){return nv.utils.defaultColor()(d,d.series)};var barClasses=function(d,i){return"nv-group nv-series-"+d.series};var lineColor=function(d,i){var p=params.lineColor?params.lineColor:{c1:"#1A8221",c2:"#62B464",l:1};return d.color||d3.interpolateHsl(d3.rgb(p.c1),d3.rgb(p.c2))(i/1)};var lineClasses=function(d,i){return"nv-group nv-series-"+d.series};switch(type){case"graduated":barColor=function(d,i){return d3.interpolateHsl(d3.rgb(params.barColor.c1),d3.rgb(params.barColor.c2))(d.series/params.barColor.l)};break;case"class":barColor=function(){return"inherit"};barClasses=function(d,i){var iClass=d.series*(params.step||1)%14;iClass=(iClass>9?"":"0")+iClass;return"nv-group nv-series-"+d.series+" nv-fill"+iClass};lineClasses=function(d,i){var iClass=d.series*(params.step||1)%14;iClass=(iClass>9?"":"0")+iClass;return"nv-group nv-series-"+d.series+" nv-fill"+iClass+" nv-stroke"+iClass};break;case"data":barColor=function(d,i){return d.classes?"inherit":d.color||nv.utils.defaultColor()(d,d.series)};barClasses=function(d,i){return"nv-group nv-series-"+d.series+(d.classes?" "+d.classes:"")};lineClasses=function(d,i){return"nv-group nv-series-"+d.series+(d.classes?" "+d.classes:"")};break}var barFill=!params.gradient?barColor:function(d,i){var p={orientation:params.orientation||"vertical",position:params.position||"middle"};return multibar.gradient(d,d.series,p)};multibar.color(barColor);multibar.fill(barFill);multibar.classes(barClasses);lines2.color(lineColor);lines2.fill(lineColor);lines2.classes(lineClasses);barLegend.color(barColor);barLegend.classes(barClasses);lineLegend.color(lineColor);lineLegend.classes(lineClasses);return chart};chart.x=function(_){if(!arguments.length){return getX}getX=_;lines.x(_);multibar.x(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;lines.y(_);multibar.y(_);return chart};chart.margin=function(_){if(!arguments.length){return margin}for(var prop in _){if(_.hasOwnProperty(prop)){margin[prop]=_[prop]}}return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.showTitle=function(_){if(!arguments.length){return showTitle}showTitle=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.showControls=function(_){if(!arguments.length){return false}return chart};chart.tooltipBar=function(_){if(!arguments.length){return tooltipBar}tooltipBar=_;return chart};chart.tooltipLine=function(_){if(!arguments.length){return tooltipLine}tooltipLine=_;return chart};chart.tooltipQuota=function(_){if(!arguments.length){return tooltipQuota}tooltipQuota=_;return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltipContent}tooltipContent=_;return chart};chart.barClick=function(_){if(!arguments.length){return barClick}barClick=_;return chart};chart.colorFill=function(_){return chart};chart.yAxisTickFormat=function(_){if(!arguments.length){return yAxisTickFormat}yAxisTickFormat=_;return chart};chart.quotaTickFormat=function(_){if(!arguments.length){return quotaTickFormat}quotaTickFormat=_;return chart};chart.strings=function(_){if(!arguments.length){return strings}for(var prop in _){if(_.hasOwnProperty(prop)){strings[prop]=_[prop]}}return chart};chart.direction=function(_){if(!arguments.length){return direction}direction=_;multibar.direction(_);yAxis.direction(_);barLegend.direction(_);lineLegend.direction(_);return chart};return chart};nv.models.pie=function(){var margin={top:0,right:0,bottom:0,left:0},width=500,height=500,getValues=function(d){return d},getX=function(d){return d.key},getY=function(d){return d.value},getDescription=function(d){return d.description},id=Math.floor(Math.random()*1e4),valueFormat=d3.format(",.2f"),showLabels=true,showLeaders=true,pieLabelsOutside=true,donutLabelsOutside=true,labelThreshold=.01,donut=false,labelSunbeamLayout=false,leaderLength=20,textOffset=5,startAngle=false,endAngle=false,donutRatio=.447,durationMs=0,direction="ltr",color=function(d,i){return nv.utils.defaultColor()(d,d.series)},fill=color,classes=function(d,i){return"nv-slice nv-series-"+d.series},dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove");function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);var pie=d3.layout.pie().sort(null).value(function(d){return d.disabled?0:getY(d)});var labelLengths=[];if(showLabels&&pieLabelsOutside){labelLengths=nv.utils.stringSetLengths(data.map(function(d){return d.key}),container,function(d){return d})}var wrap=container.selectAll(".nv-wrap.nv-pie").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-pie nv-chart-"+id);var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");chart.gradient=function(d,i){var params={x:0,y:0,r:pieRadius,s:donut?donutRatio*100+"%":"0%",u:"userSpaceOnUse"};return nv.utils.colorRadialGradient(d,id+"-"+i,params,color(d,i),wrap.select("defs"))};gEnter.append("g").attr("class","nv-pie");wrap.attr("transform","translate("+margin.left+","+margin.top+")");g.select(".nv-pie").attr("transform","translate("+availableWidth/2+","+availableHeight/2+")");container.on("click",function(d,i){dispatch.chartClick({data:d,index:i,pos:d3.event,id:id})});var slices=wrap.select(".nv-pie").selectAll(".nv-slice").data(pie);slices.exit().remove();var ae=slices.enter().append("g").on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({label:getX(d.data),value:getY(d.data),point:d.data,pointIndex:i,pos:[d3.event.pageX,d3.event.pageY],id:id})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout({label:getX(d.data),value:getY(d.data),point:d.data,index:i,id:id})}).on("mousemove",function(d,i){dispatch.elementMousemove({point:d,pointIndex:i,pos:[d3.event.pageX,d3.event.pageY],id:id})}).on("click",function(d,i){dispatch.elementClick({label:getX(d.data),value:getY(d.data),point:d.data,index:i,pos:d3.event,id:id});d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({label:getX(d.data),value:getY(d.data),point:d.data,index:i,pos:d3.event,id:id});d3.event.stopPropagation()});ae.append("path").style("stroke","#ffffff").style("stroke-width",3).style("stroke-opacity",0).each(function(d,i){this._current=d});ae.append("g").attr("transform","translate(0,0)").attr("class","nv-label");ae.select(".nv-label").append("rect").style("fill-opacity",0).style("stroke-opacity",0);ae.select(".nv-label").append("text").style("fill-opacity",0);ae.append("polyline").attr("class","nv-label-leader").style("stroke-opacity",0);var maxWidthRadius=availableWidth/2,maxHeightRadius=availableHeight/2;if(showLabels&&pieLabelsOutside){var widthRadii=[availableWidth/2+leaderLength],heightRadii=[availableHeight/2+leaderLength];slices.select("path").each(function(d,i){if(!labelOpacity(d)){return}var angle=d.startAngle+(d.endAngle-d.startAngle)/2,sin=Math.abs(Math.sin(angle)),cos=Math.abs(Math.cos(angle)),bW=maxWidthRadius-leaderLength-textOffset-labelLengths[i],bH=maxHeightRadius-7,rW=sin?bW/sin:bW,rH=cos?bH/cos:bH;widthRadii.push(rW);heightRadii.push(rH)});maxWidthRadius=d3.min(widthRadii);maxHeightRadius=d3.min(heightRadii)}var labelRadius=Math.min(maxWidthRadius,maxHeightRadius),pieRadius=labelRadius-(showLabels&&pieLabelsOutside?leaderLength:0);var pieArc=d3.svg.arc().innerRadius(0).outerRadius(pieRadius);if(startAngle){pieArc.startAngle(startAngle)}if(endAngle){pieArc.endAngle(endAngle)}if(donut){pieArc.innerRadius(pieRadius*donutRatio)}var labelArc=d3.svg.arc().innerRadius(0).outerRadius(pieRadius);if(pieLabelsOutside){if(!donut||donutLabelsOutside){labelArc.innerRadius(labelRadius).outerRadius(labelRadius)}else{labelArc.outerRadius(pieRadius*donutRatio)}}slices.classed("nv-active",function(d){return d.data.active==="active"}).classed("nv-inactive",function(d){return d.data.active==="inactive"}).attr("class",function(d){return classes(d.data,d.data.series)}).attr("fill",function(d){return fill(d.data,d.data.series)});slices.select("path").attr("d",pieArc).style("stroke-opacity",function(d){return d.startAngle===d.endAngle?0:1});if(showLabels){slices.select(".nv-label").attr("transform",function(d){if(labelSunbeamLayout){d.outerRadius=pieRadius+10;d.innerRadius=pieRadius+15;var rotateAngle=(d.startAngle+d.endAngle)/2*(180/Math.PI);rotateAngle+=90*alignedRight(d);return"translate("+labelArc.centroid(d)+") rotate("+rotateAngle+")"}else{var labelsPosition=labelArc.centroid(d),leadOffset=showLeaders?(leaderLength+textOffset)*alignedRight(d):0;return"translate("+[labelsPosition[0]+leadOffset,labelsPosition[1]]+")"}});slices.select(".nv-label text").text(function(d){return labelOpacity(d)?getX(d.data):""}).attr("dy",".35em").style("fill","#555").style("fill-opacity",labelOpacity).style("text-anchor",function(d){var anchor=alignedRight(d)===1?"start":"end";if(!pieLabelsOutside){anchor="middle"}anchor=direction==="rtl"?anchor==="start"?"end":"start":anchor;return anchor});if(!pieLabelsOutside){slices.select(".nv-label").each(function(d){if(!labelOpacity(d)){return}var slice=d3.select(this),textBox=slice.select("text").node().getBoundingClientRect();slice.select("rect").attr("rx",3).attr("ry",3).attr("width",textBox.width+10).attr("height",textBox.height+10).attr("transform",function(){return"translate("+[textBox.x-5,textBox.y-5]+")"}).style("fill","#fff").style("fill-opacity",labelOpacity)})}else if(showLeaders){slices.select(".nv-label-leader").attr("points",function(d){if(!labelOpacity(d)){return"0,0 0,0"}var leadOffset=showLeaders?leaderLength*alignedRight(d):0,outerArcPoints=d3.svg.arc().innerRadius(pieRadius).outerRadius(pieRadius).centroid(d),labelArcPoints=labelArc.centroid(d),leadArcPoints=[labelArcPoints[0]+leadOffset,labelArcPoints[1]];return outerArcPoints+" "+labelArcPoints+" "+leadArcPoints}).style("stroke","#aaa").style("fill","none").style("stroke-opacity",labelOpacity)}}else{slices.select(".nv-label-leader").style("stroke-opacity",0);slices.select(".nv-label rect").style("fill-opacity",0);slices.select(".nv-label text").style("fill-opacity",0)}function labelOpacity(d){var percent=(d.endAngle-d.startAngle)/(2*Math.PI);return percent>labelThreshold?1:0}function alignedRight(d){return(d.startAngle+d.endAngle)/2<Math.PI?1:-1}function arcTween(d){if(!donut){d.innerRadius=0}var i=d3.interpolate(this._current,d);this._current=i(0);return function(t){var iData=i(t);return pieArc(iData)}}function tweenPie(b){b.innerRadius=0;var i=d3.interpolate({startAngle:0,endAngle:0},b);return function(t){return pieArc(i(t))}}});return chart}chart.dispatch=dispatch;chart.color=function(_){if(!arguments.length){return color}color=_;return chart};chart.fill=function(_){if(!arguments.length){return fill}fill=_;return chart};chart.classes=function(_){if(!arguments.length){return classes}classes=_;return chart};chart.gradient=function(_){if(!arguments.length){return gradient}gradient=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.values=function(_){if(!arguments.length){return getValues}getValues=_;return chart};chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=d3.functor(_);return chart};chart.description=function(_){if(!arguments.length){return getDescription}getDescription=_;
return chart};chart.showLabels=function(_){if(!arguments.length){return showLabels}showLabels=_;return chart};chart.labelSunbeamLayout=function(_){if(!arguments.length){return labelSunbeamLayout}labelSunbeamLayout=_;return chart};chart.donutLabelsOutside=function(_){if(!arguments.length){return donutLabelsOutside}donutLabelsOutside=_;return chart};chart.pieLabelsOutside=function(_){if(!arguments.length){return pieLabelsOutside}pieLabelsOutside=_;return chart};chart.showLeaders=function(_){if(!arguments.length){return showLeaders}showLeaders=_;return chart};chart.donut=function(_){if(!arguments.length){return donut}donut=_;return chart};chart.donutRatio=function(_){if(!arguments.length){return donutRatio}donutRatio=_;return chart};chart.startAngle=function(_){if(!arguments.length){return startAngle}startAngle=_;return chart};chart.endAngle=function(_){if(!arguments.length){return endAngle}endAngle=_;return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.valueFormat=function(_){if(!arguments.length){return valueFormat}valueFormat=_;return chart};chart.labelThreshold=function(_){if(!arguments.length){return labelThreshold}labelThreshold=_;return chart};chart.direction=function(_){if(!arguments.length){return direction}direction=_;return chart};return chart};nv.models.pieChart=function(){var margin={top:10,right:10,bottom:10,left:10},width=null,height=null,showTitle=false,showLegend=true,direction="ltr",hole=false,tooltip=null,durationMs=0,tooltips=true,tooltipContent=function(key,x,y,e,graph){return"<h3>"+key+" - "+x+"</h3>"+"<p>"+y+"</p>"},state={},strings={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available."},dispatch=d3.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState");var pie=nv.models.pie(),legend=nv.models.legend().align("center");var showTooltip=function(e,offsetElement,total){var left=e.pos[0],top=e.pos[1],x=(pie.y()(e.point)*100/total).toFixed(1),y=pie.valueFormat()(pie.y()(e.point)),content=tooltipContent(e.point.key,x,y,e,chart);tooltip=nv.tooltip.show([left,top],content,null,null,offsetElement)};var seriesClick=function(data,e){return};function chart(selection){selection.each(function(chartData){var properties=chartData.properties,data=chartData.data,container=d3.select(this),that=this,availableWidth=(width||parseInt(container.style("width"),10)||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"),10)||400)-margin.top-margin.bottom,total=d3.sum(data.map(function(d){return d.value})),innerWidth=availableWidth,innerHeight=availableHeight,innerMargin={top:0,right:0,bottom:0,left:0};chart.update=function(){container.transition().duration(durationMs).call(chart)};chart.dataSeriesActivate=function(e){var series=e.point;series.active=!series.active||series.active==="inactive"?"active":"inactive";if(series.active==="active"){data.filter(function(d){return d.active!=="active"}).map(function(d){d.active="inactive";return d})}if(!data.filter(function(d){return d.active==="active"}).length){data.map(function(d){d.active="";container.selectAll(".nv-series").classed("nv-inactive",false);return d})}container.call(chart)};chart.container=this;if(!data||!data.length){displayNoData();return chart}var pieData=data.map(function(d,i){d.series=i;if(!d.value){d.disabled=true}return d});var totalAmount=d3.sum(pieData.filter(function(d,i){return!d.disabled}).map(function(d,i){return d.value}));state.disabled=pieData.map(function(d){return!!d.disabled});if(!totalAmount){displayNoData();return chart}else{container.selectAll(".nv-noData").remove()}var wrap=container.selectAll("g.nv-wrap.nv-pieChart").data([pieData]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-pieChart").append("g"),g=wrap.select("g").attr("class","nv-chartWrap");gEnter.append("rect").attr("class","nv-background").attr("x",-margin.left).attr("y",-margin.top).attr("width",availableWidth+margin.left+margin.right).attr("height",availableHeight+margin.top+margin.bottom).attr("fill","#FFF");gEnter.append("g").attr("class","nv-titleWrap");var titleWrap=g.select(".nv-titleWrap");gEnter.append("g").attr("class","nv-pieWrap");var pieWrap=g.select(".nv-pieWrap");gEnter.append("g").attr("class","nv-holeWrap");var holeWrap=g.select(".nv-holeWrap");gEnter.append("g").attr("class","nv-legendWrap");var legendWrap=g.select(".nv-legendWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(showTitle&&properties.title){titleWrap.select(".nv-title").remove();titleWrap.append("text").attr("class","nv-title").attr("x",direction==="rtl"?availableWidth:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").text(properties.title).attr("stroke","none").attr("fill","black");innerMargin.top+=parseInt(g.select(".nv-title").node().getBoundingClientRect().height/1.15,10)+parseInt(g.select(".nv-title").style("margin-top"),10)+parseInt(g.select(".nv-title").style("margin-bottom"),10)}if(showLegend){legend.id("legend_"+chart.id()).strings(chart.strings().legend).margin({top:10,right:10,bottom:10,left:10}).align("center").height(availableHeight-innerMargin.top);legendWrap.datum(pieData).call(legend);legend.arrange(availableWidth);legendWrap.attr("transform","translate(0,"+innerMargin.top+")")}innerMargin.top+=legend.height()+4;innerHeight=availableHeight-innerMargin.top-innerMargin.bottom;innerWidth=availableWidth-innerMargin.left-innerMargin.right;pie.width(innerWidth).height(innerHeight);pieWrap.datum(pieData.filter(function(d){return!d.disabled})).attr("transform","translate("+innerMargin.left+","+innerMargin.top+")").transition().duration(durationMs).call(pie);if(hole&&pie.donut()){holeWrap.select("text").remove();holeWrap.append("text").text(hole).attr("text-anchor","middle").attr("class","nv-pie-hole").attr("dy",".35em").style("fill","#333").style("font-size","32px").style("font-weight","bold");holeWrap.attr("transform","translate("+(innerWidth/2+innerMargin.left)+","+(innerHeight/2+innerMargin.top)+")")}function displayNoData(){container.select(".nvd3.nv-wrap").remove();var noDataText=container.selectAll(".nv-noData").data([chart.strings().noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d})}legend.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;if(!pie.values()(pieData).filter(function(d){return!d.disabled}).length){pie.values()(data).map(function(d){d.disabled=false;wrap.selectAll(".nv-series").classed("disabled",false);return d})}state.disabled=pieData.map(function(d){return!!d.disabled});dispatch.stateChange(state);container.transition().duration(durationMs).call(chart)});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode,total)}});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});dispatch.on("tooltipMove",function(e){if(tooltip){nv.tooltip.position(tooltip,e.pos)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){pieData.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}container.transition().duration(durationMs).call(chart)});dispatch.on("chartClick",function(e){if(legend.enabled()){legend.dispatch.closeMenu(e)}});pie.dispatch.on("elementClick",function(e){seriesClick(data,e)})});return chart}pie.dispatch.on("elementMouseover.tooltip",function(e){dispatch.tooltipShow(e)});pie.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});pie.dispatch.on("elementMousemove.tooltip",function(e){dispatch.tooltipMove(e)});chart.dispatch=dispatch;chart.pie=pie;chart.legend=legend;d3.rebind(chart,pie,"id","x","y","color","fill","classes","gradient");d3.rebind(chart,pie,"valueFormat","values","description","showLabels","showLeaders","donutLabelsOutside","pieLabelsOutside","donut","donutRatio","labelThreshold");chart.colorData=function(_){var type=arguments[0],params=arguments[1]||{};var color=function(d,i){return nv.utils.defaultColor()(d,d.series)};var classes=function(d,i){return"nv-slice nv-series-"+d.series};switch(type){case"graduated":color=function(d,i){return d3.interpolateHsl(d3.rgb(params.c1),d3.rgb(params.c2))(d.series/params.l)};break;case"class":color=function(){return"inherit"};classes=function(d,i){var iClass=d.series*(params.step||1)%14;iClass=(iClass>9?"":"0")+iClass;return"nv-slice nv-series-"+d.series+" nv-fill"+iClass};break;case"data":color=function(d,i){return d.classes?"inherit":d.color||nv.utils.defaultColor()(d,d.series)};classes=function(d,i){return"nv-slice nv-series-"+d.series+(d.classes?" "+d.classes:"")};break}var fill=!params.gradient?color:function(d,i){return pie.gradient(d,d.series)};pie.color(color);pie.fill(fill);pie.classes(classes);legend.color(color);legend.classes(classes);return chart};chart.margin=function(_){if(!arguments.length){return margin}for(var prop in _){if(_.hasOwnProperty(prop)){margin[prop]=_[prop]}}return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.showTitle=function(_){if(!arguments.length){return showTitle}showTitle=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltipContent}tooltipContent=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.hole=function(_){if(!arguments.length){return hole}hole=_;return chart};chart.colorFill=function(_){return chart};chart.strings=function(_){if(!arguments.length){return strings}for(var prop in _){if(_.hasOwnProperty(prop)){strings[prop]=_[prop]}}return chart};chart.seriesClick=function(_){if(!arguments.length){return seriesClick}seriesClick=_;return chart};chart.direction=function(_){if(!arguments.length){return direction}direction=_;pie.direction(_);legend.direction(_);return chart};return chart};nv.models.sparkline=function(){var margin={top:2,right:0,bottom:2,left:0},width=400,height=32,animate=true,x=d3.scale.linear(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},color=nv.utils.getColor(["#000"]),xDomain,yDomain;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);x.domain(xDomain||d3.extent(data,getX)).range([0,availableWidth]);y.domain(yDomain||d3.extent(data,getY)).range([availableHeight,0]);var wrap=container.selectAll("g.nv-wrap.nv-sparkline").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-sparkline");var gEnter=wrapEnter.append("g");var g=wrap.select("g");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var paths=wrap.selectAll("path").data(function(d){return[d]});paths.enter().append("path");paths.exit().remove();paths.style("stroke",function(d,i){return d.color||color(d,i)}).attr("d",d3.svg.line().x(function(d,i){return x(getX(d,i))}).y(function(d,i){return y(getY(d,i))}));var points=wrap.selectAll("circle.nv-point").data(function(data){var yValues=data.map(function(d,i){return getY(d,i)});function pointIndex(index){if(index!=-1){var result=data[index];result.pointIndex=index;return result}else{return null}}var maxPoint=pointIndex(yValues.lastIndexOf(y.domain()[1])),minPoint=pointIndex(yValues.indexOf(y.domain()[0])),currentPoint=pointIndex(yValues.length-1);return[minPoint,maxPoint,currentPoint].filter(function(d){return d!=null})});points.enter().append("circle");points.exit().remove();points.attr("cx",function(d,i){return x(getX(d,d.pointIndex))}).attr("cy",function(d,i){return y(getY(d,d.pointIndex))}).attr("r",2).attr("class",function(d,i){return getX(d,d.pointIndex)==x.domain()[1]?"nv-point nv-currentValue":getY(d,d.pointIndex)==y.domain()[0]?"nv-point nv-minValue":"nv-point nv-maxValue"})});return chart}chart.margin=function(_){if(!arguments.length)return margin;margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length)return width;width=_;return chart};chart.height=function(_){if(!arguments.length)return height;height=_;return chart};chart.x=function(_){if(!arguments.length)return getX;getX=d3.functor(_);return chart};chart.y=function(_){if(!arguments.length)return getY;getY=d3.functor(_);return chart};chart.xScale=function(_){if(!arguments.length)return x;x=_;return chart};chart.yScale=function(_){if(!arguments.length)return y;y=_;return chart};chart.xDomain=function(_){if(!arguments.length)return xDomain;xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length)return yDomain;yDomain=_;return chart};chart.animate=function(_){if(!arguments.length)return animate;animate=_;return chart};chart.color=function(_){if(!arguments.length)return color;color=nv.utils.getColor(_);return chart};return chart};nv.models.sparklinePlus=function(){var sparkline=nv.models.sparkline();var margin={top:15,right:100,bottom:10,left:50},width=null,height=null,x,y,index=[],paused=false,xTickFormat=d3.format(",r"),yTickFormat=d3.format(",.2f"),showValue=true,alignValue=true,rightAlignValue=false,noData="No Data Available.";function chart(selection){selection.each(function(data){var container=d3.select(this);var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;var currentValue=sparkline.y()(data[data.length-1],data.length-1);chart.update=function(){chart(selection)};chart.container=this;if(!data||!data.length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=sparkline.xScale();y=sparkline.yScale();var wrap=container.selectAll("g.nv-wrap.nv-sparklineplus").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-sparklineplus");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-sparklineWrap");gEnter.append("g").attr("class","nv-valueWrap");gEnter.append("g").attr("class","nv-hoverArea");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var sparklineWrap=g.select(".nv-sparklineWrap");sparkline.width(availableWidth).height(availableHeight);sparklineWrap.call(sparkline);var valueWrap=g.select(".nv-valueWrap");var value=valueWrap.selectAll(".nv-currentValue").data([currentValue]);value.enter().append("text").attr("class","nv-currentValue").attr("dx",rightAlignValue?-8:8).attr("dy",".9em").style("text-anchor",rightAlignValue?"end":"start");value.attr("x",availableWidth+(rightAlignValue?margin.right:0)).attr("y",alignValue?function(d){return y(d)}:0).style("fill",sparkline.color()(data[data.length-1],data.length-1)).text(yTickFormat(currentValue));gEnter.select(".nv-hoverArea").append("rect").on("mousemove",sparklineHover).on("click",function(){paused=!paused}).on("mouseout",function(){index=[];updateValueLine()});g.select(".nv-hoverArea rect").attr("transform",function(d){return"translate("+-margin.left+","+-margin.top+")"}).attr("width",availableWidth+margin.left+margin.right).attr("height",availableHeight+margin.top);function updateValueLine(){if(paused)return;var hoverValue=g.selectAll(".nv-hoverValue").data(index);var hoverEnter=hoverValue.enter().append("g").attr("class","nv-hoverValue").style("stroke-opacity",0).style("fill-opacity",0);hoverValue.exit().transition().duration(250).style("stroke-opacity",0).style("fill-opacity",0).remove();hoverValue.attr("transform",function(d){return"translate("+x(sparkline.x()(data[d],d))+",0)"}).transition().duration(250).style("stroke-opacity",1).style("fill-opacity",1);if(!index.length)return;hoverEnter.append("line").attr("x1",0).attr("y1",-margin.top).attr("x2",0).attr("y2",availableHeight);hoverEnter.append("text").attr("class","nv-xValue").attr("x",-6).attr("y",-margin.top).attr("text-anchor","end").attr("dy",".9em");g.select(".nv-hoverValue .nv-xValue").text(xTickFormat(sparkline.x()(data[index[0]],index[0])));hoverEnter.append("text").attr("class","nv-yValue").attr("x",6).attr("y",-margin.top).attr("text-anchor","start").attr("dy",".9em");g.select(".nv-hoverValue .nv-yValue").text(yTickFormat(sparkline.y()(data[index[0]],index[0])))}function sparklineHover(){if(paused)return;var pos=d3.mouse(this)[0]-margin.left;function getClosestIndex(data,x){var distance=Math.abs(sparkline.x()(data[0],0)-x);var closestIndex=0;for(var i=0;i<data.length;i++){if(Math.abs(sparkline.x()(data[i],i)-x)<distance){distance=Math.abs(sparkline.x()(data[i],i)-x);closestIndex=i}}return closestIndex}index=[getClosestIndex(data,Math.round(x.invert(pos)))];updateValueLine()}});return chart}chart.sparkline=sparkline;d3.rebind(chart,sparkline,"x","y","xScale","yScale","color");chart.margin=function(_){if(!arguments.length)return margin;margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length)return width;width=_;return chart};chart.height=function(_){if(!arguments.length)return height;height=_;return chart};chart.xTickFormat=function(_){if(!arguments.length)return xTickFormat;xTickFormat=_;return chart};chart.yTickFormat=function(_){if(!arguments.length)return yTickFormat;yTickFormat=_;return chart};chart.showValue=function(_){if(!arguments.length)return showValue;showValue=_;return chart};chart.alignValue=function(_){if(!arguments.length)return alignValue;alignValue=_;return chart};chart.rightAlignValue=function(_){if(!arguments.length)return rightAlignValue;rightAlignValue=_;return chart};chart.noData=function(_){if(!arguments.length)return noData;noData=_;return chart};return chart};nv.models.stackedArea=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,getX=function(d){return d.x},getY=function(d){return d.y},style="stack",offset="zero",order="default",interpolate="linear",clipEdge=false,x,y,delay=200,scatter=nv.models.scatter(),color=function(d,i){return nv.utils.defaultColor()(d,d.series)},fill=color,classes=function(d,i){return"nv-area nv-area-"+d.series},dispatch=d3.dispatch("tooltipShow","tooltipHide","tooltipMove","areaClick","areaMouseover","areaMouseout","areaMousemove");scatter.size(2.2).sizeDomain([2.2]);function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);x=scatter.xScale();y=scatter.yScale();data=data.map(function(aseries,i){aseries.values=aseries.values.map(function(d,j){d.index=j;d.stackedY=aseries.disabled?0:getY(d,j);return d});return aseries});data=d3.layout.stack().order(order).offset(offset).values(function(d){return d.values}).x(getX).y(function(d){return d.stackedY}).out(function(d,y0,y){d.display={y:y,y0:y0}})(data);var wrap=container.selectAll("g.nv-wrap.nv-stackedarea").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-stackedarea");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");chart.gradient=function(d,i,p){return nv.utils.colorLinearGradient(d,chart.id()+"-"+i,p,color(d,i),wrap.select("defs"))};gEnter.append("g").attr("class","nv-areaWrap");gEnter.append("g").attr("class","nv-scatterWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");scatter.width(availableWidth).height(availableHeight).x(getX).y(function(d){return d.display.y+d.display.y0}).forceY([0]);var scatterWrap=g.select(".nv-scatterWrap").datum(data.filter(function(d){return!d.disabled}));scatterWrap.call(scatter);defsEnter.append("clipPath").attr("id","nv-edge-clip-"+chart.id()).append("rect");wrap.select("#nv-edge-clip-"+chart.id()+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+chart.id()+")":"");var area=d3.svg.area().x(function(d,i){return x(getX(d,i))}).y0(function(d){return y(d.display.y0)}).y1(function(d){return y(d.display.y+d.display.y0)}).interpolate(interpolate);var zeroArea=d3.svg.area().x(function(d,i){return x(getX(d,i))}).y0(function(d){return y(d.display.y0)}).y1(function(d){return y(d.display.y0)});var path=g.select(".nv-areaWrap").selectAll("path.nv-area").data(function(d){return d});path.enter().append("path").on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.areaMouseover({point:d,series:d.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:i});g.select(".nv-chart-"+chart.id()+" .nv-area-"+i).classed("hover",true)}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.areaMouseout({point:d,series:d.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:i});g.select(".nv-chart-"+chart.id()+" .nv-area-"+i).classed("hover",false)}).on("mousemove",function(d,i){dispatch.areaMousemove({point:d,pointIndex:i,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:i})}).on("click",function(d,i){d3.select(this).classed("hover",false);dispatch.areaClick({point:d,series:d.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:i})});path.exit().attr("d",function(d,i){return zeroArea(d.values,i)}).remove();path.attr("class",classes).attr("fill",color).attr("stroke",color);path.attr("d",function(d,i){return area(d.values,i)});scatter.dispatch.on("elementMouseover.area",function(e){g.select(".nv-chart-"+chart.id()+" .nv-area-"+e.seriesIndex).classed("hover",true)});scatter.dispatch.on("elementMouseout.area",function(e){g.select(".nv-chart-"+chart.id()+" .nv-area-"+e.seriesIndex).classed("hover",false)})});return chart}scatter.dispatch.on("elementClick.area",function(e){dispatch.areaClick(e)});scatter.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});scatter.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});chart.dispatch=dispatch;chart.scatter=scatter;d3.rebind(chart,scatter,"interactive","size","id","xScale","yScale","zScale","xDomain","yDomain","sizeDomain","forceX","forceY","forceSize","clipVoronoi","useVoronoi","clipRadius");chart.color=function(_){if(!arguments.length){return color}color=_;scatter.color(color);return chart};chart.fill=function(_){if(!arguments.length){return fill}fill=_;scatter.fill(fill);return chart};chart.classes=function(_){if(!arguments.length){return classes}classes=_;scatter.classes(classes);return chart};chart.gradient=function(_){if(!arguments.length){return gradient}gradient=_;return chart};chart.x=function(_){if(!arguments.length){return getX}getX=d3.functor(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=d3.functor(_);return chart};chart.delay=function(_){if(!arguments.length){return delay}delay=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.offset=function(_){if(!arguments.length){return offset}offset=_;return chart};chart.order=function(_){if(!arguments.length){return order}order=_;return chart};chart.style=function(_){if(!arguments.length){return style}style=_;switch(style){case"stack":chart.offset("zero");chart.order("default");break;case"stream":chart.offset("wiggle");chart.order("inside-out");break;case"stream-center":chart.offset("silhouette");chart.order("inside-out");break;case"expand":chart.offset("expand");chart.order("default");break}return chart};chart.interpolate=function(_){if(!arguments.length){return interpolate}interpolate=_;return interpolate};return chart};nv.models.stackedAreaChart=function(){var margin={top:10,right:10,bottom:10,left:10},width=null,height=null,showTitle=false,showControls=false,showLegend=true,direction="ltr",tooltip=null,tooltips=true,tooltipContent=function(key,x,y,e,graph){return"<h3>"+key+"</h3>"+"<p>"+y+" on "+x+"</p>"},x,y,yAxisTickFormat=d3.format(",.2f"),state={},strings={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available."},dispatch=d3.dispatch("chartClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState");var stacked=nv.models.stackedArea().clipEdge(true),xAxis=nv.models.axis().orient("bottom").tickPadding(4).highlightZero(false).showMaxMin(false).tickFormat(function(d){return d}),yAxis=nv.models.axis().orient("left").tickPadding(4).tickFormat(stacked.offset()==="expand"?d3.format("%"):yAxisTickFormat),legend=nv.models.legend().align("right"),controls=nv.models.legend().align("left").color(["#444"]);stacked.scatter.pointActive(function(d){return!!Math.round(stacked.y()(d)*100)});var showTooltip=function(e,offsetElement){var left=e.pos[0],top=e.pos[1],x=xAxis.tickFormat()(stacked.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(stacked.y()(e.point,e.pointIndex)),content=tooltipContent(e.series.key,x,y,e,chart);tooltip=nv.tooltip.show([left,top],content,null,null,offsetElement)};function chart(selection){selection.each(function(chartData){var properties=chartData.properties,data=chartData.data,container=d3.select(this),that=this,availableWidth=(width||parseInt(container.style("width"),10)||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"),10)||400)-margin.top-margin.bottom,innerWidth=availableWidth,innerHeight=availableHeight,innerMargin={top:0,right:0,bottom:0,left:0},maxControlsWidth=0,maxLegendWidth=0,widthRatio=0;chart.update=function(){container.transition().duration(chart.delay()).call(chart)};chart.container=this;if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([chart.strings().noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}data.map(function(d,i){d.series=i});var dataLines=data.filter(function(d){return!d.disabled});dataLines=dataLines.length?dataLines:[{values:[]}];state.disabled=data.map(function(d){return!!d.disabled});state.style=stacked.style();var controlsData=[{key:"Stacked",disabled:stacked.offset()!=="zero"},{key:"Stream",disabled:stacked.offset()!=="wiggle"},{key:"Expanded",disabled:stacked.offset()!=="expand"}];x=stacked.xScale();y=stacked.yScale();xAxis.scale(x);yAxis.scale(y);var wrap=container.selectAll("g.nv-wrap.nv-stackedAreaChart").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-stackedAreaChart").append("g"),g=wrap.select("g").attr("class","nv-chartWrap");gEnter.append("rect").attr("class","nv-background").attr("x",-margin.left).attr("y",-margin.top).attr("width",availableWidth+margin.left+margin.right).attr("height",availableHeight+margin.top+margin.bottom).attr("fill","#FFF");gEnter.append("g").attr("class","nv-titleWrap");var titleWrap=g.select(".nv-titleWrap");gEnter.append("g").attr("class","nv-x nv-axis");var xAxisWrap=g.select(".nv-x.nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");var yAxisWrap=g.select(".nv-y.nv-axis");gEnter.append("g").attr("class","nv-stackedWrap");var stackedWrap=g.select(".nv-stackedWrap");gEnter.append("g").attr("class","nv-controlsWrap");var controlsWrap=g.select(".nv-controlsWrap");gEnter.append("g").attr("class","nv-legendWrap");var legendWrap=g.select(".nv-legendWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(showTitle&&properties.title){titleWrap.select(".nv-title").remove();titleWrap.append("text").attr("class","nv-title").attr("x",direction==="rtl"?availableWidth:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").text(properties.title).attr("stroke","none").attr("fill","black");innerMargin.top+=parseInt(g.select(".nv-title").node().getBoundingClientRect().height/1.15,10)+parseInt(g.select(".nv-title").style("margin-top"),10)+parseInt(g.select(".nv-title").style("margin-bottom"),10)}if(showControls){controls.id("controls_"+chart.id()).strings(chart.strings().controls).margin({top:10,right:10,bottom:10,left:10}).align("left").height(availableHeight-innerMargin.top);controlsWrap.datum(controlsData).call(controls);maxControlsWidth=controls.calculateWidth()}if(showLegend){legend.id("legend_"+chart.id()).strings(chart.strings().legend).margin({top:10,right:10,bottom:10,left:10}).align("right").height(availableHeight-innerMargin.top);legendWrap.datum(data).call(legend);maxLegendWidth=legend.calculateWidth()}widthRatio=availableWidth/(maxControlsWidth+maxLegendWidth);maxControlsWidth=Math.floor(maxControlsWidth*widthRatio);maxLegendWidth=Math.floor(maxLegendWidth*widthRatio);if(showControls){controls.arrange(maxControlsWidth);maxLegendWidth=availableWidth-controls.width()}if(showLegend){legend.arrange(maxLegendWidth);maxControlsWidth=availableWidth-legend.width()}if(showControls){controlsWrap.attr("transform","translate("+(direction==="rtl"?availableWidth-controls.width():0)+","+innerMargin.top+")")}if(showLegend){legendWrap.attr("transform","translate("+(direction==="rtl"?0:availableWidth-legend.width())+","+innerMargin.top+")")}innerMargin.top+=Math.max(legend.height(),controls.height())+4;innerHeight=availableHeight-innerMargin.top-innerMargin.bottom;stacked.width(innerWidth).height(innerHeight).id(chart.id());stackedWrap.datum(dataLines).call(stacked);xAxisWrap.call(xAxis);innerMargin[xAxis.orient()]+=xAxis.height();innerHeight=availableHeight-innerMargin.top-innerMargin.bottom;yAxisWrap.call(yAxis);innerMargin[yAxis.orient()]+=yAxis.width();innerWidth=availableWidth-innerMargin.left-innerMargin.right;stacked.width(innerWidth).height(innerHeight);stackedWrap.attr("transform","translate("+innerMargin.left+","+innerMargin.top+")").transition().duration(chart.delay()).call(stacked);xAxis.ticks(innerWidth/100).tickSize(-innerHeight,0);xAxisWrap.attr("transform","translate("+innerMargin.left+","+(xAxis.orient()==="bottom"?innerHeight+innerMargin.top:innerMargin.top)+")").transition().call(xAxis);yAxis.ticks(stacked.offset()==="wiggle"?0:innerHeight/36).tickSize(-innerWidth,0);yAxisWrap.attr("transform","translate("+(yAxis.orient()==="left"?innerMargin.left:innerMargin.left+innerWidth)+","+innerMargin.top+")").transition().call(yAxis);stacked.dispatch.on("areaClick.toggle",function(e){if(data.filter(function(d){return!d.disabled}).length===1){data=data.map(function(d){d.disabled=false;return d})}else{data=data.map(function(d,i){d.disabled=i!==e.seriesIndex;return d})}state.disabled=data.map(function(d){return!!d.disabled;
});dispatch.stateChange(state);container.transition().duration(chart.delay()).call(chart)});legend.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;if(!data.filter(function(d){return!d.disabled}).length){data.map(function(d){d.disabled=false;g.selectAll(".nv-series").classed("disabled",false);return d})}state.disabled=data.map(function(d){return!!d.disabled});dispatch.stateChange(state);container.transition().duration(chart.delay()).call(chart)});controls.dispatch.on("legendClick",function(d,i){if(!d.disabled){return}controlsData=controlsData.map(function(s){s.disabled=true;return s});d.disabled=false;switch(d.key){case"Stacked":stacked.style("stack");break;case"Stream":stacked.style("stream");break;case"Expanded":stacked.style("expand");break}state.style=stacked.style();dispatch.stateChange(state);container.transition().duration(chart.delay()).call(chart)});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});dispatch.on("tooltipMove",function(e){if(tooltip){nv.tooltip.position(tooltip,e.pos,"s")}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}if(typeof e.style!=="undefined"){stacked.style(e.style);state.style=e.style}container.transition().duration(chart.delay()).call(chart)});dispatch.on("chartClick",function(e){if(controls.enabled()){controls.dispatch.closeMenu(e)}if(legend.enabled()){legend.dispatch.closeMenu(e)}})});return chart}stacked.dispatch.on("areaMouseover.tooltip",function(e){});stacked.dispatch.on("areaMouseout.tooltip",function(e){});stacked.dispatch.on("areaMousemove.tooltip",function(e){});stacked.dispatch.on("tooltipShow",function(e){dispatch.tooltipShow(e)});stacked.dispatch.on("tooltipHide",function(e){dispatch.tooltipHide(e)});chart.dispatch=dispatch;chart.stacked=stacked;chart.legend=legend;chart.controls=controls;chart.xAxis=xAxis;chart.yAxis=yAxis;d3.rebind(chart,stacked,"id","x","y","xScale","yScale","xDomain","yDomain","forceX","forceY","clipEdge","delay","color","fill","classes","gradient");d3.rebind(chart,stacked,"size","sizeDomain","forceSize","offset","order","style","interactive","useVoronoi","clipVoronoi");d3.rebind(chart,xAxis,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks");chart.colorData=function(_){var type=arguments[0],params=arguments[1]||{};var color=function(d,i){return nv.utils.defaultColor()(d,d.series)};var classes=function(d,i){return"nv-area nv-area-"+d.series};switch(type){case"graduated":color=function(d,i){return d3.interpolateHsl(d3.rgb(params.c1),d3.rgb(params.c2))(d.series/params.l)};break;case"class":color=function(){return"inherit"};classes=function(d,i){var iClass=d.series*(params.step||1)%14;iClass=(iClass>9?"":"0")+iClass;return"nv-area nv-area-"+d.series+" nv-fill"+iClass+" nv-stroke"+iClass};break;case"data":color=function(d,i){return d.color||nv.utils.defaultColor()(d,d.series)};classes=function(d,i){return"nv-area nv-area-"+d.series+(d.classes?" "+d.classes:"")};break}var fill=!params.gradient?color:function(d,i){var p={orientation:params.orientation||"horizontal",position:params.position||"base"};return stacked.gradient(d,d.series,p)};stacked.color(color);stacked.fill(fill);stacked.classes(classes);legend.color(color);legend.classes(classes);return chart};chart.margin=function(_){if(!arguments.length){return margin}for(var prop in _){if(_.hasOwnProperty(prop)){margin[prop]=_[prop]}}return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.showTitle=function(_){if(!arguments.length){return showTitle}showTitle=_;return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltipContent}tooltipContent=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};yAxis.tickFormat=function(_){if(!arguments.length){return yAxisTickFormat}yAxisTickFormat=_;return yAxis};chart.strings=function(_){if(!arguments.length){return strings}for(var prop in _){if(_.hasOwnProperty(prop)){strings[prop]=_[prop]}}return chart};chart.direction=function(_){if(!arguments.length){return direction}direction=_;yAxis.direction(_);legend.direction(_);controls.direction(_);return chart};return chart};nv.models.treemap=function(){var margin={top:20,right:0,bottom:0,left:0},width=0,height=0,x,y,id=Math.floor(Math.random()*1e4),getSize=function(d){return d.size},groupBy=function(d){return d.name},clipEdge=true,groups=[],leafClick=function(){return false},color=function(d,i){return nv.utils.defaultColor()(d,i)},fill=color,classes=function(d,i){return"nv-child"},direction="ltr",dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove");var x0,y0;function chart(selection){selection.each(function(chartData){var data=chartData[0];function reduceGroups(d){var i,l;if(d.children&&groupBy(d)&&groups.indexOf(groupBy(d))===-1){groups.push(groupBy(d));l=d.children.length;for(i=0;i<l;i+=1){reduceGroups(d.children[i])}}}reduceGroups(data);var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this),transitioning;x=d3.scale.linear().domain([0,data.dx]).range([0,availableWidth]);y=d3.scale.linear().domain([0,data.dy]).range([0,availableHeight]);x0=x0||x;y0=y0||y;var wrap=container.selectAll("g.nv-wrap.nv-treemap").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-treemap");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");chart.gradient=function(d,i,p){var iColor=d.parent.colorIndex||groups.indexOf(groupBy(d.parent))||i;return nv.utils.colorLinearGradient(d,id+"-"+i,p,color(d,iColor,groups.length),wrap.select("defs"))};defsEnter.append("clipPath").attr("id","nv-edge-clip-"+id).append("rect");wrap.select("#nv-edge-clip-"+id+" rect").attr("width",width).attr("height",height);g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":"");var grandparent=gEnter.append("g").attr("class","nv-grandparent");grandparent.append("rect").attr("width",width).attr("height",margin.top);grandparent.append("text").attr("x",direction==="rtl"?width-6:6).attr("y",6).attr("dy",".75em");display(data);function display(d){var treemap=d3.layout.treemap().value(getSize).sort(function(a,b){return getSize(a)-getSize(b)}).round(false);layout(d);grandparent.datum(d.parent).on("click",transition).select("text").text(name(d));var g1=gEnter.insert("g",".nv-grandparent").attr("class","nv-depth").attr("height",availableHeight).attr("transform","translate("+margin.left+","+margin.top+")");var g=g1.selectAll("g").data(d.children).enter().append("g");g.filter(function(d){return d.children}).classed("nv-children",true).on("click",transition);g.filter(function(d){return!d.children}).on("click",leafClick);g.on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({point:d,pointIndex:i,pos:[d3.event.pageX,d3.event.pageY],id:id})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout()}).on("mousemove",function(d,i){dispatch.elementMousemove({point:d,pointIndex:i,pos:[d3.event.pageX,d3.event.pageY],id:id})});var child_rects=g.selectAll(".nv-child").data(function(d){return d.children||[d]}).enter().append("rect").attr("class",classes).attr("fill",function(d,i){var iColor=d.parent.colorIndex||groups.indexOf(groupBy(d.parent))||i;return this.getAttribute("fill")||fill(d,iColor,groups.length)}).call(rect);child_rects.on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({label:groupBy(d),value:getSize(d),point:d,pointIndex:i,pos:[d3.event.pageX,d3.event.pageY],id:id})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout()});g.append("rect").attr("class","nv-parent").call(rect);g.append("text").attr("dy",".75em").text(function(d){return groupBy(d)}).call(text);function transition(d){dispatch.elementMouseout();if(transitioning||!d){return}transitioning=true;var g2=display(d),t1=g1.transition().duration(750),t2=g2.transition().duration(750);x.domain([d.x,d.x+d.dx]);y.domain([d.y,d.y+d.dy]);container.style("shape-rendering",null);container.selectAll(".nv-depth").sort(function(a,b){return a.depth-b.depth});g2.selectAll("text").style("fill-opacity",0);t1.selectAll("text").call(text).style("fill-opacity",0);t2.selectAll("text").call(text).style("fill-opacity",1);t1.selectAll("rect").call(rect);t2.selectAll("rect").call(rect);t1.remove().each("end",function(){container.style("shape-rendering","crispEdges");transitioning=false})}function layout(d){if(d.children){treemap.nodes({children:d.children});d.children.forEach(function(c){c.x=d.x+c.x*d.dx;c.y=d.y+c.y*d.dy;c.dx*=d.dx;c.dy*=d.dy;c.parent=d;layout(c)})}}function text(t){t.attr("x",function(d){var xpos=direction==="rtl"?x(d.x+d.dx)-x(d.x)-6:6;return x(d.x)+xpos}).attr("y",function(d){return y(d.y)+6})}function rect(r){r.attr("x",function(d){return x(d.x)}).attr("y",function(d){return y(d.y)}).attr("width",function(d){return x(d.x+d.dx)-x(d.x)}).attr("height",function(d){return y(d.y+d.dy)-y(d.y)})}function name(d){if(d.parent){return name(d.parent)+" / "+groupBy(d)}return groupBy(d)}return g}});return chart}chart.dispatch=dispatch;chart.color=function(_){if(!arguments.length){return color}color=_;return chart};chart.fill=function(_){if(!arguments.length){return fill}fill=_;return chart};chart.classes=function(_){if(!arguments.length){return classes}classes=_;return chart};chart.gradient=function(_){if(!arguments.length){return gradient}gradient=_;return chart};chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!=="undefined"?_.top:margin.top;margin.right=typeof _.right!=="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!=="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!=="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.leafClick=function(_){if(!arguments.length){return leafClick}leafClick=_;return chart};chart.getSize=function(_){if(!arguments.length){return getSize}getSize=_;return chart};chart.groupBy=function(_){if(!arguments.length){return groupBy}groupBy=_;return chart};chart.groups=function(_){if(!arguments.length){return groups}groups=_;return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.direction=function(_){if(!arguments.length){return direction}direction=_;return chart};return chart};nv.models.treemapChart=function(){var margin={top:0,right:10,bottom:10,left:10},width=null,height=null,showTitle=false,showLegend=false,direction="ltr",tooltip=null,tooltips=true,tooltipContent=function(point){var tt="<p>Value: <b>"+d3.format(",.2s")(point.value)+"</b></p>"+"<p>Name: <b>"+point.name+"</b></p>";return tt},colorData="default",colorArray=d3.scale.category20().range().map(function(d){return d}),x,y,strings={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available."},dispatch=d3.dispatch("tooltipShow","tooltipHide","tooltipMove","elementMousemove");var treemap=nv.models.treemap(),legend=nv.models.legend();var showTooltip=function(e,offsetElement){var left=e.pos[0],top=e.pos[1],content=tooltipContent(e.point);tooltip=nv.tooltip.show([left,top],content,null,null,offsetElement)};function chart(selection){selection.each(function(chartData){var data=[chartData];var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"),10)||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"),10)||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(300).call(chart)};chart.container=this;if(!data||!data.length||!data.filter(function(d){return d&&d.children.length}).length){container.select(".nvd3.nv-wrap").remove();var noDataText=container.selectAll(".nv-noData").data([chart.strings().noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}if(colorData==="data"){removeColors(data[0])}var wrap=container.selectAll("g.nv-wrap.nv-treemapWithLegend").data(data);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-treemapWithLegend").append("g");var g=wrap.select("g");gEnter.append("rect").attr("class","nv-background").attr("x",-margin.left).attr("y",-margin.top).attr("width",availableWidth+margin.left+margin.right).attr("height",availableHeight+margin.top+margin.bottom).attr("fill","#FFF");gEnter.append("g").attr("class","nv-treemapWrap");var titleHeight=0,legendHeight=0;if(showLegend){gEnter.append("g").attr("class","nv-legendWrap");legend.id("legend_"+chart.id()).strings(chart.strings().legend).width(availableWidth+margin.left).height(availableHeight);g.select(".nv-legendWrap").datum(data).call(legend);legendHeight=legend.height()+10;if(margin.top!==legendHeight+titleHeight){margin.top=legendHeight+titleHeight;availableHeight=(height||parseInt(container.style("height"),10)||400)-margin.top-margin.bottom}g.select(".nv-legendWrap").attr("transform","translate("+-margin.left+","+-margin.top+")")}if(showTitle&&properties.title){gEnter.append("g").attr("class","nv-titleWrap");g.select(".nv-title").remove();g.select(".nv-titleWrap").append("text").attr("class","nv-title").attr("x",0).attr("y",0).attr("text-anchor","start").text(properties.title).attr("stroke","none").attr("fill","black");titleHeight=parseInt(g.select(".nv-title").style("height"),10)+parseInt(g.select(".nv-title").style("margin-top"),10)+parseInt(g.select(".nv-title").style("margin-bottom"),10);if(margin.top!==titleHeight+legendHeight){margin.top=titleHeight+legendHeight;availableHeight=(height||parseInt(container.style("height"),10)||400)-margin.top-margin.bottom}g.select(".nv-titleWrap").attr("transform","translate(0,"+(-margin.top+parseInt(g.select(".nv-title").style("height"),10))+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");treemap.width(availableWidth).height(availableHeight);var treemapWrap=g.select(".nv-treemapWrap").datum(data.filter(function(d){return!d.disabled}));treemapWrap.transition().call(treemap);legend.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;if(!data.filter(function(d){return!d.disabled}).length){data.map(function(d){d.disabled=false;wrap.selectAll(".nv-series").classed("disabled",false);return d})}container.transition().duration(300).call(chart)});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});function removeColors(d){var i,l;if(d.color&&colorArray.indexOf(d.color)!==-1){colorArray.splice(colorArray.indexOf(d.color),1)}if(d.children){l=d.children.length;for(i=0;i<l;i+=1){removeColors(d.children[i])}}}});return chart}treemap.dispatch.on("elementMouseover",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});treemap.dispatch.on("elementMouseout",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});treemap.dispatch.on("elementMousemove",function(e){dispatch.tooltipMove(e)});dispatch.on("tooltipMove",function(e){if(tooltip){nv.tooltip.position(tooltip,e.pos)}});chart.dispatch=dispatch;chart.legend=legend;chart.treemap=treemap;d3.rebind(chart,treemap,"x","y","xDomain","yDomain","forceX","forceY","clipEdge","id","delay","leafClick","getSize","getName","groups","color","fill","classes","gradient","direction");chart.colorData=function(_){if(!arguments.length){return colorData}var type=arguments[0],params=arguments[1]||{};var color=function(d,i){var c=type==="data"&&d.color?{color:d.color}:{};return nv.utils.getColor(colorArray)(c,i)};var classes=function(d,i){return"nv-child"};switch(type){case"graduated":color=function(d,i,l){return d3.interpolateHsl(d3.rgb(params.c1),d3.rgb(params.c2))(i/l)};break;case"class":color=function(){return"inherit"};classes=function(d,i){var iClass=i*(params.step||1)%14;iClass=(iClass>9?"":"0")+iClass;return"nv-child "+(d.className||"nv-fill"+iClass)};break}var fill=!params.gradient?color:function(d,i){var p={orientation:params.orientation||"horizontal",position:params.position||"base"};return treemap.gradient(d,i,p)};treemap.color(color);treemap.fill(fill);treemap.classes(classes);legend.color(color);legend.classes(classes);colorData=arguments[0];return chart};chart.x=function(_){if(!arguments.length){return getX}getX=_;treemap.x(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;treemap.y(_);return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!=="undefined"?_.top:margin.top;margin.right=typeof _.right!=="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!=="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!=="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.showTitle=function(_){if(!arguments.length){return showTitle}showTitle=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltipContent}tooltipContent=_;return chart};chart.strings=function(_){if(!arguments.length){return strings}for(var prop in _){if(_.hasOwnProperty(prop)){strings[prop]=_[prop]}}return chart};return chart};nv.models.tree=function(){var r=5.5,padding={top:10,right:10,bottom:10,left:10},duration=300,zoomExtents={min:.25,max:2},nodeSize={width:100,height:50},nodeImgPath="../img/",nodeRenderer=function(d){return'<div class="nv-tree-node"></div>'},zoomCallback=function(d){return},horizontal=false;var id=Math.floor(Math.random()*1e4),color=function(d,i){return nv.utils.defaultColor()(d,i)},fill=function(d,i){return color(d,i)},gradient=function(d,i){return color(d,i)},setX=function(d,v){d.x=v},setY=function(d,v){d.y=v},setX0=function(d,v){if(horizontal){d.y0=v}else{d.x0=v}},setY0=function(d,v){if(horizontal){d.x0=v}else{d.y0=v}},getX=function(d){return horizontal?d.y:d.x},getY=function(d){return horizontal?d.x:d.y},getX0=function(d){return horizontal?d.y0:d.x0},getY0=function(d){return horizontal?d.x0:d.y0},getId=function(d){return d.id},fillGradient=function(d,i){return nv.utils.colorRadialGradient(d,i,0,0,"35%","35%",color(d,i),wrap.select("defs"))},useClass=false,valueFormat=d3.format(",.2f"),showLabels=true,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");function chart(selection){selection.each(function(data){var diagonal=d3.svg.diagonal().projection(function(d){return[getX(d),getY(d)]});var zoom=null;chart.setZoom=function(){zoom=d3.behavior.zoom().scaleExtent([zoomExtents.min,zoomExtents.max]).on("zoom",function(){treeWrapper.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")");zoomCallback(d3.event.scale)})};chart.setZoom();var svg=d3.select(this);var availableSize={width:parseInt(svg.style("width"),10)-padding.left-padding.right,height:parseInt(svg.style("height"),10)-padding.top-padding.bottom};var wrap=svg.selectAll(".nv-wrap").data([1]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-treeChart").attr("id","nv-chart-"+id);wrap.call(zoom);wrapEnter.append("defs");var defsEnter=wrap.select("defs");wrapEnter.append("svg:rect").attr("class","nv-chartBackground").attr("width",availableSize.width).attr("height",availableSize.height).attr("transform","translate("+padding.left+","+padding.top+")").style("fill","transparent");var backg=wrap.select(".nv-chartBackground");var gEnter=wrapEnter.append("g").attr("class","nv-chartWrap");var treeWrapper=wrap.select(".nv-chartWrap");gEnter.append("g").attr("class","nv-tree");var treeChart=wrap.select(".nv-tree");var tree=d3.layout.tree().size(null).elementsize([horizontal?nodeSize.height:nodeSize.width,1]).separation(function separation(a,b){return a.parent==b.parent?1:1});data.x0=data.x0||0;data.y0=data.y0||0;var _data=data;var nodes=null;chart.resize=function(){chart.reset();availableSize={width:parseInt(svg.style("width"),10)-padding.left-padding.right,height:parseInt(svg.style("height"),10)-padding.top-padding.bottom};var size=[d3.min(nodes,getX)+d3.max(nodes,getX)+(horizontal?nodeSize.width:0),d3.min(nodes,getY)+d3.max(nodes,getY)+(horizontal?0:nodeSize.height)],xScale=availableSize.width/size[0],yScale=availableSize.height/size[1],scale=d3.min([xScale,yScale]),center=[xScale<yScale?0:(availableSize.width/scale-size[0])/2,xScale>yScale?0:(availableSize.height/scale-size[1])/2],offset=[horizontal?nodeSize.width:padding.left/2,horizontal?padding.top/2:nodeSize.height],translate=[(offset[0]+center[0])*scale,(offset[1]+center[1])*scale];backg.attr("width",availableSize.width).attr("height",availableSize.height);treeChart.attr("transform","translate("+translate+")scale("+scale+")")};chart.orientation=function(orientation){horizontal=orientation==="horizontal"||!horizontal?true:false;tree.elementsize([horizontal?nodeSize.height:nodeSize.width,1]);chart.update(_data)};chart.showall=function(){function expandAll(d){if(d.children&&d.children.length||d._children&&d._children.length){if(d._children&&d._children.length){d.children=d._children;d._children=null}d.children.forEach(expandAll)}}expandAll(_data);chart.update(_data)};chart.reset=function(){chart.setZoom();zoom.translate([0,0]).scale(1);wrap.call(zoom);treeWrapper.attr("transform","translate("+[0,0]+")scale("+1+")")};chart.zoomStep=function(step){var level=zoom.scale()+step;return this.zoomLevel(level)};chart.zoomLevel=function(level){var scale=Math.min(Math.max(level,zoomExtents.min),zoomExtents.max),prevScale=zoom.scale(),prevTrans=zoom.translate(),treeBBox=backg.node().getBoundingClientRect(),size=[treeBBox.width,treeBBox.height],offset=[(size[0]-size[0]*scale)/2,(size[1]-size[1]*scale)/2],shift=[scale*(prevTrans[0]-(size[0]-size[0]*prevScale)/2)/prevScale,scale*(prevTrans[1]-(size[1]-size[1]*prevScale)/2)/prevScale],translate=[offset[0]+shift[0],offset[1]+shift[1]];zoom.translate(translate).scale(scale);treeWrapper.attr("transform","translate("+translate+")scale("+scale+")");return scale};chart.zoomScale=function(){return zoom.scale()};chart.filter=function(node){var __data={},found=false;function findNode(d){if(getId(d)===node){__data=d;found=true}else if(!found&&d.children){d.children.forEach(findNode)}}findNode(data);__data.x0=0;__data.y0=0;_data=__data;chart.update(_data)};chart.update=function(source){function leafClick(d){toggle(d);chart.update(d)}function toggle(d){if(d.children){d._children=d.children;d.children=null}else{d.children=d._children;d._children=null}}nodes=tree.nodes(_data);var root=nodes[0];nodes.forEach(function(d){setY(d,d.depth*(horizontal?2*nodeSize.width:2*nodeSize.height))});var node=treeChart.selectAll("g.nv-card").data(nodes,getId);var nodeEnter=node.enter().append("svg:g").attr("class","nv-card").attr("id",function(d){return"nv-card-"+getId(d)}).attr("transform",function(d){if(getY(source)===0){return"translate("+getX(root)+","+getY(root)+")"}else{return"translate("+getX0(source)+","+getY0(source)+")"}});nodeEnter.append("foreignObject").attr("class","nv-foreign-object").attr("width",1).attr("height",1).attr("x",-1).attr("y",-1).attr("externalResourcesRequired",true).append("xhtml:body").style("font",'14px "Helvetica Neue"').html(nodeRenderer);var xcCircle=nodeEnter.append("svg:g").attr("class","nv-expcoll").style("opacity",1e-6).on("click",leafClick);xcCircle.append("svg:circle").attr("class","nv-circ-back").attr("r",r);xcCircle.append("svg:line").attr("class","nv-line-vert").attr("x1",0).attr("y1",.5-r).attr("x2",0).attr("y2",r-.5).style("stroke","#bbb");xcCircle.append("svg:line").attr("class","nv-line-hrzn").attr("x1",.5-r).attr("y1",0).attr("x2",r-.5).attr("y2",0).style("stroke","#fff");var nodeUpdate=node.transition().duration(duration).attr("transform",function(d){return"translate("+getX(d)+","+getY(d)+")"});nodeUpdate.select(".nv-expcoll").style("opacity",function(d){return d.children&&d.children.length||d._children&&d._children.length?1:0});nodeUpdate.select(".nv-circ-back").style("fill",function(d){return d._children&&d._children.length?"#777":d.children?"#bbb":"none"});nodeUpdate.select(".nv-line-vert").style("stroke",function(d){return d._children&&d._children.length?"#fff":"#bbb"});nodeUpdate.selectAll(".nv-foreign-object").attr("width",nodeSize.width).attr("height",nodeSize.height).attr("x",horizontal?-nodeSize.width+r:-nodeSize.width/2).attr("y",horizontal?-nodeSize.height/2+r:-nodeSize.height+r*2);var nodeExit=node.exit().transition().duration(duration).attr("transform",function(d){return"translate("+getX(source)+","+getY(source)+")"}).remove();nodeExit.selectAll(".nv-expcoll").style("stroke-opacity",1e-6);nodeExit.selectAll(".nv-foreign-object").attr("width",1).attr("height",1).attr("x",-1).attr("y",-1);var link=treeChart.selectAll("path.link").data(tree.links(nodes),function(d){return getId(d.source)+"-"+getId(d.target)});link.enter().insert("svg:path","g").attr("class","link").attr("d",function(d){var o=getY(source)===0?{x:source.x,y:source.y}:{x:source.x0,y:source.y0};return diagonal({source:o,target:o})});link.transition().duration(duration).attr("d",diagonal);link.exit().transition().duration(duration).attr("d",function(d){var o={x:source.x,y:source.y};return diagonal({source:o,target:o})}).remove();nodes.forEach(function(d){setX0(d,getX(d));setY0(d,getY(d))});chart.resize()};chart.gradient(fillGradient);chart.update(_data)});return chart}chart.dispatch=dispatch;chart.color=function(_){if(!arguments.length)return color;color=_;return chart};chart.fill=function(_){if(!arguments.length)return fill;fill=_;return chart};chart.gradient=function(_){if(!arguments.length)return gradient;gradient=_;return chart};chart.useClass=function(_){if(!arguments.length)return useClass;useClass=_;return chart};chart.width=function(_){if(!arguments.length)return width;width=_;return chart};chart.height=function(_){if(!arguments.length)return height;height=_;return chart};chart.values=function(_){if(!arguments.length)return getValues;getValues=_;return chart};chart.x=function(_){if(!arguments.length)return getX;getX=_;return chart};chart.y=function(_){if(!arguments.length)return getY;getY=d3.functor(_);return chart};chart.showLabels=function(_){if(!arguments.length)return showLabels;showLabels=_;return chart};chart.id=function(_){if(!arguments.length)return id;id=_;return chart};chart.valueFormat=function(_){if(!arguments.length)return valueFormat;valueFormat=_;return chart};chart.labelThreshold=function(_){if(!arguments.length)return labelThreshold;labelThreshold=_;return chart};chart.radius=function(_){if(!arguments.length)return r;r=_;return chart};chart.duration=function(_){if(!arguments.length)return duration;duration=_;return chart};chart.zoomExtents=function(_){if(!arguments.length)return zoomExtents;zoomExtents=_;return chart};chart.zoomCallback=function(_){if(!arguments.length)return zoomCallback;zoomCallback=_;return chart};chart.padding=function(_){if(!arguments.length)return padding;padding=_;return chart};chart.nodeSize=function(_){if(!arguments.length)return nodeSize;nodeSize=_;return chart};chart.nodeImgPath=function(_){if(!arguments.length)return nodeImgPath;nodeImgPath=_;return chart};chart.nodeRenderer=function(_){if(!arguments.length)return nodeRenderer;nodeRenderer=_;return chart};chart.horizontal=function(_){if(!arguments.length)return horizontal;horizontal=_;return chart};chart.getId=function(_){if(!arguments.length)return getId;getId=_;return chart};return chart}})();

/* End of File include/javascript/nvd3/nv.d3.min.js */


(function(app){app.error=_.extend(app.error);function backToLogin(bDismiss){if(bDismiss)app.alert.dismissAll();if(app.api.isAuthenticated()){app.api.resetAuth();}
app.router.login();}
function showErrorPage(status,dismiss){if(dismiss){app.alert.dismissAll();}
app.controller.loadView({layout:"error",errorType:status,module:"Error",create:true});}
function alertUser(key,title,msg){app.alert.show(key,{level:'error',messages:app.lang.get(msg),title:app.lang.get(title)});}
app.events.on('app:sync:error',function(error){if(error.status!==0){backToLogin(true);}
alertUser("sync_failure","ERR_SYNC_FAILED",(error&&error.message)||"LBL_INVALID_412_RESPONSE");});app.error.handleNeedLoginError=function(error){backToLogin(true);alertUser("needs_login_error","LBL_INVALID_CREDS_TITLE",error.message);};app.error.handleInvalidGrantError=function(error){backToLogin(true);alertUser("invalid_grant_error","LBL_INVALID_GRANT_TITLE","LBL_INVALID_GRANT");};app.error.handleInvalidClientError=function(error){backToLogin(true);alertUser("invalid_client_error","LBL_AUTH_FAILED_TITLE","LBL_AUTH_FAILED");};app.error.handleInvalidRequestError=function(error){backToLogin(true);alertUser("invalid_request_error","LBL_INVALID_REQUEST_TITLE","LBL_INVALID_REQUEST");};app.error.handleUnspecified400Error=function(error){showErrorPage('400');};app.error.handleTimeoutError=function(error){app.alert.dismissAll();alertUser("timeout_error","LBL_REQUEST_TIMEOUT_TITLE","LBL_REQUEST_TIMEOUT");};app.error.handleUnauthorizedError=function(error){backToLogin(true);alertUser("unauthorized_request_error","LBL_UNAUTHORIZED_TITLE","LBL_UNAUTHORIZED");};app.error.handleForbiddenError=function(error){if(error.code!="not_authorized"){app.alert.dismissAll();}
if(error.code=="portal_not_configured"){backToLogin(true);}
app.logger.error(app.lang.get(error.message?error.message:"LBL_RESOURCE_UNAVAILABLE"));};app.error.handleNotFoundError=function(error,model,options){var layout=app.controller.layout||{};if((options&&options.context!=layout.context)||(model&&layout.context&&layout.context.get("model")&&layout.context.get("model")!=model)){return;}
if(!layout||!_.isObject(layout.error)||!_.isFunction(layout.error.handleNotFoundError)||layout.error.handleNotFoundError(error,model,options)!==false){showErrorPage("404");}};app.error.handleMethodNotAllowedError=function(error){backToLogin(true);alertUser("not_allowed_error","LBL_METHOD_NOT_ALLOWED_TITLE","LBL_METHOD_NOT_ALLOWED");};app.error.handleMethodConflictError=function(error){app.logger.error('Data conflict detected.');};app.error.handleValidationError=function(error){var layout=app.controller.layout;if(!_.isObject(layout.error)||!_.isFunction(layout.error.handleValidationError)||layout.error.handleValidationError(error)!==false){if(error instanceof app.data.beanModel){return;}
alertUser("validation_error","LBL_PRECONDITION_MISSING_TITLE",error.message||"LBL_PRECONDITION_MISSING");error.handled=true;}};app.error.handleHeaderPreconditionFailed=function(error,b,c,d){if(!app.isSynced){return;}
if(!error||error.code!=='metadata_out_of_date'){return;}
var responseText=JSON.parse(error.responseText);var newHash=responseText&&responseText.metadata_hash;var userHash=responseText&&responseText.user_hash;var afterSync=error.request.state&&error.request.state.loadingAfterSync;if(((!newHash&&afterSync)||newHash===app.metadata.getHash())&&((!userHash&&afterSync)||userHash===app.user.get("_hash"))){app.logger.fatal('A request returned the error code "metadata_out_of_date" for no reason.');app.alert.show('invalid_412',{level:'error',messages:['LBL_INVALID_412_RESPONSE']});app.api.resetAuth();app.router.refresh();return;}
app.sync();};app.error.handleMethodFailureError=function(error){error.handled=true;if(error.code=="request_failure"){showErrorPage("422");}else{alertUser("precondtion_failure_error","LBL_PRECONDITION_MISSING_TITLE","LBL_PRECONDITION_MISSING");}};app.error.handleServerError=function(error){if(error.payload&&error.payload.url){if(app.acl.hasAccess('admin','Administration')){app.router.navigate(error.payload.url,{trigger:true,replace:true});return;}}
app.controller.loadView({layout:"error",errorType:error.status||"500",module:"Error",error:error,create:true});};})(SUGAR.App);
/* End of File include/javascript/sugar7/error.js */


var _inputFocused=null;if(Modernizr.touch){$(document).on('blur','input, textarea',function(){_inputFocused=setTimeout(function(){window.scrollTo(document.body.scrollLeft,document.body.scrollTop);},0);});$(document).on('focus','input, textarea',function(){clearTimeout(_inputFocused);});}
/* End of File include/javascript/sugar7/touch.js */


(function($){if(typeof $.fn.each2=="undefined"){$.extend($.fn,{each2:function(c){var j=$([0]),i=-1,l=this.length;while(++i<l&&(j.context=j[0]=this[i])&&c.call(j[0],i,j)!==false);return this;}});}})(jQuery);(function($,undefined){"use strict";if(window.Select2!==undefined){return;}
var KEY,AbstractSelect2,SingleSelect2,MultiSelect2,nextUid,sizer,lastMousePosition={x:0,y:0},$document,scrollBarDimensions,KEY={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(k){k=k.which?k.which:k;switch(k){case KEY.LEFT:case KEY.RIGHT:case KEY.UP:case KEY.DOWN:return true;}
return false;},isControl:function(e){var k=e.which;switch(k){case KEY.SHIFT:case KEY.CTRL:case KEY.ALT:return true;}
if(e.metaKey)return true;return false;},isFunctionKey:function(k){k=k.which?k.which:k;return k>=112&&k<=123;}},MEASURE_SCROLLBAR_TEMPLATE="<div class='select2-measure-scrollbar'></div>",DIACRITICS={"\u24B6":"A","\uFF21":"A","\u00C0":"A","\u00C1":"A","\u00C2":"A","\u1EA6":"A","\u1EA4":"A","\u1EAA":"A","\u1EA8":"A","\u00C3":"A","\u0100":"A","\u0102":"A","\u1EB0":"A","\u1EAE":"A","\u1EB4":"A","\u1EB2":"A","\u0226":"A","\u01E0":"A","\u00C4":"A","\u01DE":"A","\u1EA2":"A","\u00C5":"A","\u01FA":"A","\u01CD":"A","\u0200":"A","\u0202":"A","\u1EA0":"A","\u1EAC":"A","\u1EB6":"A","\u1E00":"A","\u0104":"A","\u023A":"A","\u2C6F":"A","\uA732":"AA","\u00C6":"AE","\u01FC":"AE","\u01E2":"AE","\uA734":"AO","\uA736":"AU","\uA738":"AV","\uA73A":"AV","\uA73C":"AY","\u24B7":"B","\uFF22":"B","\u1E02":"B","\u1E04":"B","\u1E06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24B8":"C","\uFF23":"C","\u0106":"C","\u0108":"C","\u010A":"C","\u010C":"C","\u00C7":"C","\u1E08":"C","\u0187":"C","\u023B":"C","\uA73E":"C","\u24B9":"D","\uFF24":"D","\u1E0A":"D","\u010E":"D","\u1E0C":"D","\u1E10":"D","\u1E12":"D","\u1E0E":"D","\u0110":"D","\u018B":"D","\u018A":"D","\u0189":"D","\uA779":"D","\u01F1":"DZ","\u01C4":"DZ","\u01F2":"Dz","\u01C5":"Dz","\u24BA":"E","\uFF25":"E","\u00C8":"E","\u00C9":"E","\u00CA":"E","\u1EC0":"E","\u1EBE":"E","\u1EC4":"E","\u1EC2":"E","\u1EBC":"E","\u0112":"E","\u1E14":"E","\u1E16":"E","\u0114":"E","\u0116":"E","\u00CB":"E","\u1EBA":"E","\u011A":"E","\u0204":"E","\u0206":"E","\u1EB8":"E","\u1EC6":"E","\u0228":"E","\u1E1C":"E","\u0118":"E","\u1E18":"E","\u1E1A":"E","\u0190":"E","\u018E":"E","\u24BB":"F","\uFF26":"F","\u1E1E":"F","\u0191":"F","\uA77B":"F","\u24BC":"G","\uFF27":"G","\u01F4":"G","\u011C":"G","\u1E20":"G","\u011E":"G","\u0120":"G","\u01E6":"G","\u0122":"G","\u01E4":"G","\u0193":"G","\uA7A0":"G","\uA77D":"G","\uA77E":"G","\u24BD":"H","\uFF28":"H","\u0124":"H","\u1E22":"H","\u1E26":"H","\u021E":"H","\u1E24":"H","\u1E28":"H","\u1E2A":"H","\u0126":"H","\u2C67":"H","\u2C75":"H","\uA78D":"H","\u24BE":"I","\uFF29":"I","\u00CC":"I","\u00CD":"I","\u00CE":"I","\u0128":"I","\u012A":"I","\u012C":"I","\u0130":"I","\u00CF":"I","\u1E2E":"I","\u1EC8":"I","\u01CF":"I","\u0208":"I","\u020A":"I","\u1ECA":"I","\u012E":"I","\u1E2C":"I","\u0197":"I","\u24BF":"J","\uFF2A":"J","\u0134":"J","\u0248":"J","\u24C0":"K","\uFF2B":"K","\u1E30":"K","\u01E8":"K","\u1E32":"K","\u0136":"K","\u1E34":"K","\u0198":"K","\u2C69":"K","\uA740":"K","\uA742":"K","\uA744":"K","\uA7A2":"K","\u24C1":"L","\uFF2C":"L","\u013F":"L","\u0139":"L","\u013D":"L","\u1E36":"L","\u1E38":"L","\u013B":"L","\u1E3C":"L","\u1E3A":"L","\u0141":"L","\u023D":"L","\u2C62":"L","\u2C60":"L","\uA748":"L","\uA746":"L","\uA780":"L","\u01C7":"LJ","\u01C8":"Lj","\u24C2":"M","\uFF2D":"M","\u1E3E":"M","\u1E40":"M","\u1E42":"M","\u2C6E":"M","\u019C":"M","\u24C3":"N","\uFF2E":"N","\u01F8":"N","\u0143":"N","\u00D1":"N","\u1E44":"N","\u0147":"N","\u1E46":"N","\u0145":"N","\u1E4A":"N","\u1E48":"N","\u0220":"N","\u019D":"N","\uA790":"N","\uA7A4":"N","\u01CA":"NJ","\u01CB":"Nj","\u24C4":"O","\uFF2F":"O","\u00D2":"O","\u00D3":"O","\u00D4":"O","\u1ED2":"O","\u1ED0":"O","\u1ED6":"O","\u1ED4":"O","\u00D5":"O","\u1E4C":"O","\u022C":"O","\u1E4E":"O","\u014C":"O","\u1E50":"O","\u1E52":"O","\u014E":"O","\u022E":"O","\u0230":"O","\u00D6":"O","\u022A":"O","\u1ECE":"O","\u0150":"O","\u01D1":"O","\u020C":"O","\u020E":"O","\u01A0":"O","\u1EDC":"O","\u1EDA":"O","\u1EE0":"O","\u1EDE":"O","\u1EE2":"O","\u1ECC":"O","\u1ED8":"O","\u01EA":"O","\u01EC":"O","\u00D8":"O","\u01FE":"O","\u0186":"O","\u019F":"O","\uA74A":"O","\uA74C":"O","\u01A2":"OI","\uA74E":"OO","\u0222":"OU","\u24C5":"P","\uFF30":"P","\u1E54":"P","\u1E56":"P","\u01A4":"P","\u2C63":"P","\uA750":"P","\uA752":"P","\uA754":"P","\u24C6":"Q","\uFF31":"Q","\uA756":"Q","\uA758":"Q","\u024A":"Q","\u24C7":"R","\uFF32":"R","\u0154":"R","\u1E58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1E5A":"R","\u1E5C":"R","\u0156":"R","\u1E5E":"R","\u024C":"R","\u2C64":"R","\uA75A":"R","\uA7A6":"R","\uA782":"R","\u24C8":"S","\uFF33":"S","\u1E9E":"S","\u015A":"S","\u1E64":"S","\u015C":"S","\u1E60":"S","\u0160":"S","\u1E66":"S","\u1E62":"S","\u1E68":"S","\u0218":"S","\u015E":"S","\u2C7E":"S","\uA7A8":"S","\uA784":"S","\u24C9":"T","\uFF34":"T","\u1E6A":"T","\u0164":"T","\u1E6C":"T","\u021A":"T","\u0162":"T","\u1E70":"T","\u1E6E":"T","\u0166":"T","\u01AC":"T","\u01AE":"T","\u023E":"T","\uA786":"T","\uA728":"TZ","\u24CA":"U","\uFF35":"U","\u00D9":"U","\u00DA":"U","\u00DB":"U","\u0168":"U","\u1E78":"U","\u016A":"U","\u1E7A":"U","\u016C":"U","\u00DC":"U","\u01DB":"U","\u01D7":"U","\u01D5":"U","\u01D9":"U","\u1EE6":"U","\u016E":"U","\u0170":"U","\u01D3":"U","\u0214":"U","\u0216":"U","\u01AF":"U","\u1EEA":"U","\u1EE8":"U","\u1EEE":"U","\u1EEC":"U","\u1EF0":"U","\u1EE4":"U","\u1E72":"U","\u0172":"U","\u1E76":"U","\u1E74":"U","\u0244":"U","\u24CB":"V","\uFF36":"V","\u1E7C":"V","\u1E7E":"V","\u01B2":"V","\uA75E":"V","\u0245":"V","\uA760":"VY","\u24CC":"W","\uFF37":"W","\u1E80":"W","\u1E82":"W","\u0174":"W","\u1E86":"W","\u1E84":"W","\u1E88":"W","\u2C72":"W","\u24CD":"X","\uFF38":"X","\u1E8A":"X","\u1E8C":"X","\u24CE":"Y","\uFF39":"Y","\u1EF2":"Y","\u00DD":"Y","\u0176":"Y","\u1EF8":"Y","\u0232":"Y","\u1E8E":"Y","\u0178":"Y","\u1EF6":"Y","\u1EF4":"Y","\u01B3":"Y","\u024E":"Y","\u1EFE":"Y","\u24CF":"Z","\uFF3A":"Z","\u0179":"Z","\u1E90":"Z","\u017B":"Z","\u017D":"Z","\u1E92":"Z","\u1E94":"Z","\u01B5":"Z","\u0224":"Z","\u2C7F":"Z","\u2C6B":"Z","\uA762":"Z","\u24D0":"a","\uFF41":"a","\u1E9A":"a","\u00E0":"a","\u00E1":"a","\u00E2":"a","\u1EA7":"a","\u1EA5":"a","\u1EAB":"a","\u1EA9":"a","\u00E3":"a","\u0101":"a","\u0103":"a","\u1EB1":"a","\u1EAF":"a","\u1EB5":"a","\u1EB3":"a","\u0227":"a","\u01E1":"a","\u00E4":"a","\u01DF":"a","\u1EA3":"a","\u00E5":"a","\u01FB":"a","\u01CE":"a","\u0201":"a","\u0203":"a","\u1EA1":"a","\u1EAD":"a","\u1EB7":"a","\u1E01":"a","\u0105":"a","\u2C65":"a","\u0250":"a","\uA733":"aa","\u00E6":"ae","\u01FD":"ae","\u01E3":"ae","\uA735":"ao","\uA737":"au","\uA739":"av","\uA73B":"av","\uA73D":"ay","\u24D1":"b","\uFF42":"b","\u1E03":"b","\u1E05":"b","\u1E07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24D2":"c","\uFF43":"c","\u0107":"c","\u0109":"c","\u010B":"c","\u010D":"c","\u00E7":"c","\u1E09":"c","\u0188":"c","\u023C":"c","\uA73F":"c","\u2184":"c","\u24D3":"d","\uFF44":"d","\u1E0B":"d","\u010F":"d","\u1E0D":"d","\u1E11":"d","\u1E13":"d","\u1E0F":"d","\u0111":"d","\u018C":"d","\u0256":"d","\u0257":"d","\uA77A":"d","\u01F3":"dz","\u01C6":"dz","\u24D4":"e","\uFF45":"e","\u00E8":"e","\u00E9":"e","\u00EA":"e","\u1EC1":"e","\u1EBF":"e","\u1EC5":"e","\u1EC3":"e","\u1EBD":"e","\u0113":"e","\u1E15":"e","\u1E17":"e","\u0115":"e","\u0117":"e","\u00EB":"e","\u1EBB":"e","\u011B":"e","\u0205":"e","\u0207":"e","\u1EB9":"e","\u1EC7":"e","\u0229":"e","\u1E1D":"e","\u0119":"e","\u1E19":"e","\u1E1B":"e","\u0247":"e","\u025B":"e","\u01DD":"e","\u24D5":"f","\uFF46":"f","\u1E1F":"f","\u0192":"f","\uA77C":"f","\u24D6":"g","\uFF47":"g","\u01F5":"g","\u011D":"g","\u1E21":"g","\u011F":"g","\u0121":"g","\u01E7":"g","\u0123":"g","\u01E5":"g","\u0260":"g","\uA7A1":"g","\u1D79":"g","\uA77F":"g","\u24D7":"h","\uFF48":"h","\u0125":"h","\u1E23":"h","\u1E27":"h","\u021F":"h","\u1E25":"h","\u1E29":"h","\u1E2B":"h","\u1E96":"h","\u0127":"h","\u2C68":"h","\u2C76":"h","\u0265":"h","\u0195":"hv","\u24D8":"i","\uFF49":"i","\u00EC":"i","\u00ED":"i","\u00EE":"i","\u0129":"i","\u012B":"i","\u012D":"i","\u00EF":"i","\u1E2F":"i","\u1EC9":"i","\u01D0":"i","\u0209":"i","\u020B":"i","\u1ECB":"i","\u012F":"i","\u1E2D":"i","\u0268":"i","\u0131":"i","\u24D9":"j","\uFF4A":"j","\u0135":"j","\u01F0":"j","\u0249":"j","\u24DA":"k","\uFF4B":"k","\u1E31":"k","\u01E9":"k","\u1E33":"k","\u0137":"k","\u1E35":"k","\u0199":"k","\u2C6A":"k","\uA741":"k","\uA743":"k","\uA745":"k","\uA7A3":"k","\u24DB":"l","\uFF4C":"l","\u0140":"l","\u013A":"l","\u013E":"l","\u1E37":"l","\u1E39":"l","\u013C":"l","\u1E3D":"l","\u1E3B":"l","\u017F":"l","\u0142":"l","\u019A":"l","\u026B":"l","\u2C61":"l","\uA749":"l","\uA781":"l","\uA747":"l","\u01C9":"lj","\u24DC":"m","\uFF4D":"m","\u1E3F":"m","\u1E41":"m","\u1E43":"m","\u0271":"m","\u026F":"m","\u24DD":"n","\uFF4E":"n","\u01F9":"n","\u0144":"n","\u00F1":"n","\u1E45":"n","\u0148":"n","\u1E47":"n","\u0146":"n","\u1E4B":"n","\u1E49":"n","\u019E":"n","\u0272":"n","\u0149":"n","\uA791":"n","\uA7A5":"n","\u01CC":"nj","\u24DE":"o","\uFF4F":"o","\u00F2":"o","\u00F3":"o","\u00F4":"o","\u1ED3":"o","\u1ED1":"o","\u1ED7":"o","\u1ED5":"o","\u00F5":"o","\u1E4D":"o","\u022D":"o","\u1E4F":"o","\u014D":"o","\u1E51":"o","\u1E53":"o","\u014F":"o","\u022F":"o","\u0231":"o","\u00F6":"o","\u022B":"o","\u1ECF":"o","\u0151":"o","\u01D2":"o","\u020D":"o","\u020F":"o","\u01A1":"o","\u1EDD":"o","\u1EDB":"o","\u1EE1":"o","\u1EDF":"o","\u1EE3":"o","\u1ECD":"o","\u1ED9":"o","\u01EB":"o","\u01ED":"o","\u00F8":"o","\u01FF":"o","\u0254":"o","\uA74B":"o","\uA74D":"o","\u0275":"o","\u01A3":"oi","\u0223":"ou","\uA74F":"oo","\u24DF":"p","\uFF50":"p","\u1E55":"p","\u1E57":"p","\u01A5":"p","\u1D7D":"p","\uA751":"p","\uA753":"p","\uA755":"p","\u24E0":"q","\uFF51":"q","\u024B":"q","\uA757":"q","\uA759":"q","\u24E1":"r","\uFF52":"r","\u0155":"r","\u1E59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1E5B":"r","\u1E5D":"r","\u0157":"r","\u1E5F":"r","\u024D":"r","\u027D":"r","\uA75B":"r","\uA7A7":"r","\uA783":"r","\u24E2":"s","\uFF53":"s","\u00DF":"s","\u015B":"s","\u1E65":"s","\u015D":"s","\u1E61":"s","\u0161":"s","\u1E67":"s","\u1E63":"s","\u1E69":"s","\u0219":"s","\u015F":"s","\u023F":"s","\uA7A9":"s","\uA785":"s","\u1E9B":"s","\u24E3":"t","\uFF54":"t","\u1E6B":"t","\u1E97":"t","\u0165":"t","\u1E6D":"t","\u021B":"t","\u0163":"t","\u1E71":"t","\u1E6F":"t","\u0167":"t","\u01AD":"t","\u0288":"t","\u2C66":"t","\uA787":"t","\uA729":"tz","\u24E4":"u","\uFF55":"u","\u00F9":"u","\u00FA":"u","\u00FB":"u","\u0169":"u","\u1E79":"u","\u016B":"u","\u1E7B":"u","\u016D":"u","\u00FC":"u","\u01DC":"u","\u01D8":"u","\u01D6":"u","\u01DA":"u","\u1EE7":"u","\u016F":"u","\u0171":"u","\u01D4":"u","\u0215":"u","\u0217":"u","\u01B0":"u","\u1EEB":"u","\u1EE9":"u","\u1EEF":"u","\u1EED":"u","\u1EF1":"u","\u1EE5":"u","\u1E73":"u","\u0173":"u","\u1E77":"u","\u1E75":"u","\u0289":"u","\u24E5":"v","\uFF56":"v","\u1E7D":"v","\u1E7F":"v","\u028B":"v","\uA75F":"v","\u028C":"v","\uA761":"vy","\u24E6":"w","\uFF57":"w","\u1E81":"w","\u1E83":"w","\u0175":"w","\u1E87":"w","\u1E85":"w","\u1E98":"w","\u1E89":"w","\u2C73":"w","\u24E7":"x","\uFF58":"x","\u1E8B":"x","\u1E8D":"x","\u24E8":"y","\uFF59":"y","\u1EF3":"y","\u00FD":"y","\u0177":"y","\u1EF9":"y","\u0233":"y","\u1E8F":"y","\u00FF":"y","\u1EF7":"y","\u1E99":"y","\u1EF5":"y","\u01B4":"y","\u024F":"y","\u1EFF":"y","\u24E9":"z","\uFF5A":"z","\u017A":"z","\u1E91":"z","\u017C":"z","\u017E":"z","\u1E93":"z","\u1E95":"z","\u01B6":"z","\u0225":"z","\u0240":"z","\u2C6C":"z","\uA763":"z"};$document=$(document);nextUid=(function(){var counter=1;return function(){return counter++;};}());function reinsertElement(element){var placeholder=$(document.createTextNode(''));element.before(placeholder);placeholder.before(element);placeholder.remove();}
function stripDiacritics(str){var ret,i,l,c;if(!str||str.length<1)return str;ret="";for(i=0,l=str.length;i<l;i++){c=str.charAt(i);ret+=DIACRITICS[c]||c;}
return ret;}
function indexOf(value,array){var i=0,l=array.length;for(;i<l;i=i+1){if(equal(value,array[i]))return i;}
return-1;}
function measureScrollbar(){var $template=$(MEASURE_SCROLLBAR_TEMPLATE);$template.appendTo('body');var dim={width:$template.width()-$template[0].clientWidth,height:$template.height()-$template[0].clientHeight};$template.remove();return dim;}
function equal(a,b){if(a===b)return true;if(a===undefined||b===undefined)return false;if(a===null||b===null)return false;if(a.constructor===String)return a+''===b+'';if(b.constructor===String)return b+''===a+'';return false;}
function splitVal(string,separator){var val,i,l;if(string===null||string.length<1)return[];val=string.split(separator);for(i=0,l=val.length;i<l;i=i+1)val[i]=$.trim(val[i]);return val;}
function getSideBorderPadding(element){return element.outerWidth(false)-element.width();}
function installKeyUpChangeEvent(element){var key="keyup-change-value";element.on("keydown",function(){if($.data(element,key)===undefined){$.data(element,key,element.val());}});element.on("keyup",function(){var val=$.data(element,key);if(val!==undefined&&element.val()!==val){$.removeData(element,key);element.trigger("keyup-change");}});}
$document.on("mousemove",function(e){lastMousePosition.x=e.pageX;lastMousePosition.y=e.pageY;});function installFilteredMouseMove(element){element.on("mousemove",function(e){var lastpos=lastMousePosition;if(lastpos===undefined||lastpos.x!==e.pageX||lastpos.y!==e.pageY){$(e.target).trigger("mousemove-filtered",e);}});}
function debounce(quietMillis,fn,ctx){ctx=ctx||undefined;var timeout;return function(){var args=arguments;window.clearTimeout(timeout);timeout=window.setTimeout(function(){fn.apply(ctx,args);},quietMillis);};}
function thunk(formula){var evaluated=false,value;return function(){if(evaluated===false){value=formula();evaluated=true;}
return value;};};function installDebouncedScroll(threshold,element){var notify=debounce(threshold,function(e){element.trigger("scroll-debounced",e);});element.on("scroll",function(e){if(indexOf(e.target,element.get())>=0)notify(e);});}
function focus($el){if($el[0]===document.activeElement)return;window.setTimeout(function(){var el=$el[0],pos=$el.val().length,range;$el.focus();var isVisible=(el.offsetWidth>0||el.offsetHeight>0);if(isVisible&&el===document.activeElement){if(el.setSelectionRange)
{el.setSelectionRange(pos,pos);}
else if(el.createTextRange){range=el.createTextRange();range.collapse(false);range.select();}}},0);}
function getCursorInfo(el){el=$(el)[0];var offset=0;var length=0;if('selectionStart'in el){offset=el.selectionStart;length=el.selectionEnd-offset;}else if('selection'in document){el.focus();var sel=document.selection.createRange();length=document.selection.createRange().text.length;sel.moveStart('character',-el.value.length);offset=sel.text.length-length;}
return{offset:offset,length:length};}
function killEvent(event){event.preventDefault();event.stopPropagation();}
function killEventImmediately(event){event.preventDefault();event.stopImmediatePropagation();}
function measureTextWidth(e){if(!sizer){var style=e[0].currentStyle||window.getComputedStyle(e[0],null);sizer=$(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:style.fontSize,fontFamily:style.fontFamily,fontStyle:style.fontStyle,fontWeight:style.fontWeight,letterSpacing:style.letterSpacing,textTransform:style.textTransform,whiteSpace:"nowrap"});sizer.attr("class","select2-sizer");$("body").append(sizer);}
sizer.text(e.val());return sizer.width();}
function syncCssClasses(dest,src,adapter){var classes,replacements=[],adapted;classes=dest.attr("class");if(classes){classes=''+classes;$(classes.split(" ")).each2(function(){if(this.indexOf("select2-")===0){replacements.push(this);}});}
classes=src.attr("class");if(classes){classes=''+classes;$(classes.split(" ")).each2(function(){if(this.indexOf("select2-")!==0){adapted=adapter(this);if(adapted){replacements.push(adapted);}}});}
dest.attr("class",replacements.join(" "));}
function markMatch(text,term,markup,escapeMarkup){var match=stripDiacritics(text.toUpperCase()).indexOf(stripDiacritics(term.toUpperCase())),tl=term.length;if(match<0){markup.push(escapeMarkup(text));return;}
markup.push(escapeMarkup(text.substring(0,match)));markup.push("<span class='select2-match'>");markup.push(escapeMarkup(text.substring(match,match+tl)));markup.push("</span>");markup.push(escapeMarkup(text.substring(match+tl,text.length)));}
function defaultEscapeMarkup(markup){var replace_map={'\\':'&#92;','&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;',"/":'&#47;'};return String(markup).replace(/[&<>"'\/\\]/g,function(match){return replace_map[match];});}
function ajax(options){var timeout,handler=null,quietMillis=options.quietMillis||100,ajaxUrl=options.url,self=this;return function(query){window.clearTimeout(timeout);timeout=window.setTimeout(function(){var data=options.data,url=ajaxUrl,transport=options.transport||$.fn.select2.ajaxDefaults.transport,deprecated={type:options.type||'GET',cache:options.cache||false,jsonpCallback:options.jsonpCallback||undefined,dataType:options.dataType||"json"},params=$.extend({},$.fn.select2.ajaxDefaults.params,deprecated);data=data?data.call(self,query.term,query.page,query.context):null;url=(typeof url==='function')?url.call(self,query.term,query.page,query.context):url;if(handler&&typeof handler.abort==="function"){handler.abort();}
if(options.params){if($.isFunction(options.params)){$.extend(params,options.params.call(self));}else{$.extend(params,options.params);}}
$.extend(params,{url:url,dataType:options.dataType,data:data,success:function(data){var results=options.results(data,query.page);query.callback(results);}});handler=transport.call(self,params);},quietMillis);};}
function local(options){var data=options,dataText,tmp,text=function(item){return""+item.text;};if($.isArray(data)){tmp=data;data={results:tmp};}
if($.isFunction(data)===false){tmp=data;data=function(){return tmp;};}
var dataItem=data();if(dataItem.text){text=dataItem.text;if(!$.isFunction(text)){dataText=dataItem.text;text=function(item){return item[dataText];};}}
return function(query){var t=query.term,filtered={results:[]},process;if(t===""){query.callback(data());return;}
process=function(datum,collection){var group,attr;datum=datum[0];if(datum.children){group={};for(attr in datum){if(datum.hasOwnProperty(attr))group[attr]=datum[attr];}
group.children=[];$(datum.children).each2(function(i,childDatum){process(childDatum,group.children);});if(group.children.length||query.matcher(t,text(group),datum)){collection.push(group);}}else{if(query.matcher(t,text(datum),datum)){collection.push(datum);}}};$(data().results).each2(function(i,datum){process(datum,filtered.results);});query.callback(filtered);};}
function tags(data){var isFunc=$.isFunction(data);return function(query){var t=query.term,filtered={results:[]};$(isFunc?data():data).each(function(){var isObject=this.text!==undefined,text=isObject?this.text:this;if(t===""||query.matcher(t,text)){filtered.results.push(isObject?this:{id:this,text:this});}});query.callback(filtered);};}
function checkFormatter(formatter,formatterName){if($.isFunction(formatter))return true;if(!formatter)return false;if(typeof(formatter)==='string')return true;throw new Error(formatterName+" must be a string, function, or falsy value");}
function evaluate(val){if($.isFunction(val)){var args=Array.prototype.slice.call(arguments,1);return val.apply(null,args);}
return val;}
function countResults(results){var count=0;$.each(results,function(i,item){if(item.children){count+=countResults(item.children);}else{count++;}});return count;}
function defaultTokenizer(input,selection,selectCallback,opts){var original=input,dupe=false,token,index,i,l,separator;if(!opts.createSearchChoice||!opts.tokenSeparators||opts.tokenSeparators.length<1)return undefined;while(true){index=-1;for(i=0,l=opts.tokenSeparators.length;i<l;i++){separator=opts.tokenSeparators[i];index=input.indexOf(separator);if(index>=0)break;}
if(index<0)break;token=input.substring(0,index);input=input.substring(index+separator.length);if(token.length>0){token=opts.createSearchChoice.call(this,token,selection);if(token!==undefined&&token!==null&&opts.id(token)!==undefined&&opts.id(token)!==null){dupe=false;for(i=0,l=selection.length;i<l;i++){if(equal(opts.id(token),opts.id(selection[i]))){dupe=true;break;}}
if(!dupe)selectCallback(token);}}}
if(original!==input)return input;}
function clazz(SuperClass,methods){var constructor=function(){};constructor.prototype=new SuperClass;constructor.prototype.constructor=constructor;constructor.prototype.parent=SuperClass.prototype;constructor.prototype=$.extend(constructor.prototype,methods);return constructor;}
AbstractSelect2=clazz(Object,{bind:function(func){var self=this;return function(){func.apply(self,arguments);};},init:function(opts){var results,search,resultsSelector=".select2-results";this.opts=opts=this.prepareOpts(opts);this.id=opts.id;if(opts.element.data("select2")!==undefined&&opts.element.data("select2")!==null){opts.element.data("select2").destroy();}
this.container=this.createContainer();this.liveRegion=$("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body);this.containerId="s2id_"+(opts.element.attr("id")||"autogen"+nextUid()).replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,'\\$1');this.containerSelector="#"+this.containerId;this.container.attr("id",this.containerId);this.body=thunk(function(){return opts.element.closest("body");});syncCssClasses(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.attr("style",opts.element.attr("style"));this.container.css(evaluate(opts.containerCss));this.container.addClass(evaluate(opts.containerCssClass));this.elementTabIndex=this.opts.element.attr("tabindex");this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",killEvent);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");syncCssClasses(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(evaluate(opts.dropdownCssClass));this.dropdown.data("select2",this);this.dropdown.on("click",killEvent);this.results=results=this.container.find(resultsSelector);this.search=search=this.container.find("input.select2-input");this.queryCount=0;this.resultsPage=0;this.context=null;this.initContainer();this.container.on("click",killEvent);installFilteredMouseMove(this.results);this.dropdown.on("mousemove-filtered touchstart touchmove touchend",resultsSelector,this.bind(this.highlightUnderEvent));this.dropdown.on("touchend",resultsSelector,this.bind(this.selectHighlighted));this.dropdown.on("touchmove",resultsSelector,this.bind(this.touchMoved));this.dropdown.on("touchstart touchend",resultsSelector,this.bind(this.clearTouchMoved));installDebouncedScroll(80,this.results);this.dropdown.on("scroll-debounced",resultsSelector,this.bind(this.loadMoreIfNeeded));$(this.container).on("change",".select2-input",function(e){e.stopPropagation();});$(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation();});if($.fn.mousewheel){results.mousewheel(function(e,delta,deltaX,deltaY){var top=results.scrollTop();if(deltaY>0&&top-deltaY<=0){results.scrollTop(0);killEvent(e);}else if(deltaY<0&&results.get(0).scrollHeight-results.scrollTop()+deltaY<=results.height()){results.scrollTop(results.get(0).scrollHeight-results.height());killEvent(e);}});}
installKeyUpChangeEvent(search);search.on("keyup-change input paste",this.bind(this.updateResults));search.on("focus",function(){search.addClass("select2-focused");});search.on("blur",function(){search.removeClass("select2-focused");});this.dropdown.on("mouseup",resultsSelector,this.bind(function(e){if($(e.target).closest(".select2-result-selectable").length>0){this.highlightUnderEvent(e);this.selectHighlighted(e);}}));this.dropdown.on("click mouseup mousedown focusin",function(e){e.stopPropagation();});this.nextSearchTerm=undefined;if($.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource();}
if(opts.maximumInputLength!==null){this.search.attr("maxlength",opts.maximumInputLength);}
var disabled=opts.element.prop("disabled");if(disabled===undefined)disabled=false;this.enable(!disabled);var readonly=opts.element.prop("readonly");if(readonly===undefined)readonly=false;this.readonly(readonly);scrollBarDimensions=scrollBarDimensions||measureScrollbar();this.autofocus=opts.element.prop("autofocus");opts.element.prop("autofocus",false);if(this.autofocus)this.focus();this.search.attr("placeholder",opts.searchInputPlaceholder);},destroy:function(){var element=this.opts.element,select2=element.data("select2");this.close();if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null;}
if(select2!==undefined){select2.container.remove();select2.liveRegion.remove();select2.dropdown.remove();element.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||false);if(this.elementTabIndex){element.attr({tabindex:this.elementTabIndex});}else{element.removeAttr("tabindex");}
element.show();}},optionToData:function(element){if(element.is("option")){return{id:element.prop("value"),text:element.text(),element:element.get(),css:element.attr("class"),disabled:element.prop("disabled"),locked:equal(element.attr("locked"),"locked")||equal(element.data("locked"),true)};}else if(element.is("optgroup")){return{text:element.attr("label"),children:[],element:element.get(),css:element.attr("class")};}},prepareOpts:function(opts){var element,select,idKey,ajaxUrl,self=this;element=opts.element;if(element.get(0).tagName.toLowerCase()==="select"){this.select=select=opts.element;}
if(select){$.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in opts){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.");}});}
opts=$.extend({},{populateResults:function(container,results,query){var populate,id=this.opts.id,liveRegion=this.liveRegion;populate=function(results,container,depth){var i,l,result,selectable,disabled,compound,node,label,innerContainer,formatted;results=opts.sortResults(results,container,query);for(i=0,l=results.length;i<l;i=i+1){result=results[i];disabled=(result.disabled===true);selectable=(!disabled)&&(id(result)!==undefined);compound=result.children&&result.children.length>0;node=$("<li></li>");node.addClass("select2-results-dept-"+depth);node.addClass("select2-result");node.addClass(selectable?"select2-result-selectable":"select2-result-unselectable");if(disabled){node.addClass("select2-disabled");}
if(compound){node.addClass("select2-result-with-children");}
node.addClass(self.opts.formatResultCssClass(result));node.attr("role","presentation");label=$(document.createElement("div"));label.addClass("select2-result-label");label.attr("id","select2-result-label-"+nextUid());label.attr("role","option");formatted=opts.formatResult(result,label,query,self.opts.escapeMarkup);if(formatted!==undefined){label.html(formatted);node.append(label);}
if(compound){innerContainer=$("<ul></ul>");innerContainer.addClass("select2-result-sub");populate(result.children,innerContainer,depth+1);node.append(innerContainer);}
node.data("select2-data",result);container.append(node);}
liveRegion.text(opts.formatMatches(results.length));};populate(results,container,0);}},$.fn.select2.defaults,opts);if(typeof(opts.id)!=="function"){idKey=opts.id;opts.id=function(e){return e[idKey];};}
if($.isArray(opts.element.data("select2Tags"))){if("tags"in opts){throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+opts.element.attr("id");}
opts.tags=opts.element.data("select2Tags");}
if(select){opts.query=this.bind(function(query){var data={results:[],more:false},term=query.term,children,placeholderOption,process;process=function(element,collection){var group;if(element.is("option")){if(query.matcher(term,element.text(),element)){collection.push(self.optionToData(element));}}else if(element.is("optgroup")){group=self.optionToData(element);element.children().each2(function(i,elm){process(elm,group.children);});if(group.children.length>0){collection.push(group);}}};children=element.children();if(this.getPlaceholder()!==undefined&&children.length>0){placeholderOption=this.getPlaceholderOption();if(placeholderOption){children=children.not(placeholderOption);}}
children.each2(function(i,elm){process(elm,data.results);});query.callback(data);});opts.id=function(e){return e.id;};}else{if(!("query"in opts)){if("ajax"in opts){ajaxUrl=opts.element.data("ajax-url");if(ajaxUrl&&ajaxUrl.length>0){opts.ajax.url=ajaxUrl;}
opts.query=ajax.call(opts.element,opts.ajax);}else if("data"in opts){opts.query=local(opts.data);}else if("tags"in opts){opts.query=tags(opts.tags);if(opts.createSearchChoice===undefined){opts.createSearchChoice=function(term){return{id:$.trim(term),text:$.trim(term)};};}
if(opts.initSelection===undefined){opts.initSelection=function(element,callback){var data=[];$(splitVal(element.val(),opts.separator)).each(function(){var obj={id:this,text:this},tags=opts.tags;if($.isFunction(tags))tags=tags();$(tags).each(function(){if(equal(this.id,obj.id)){obj=this;return false;}});data.push(obj);});callback(data);};}}}}
if(typeof(opts.query)!=="function"){throw"query function not defined for Select2 "+opts.element.attr("id");}
if(opts.createSearchChoicePosition==='top'){opts.createSearchChoicePosition=function(list,item){list.unshift(item);};}
else if(opts.createSearchChoicePosition==='bottom'){opts.createSearchChoicePosition=function(list,item){list.push(item);};}
else if(typeof(opts.createSearchChoicePosition)!=="function"){throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";}
return opts;},monitorSource:function(){var el=this.opts.element,sync,observer;el.on("change.select2",this.bind(function(e){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection();}}));sync=this.bind(function(){var disabled=el.prop("disabled");if(disabled===undefined)disabled=false;this.enable(!disabled);var readonly=el.prop("readonly");if(readonly===undefined)readonly=false;this.readonly(readonly);syncCssClasses(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.addClass(evaluate(this.opts.containerCssClass));syncCssClasses(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(evaluate(this.opts.dropdownCssClass));});el.on("propertychange.select2",sync);if(this.mutationCallback===undefined){this.mutationCallback=function(mutations){mutations.forEach(sync);}}
observer=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(observer!==undefined){if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null;}
this.propertyObserver=new observer(this.mutationCallback);this.propertyObserver.observe(el.get(0),{attributes:true,subtree:false});}},triggerSelect:function(data){var evt=$.Event("select2-selecting",{val:this.id(data),object:data});this.opts.element.trigger(evt);return!evt.isDefaultPrevented();},triggerChange:function(details){details=details||{};details=$.extend({},details,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(details);this.opts.element.data("select2-change-triggered",false);this.opts.element.click();if(this.opts.blurOnChange)
this.opts.element.blur();},isInterfaceEnabled:function()
{return this.enabledInterface===true;},enableInterface:function(){var enabled=this._enabled&&!this._readonly,disabled=!enabled;if(enabled===this.enabledInterface)return false;this.container.toggleClass("select2-container-disabled",disabled);this.close();this.enabledInterface=enabled;return true;},enable:function(enabled){if(enabled===undefined)enabled=true;if(this._enabled===enabled)return;this._enabled=enabled;this.opts.element.prop("disabled",!enabled);this.enableInterface();},disable:function(){this.enable(false);},readonly:function(enabled){if(enabled===undefined)enabled=false;if(this._readonly===enabled)return;this._readonly=enabled;this.opts.element.prop("readonly",enabled);this.enableInterface();},opened:function(){return this.container.hasClass("select2-dropdown-open");},positionDropdown:function(){var $dropdown=this.dropdown,offset=this.container.offset(),height=this.container.outerHeight(false),width=this.container.outerWidth(false),dropHeight=$dropdown.outerHeight(false),$window=$(window),windowWidth=$window.width(),windowHeight=$window.height(),viewPortRight=$window.scrollLeft()+windowWidth,viewportBottom=$window.scrollTop()+windowHeight,dropTop=offset.top+height,dropLeft=offset.left,enoughRoomBelow=dropTop+dropHeight<=viewportBottom,enoughRoomAbove=(offset.top-dropHeight)>=$window.scrollTop(),dropWidth=$dropdown.outerWidth(false),enoughRoomOnRight=dropLeft+dropWidth<=viewPortRight,aboveNow=$dropdown.hasClass("select2-drop-above"),bodyOffset,above,changeDirection,css,resultsListNode;if(aboveNow){above=true;if(!enoughRoomAbove&&enoughRoomBelow){changeDirection=true;above=false;}}else{above=false;if(!enoughRoomBelow&&enoughRoomAbove){changeDirection=true;above=true;}}
if(changeDirection){$dropdown.hide();offset=this.container.offset();height=this.container.outerHeight(false);width=this.container.outerWidth(false);dropHeight=$dropdown.outerHeight(false);viewPortRight=$window.scrollLeft()+windowWidth;viewportBottom=$window.scrollTop()+windowHeight;dropTop=offset.top+height;dropLeft=offset.left;dropWidth=$dropdown.outerWidth(false);enoughRoomOnRight=dropLeft+dropWidth<=viewPortRight;$dropdown.show();}
if(this.opts.dropdownAutoWidth){resultsListNode=$('.select2-results',$dropdown)[0];$dropdown.addClass('select2-drop-auto-width');$dropdown.css('width','');dropWidth=$dropdown.outerWidth(false)+(resultsListNode.scrollHeight===resultsListNode.clientHeight?0:scrollBarDimensions.width);dropWidth>width?width=dropWidth:dropWidth=width;enoughRoomOnRight=dropLeft+dropWidth<=viewPortRight;}
else{this.container.removeClass('select2-drop-auto-width');}
if(this.body().css('position')!=='static'){bodyOffset=this.body().offset();dropTop-=bodyOffset.top;dropLeft-=bodyOffset.left;}
if(!enoughRoomOnRight){dropLeft=offset.left+this.container.outerWidth(false)-dropWidth;}
css={left:dropLeft,width:width};if(above){css.top=offset.top-dropHeight;css.bottom='auto';this.container.addClass("select2-drop-above");$dropdown.addClass("select2-drop-above");}
else{css.top=dropTop;css.bottom='auto';this.container.removeClass("select2-drop-above");$dropdown.removeClass("select2-drop-above");}
css=$.extend(css,evaluate(this.opts.dropdownCss));$dropdown.css(css);},shouldOpen:function(){var event;if(this.opened())return false;if(this._enabled===false||this._readonly===true)return false;event=$.Event("select2-opening");this.opts.element.trigger(event);return!event.isDefaultPrevented();},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above");},open:function(){if(!this.shouldOpen())return false;this.opening();return true;},opening:function(){var cid=this.containerId,scroll="scroll."+cid,resize="resize."+cid,orient="orientationchange."+cid,mask;this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.clearDropdownAlignmentPreference();if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body());}
mask=$("#select2-drop-mask");if(mask.length==0){mask=$(document.createElement("div"));mask.attr("id","select2-drop-mask").attr("class","select2-drop-mask");mask.hide();mask.appendTo(this.body());mask.on("mousedown touchstart click",function(e){reinsertElement(mask);var dropdown=$("#select2-drop"),self;if(dropdown.length>0){self=dropdown.data("select2");if(self.opts.selectOnBlur){self.selectHighlighted({noFocus:true});}
self.close();e.preventDefault();e.stopPropagation();}});}
if(this.dropdown.prev()[0]!==mask[0]){this.dropdown.before(mask);}
$("#select2-drop").removeAttr("id");this.dropdown.attr("id","select2-drop");mask.show();this.positionDropdown();this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");var that=this;this.container.parents().add(window).each(function(){$(this).on(resize+" "+scroll+" "+orient,function(e){that.positionDropdown();});});},close:function(){if(!this.opened())return;var cid=this.containerId,scroll="scroll."+cid,resize="resize."+cid,orient="orientationchange."+cid;this.container.parents().add(window).each(function(){$(this).off(scroll).off(resize).off(orient);});this.clearDropdownAlignmentPreference();$("#select2-drop-mask").hide();this.dropdown.removeAttr("id");this.dropdown.hide();this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active");this.results.empty();this.clearSearch();this.search.removeClass("select2-active");this.opts.element.trigger($.Event("select2-close"));},externalSearch:function(term){this.open();this.search.val(term);this.updateResults(false);},clearSearch:function(){},getMaximumSelectionSize:function(){return evaluate(this.opts.maximumSelectionSize);},ensureHighlightVisible:function(){var results=this.results,children,index,child,hb,rb,y,more;index=this.highlight();if(index<0)return;if(index==0){results.scrollTop(0);return;}
children=this.findHighlightableChoices().find('.select2-result-label');child=$(children[index]);hb=child.offset().top+child.outerHeight(true);if(index===children.length-1){more=results.find("li.select2-more-results");if(more.length>0){hb=more.offset().top+more.outerHeight(true);}}
rb=results.offset().top+results.outerHeight(true);if(hb>rb){results.scrollTop(results.scrollTop()+(hb-rb));}
y=child.offset().top-results.offset().top;if(y<0&&child.css('display')!='none'){results.scrollTop(results.scrollTop()+y);}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)");},moveHighlight:function(delta){var choices=this.findHighlightableChoices(),index=this.highlight();while(index>-1&&index<choices.length){index+=delta;var choice=$(choices[index]);if(choice.hasClass("select2-result-selectable")&&!choice.hasClass("select2-disabled")&&!choice.hasClass("select2-selected")){this.highlight(index);break;}}},highlight:function(index){var choices=this.findHighlightableChoices(),choice,data;if(arguments.length===0){return indexOf(choices.filter(".select2-highlighted")[0],choices.get());}
if(index>=choices.length)index=choices.length-1;if(index<0)index=0;this.removeHighlight();choice=$(choices[index]);choice.addClass("select2-highlighted");this.search.attr("aria-activedescendant",choice.find(".select2-result-label").attr("id"));this.ensureHighlightVisible();this.liveRegion.text(choice.text());data=choice.data("select2-data");if(data){this.opts.element.trigger({type:"select2-highlight",val:this.id(data),choice:data});}},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted");},touchMoved:function(){this._touchMoved=true;},clearTouchMoved:function(){this._touchMoved=false;},countSelectableResults:function(){return this.findHighlightableChoices().length;},highlightUnderEvent:function(event){var el=$(event.target).closest(".select2-result-selectable");if(el.length>0&&!el.is(".select2-highlighted")){var choices=this.findHighlightableChoices();this.highlight(choices.index(el));}else if(el.length==0){this.removeHighlight();}},loadMoreIfNeeded:function(){var results=this.results,more=results.find("li.select2-more-results"),below,page=this.resultsPage+1,self=this,term=this.search.val(),context=this.context;if(more.length===0)return;below=more.offset().top-results.offset().top-results.height();if(below<=this.opts.loadMorePadding){more.addClass("select2-active");this.opts.query({element:this.opts.element,term:term,page:page,context:context,matcher:this.opts.matcher,callback:this.bind(function(data){if(!self.opened())return;self.opts.populateResults.call(this,results,data.results,{term:term,page:page,context:context});self.postprocessResults(data,false,false);if(data.more===true){more.detach().appendTo(results).text(evaluate(self.opts.formatLoadMore,page+1));window.setTimeout(function(){self.loadMoreIfNeeded();},10);}else{more.remove();}
self.positionDropdown();self.resultsPage=page;self.context=data.context;this.opts.element.trigger({type:"select2-loaded",items:data});})});}},tokenize:function(){},updateResults:function(initial){var search=this.search,results=this.results,opts=this.opts,data,self=this,input,term=search.val(),lastTerm=$.data(this.container,"select2-last-term"),queryNumber;if(initial!==true&&lastTerm&&equal(term,lastTerm))return;$.data(this.container,"select2-last-term",term);if(initial!==true&&(this.showSearchInput===false||!this.opened())){return;}
function postRender(){search.removeClass("select2-active");self.positionDropdown();if(results.find('.select2-no-results,.select2-selection-limit,.select2-searching').length){self.liveRegion.text(results.text());}
else{self.liveRegion.text(self.opts.formatMatches(results.find('.select2-result-selectable').length));}}
function render(html){results.html(html);postRender();}
queryNumber=++this.queryCount;var maxSelSize=this.getMaximumSelectionSize();if(maxSelSize>=1){data=this.data();if($.isArray(data)&&data.length>=maxSelSize&&checkFormatter(opts.formatSelectionTooBig,"formatSelectionTooBig")){render("<li class='select2-selection-limit'>"+evaluate(opts.formatSelectionTooBig,maxSelSize)+"</li>");return;}}
if(search.val().length<opts.minimumInputLength){if(checkFormatter(opts.formatInputTooShort,"formatInputTooShort")){render("<li class='select2-no-results'>"+evaluate(opts.formatInputTooShort,search.val(),opts.minimumInputLength)+"</li>");}else{render("");}
if(initial&&this.showSearch)this.showSearch(true);return;}
if(opts.maximumInputLength&&search.val().length>opts.maximumInputLength){if(checkFormatter(opts.formatInputTooLong,"formatInputTooLong")){render("<li class='select2-no-results'>"+evaluate(opts.formatInputTooLong,search.val(),opts.maximumInputLength)+"</li>");}else{render("");}
return;}
if(opts.formatSearching&&this.findHighlightableChoices().length===0){render("<li class='select2-searching'>"+evaluate(opts.formatSearching)+"</li>");}
search.addClass("select2-active");this.removeHighlight();input=this.tokenize();if(input!=undefined&&input!=null){search.val(input);}
this.resultsPage=1;opts.query({element:opts.element,term:search.val(),page:this.resultsPage,context:null,matcher:opts.matcher,callback:this.bind(function(data){var def;if(queryNumber!=this.queryCount){return;}
if(!this.opened()){this.search.removeClass("select2-active");return;}
this.context=(data.context===undefined)?null:data.context;if(this.opts.createSearchChoice&&search.val()!==""){def=this.opts.createSearchChoice.call(self,search.val(),data.results);if(def!==undefined&&def!==null&&self.id(def)!==undefined&&self.id(def)!==null){if($(data.results).filter(function(){return equal(self.id(this),self.id(def));}).length===0){this.opts.createSearchChoicePosition(data.results,def);}}}
if(data.results.length===0&&checkFormatter(opts.formatNoMatches,"formatNoMatches")){render("<li class='select2-no-results'>"+evaluate(opts.formatNoMatches,search.val())+"</li>");return;}
results.empty();self.opts.populateResults.call(this,results,data.results,{term:search.val(),page:this.resultsPage,context:null});if(data.more===true&&checkFormatter(opts.formatLoadMore,"formatLoadMore")){results.append("<li class='select2-more-results'>"+self.opts.escapeMarkup(evaluate(opts.formatLoadMore,this.resultsPage))+"</li>");window.setTimeout(function(){self.loadMoreIfNeeded();},10);}
this.postprocessResults(data,initial);postRender();this.opts.element.trigger({type:"select2-loaded",items:data});})});},cancel:function(){this.close();},blur:function(){if(this.opts.selectOnBlur)
this.selectHighlighted({noFocus:true});this.close();this.container.removeClass("select2-container-active");if(this.search[0]===document.activeElement){this.search.blur();}
this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");},focusSearch:function(){focus(this.search);},selectHighlighted:function(options){if(this._touchMoved){this.clearTouchMoved();return;}
var index=this.highlight(),highlighted=this.results.find(".select2-highlighted"),data=highlighted.closest('.select2-result').data("select2-data");if(data){this.highlight(index);this.onSelect(data,options);}else if(options&&options.noFocus){this.close();}},getPlaceholder:function(){var placeholderOption;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((placeholderOption=this.getPlaceholderOption())!==undefined?placeholderOption.text():undefined);},getPlaceholderOption:function(){if(this.select){var firstOption=this.select.children('option').first();if(this.opts.placeholderOption!==undefined){return(this.opts.placeholderOption==="first"&&firstOption)||(typeof this.opts.placeholderOption==="function"&&this.opts.placeholderOption(this.select));}else if(firstOption.text()===""&&firstOption.val()===""){return firstOption;}}},initContainerWidth:function(){function resolveContainerWidth(){var style,attrs,matches,i,l,attr;if(this.opts.width==="off"){return null;}else if(this.opts.width==="element"){return this.opts.element.outerWidth(false)===0?'auto':this.opts.element.outerWidth(false)+'px';}else if(this.opts.width==="copy"||this.opts.width==="resolve"){style=this.opts.element.attr('style');if(style!==undefined){attrs=style.split(';');for(i=0,l=attrs.length;i<l;i=i+1){attr=attrs[i].replace(/\s/g,'');matches=attr.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i);if(matches!==null&&matches.length>=1)
return matches[1];}}
if(this.opts.width==="resolve"){style=this.opts.element.css('width');if(style.indexOf("%")>0)return style;return(this.opts.element.outerWidth(false)===0?'auto':this.opts.element.outerWidth(false)+'px');}
return null;}else if($.isFunction(this.opts.width)){return this.opts.width();}else{return this.opts.width;}};var width=resolveContainerWidth.call(this);if(width!==null){this.container.css("width",width);}}});SingleSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""));return container;},enableInterface:function(){if(this.parent.enableInterface.apply(this,arguments)){this.focusser.prop("disabled",!this.isInterfaceEnabled());}},opening:function(){var el,range,len;if(this.opts.minimumResultsForSearch>=0){this.showSearch(true);}
this.parent.opening.apply(this,arguments);if(this.showSearchInput!==false){this.search.val(this.focusser.val());}
this.search.focus();el=this.search.get(0);if(el.createTextRange){range=el.createTextRange();range.collapse(false);range.select();}else if(el.setSelectionRange){len=this.search.val().length;el.setSelectionRange(len,len);}
if(this.search.val()===""){if(this.nextSearchTerm!=undefined){this.search.val(this.nextSearchTerm);this.search.select();}}
this.focusser.prop("disabled",true).val("");this.updateResults(true);this.opts.element.trigger($.Event("select2-open"));},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments);this.focusser.prop("disabled",false);if(this.opts.shouldFocusInput(this)){this.focusser.focus();}},focus:function(){if(this.opened()){this.close();}else{this.focusser.prop("disabled",false);if(this.opts.shouldFocusInput(this)){this.focusser.focus();}}},isFocused:function(){return this.container.hasClass("select2-container-active");},cancel:function(){this.parent.cancel.apply(this,arguments);this.focusser.prop("disabled",false);if(this.opts.shouldFocusInput(this)){this.focusser.focus();}},destroy:function(){$("label[for='"+this.focusser.attr('id')+"']").attr('for',this.opts.element.attr("id"));this.parent.destroy.apply(this,arguments);},initContainer:function(){var selection,container=this.container,dropdown=this.dropdown,idSuffix=nextUid(),elementLabel;if(this.opts.minimumResultsForSearch<0){this.showSearch(false);}else{this.showSearch(true);}
this.selection=selection=container.find(".select2-choice");this.focusser=container.find(".select2-focusser");selection.find(".select2-chosen").attr("id","select2-chosen-"+idSuffix);this.focusser.attr("aria-labelledby","select2-chosen-"+idSuffix);this.results.attr("id","select2-results-"+idSuffix);this.search.attr("aria-owns","select2-results-"+idSuffix);this.focusser.attr("id","s2id_autogen"+idSuffix);elementLabel=$("label[for='"+this.opts.element.attr("id")+"']");this.focusser.prev().text(elementLabel.text()).attr('for',this.focusser.attr('id'));var originalTitle=this.opts.element.attr("title");this.opts.element.attr("title",(originalTitle||elementLabel.text()));this.focusser.attr("tabindex",this.elementTabIndex);this.search.attr("id",this.focusser.attr('id')+'_search');this.search.prev().text($("label[for='"+this.focusser.attr('id')+"']").text()).attr('for',this.search.attr('id'));this.search.on("keydown",this.bind(function(e){if(!this.isInterfaceEnabled())return;if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e);return;}
switch(e.which){case KEY.UP:case KEY.DOWN:this.moveHighlight((e.which===KEY.UP)?-1:1);killEvent(e);return;case KEY.ENTER:this.selectHighlighted();killEvent(e);return;case KEY.TAB:this.selectHighlighted({noFocus:true});return;case KEY.ESC:this.cancel(e);killEvent(e);return;}}));this.search.on("blur",this.bind(function(e){if(document.activeElement===this.body().get(0)){window.setTimeout(this.bind(function(){if(this.opened()){this.search.focus();}}),0);}}));this.focusser.on("keydown",this.bind(function(e){if(!this.isInterfaceEnabled())return;if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC){return;}
if(this.opts.openOnEnter===false&&e.which===KEY.ENTER){killEvent(e);return;}
if(e.which==KEY.DOWN||e.which==KEY.UP||(e.which==KEY.ENTER&&this.opts.openOnEnter)){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;this.open();killEvent(e);return;}
if(e.which==KEY.DELETE||e.which==KEY.BACKSPACE){if(this.opts.allowClear){this.clear();}
killEvent(e);return;}}));installKeyUpChangeEvent(this.focusser);this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){e.stopPropagation();if(this.opened())return;this.open();}}));selection.on("mousedown touchstart","abbr",this.bind(function(e){if(!this.isInterfaceEnabled())return;this.clear();killEventImmediately(e);this.close();this.selection.focus();}));selection.on("mousedown touchstart",this.bind(function(e){reinsertElement(selection);if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger($.Event("select2-focus"));}
if(this.opened()){this.close();}else if(this.isInterfaceEnabled()){this.open();}
killEvent(e);}));dropdown.on("mousedown touchstart",this.bind(function(){this.search.focus();}));selection.on("focus",this.bind(function(e){killEvent(e);}));this.focusser.on("focus",this.bind(function(){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger($.Event("select2-focus"));}
this.container.addClass("select2-container-active");})).on("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active");this.opts.element.trigger($.Event("select2-blur"));}}));this.search.on("focus",this.bind(function(){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger($.Event("select2-focus"));}
this.container.addClass("select2-container-active");}));this.initContainerWidth();this.opts.element.addClass("select2-offscreen");this.setPlaceholder();},clear:function(triggerChange){var data=this.selection.data("select2-data");if(data){var evt=$.Event("select2-clearing");this.opts.element.trigger(evt);if(evt.isDefaultPrevented()){return;}
var placeholderOption=this.getPlaceholderOption();this.opts.element.val(placeholderOption?placeholderOption.val():"");this.selection.find(".select2-chosen").empty();this.selection.removeData("select2-data");this.setPlaceholder();if(triggerChange!==false){this.opts.element.trigger({type:"select2-removed",val:this.id(data),choice:data});this.triggerChange({removed:data});}}},initSelection:function(){var selected;if(this.isPlaceholderOptionSelected()){this.updateSelection(null);this.close();this.setPlaceholder();}else{var self=this;this.opts.initSelection.call(null,this.opts.element,function(selected){if(selected!==undefined&&selected!==null){self.updateSelection(selected);self.close();self.setPlaceholder();self.nextSearchTerm=self.opts.nextSearchTerm(selected,self.search.val());}});}},isPlaceholderOptionSelected:function(){var placeholderOption;if(!this.getPlaceholder())return false;return((placeholderOption=this.getPlaceholderOption())!==undefined&&placeholderOption.prop("selected"))||(this.opts.element.val()==="")||(this.opts.element.val()===undefined)||(this.opts.element.val()===null);},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments),self=this;if(opts.element.get(0).tagName.toLowerCase()==="select"){opts.initSelection=function(element,callback){var selected=element.find("option").filter(function(){return this.selected&&!this.disabled});callback(self.optionToData(selected));};}else if("data"in opts){opts.initSelection=opts.initSelection||function(element,callback){var id=element.val();var match=null;opts.query({matcher:function(term,text,el){var is_match=equal(id,opts.id(el));if(is_match){match=el;}
return is_match;},callback:!$.isFunction(callback)?$.noop:function(){callback(match);}});};}
return opts;},getPlaceholder:function(){if(this.select){if(this.getPlaceholderOption()===undefined){return undefined;}}
return this.parent.getPlaceholder.apply(this,arguments);},setPlaceholder:function(){var placeholder=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&placeholder!==undefined){if(this.select&&this.getPlaceholderOption()===undefined)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(placeholder));this.selection.addClass("select2-default");this.container.removeClass("select2-allowclear");}},postprocessResults:function(data,initial,noHighlightUpdate){var selected=0,self=this,showSearchInput=true;this.findHighlightableChoices().each2(function(i,elm){if(equal(self.id(elm.data("select2-data")),self.opts.element.val())){selected=i;return false;}});if(noHighlightUpdate!==false){if(initial===true&&selected>=0){this.highlight(selected);}else{this.highlight(0);}}
if(initial===true){var min=this.opts.minimumResultsForSearch;if(min>=0){this.showSearch(countResults(data.results)>=min);}}},showSearch:function(showSearchInput){if(this.showSearchInput===showSearchInput)return;this.showSearchInput=showSearchInput;this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!showSearchInput);this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!showSearchInput);$(this.dropdown,this.container).toggleClass("select2-with-searchbox",showSearchInput);},onSelect:function(data,options){if(!this.triggerSelect(data)){return;}
var old=this.opts.element.val(),oldData=this.data();this.opts.element.val(this.id(data));this.updateSelection(data);this.opts.element.trigger({type:"select2-selected",val:this.id(data),choice:data});this.nextSearchTerm=this.opts.nextSearchTerm(data,this.search.val());this.close();if((!options||!options.noFocus)&&this.opts.shouldFocusInput(this)){this.focusser.focus();}
if(!equal(old,this.id(data))){this.triggerChange({added:data,removed:oldData});}},updateSelection:function(data){var container=this.selection.find(".select2-chosen"),formatted,cssClass;this.selection.data("select2-data",data);container.empty();if(data!==null){formatted=this.opts.formatSelection(data,container,this.opts.escapeMarkup);}
if(formatted!==undefined){container.append(formatted);}
cssClass=this.opts.formatSelectionCssClass(data,container);if(cssClass!==undefined){container.addClass(cssClass);}
this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==undefined){this.container.addClass("select2-allowclear");}},val:function(){var val,triggerChange=false,data=null,self=this,oldData=this.data();if(arguments.length===0){return this.opts.element.val();}
val=arguments[0];if(arguments.length>1){triggerChange=arguments[1];}
if(this.select){this.select.val(val).find("option").filter(function(){return this.selected}).each2(function(i,elm){data=self.optionToData(elm);return false;});this.updateSelection(data);this.setPlaceholder();if(triggerChange){this.triggerChange({added:data,removed:oldData});}}else{if(!val&&val!==0){this.clear(triggerChange);return;}
if(this.opts.initSelection===undefined){throw new Error("cannot call val() if initSelection() is not defined");}
this.opts.element.val(val);this.opts.initSelection(this.opts.element,function(data){self.opts.element.val(!data?"":self.id(data));self.updateSelection(data);self.setPlaceholder();if(triggerChange){self.triggerChange({added:data,removed:oldData});}});}},clearSearch:function(){this.search.val("");this.focusser.val("");},data:function(value){var data,triggerChange=false;if(arguments.length===0){data=this.selection.data("select2-data");if(data==undefined)data=null;return data;}else{if(arguments.length>1){triggerChange=arguments[1];}
if(!value){this.clear(triggerChange);}else{data=this.data();this.opts.element.val(!value?"":this.id(value));this.updateSelection(value);if(triggerChange){this.triggerChange({added:value,removed:data});}}}}});MultiSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return container;},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments),self=this;if(opts.element.get(0).tagName.toLowerCase()==="select"){opts.initSelection=function(element,callback){var data=[];element.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(i,elm){data.push(self.optionToData(elm));});callback(data);};}else if("data"in opts){opts.initSelection=opts.initSelection||function(element,callback){var ids=splitVal(element.val(),opts.separator);var matches=[];opts.query({matcher:function(term,text,el){var is_match=$.grep(ids,function(id){return equal(id,opts.id(el));}).length;if(is_match){matches.push(el);}
return is_match;},callback:!$.isFunction(callback)?$.noop:function(){var ordered=[];for(var i=0;i<ids.length;i++){var id=ids[i];for(var j=0;j<matches.length;j++){var match=matches[j];if(equal(id,opts.id(match))){ordered.push(match);matches.splice(j,1);break;}}}
callback(ordered);}});};}
return opts;},selectChoice:function(choice){var selected=this.container.find(".select2-search-choice-focus");if(selected.length&&choice&&choice[0]==selected[0]){}else{if(selected.length){this.opts.element.trigger("choice-deselected",selected);}
selected.removeClass("select2-search-choice-focus");if(choice&&choice.length){this.close();choice.addClass("select2-search-choice-focus");this.opts.element.trigger("choice-selected",choice);}}},destroy:function(){$("label[for='"+this.search.attr('id')+"']").attr('for',this.opts.element.attr("id"));this.parent.destroy.apply(this,arguments);},initContainer:function(){var selector=".select2-choices",selection;this.searchContainer=this.container.find(".select2-search-field");this.selection=selection=this.container.find(selector);var _this=this;this.selection.on("click",".select2-search-choice:not(.select2-locked)",function(e){_this.search[0].focus();_this.selectChoice($(this));});this.search.attr("id","s2id_autogen"+nextUid());this.search.prev().text($("label[for='"+this.opts.element.attr("id")+"']").text()).attr('for',this.search.attr('id'));this.search.on("input paste",this.bind(function(){if(!this.isInterfaceEnabled())return;if(!this.opened()){this.open();}}));this.search.attr("tabindex",this.elementTabIndex);this.keydowns=0;this.search.on("keydown",this.bind(function(e){if(!this.isInterfaceEnabled())return;++this.keydowns;var selected=selection.find(".select2-search-choice-focus");var prev=selected.prev(".select2-search-choice:not(.select2-locked)");var next=selected.next(".select2-search-choice:not(.select2-locked)");var pos=getCursorInfo(this.search);if(selected.length&&(e.which==KEY.LEFT||e.which==KEY.RIGHT||e.which==KEY.BACKSPACE||e.which==KEY.DELETE||e.which==KEY.ENTER)){var selectedChoice=selected;if(e.which==KEY.LEFT&&prev.length){selectedChoice=prev;}
else if(e.which==KEY.RIGHT){selectedChoice=next.length?next:null;}
else if(e.which===KEY.BACKSPACE){if(this.unselect(selected.first())){this.search.width(10);selectedChoice=prev.length?prev:next;}}else if(e.which==KEY.DELETE){if(this.unselect(selected.first())){this.search.width(10);selectedChoice=next.length?next:null;}}else if(e.which==KEY.ENTER){selectedChoice=null;}
this.selectChoice(selectedChoice);killEvent(e);if(!selectedChoice||!selectedChoice.length){this.open();}
return;}else if(((e.which===KEY.BACKSPACE&&this.keydowns==1)||e.which==KEY.LEFT)&&(pos.offset==0&&!pos.length)){this.selectChoice(selection.find(".select2-search-choice:not(.select2-locked)").last());killEvent(e);return;}else{this.selectChoice(null);}
if(this.opened()){switch(e.which){case KEY.UP:case KEY.DOWN:this.moveHighlight((e.which===KEY.UP)?-1:1);killEvent(e);return;case KEY.ENTER:this.selectHighlighted();killEvent(e);return;case KEY.TAB:this.selectHighlighted({noFocus:true});this.close();return;case KEY.ESC:this.cancel(e);killEvent(e);return;}}
if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.BACKSPACE||e.which===KEY.ESC){return;}
if(e.which===KEY.ENTER){if(this.opts.openOnEnter===false){return;}else if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey){return;}}
this.open();if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e);}
if(e.which===KEY.ENTER){killEvent(e);}}));this.search.on("keyup",this.bind(function(e){this.keydowns=0;this.resizeSearch();}));this.search.on("blur",this.bind(function(e){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");this.selectChoice(null);if(!this.opened())this.clearSearch();e.stopImmediatePropagation();this.opts.element.trigger($.Event("select2-blur"));}));this.container.on("click",selector,this.bind(function(e){if(!this.isInterfaceEnabled())return;if($(e.target).closest(".select2-search-choice").length>0){return;}
this.selectChoice(null);this.clearPlaceholder();if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger($.Event("select2-focus"));}
this.open();this.focusSearch();e.preventDefault();}));this.container.on("focus",selector,this.bind(function(){if(!this.isInterfaceEnabled())return;if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger($.Event("select2-focus"));}
this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder();}));this.initContainerWidth();this.opts.element.addClass("select2-offscreen");this.clearSearch();},enableInterface:function(){if(this.parent.enableInterface.apply(this,arguments)){this.search.prop("disabled",!this.isInterfaceEnabled());}},initSelection:function(){var data;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.updateSelection([]);this.close();this.clearSearch();}
if(this.select||this.opts.element.val()!==""){var self=this;this.opts.initSelection.call(null,this.opts.element,function(data){if(data!==undefined&&data!==null){self.updateSelection(data);self.close();self.clearSearch();}});}},clearSearch:function(){var placeholder=this.getPlaceholder(),maxWidth=this.getMaxSearchWidth();if(placeholder!==undefined&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(placeholder).addClass("select2-default");this.search.width(maxWidth>0?maxWidth:this.container.css("width"));}else{this.search.val("").width(10);}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default");}},opening:function(){this.clearPlaceholder();this.resizeSearch();this.parent.opening.apply(this,arguments);this.focusSearch();if(this.search.val()===""){if(this.nextSearchTerm!=undefined){this.search.val(this.nextSearchTerm);this.search.select();}}
this.updateResults(true);this.search.focus();this.opts.element.trigger($.Event("select2-open"));},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments);},focus:function(){this.close();this.search.focus();},isFocused:function(){return this.search.hasClass("select2-focused");},updateSelection:function(data){var ids=[],filtered=[],self=this;$(data).each(function(){if(indexOf(self.id(this),ids)<0){ids.push(self.id(this));filtered.push(this);}});data=filtered;this.selection.find(".select2-search-choice").remove();$(data).each(function(){self.addSelectedChoice(this);});self.postprocessResults();},tokenize:function(){var input=this.search.val();input=this.opts.tokenizer.call(this,input,this.data(),this.bind(this.onSelect),this.opts);if(input!=null&&input!=undefined){this.search.val(input);if(input.length>0){this.open();}}},onSelect:function(data,options){if(!this.triggerSelect(data)){return;}
this.addSelectedChoice(data);this.opts.element.trigger({type:"selected",val:this.id(data),choice:data});this.nextSearchTerm=this.opts.nextSearchTerm(data,this.search.val());this.clearSearch();this.updateResults();if(this.select||!this.opts.closeOnSelect)this.postprocessResults(data,false,this.opts.closeOnSelect===true);if(this.opts.closeOnSelect){this.close();this.search.width(10);}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();if(this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()){this.updateResults(true);}else{if(this.nextSearchTerm!=undefined){this.search.val(this.nextSearchTerm);this.updateResults();this.search.select();}}
this.positionDropdown();}else{this.close();this.search.width(10);}}
this.triggerChange({added:data});if(!options||!options.noFocus)
this.focusSearch();},cancel:function(){this.close();this.focusSearch();},addSelectedChoice:function(data){var enableChoice=!data.locked,enabledItem=$("<li class='select2-search-choice'>"+"    <div></div>"+"    <a href='#' class='select2-search-choice-close' tabindex='-1'></a>"+"</li>"),disabledItem=$("<li class='select2-search-choice select2-locked'>"+"<div></div>"+"</li>");var choice=enableChoice?enabledItem:disabledItem,id=this.id(data),val=this.getVal(),formatted,cssClass;formatted=this.opts.formatSelection(data,choice.find("div"),this.opts.escapeMarkup);if(formatted!=undefined){choice.find("div").replaceWith("<div>"+formatted+"</div>");}
cssClass=this.opts.formatSelectionCssClass(data,choice.find("div"));if(cssClass!=undefined){choice.addClass(cssClass);}
if(enableChoice){choice.find(".select2-search-choice-close").on("mousedown",killEvent).on("click dblclick",this.bind(function(e){if(!this.isInterfaceEnabled())return;this.unselect($(e.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");killEvent(e);this.close();this.focusSearch();})).on("focus",this.bind(function(){if(!this.isInterfaceEnabled())return;this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");}));}
choice.data("select2-data",data);choice.insertBefore(this.searchContainer);val.push(id);this.setVal(val);},unselect:function(selected){var val=this.getVal(),data,index;selected=selected.closest(".select2-search-choice");if(selected.length===0){throw"Invalid argument: "+selected+". Must be .select2-search-choice";}
data=selected.data("select2-data");if(!data){return;}
var evt=$.Event("select2-removing");evt.val=this.id(data);evt.choice=data;this.opts.element.trigger(evt);if(evt.isDefaultPrevented()){return false;}
while((index=indexOf(this.id(data),val))>=0){val.splice(index,1);this.setVal(val);if(this.select)this.postprocessResults();}
selected.remove();this.opts.element.trigger({type:"select2-removed",val:this.id(data),choice:data});this.triggerChange({removed:data});return true;},postprocessResults:function(data,initial,noHighlightUpdate){var val=this.getVal(),choices=this.results.find(".select2-result"),compound=this.results.find(".select2-result-with-children"),self=this;choices.each2(function(i,choice){var id=self.id(choice.data("select2-data"));if(indexOf(id,val)>=0){choice.addClass("select2-selected");choice.find(".select2-result-selectable").addClass("select2-selected");}});compound.each2(function(i,choice){if(!choice.is('.select2-result-selectable')&&choice.find(".select2-result-selectable:not(.select2-selected)").length===0){choice.addClass("select2-selected");}});if(this.highlight()==-1&&noHighlightUpdate!==false){self.highlight(0);}
if(!this.opts.createSearchChoice&&!choices.filter('.select2-result:not(.select2-selected)').length>0){if(!data||data&&!data.more&&this.results.find(".select2-no-results").length===0){if(checkFormatter(self.opts.formatNoMatches,"formatNoMatches")){this.results.append("<li class='select2-no-results'>"+evaluate(self.opts.formatNoMatches,self.search.val())+"</li>");}}}},getMaxSearchWidth:function(){return this.selection.width()-getSideBorderPadding(this.search);},resizeSearch:function(){var minimumWidth,left,maxWidth,containerLeft,searchWidth,sideBorderPadding=getSideBorderPadding(this.search);minimumWidth=measureTextWidth(this.search)+10;left=this.search.offset().left;maxWidth=this.selection.width();containerLeft=this.selection.offset().left;searchWidth=maxWidth-(left-containerLeft)-sideBorderPadding;if(searchWidth<minimumWidth){searchWidth=maxWidth-sideBorderPadding;}
if(searchWidth<40){searchWidth=maxWidth-sideBorderPadding;}
if(searchWidth<=0){searchWidth=minimumWidth;}
this.search.width(Math.floor(searchWidth));},getVal:function(){var val;if(this.select){val=this.select.val();return val===null?[]:val;}else{val=this.opts.element.val();return splitVal(val,this.opts.separator);}},setVal:function(val){var unique;if(this.select){this.select.val(val);}else{unique=[];$(val).each(function(){if(indexOf(this,unique)<0)unique.push(this);});this.opts.element.val(unique.length===0?"":unique.join(this.opts.separator));}},buildChangeDetails:function(old,current){var current=current.slice(0),old=old.slice(0);for(var i=0;i<current.length;i++){for(var j=0;j<old.length;j++){if(equal(this.opts.id(current[i]),this.opts.id(old[j]))){current.splice(i,1);if(i>0){i--;}
old.splice(j,1);j--;}}}
return{added:current,removed:old};},val:function(val,triggerChange){var oldData,self=this;if(arguments.length===0){return this.getVal();}
oldData=this.data();if(!oldData.length)oldData=[];if(!val&&val!==0){this.opts.element.val("");this.updateSelection([]);this.clearSearch();if(triggerChange){this.triggerChange({added:this.data(),removed:oldData});}
return;}
this.setVal(val);if(this.select){this.opts.initSelection(this.select,this.bind(this.updateSelection));if(triggerChange){this.triggerChange(this.buildChangeDetails(oldData,this.data()));}}else{if(this.opts.initSelection===undefined){throw new Error("val() cannot be called if initSelection() is not defined");}
this.opts.initSelection(this.opts.element,function(data){var ids=$.map(data,self.id);self.setVal(ids);self.updateSelection(data);self.clearSearch();if(triggerChange){self.triggerChange(self.buildChangeDetails(oldData,self.data()));}});}
this.clearSearch();},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");}
this.search.width(0);this.searchContainer.hide();},onSortEnd:function(){var val=[],self=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){val.push(self.opts.id($(this).data("select2-data")));});this.setVal(val);this.triggerChange();},data:function(values,triggerChange){var self=this,ids,old;if(arguments.length===0){return this.selection.children(".select2-search-choice").map(function(){return $(this).data("select2-data");}).get();}else{old=this.data();if(!values){values=[];}
ids=$.map(values,function(e){return self.opts.id(e);});this.setVal(ids);this.updateSelection(values);this.clearSearch();if(triggerChange){this.triggerChange(this.buildChangeDetails(old,this.data()));}}}});$.fn.select2=function(){var args=Array.prototype.slice.call(arguments,0),opts,select2,method,value,multiple,allowedMethods=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],valueMethods=["opened","isFocused","container","dropdown"],propertyMethods=["val","data"],methodsMap={search:"externalSearch"};this.each(function(){if(args.length===0||typeof(args[0])==="object"){opts=args.length===0?{}:$.extend({},args[0]);opts.element=$(this);if(opts.element.get(0).tagName.toLowerCase()==="select"){multiple=opts.element.prop("multiple");}else{multiple=opts.multiple||false;if("tags"in opts){opts.multiple=multiple=true;}}
select2=multiple?new window.Select2["class"].multi():new window.Select2["class"].single();select2.init(opts);}else if(typeof(args[0])==="string"){if(indexOf(args[0],allowedMethods)<0){throw"Unknown method: "+args[0];}
value=undefined;select2=$(this).data("select2");if(select2===undefined)return;method=args[0];if(method==="container"){value=select2.container;}else if(method==="dropdown"){value=select2.dropdown;}else{if(methodsMap[method])method=methodsMap[method];value=select2[method].apply(select2,args.slice(1));}
if(indexOf(args[0],valueMethods)>=0||(indexOf(args[0],propertyMethods)&&args.length==1)){return false;}}else{throw"Invalid arguments to select2 plugin: "+args;}});return(value===undefined)?this:value;};$.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(result,container,query,escapeMarkup){var markup=[];markMatch(result.text,query.term,markup,escapeMarkup);return markup.join("");},formatSelection:function(data,container,escapeMarkup){return data?escapeMarkup(data.text):undefined;},sortResults:function(results,container,query){return results;},formatResultCssClass:function(data){return data.css;},formatSelectionCssClass:function(data,container){return undefined;},formatMatches:function(matches){return matches+" results are available, use up and down arrow keys to navigate.";},formatNoMatches:function(){return"No matches found";},formatInputTooShort:function(input,min){var n=min-input.length;return"Please enter "+n+" or more character"+(n==1?"":"s");},formatInputTooLong:function(input,max){var n=input.length-max;return"Please delete "+n+" character"+(n==1?"":"s");},formatSelectionTooBig:function(limit){return"You can only select "+limit+" item"+(limit==1?"":"s");},formatLoadMore:function(pageNumber){return"Loading more results";},formatSearching:function(){return"Searching";},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==undefined?null:e.id;},matcher:function(term,text){return stripDiacritics(''+text).toUpperCase().indexOf(stripDiacritics(''+term).toUpperCase())>=0;},separator:",",tokenSeparators:[],tokenizer:defaultTokenizer,escapeMarkup:defaultEscapeMarkup,blurOnChange:false,selectOnBlur:false,adaptContainerCssClass:function(c){return c;},adaptDropdownCssClass:function(c){return null;},nextSearchTerm:function(selectedObject,currentSearchTerm){return undefined;},searchInputPlaceholder:'',createSearchChoicePosition:'top',shouldFocusInput:function(instance){if(instance.opts.minimumResultsForSearch<0){return false;}
return true;}};$.fn.select2.ajaxDefaults={transport:$.ajax,params:{type:"GET",cache:false,dataType:"json"}};window.Select2={query:{ajax:ajax,local:local,tags:tags},util:{debounce:debounce,markMatch:markMatch,escapeMarkup:defaultEscapeMarkup,stripDiacritics:stripDiacritics},"class":{"abstract":AbstractSelect2,"single":SingleSelect2,"multi":MultiSelect2}};}(jQuery));
/* End of File include/javascript/select2/select2.js */


(function($){$(function(){if(!window.Select2){return;}
var originalDestroy=window.Select2.class.abstract.prototype.destroy;_.extend(window.Select2.class.abstract.prototype,{destroy:function(){originalDestroy.call(this);var mask=$('#select2-drop-mask');mask.remove();}});});})(jQuery);
/* End of File include/javascript/sugar7/plugins/Select2.js */


(function(factory){if(typeof exports==="object"&&exports&&typeof module==="object"&&module&&module.exports===exports){factory(require("jquery"));}else if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else{factory(jQuery);}}(function($){var _baseDate=_generateBaseDate();var _ONE_DAY=86400;var _lang={am:'am',pm:'pm',AM:'AM',PM:'PM',decimal:'.',mins:'mins',hr:'hr',hrs:'hrs'};var methods={init:function(options)
{return this.each(function()
{var self=$(this);var attributeOptions=[];for(var key in $.fn.timepicker.defaults){if(self.data(key)){attributeOptions[key]=self.data(key);}}
var settings=$.extend({},$.fn.timepicker.defaults,attributeOptions,options);if(settings.lang){_lang=$.extend(_lang,settings.lang);}
settings=_parseSettings(settings);self.data('timepicker-settings',settings);self.addClass('ui-timepicker-input');if(settings.useSelect){_render(self);}else{self.prop('autocomplete','off');self.on('click.timepicker focus.timepicker',methods.show);self.on('change.timepicker',_formatValue);self.on('keydown.timepicker',_keydownhandler);self.on('keyup.timepicker',_keyuphandler);_formatValue.call(self.get(0));}});},show:function(e)
{var self=$(this);var settings=self.data('timepicker-settings');if(e){if(!settings.showOnFocus){return true;}
e.preventDefault();}
if(settings.useSelect){self.data('timepicker-list').focus();return;}
if(_hideKeyboard(self)){self.blur();}
var list=self.data('timepicker-list');if(self.prop('readonly')){return;}
if(!list||list.length===0||typeof settings.durationTime==='function'){_render(self);list=self.data('timepicker-list');}
if(_isVisible(list)){return;}
methods.hide();list.show();var listOffset={};if(settings.orientation=='rtl'){listOffset.left=self.offset().left+self.outerWidth()-list.outerWidth()+parseInt(list.css('marginLeft').replace('px',''),10);}else{listOffset.left=self.offset().left+parseInt(list.css('marginLeft').replace('px',''),10);}
if((self.offset().top+self.outerHeight(true)+list.outerHeight())>$(window).height()+$(window).scrollTop()){listOffset.top=self.offset().top-list.outerHeight()+parseInt(list.css('marginTop').replace('px',''),10);}else{listOffset.top=self.offset().top+self.outerHeight()+parseInt(list.css('marginTop').replace('px',''),10);}
list.offset(listOffset);var selected=list.find('.ui-timepicker-selected');if(!selected.length){if(_getTimeValue(self)){selected=_findRow(self,list,_time2int(_getTimeValue(self)));}else if(settings.scrollDefault){selected=_findRow(self,list,settings.scrollDefault);}}
if(selected&&selected.length){var topOffset=list.scrollTop()+selected.position().top-selected.outerHeight();list.scrollTop(topOffset);}else{list.scrollTop(0);}
$(document).on('touchstart.ui-timepicker mousedown.ui-timepicker',_closeHandler);if(settings.closeOnWindowScroll){$(document).on('scroll.ui-timepicker',_closeHandler);}
self.trigger('showTimepicker');return this;},hide:function(e)
{var self=$(this);var settings=self.data('timepicker-settings');if(settings&&settings.useSelect){self.blur();}
$('.ui-timepicker-wrapper').each(function(){var list=$(this);if(!_isVisible(list)){return;}
var self=list.data('timepicker-input');var settings=self.data('timepicker-settings');if(settings&&settings.selectOnBlur){_selectValue(self);}
list.hide();self.trigger('hideTimepicker');});return this;},option:function(key,value)
{return this.each(function(){var self=$(this);var settings=self.data('timepicker-settings');var list=self.data('timepicker-list');if(typeof key=='object'){settings=$.extend(settings,key);}else if(typeof key=='string'&&typeof value!='undefined'){settings[key]=value;}else if(typeof key=='string'){return settings[key];}
settings=_parseSettings(settings);self.data('timepicker-settings',settings);if(list){list.remove();self.data('timepicker-list',false);}
if(settings.useSelect){_render(self);}});},getSecondsFromMidnight:function()
{return _time2int(_getTimeValue(this));},getTime:function(relative_date)
{var self=this;var time_string=_getTimeValue(self);if(!time_string){return null;}
if(!relative_date){relative_date=new Date();}
var offset=_time2int(time_string);var time=new Date(relative_date);time.setHours(offset / 3600);time.setMinutes(offset%3600 / 60);time.setSeconds(offset%60);time.setMilliseconds(0);return time;},setTime:function(value)
{var self=this;var settings=self.data('timepicker-settings');if(settings.forceRoundTime){var prettyTime=_roundAndFormatTime(value,settings)}else{var prettyTime=_int2time(_time2int(value),settings.timeFormat);}
_setTimeValue(self,prettyTime);if(self.data('timepicker-list')){_setSelected(self,self.data('timepicker-list'));}
return this;},remove:function()
{var self=this;if(!self.hasClass('ui-timepicker-input')){return;}
var settings=self.data('timepicker-settings');self.removeAttr('autocomplete','off');self.removeClass('ui-timepicker-input');self.removeData('timepicker-settings');self.off('.timepicker');if(self.data('timepicker-list')){self.data('timepicker-list').remove();}
if(settings.useSelect){self.show();}
self.removeData('timepicker-list');return this;}};function _isVisible(elem)
{var el=elem[0];return el.offsetWidth>0&&el.offsetHeight>0;}
function _parseSettings(settings)
{if(settings.minTime){settings.minTime=_time2int(settings.minTime);}
if(settings.maxTime){settings.maxTime=_time2int(settings.maxTime);}
if(settings.durationTime&&typeof settings.durationTime!=='function'){settings.durationTime=_time2int(settings.durationTime);}
if(settings.scrollDefault=='now'){settings.scrollDefault=_time2int(new Date());}else if(settings.scrollDefault){settings.scrollDefault=_time2int(settings.scrollDefault);}else if(settings.minTime){settings.scrollDefault=settings.minTime;}
if(settings.scrollDefault){settings.scrollDefault=_roundTime(settings.scrollDefault,settings);}
if($.type(settings.timeFormat)==="string"&&settings.timeFormat.match(/[gh]/)){settings._twelveHourTime=true;}
if(settings.disableTimeRanges.length>0){for(var i in settings.disableTimeRanges){settings.disableTimeRanges[i]=[_time2int(settings.disableTimeRanges[i][0]),_time2int(settings.disableTimeRanges[i][1])];}
settings.disableTimeRanges=settings.disableTimeRanges.sort(function(a,b){return a[0]-b[0];});for(var i=settings.disableTimeRanges.length-1;i>0;i--){if(settings.disableTimeRanges[i][0]<=settings.disableTimeRanges[i-1][1]){settings.disableTimeRanges[i-1]=[Math.min(settings.disableTimeRanges[i][0],settings.disableTimeRanges[i-1][0]),Math.max(settings.disableTimeRanges[i][1],settings.disableTimeRanges[i-1][1])];settings.disableTimeRanges.splice(i,1);}}}
return settings;}
function _render(self)
{var settings=self.data('timepicker-settings');var list=self.data('timepicker-list');if(list&&list.length){list.remove();self.data('timepicker-list',false);}
if(settings.useSelect){list=$('<select />',{'class':'ui-timepicker-select'});var wrapped_list=list;}else{list=$('<ul />',{'class':'ui-timepicker-list'});var wrapped_list=$('<div />',{'class':'ui-timepicker-wrapper','tabindex':-1});wrapped_list.css({'display':'none','position':'absolute'}).append(list);}
if(settings.noneOption){if(settings.noneOption===true){settings.noneOption=(settings.useSelect)?'Time...':'None';}
if($.isArray(settings.noneOption)){for(var i in settings.noneOption){if(parseInt(i,10)==i){var noneElement=_generateNoneElement(settings.noneOption[i],settings.useSelect);list.append(noneElement);}}}else{var noneElement=_generateNoneElement(settings.noneOption,settings.useSelect);list.append(noneElement);}}
if(settings.className){wrapped_list.addClass(settings.className);}
if((settings.minTime!==null||settings.durationTime!==null)&&settings.showDuration){wrapped_list.addClass('ui-timepicker-with-duration');wrapped_list.addClass('ui-timepicker-step-'+settings.step);}
var durStart=settings.minTime;if(typeof settings.durationTime==='function'){durStart=_time2int(settings.durationTime());}else if(settings.durationTime!==null){durStart=settings.durationTime;}
var start=(settings.minTime!==null)?settings.minTime:0;var end=(settings.maxTime!==null)?settings.maxTime:(start+_ONE_DAY-1);if(end<=start){end+=_ONE_DAY;}
if(end===_ONE_DAY-1&&$.type(settings.timeFormat)==="string"&&settings.timeFormat.indexOf('H')!==-1){end=_ONE_DAY;}
var dr=settings.disableTimeRanges;var drCur=0;var drLen=dr.length;for(var i=start;i<=end;i+=settings.step*60){var timeInt=i;var timeString=_int2time(timeInt,settings.timeFormat);if(settings.useSelect){var row=$('<option />',{'value':timeString});row.text(timeString);}else{var row=$('<li />');row.data('time',(timeInt<=86400?timeInt:timeInt%86400));row.text(timeString);}
if((settings.minTime!==null||settings.durationTime!==null)&&settings.showDuration){var durationString=_int2duration(i-durStart,settings.step);if(settings.useSelect){row.text(row.text()+' ('+durationString+')');}else{var duration=$('<span />',{'class':'ui-timepicker-duration'});duration.text(' ('+durationString+')');row.append(duration);}}
if(drCur<drLen){if(timeInt>=dr[drCur][1]){drCur+=1;}
if(dr[drCur]&&timeInt>=dr[drCur][0]&&timeInt<dr[drCur][1]){if(settings.useSelect){row.prop('disabled',true);}else{row.addClass('ui-timepicker-disabled');}}}
list.append(row);}
wrapped_list.data('timepicker-input',self);self.data('timepicker-list',wrapped_list);if(settings.useSelect){if(self.val()){list.val(_roundAndFormatTime(self.val(),settings));}
list.on('focus',function(){$(this).data('timepicker-input').trigger('showTimepicker');});list.on('blur',function(){$(this).data('timepicker-input').trigger('hideTimepicker');});list.on('change',function(){_setTimeValue(self,$(this).val(),'select');});_setTimeValue(self,list.val());self.hide().after(list);}else{var appendTo=settings.appendTo;if(typeof appendTo==='string'){appendTo=$(appendTo);}else if(typeof appendTo==='function'){appendTo=appendTo(self);}
appendTo.append(wrapped_list);_setSelected(self,list);list.on('mousedown','li',function(e){self.off('focus.timepicker');self.on('focus.timepicker-ie-hack',function(){self.off('focus.timepicker-ie-hack');self.on('focus.timepicker',methods.show);});if(!_hideKeyboard(self)){self[0].focus();}
list.find('li').removeClass('ui-timepicker-selected');$(this).addClass('ui-timepicker-selected');if(_selectValue(self)){self.trigger('hideTimepicker');wrapped_list.hide();}});}}
function _generateNoneElement(optionValue,useSelect)
{var label,className,value;if(typeof optionValue=='object'){label=optionValue.label;className=optionValue.className;value=optionValue.value;}else if(typeof optionValue=='string'){label=optionValue;}else{$.error('Invalid noneOption value');}
if(useSelect){return $('<option />',{'value':value,'class':className,'text':label});}else{return $('<li />',{'class':className,'text':label}).data('time',value);}}
function _roundTime(seconds,settings)
{if(!$.isNumeric(seconds)){seconds=_time2int(seconds);}
if(seconds===null){return null;}else{var offset=seconds%(settings.step*60);if(offset>=settings.step*30){seconds+=(settings.step*60)-offset;}else{seconds-=offset;}
return seconds;}}
function _roundAndFormatTime(seconds,settings)
{seconds=_roundTime(seconds,settings);if(seconds!==null){return _int2time(seconds,settings.timeFormat);}}
function _generateBaseDate()
{return new Date(1970,1,1,0,0,0);}
function _closeHandler(e)
{var target=$(e.target);var input=target.closest('.ui-timepicker-input');if(input.length===0&&target.closest('.ui-timepicker-wrapper').length===0){methods.hide();$(document).unbind('.ui-timepicker');}}
function _hideKeyboard(self)
{var settings=self.data('timepicker-settings');return((window.navigator.msMaxTouchPoints||'ontouchstart'in document)&&settings.disableTouchKeyboard);}
function _findRow(self,list,value)
{if(!value&&value!==0){return false;}
var settings=self.data('timepicker-settings');var out=false;var halfStep=settings.step*30;list.find('li').each(function(i,obj){var jObj=$(obj);if(typeof jObj.data('time')!='number'){return;}
var offset=jObj.data('time')-value;if(Math.abs(offset)<halfStep||offset==halfStep){out=jObj;return false;}});return out;}
function _setSelected(self,list)
{list.find('li').removeClass('ui-timepicker-selected');var timeValue=_time2int(_getTimeValue(self),self.data('timepicker-settings'));if(timeValue===null){return;}
var selected=_findRow(self,list,timeValue);if(selected){var topDelta=selected.offset().top-list.offset().top;if(topDelta+selected.outerHeight()>list.outerHeight()||topDelta<0){list.scrollTop(list.scrollTop()+selected.position().top-selected.outerHeight());}
selected.addClass('ui-timepicker-selected');}}
function _formatValue(e)
{if(this.value===''){return;}
var self=$(this);var list=self.data('timepicker-list');if(self.is(':focus')&&(!e||e.type!='change')){return;}
var seconds=_time2int(this.value);if(seconds===null){self.trigger('timeFormatError');return;}
var settings=self.data('timepicker-settings');var rangeError=false;if(settings.minTime!==null&&seconds<settings.minTime){rangeError=true;}else if(settings.maxTime!==null&&seconds>settings.maxTime){rangeError=true;}
$.each(settings.disableTimeRanges,function(){if(seconds>=this[0]&&seconds<this[1]){rangeError=true;return false;}});if(settings.forceRoundTime){var offset=seconds%(settings.step*60);if(offset>=settings.step*30){seconds+=(settings.step*60)-offset;}else{seconds-=offset;}}
var prettyTime=_int2time(seconds,settings.timeFormat);if(rangeError){if(_setTimeValue(self,prettyTime,'error')){self.trigger('timeRangeError');}}else{_setTimeValue(self,prettyTime);}}
function _getTimeValue(self)
{if(self.is('input')){return self.val();}else{return self.data('ui-timepicker-value');}}
function _setTimeValue(self,value,source)
{if(self.is('input')){self.val(value);var settings=self.data('timepicker-settings');if(settings.useSelect){self.data('timepicker-list').val(_roundAndFormatTime(value,settings));}}
if(self.data('ui-timepicker-value')!=value){self.data('ui-timepicker-value',value);if(source=='select'){self.trigger('selectTime').trigger('changeTime').trigger('change');}else if(source!='error'){self.trigger('changeTime');}
return true;}else{self.trigger('selectTime');return false;}}
function _keydownhandler(e)
{var self=$(this);var list=self.data('timepicker-list');if(!list||!_isVisible(list)){if(e.keyCode==40){methods.show.call(self.get(0));list=self.data('timepicker-list');if(!_hideKeyboard(self)){self.focus();}}else{return true;}}
switch(e.keyCode){case 13:if(_selectValue(self)){methods.hide.apply(this);}
e.preventDefault();return false;case 38:var selected=list.find('.ui-timepicker-selected');if(!selected.length){list.find('li').each(function(i,obj){if($(obj).position().top>0){selected=$(obj);return false;}});selected.addClass('ui-timepicker-selected');}else if(!selected.is(':first-child')){selected.removeClass('ui-timepicker-selected');selected.prev().addClass('ui-timepicker-selected');if(selected.prev().position().top<selected.outerHeight()){list.scrollTop(list.scrollTop()-selected.outerHeight());}}
return false;case 40:selected=list.find('.ui-timepicker-selected');if(selected.length===0){list.find('li').each(function(i,obj){if($(obj).position().top>0){selected=$(obj);return false;}});selected.addClass('ui-timepicker-selected');}else if(!selected.is(':last-child')){selected.removeClass('ui-timepicker-selected');selected.next().addClass('ui-timepicker-selected');if(selected.next().position().top+2*selected.outerHeight()>list.outerHeight()){list.scrollTop(list.scrollTop()+selected.outerHeight());}}
return false;case 27:list.find('li').removeClass('ui-timepicker-selected');methods.hide();break;case 9:methods.hide();break;default:return true;}}
function _keyuphandler(e)
{var self=$(this);var list=self.data('timepicker-list');if(!list||!_isVisible(list)){return true;}
if(!self.data('timepicker-settings').typeaheadHighlight){list.find('li').removeClass('ui-timepicker-selected');return true;}
switch(e.keyCode){case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 77:case 80:case 186:case 8:case 46:_setSelected(self,list);break;default:return;}}
function _selectValue(self)
{var settings=self.data('timepicker-settings');var list=self.data('timepicker-list');var timeValue=null;var cursor=list.find('.ui-timepicker-selected');if(cursor.hasClass('ui-timepicker-disabled')){return false;}
if(cursor.length){timeValue=cursor.data('time');}
if(timeValue!==null){if(typeof timeValue=='string'){self.val(timeValue);}else{var timeString=_int2time(timeValue,settings.timeFormat);_setTimeValue(self,timeString,'select');}}
return true;}
function _int2duration(seconds,step)
{seconds=Math.abs(seconds);var minutes=Math.round(seconds/60),duration=[],hours,mins;if(minutes<60){duration=[minutes,_lang.mins];}else{hours=Math.floor(minutes/60);mins=minutes%60;if(step==30&&mins==30){hours+=_lang.decimal+5;}
duration.push(hours);duration.push(hours==1?_lang.hr:_lang.hrs);if(step!=30&&mins){duration.push(mins);duration.push(_lang.mins);}}
return duration.join(' ');}
function _int2time(seconds,format)
{if(seconds===null){return;}
var time=new Date(_baseDate.valueOf()+(seconds*1000));if(isNaN(time.getTime())){return;}
if($.type(format)==="function"){return format(time);}
var output='';var hour,code;for(var i=0;i<format.length;i++){code=format.charAt(i);switch(code){case'a':output+=(time.getHours()>11)?_lang.pm:_lang.am;break;case'A':output+=(time.getHours()>11)?_lang.pm.toUpperCase():_lang.am.toUpperCase();break;case'g':hour=time.getHours()%12;output+=(hour===0)?'12':hour;break;case'G':output+=time.getHours();break;case'h':hour=time.getHours()%12;if(hour!==0&&hour<10){hour='0'+hour;}
output+=(hour===0)?'12':hour;break;case'H':hour=time.getHours();if(seconds===_ONE_DAY)hour=24;output+=(hour>9)?hour:'0'+hour;break;case'i':var minutes=time.getMinutes();output+=(minutes>9)?minutes:'0'+minutes;break;case's':seconds=time.getSeconds();output+=(seconds>9)?seconds:'0'+seconds;break;case'\\':i++;output+=format.charAt(i);break;default:output+=code;}}
return output;}
function _time2int(timeString,settings)
{if(timeString==='')return null;if(!timeString||timeString+0==timeString)return timeString;if(typeof(timeString)=='object'){return timeString.getHours()*3600+timeString.getMinutes()*60+timeString.getSeconds();}
timeString=timeString.toLowerCase();if(timeString.slice(-1)=='a'||timeString.slice(-1)=='p'){timeString+='m';}
var pattern=new RegExp('^([0-2]?[0-9])\\W?([0-5][0-9])?\\W?([0-5][0-9])?\\s*('+_lang.am+'|'+_lang.pm+')?$');var time=timeString.match(pattern);if(!time){return null;}
var hour=parseInt(time[1]*1,10);var ampm=time[4];var hours=hour;if(ampm){if(hour==12){hours=(time[4]==_lang.pm)?12:0;}else{hours=(hour+(time[4]==_lang.pm?12:0));}}
var minutes=(time[2]*1||0);var seconds=(time[3]*1||0);var timeInt=hours*3600+minutes*60+seconds;if(!ampm&&settings&&settings._twelveHourTime&&settings.scrollDefault){var delta=timeInt-settings.scrollDefault;if(delta<0&&delta>=_ONE_DAY /-2){timeInt=(timeInt+(_ONE_DAY / 2))%_ONE_DAY;}}
return timeInt}
function _pad2(n){return("0"+n).slice(-2);}
$.fn.timepicker=function(method)
{if(!this.length)return this;if(methods[method]){if(!this.hasClass('ui-timepicker-input')){return this;}
return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}
else if(typeof method==="object"||!method){return methods.init.apply(this,arguments);}
else{$.error("Method "+method+" does not exist on jQuery.timepicker");}};$.fn.timepicker.defaults={className:null,minTime:null,maxTime:null,durationTime:null,step:30,showDuration:false,showOnFocus:true,timeFormat:'g:ia',scrollDefault:null,selectOnBlur:false,disableTouchKeyboard:false,forceRoundTime:false,appendTo:'body',orientation:'ltr',disableTimeRanges:[],closeOnWindowScroll:false,typeaheadHighlight:true,noneOption:false};}));
/* End of File include/javascript/jquery/jquery.timepicker.js */


(function(){if(jQuery&&jQuery.jstree){return;}
var is_ie6=false,is_ie7=false,is_ff2=false;(function($){"use strict";$.vakata={};$.vakata.css={get_css:function(rule_name,delete_flag,sheet){rule_name=rule_name.toLowerCase();var css_rules=sheet.cssRules||sheet.rules,j=0;do{if(css_rules.length&&j>css_rules.length+5){return false;}
if(css_rules[j].selectorText&&css_rules[j].selectorText.toLowerCase()==rule_name){if(delete_flag===true){if(sheet.removeRule){sheet.removeRule(j);}
if(sheet.deleteRule){sheet.deleteRule(j);}
return true;}
else{return css_rules[j];}}}
while(css_rules[++j]);return false;},add_css:function(rule_name,sheet){if($.jstree.css.get_css(rule_name,false,sheet)){return false;}
if(sheet.insertRule){sheet.insertRule(rule_name+' { }',0);}else{sheet.addRule(rule_name,null,0);}
return $.vakata.css.get_css(rule_name);},remove_css:function(rule_name,sheet){return $.vakata.css.get_css(rule_name,true,sheet);},add_sheet:function(opts){var tmp=false,is_new=true;if(opts.str){if(opts.title){tmp=$("style[id='"+opts.title+"-stylesheet']")[0];}
if(tmp){is_new=false;}
else{tmp=document.createElement("style");tmp.setAttribute('type',"text/css");if(opts.title){tmp.setAttribute("id",opts.title+"-stylesheet");}}
if(tmp.styleSheet){if(is_new){document.getElementsByTagName("head")[0].appendChild(tmp);tmp.styleSheet.cssText=opts.str;}
else{tmp.styleSheet.cssText=tmp.styleSheet.cssText+" "+opts.str;}}
else{tmp.appendChild(document.createTextNode(opts.str));document.getElementsByTagName("head")[0].appendChild(tmp);}
return tmp.sheet||tmp.styleSheet;}
if(opts.url){if(document.createStyleSheet){try{tmp=document.createStyleSheet(opts.url);}catch(e){}}
else{tmp=document.createElement('link');tmp.rel='stylesheet';tmp.type='text/css';tmp.media="all";tmp.href=opts.url;document.getElementsByTagName("head")[0].appendChild(tmp);return tmp.styleSheet;}}}};var instances=[],focused_instance=-1,plugins={},prepared_move={};$.fn.jstree=function(settings){var isMethodCall=(typeof settings=='string'),args=Array.prototype.slice.call(arguments,1),returnValue=this;if(isMethodCall){if(settings.substring(0,1)=='_'){return returnValue;}
this.each(function(){var instance=instances[$.data(this,"jstree_instance_id")],methodValue=(instance&&$.isFunction(instance[settings]))?instance[settings].apply(instance,args):instance;if(typeof methodValue!=="undefined"&&(settings.indexOf("is_")===0||(methodValue!==true&&methodValue!==false))){returnValue=methodValue;return false;}});}
else{this.each(function(){var instance_id=$.data(this,"jstree_instance_id"),a=[],b=settings?$.extend({},true,settings):{},c=$(this),s=false,t=[];a=a.concat(args);if(c.data("jstree")){a.push(c.data("jstree"));}
b=a.length?$.extend.apply(null,[true,b].concat(a)):b;if(typeof instance_id!=="undefined"&&instances[instance_id]){instances[instance_id].destroy();}
instance_id=parseInt(instances.push({}),10)-1;$.data(this,"jstree_instance_id",instance_id);b.plugins=$.isArray(b.plugins)?b.plugins:$.jstree.defaults.plugins.slice();b.plugins.unshift("core");b.plugins=b.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");s=$.extend(true,{},$.jstree.defaults,b);s.plugins=b.plugins;$.each(plugins,function(i,val){if($.inArray(i,s.plugins)===-1){s[i]=null;delete s[i];}
else{t.push(i);}});s.plugins=t;instances[instance_id]=new $.jstree._instance(instance_id,$(this).addClass("jstree jstree-"+instance_id),s);$.each(instances[instance_id]._get_settings().plugins,function(i,val){instances[instance_id].data[val]={};});$.each(instances[instance_id]._get_settings().plugins,function(i,val){if(plugins[val]){plugins[val].__init.apply(instances[instance_id]);}});setTimeout(function(){if(instances[instance_id]){instances[instance_id].init();}},0);});}
return returnValue;};$.jstree={defaults:{plugins:[]},_focused:function(){return instances[focused_instance]||null;},_reference:function(needle){if(instances[needle]){return instances[needle];}
var o=$(needle);if(!o.length&&typeof needle==="string"){o=$("#"+needle);}
if(!o.length){return null;}
return instances[o.closest(".jstree").data("jstree_instance_id")]||null;},_instance:function(index,container,settings){this.data={core:{}};this.get_settings=function(){return $.extend(true,{},settings);};this._get_settings=function(){return settings;};this.get_index=function(){return index;};this.get_container=function(){return container;};this.get_container_ul=function(){return container.children("ul:eq(0)");};this._set_settings=function(s){settings=$.extend(true,{},settings,s);};},_fn:{},plugin:function(pname,pdata){pdata=$.extend({},{__init:$.noop,__destroy:$.noop,_fn:{},defaults:false},pdata);plugins[pname]=pdata;$.jstree.defaults[pname]=pdata.defaults;$.each(pdata._fn,function(i,val){val.plugin=pname;val.old=$.jstree._fn[i];$.jstree._fn[i]=function(){var rslt,func=val,args=Array.prototype.slice.call(arguments),evnt=new $.Event("before.jstree"),rlbk=false;if(this.data.core.locked===true&&i!=="unlock"&&i!=="is_locked"){return;}
do{if(func&&func.plugin&&$.inArray(func.plugin,this._get_settings().plugins)!==-1){break;}
func=func.old;}while(func);if(!func){return;}
if(i.indexOf("_")===0){rslt=func.apply(this,args);}
else{rslt=this.get_container().triggerHandler(evnt,{"func":i,"inst":this,"args":args,"plugin":func.plugin});if(rslt===false){return;}
if(typeof rslt!=="undefined"){args=rslt;}
rslt=func.apply($.extend({},this,{__callback:function(data){this.get_container().triggerHandler(i+'.jstree',{"inst":this,"args":args,"rslt":data,"rlbk":rlbk});},__rollback:function(){rlbk=this.get_rollback();return rlbk;},__call_old:function(replace_arguments){return func.old.apply(this,(replace_arguments?Array.prototype.slice.call(arguments,1):args));}}),args);}
return rslt;};$.jstree._fn[i].old=val.old;$.jstree._fn[i].plugin=pname;});},rollback:function(rb){if(rb){if(!$.isArray(rb)){rb=[rb];}
$.each(rb,function(i,val){instances[val.i].set_rollback(val.h,val.d);});}}};$.jstree._fn=$.jstree._instance.prototype={};$(function(){var u=navigator.userAgent.toLowerCase(),v=(u.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,'0'])[1],css_string=''+'.jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } '+'.jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } '+'.jstree-rtl li { margin-left:0; margin-right:18px; } '+'.jstree > ul > li { margin-left:0px; } '+'.jstree-rtl > ul > li { margin-right:0px; } '+'.jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } '+'.jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } '+'.jstree a:focus { outline: none; } '+'.jstree a > ins { height:16px; width:16px; } '+'.jstree a > .jstree-icon { margin-right:3px; } '+'.jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } '+'li.jstree-open > ul { display:block; } ';if(/msie/.test(u)&&parseInt(v,10)==6){is_ie6=true;try{document.execCommand("BackgroundImageCache",false,true);}catch(err){}
css_string+=''+'.jstree li { height:18px; margin-left:0; margin-right:0; } '+'.jstree li li { margin-left:18px; } '+'.jstree-rtl li li { margin-left:0px; margin-right:18px; } '+'li.jstree-open ul { display:block; } '+'.jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } '+'.jstree li a ins { height:16px; width:16px; margin-right:3px; } '+'.jstree-rtl li a ins { margin-right:0px; margin-left:3px; } ';}
if(/msie/.test(u)&&parseInt(v,10)==7){is_ie7=true;css_string+='.jstree li a { border-width:0 !important; padding:0px 2px !important; } ';}
if(!/compatible/.test(u)&&/mozilla/.test(u)&&parseFloat(v,10)<1.9){is_ff2=true;css_string+=''+'.jstree ins { display:-moz-inline-box; } '+'.jstree li { line-height:12px; } '+'.jstree a { display:-moz-inline-box; } '+'.jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } ';}
$.vakata.css.add_sheet({str:css_string,title:"jstree"});});$.jstree.plugin("core",{__init:function(){this.data.core.locked=false;this.data.core.to_open=this.get_settings().core.initially_open;this.data.core.to_load=this.get_settings().core.initially_load;},defaults:{html_titles:false,animation:500,initially_open:[],initially_load:[],open_parents:true,notify_plugins:true,rtl:false,load_open:false,strings:{loading:" ",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus();if(this._get_settings().core.rtl){this.get_container().addClass("jstree-rtl").css("direction","rtl");}
this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_string("loading")+"</a></li></ul>");this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18;this.get_container().delegate("li > ins","click.jstree",$.proxy(function(event){event.preventDefault();event.currentTarget.blur();if(!$(event.currentTarget).hasClass("jstree-loading")){this.select_node(event.currentTarget,true,event);}},this)).bind("mousedown.jstree",$.proxy(function(){this.set_focus();},this)).bind("dblclick.jstree",function(event){var sel;if(document.selection&&document.selection.empty){document.selection.empty();}
else{if(window.getSelection){sel=window.getSelection();try{sel.removeAllRanges();sel.collapse();}catch(err){}}}});if(this._get_settings().core.notify_plugins){this.get_container().bind("load_node.jstree",$.proxy(function(e,data){var o=this._get_node(data.rslt.obj),t=this;if(o===-1){o=this.get_container_ul();}
if(!o.length){return;}
o.find("li").each(function(){var th=$(this);if(th.data("jstree")){$.each(th.data("jstree"),function(plugin,values){if(t.data[plugin]&&$.isFunction(t["_"+plugin+"_notify"])){t["_"+plugin+"_notify"].call(t,th,values);}});}});},this));}
if(this._get_settings().core.load_open){this.get_container().bind("load_node.jstree",$.proxy(function(e,data){var o=this._get_node(data.rslt.obj),t=this;if(o===-1){o=this.get_container_ul();}
if(!o.length){return;}
o.find("li.jstree-open:not(:has(ul))").each(function(){t.load_node(this,$.noop,$.noop);});},this));}
this.__callback();this.load_node(-1,function(){this.loaded();this.reload_nodes();});},destroy:function(){var i,n=this.get_index(),s=this._get_settings(),_this=this;$.each(s.plugins,function(i,val){try{plugins[val].__destroy.apply(_this);}catch(err){}});this.__callback();if(this.is_focused()){for(i in instances){if(instances.hasOwnProperty(i)&&i!=n){instances[i].set_focus();break;}}}
if(n===focused_instance){focused_instance=-1;}
this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree_instance_id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,'');});$(document).unbind(".jstree-"+n).undelegate(".jstree-"+n);instances[n]=null;delete instances[n];},_core_notify:function(n,data){if(data.opened){this.open_node(n,false,true);}},lock:function(){this.data.core.locked=true;this.get_container().children("ul").addClass("jstree-locked").css("opacity","0.7");this.__callback({});},unlock:function(){this.data.core.locked=false;this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1");this.__callback({});},is_locked:function(){return this.data.core.locked;},save_opened:function(){var _this=this;this.data.core.to_open=[];this.get_container_ul().find("li.jstree-open").each(function(){if(this.id){_this.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"));}});this.__callback(_this.data.core.to_open);},save_loaded:function(){},reload_nodes:function(is_callback){var _this=this,done=true,current=[],remaining=[];if(!is_callback){this.data.core.reopen=false;this.data.core.refreshing=true;this.data.core.to_open=$.map($.makeArray(this.data.core.to_open),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:");});this.data.core.to_load=$.map($.makeArray(this.data.core.to_load),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:");});if(this.data.core.to_open.length){this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open);}}
if(this.data.core.to_load.length){$.each(this.data.core.to_load,function(i,val){if(val=="#"){return true;}
if($(val).length){current.push(val);}
else{remaining.push(val);}});if(current.length){this.data.core.to_load=remaining;$.each(current,function(i,val){if(!_this._is_loaded(val)){_this.load_node(val,function(){_this.reload_nodes(true);},function(){_this.reload_nodes(true);});done=false;}});}}
if(this.data.core.to_open.length){$.each(this.data.core.to_open,function(i,val){_this.open_node(val,false,true);});}
if(done){if(this.data.core.reopen){clearTimeout(this.data.core.reopen);}
this.data.core.reopen=setTimeout(function(){_this.__callback({},_this);},50);this.data.core.refreshing=false;this.reopen();}},reopen:function(){var _this=this;if(this.data.core.to_open.length){$.each(this.data.core.to_open,function(i,val){_this.open_node(val,false,true);});}
this.__callback({});},refresh:function(obj){var _this=this;this.save_opened();if(!obj){obj=-1;}
obj=this._get_node(obj);if(!obj){obj=-1;}
if(obj!==-1){obj.children("UL").remove();}
else{this.get_container_ul().empty();}
this.load_node(obj,function(){_this.__callback({"obj":obj});_this.reload_nodes();});},loaded:function(){this.__callback();},set_focus:function(){if(this.is_focused()){return;}
var f=$.jstree._focused();if(f){f.unset_focus();}
this.get_container().addClass("jstree-focused");focused_instance=this.get_index();this.__callback();},is_focused:function(){return focused_instance==this.get_index();},unset_focus:function(){if(this.is_focused()){this.get_container().removeClass("jstree-focused");focused_instance=-1;}
this.__callback();},_get_node:function(obj){var $obj=$(obj,this.get_container());if($obj.is(".jstree")||obj==-1){return-1;}
$obj=$obj.closest("li",this.get_container());return $obj.length?$obj:false;},_get_next:function(obj,strict){obj=this._get_node(obj);if(obj===-1){return this.get_container().find("> ul > li:first-child");}
if(!obj.length){return false;}
if(strict){return(obj.nextAll("li").size()>0)?obj.nextAll("li:eq(0)"):false;}
if(obj.hasClass("jstree-open")){return obj.find("li:eq(0)");}
else if(obj.nextAll("li").size()>0){return obj.nextAll("li:eq(0)");}
else{return obj.parentsUntil(".jstree","li").next("li").eq(0);}},_get_prev:function(obj,strict){obj=this._get_node(obj);if(obj===-1){return this.get_container().find("> ul > li:last-child");}
if(!obj.length){return false;}
if(strict){return(obj.prevAll("li").length>0)?obj.prevAll("li:eq(0)"):false;}
if(obj.prev("li").length){obj=obj.prev("li").eq(0);while(obj.hasClass("jstree-open")){obj=obj.children("ul:eq(0)").children("li:last");}
return obj;}
else{var o=obj.parentsUntil(".jstree","li:eq(0)");return o.length?o:false;}},_get_parent:function(obj){obj=this._get_node(obj);if(obj==-1||!obj.length){return false;}
var o=obj.parentsUntil(".jstree","li:eq(0)");return o.length?o:-1;},_get_children:function(obj){obj=this._get_node(obj);if(obj===-1){return this.get_container().children("ul:eq(0)").children("li");}
if(!obj.length){return false;}
return obj.children("ul:eq(0)").children("li");},get_path:function(obj,id_mode){var p=[],_this=this;obj=this._get_node(obj);if(obj===-1||!obj||!obj.length){return false;}
obj.parentsUntil(".jstree","li").each(function(){p.push(id_mode?this.id:_this.get_text(this));});p.reverse();p.push(id_mode?obj.attr("id"):this.get_text(obj));return p;},_get_string:function(key){return this._get_settings().core.strings[key]||key;},is_open:function(obj){obj=this._get_node(obj);return obj&&obj!==-1&&obj.hasClass("jstree-open");},is_closed:function(obj){obj=this._get_node(obj);return obj&&obj!==-1&&obj.hasClass("jstree-closed");},is_leaf:function(obj){obj=this._get_node(obj);return obj&&obj!==-1&&obj.hasClass("jstree-leaf");},correct_state:function(obj){obj=this._get_node(obj);if(!obj||obj===-1){return false;}
obj.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove();this.__callback({"obj":obj});},open_node:function(obj,callback,skip_animation){obj=this._get_node(obj);if(!obj.length){return false;}
if(!obj.hasClass("jstree-closed")){if(callback){callback.call();}return false;}
var s=skip_animation||is_ie6?0:this._get_settings().core.animation,t=this;if(!this._is_loaded(obj)){obj.children("a").addClass("jstree-loading");this.load_node(obj,function(){t.open_node(obj,callback,skip_animation);},callback);}
else{if(this._get_settings().core.open_parents){obj.parentsUntil(".jstree",".jstree-closed").each(function(){t.open_node(this,false,true);});}
if(s){obj.children("ul").css("display","none");}
obj.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading");if(s){obj.children("ul").stop(true,true).slideDown(s,function(){this.style.display="";t.after_open(obj);});}
else{t.after_open(obj);}
this.__callback({"obj":obj});if(callback){callback.call();}}},after_open:function(obj){this.__callback({"obj":obj});},close_node:function(obj,skip_animation){obj=this._get_node(obj);var s=skip_animation||is_ie6?0:this._get_settings().core.animation,t=this;if(!obj.length||!obj.hasClass("jstree-open")){return false;}
if(s){obj.children("ul").attr("style","display:block !important");}
obj.removeClass("jstree-open").addClass("jstree-closed");if(s){obj.children("ul").stop(true,true).slideUp(s,function(){this.style.display="";t.after_close(obj);});}
else{t.after_close(obj);}
this.__callback({"obj":obj});},after_close:function(obj){this.__callback({"obj":obj});},toggle_node:function(obj){obj=this._get_node(obj);if(obj.hasClass("jstree-closed")){return this.open_node(obj);}
if(obj.hasClass("jstree-open")){return this.close_node(obj);}},open_all:function(obj,do_animation,original_obj){obj=obj?this._get_node(obj):-1;if(!obj||obj===-1){obj=this.get_container_ul();}
if(original_obj){obj=obj.find("li.jstree-closed");}
else{original_obj=obj;if(obj.is(".jstree-closed")){obj=obj.find("li.jstree-closed").andSelf();}
else{obj=obj.find("li.jstree-closed");}}
var _this=this;obj.each(function(){var __this=this;if(!_this._is_loaded(this)){_this.open_node(this,function(){_this.open_all(__this,do_animation,original_obj);},!do_animation);}
else{_this.open_node(this,false,!do_animation);}});if(original_obj.find('li.jstree-closed').length===0){this.__callback({"obj":original_obj});}},close_all:function(obj,do_animation){var _this=this;obj=obj?this._get_node(obj):this.get_container();if(!obj||obj===-1){obj=this.get_container_ul();}
obj.find("li.jstree-open").andSelf().each(function(){_this.close_node(this,!do_animation);});this.__callback({"obj":obj});},clean_node:function(obj){obj=obj&&obj!=-1?$(obj):this.get_container_ul();obj=obj.is("li")?obj.find("li").andSelf():obj.find("li");obj.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed");obj.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove();this.__callback({"obj":obj});},get_rollback:function(){this.__callback();return{i:this.get_index(),h:this.get_container().children("ul").clone(true),d:this.data};},set_rollback:function(html,data){this.get_container().empty().append(html);this.data=data;this.__callback();},load_node:function(obj,s_call,e_call){this.__callback({"obj":obj});},_is_loaded:function(obj){return true;},create_node:function(obj,position,js,callback,is_loaded){obj=this._get_node(obj);position=typeof position==="undefined"?"last":position;var d=$("<li />"),s=this._get_settings().core,tmp;if(obj!==-1&&!obj.length){return false;}
if(!is_loaded&&!this._is_loaded(obj)){this.load_node(obj,function(){this.create_node(obj,position,js,callback,true);});return false;}
this.__rollback();if(typeof js==="string"){js={"data":js};}
if(!js){js={};}
if(js.attr){d.attr(js.attr);}
if(js.metadata){d.data(js.metadata);}
if(js.state){d.addClass("jstree-"+js.state);}
if(!js.data){js.data=this._get_string("new_node");}
if(!$.isArray(js.data)){tmp=js.data;js.data=[];js.data.push(tmp);}
$.each(js.data,function(i,m){tmp=$("<a />");if($.isFunction(m)){m=m.call(this,js);}
if(typeof m=="string"){tmp.attr('href','#')[s.html_titles?"html":"text"](m);}
else{if(!m.attr){m.attr={};}
if(!m.attr.href){m.attr.href='#';}
tmp.attr(m.attr)[s.html_titles?"html":"text"](m.title);if(m.language){tmp.addClass(m.language);}}
tmp.prepend("<ins class='jstree-icon'>&#160;</ins>");if(!m.icon&&js.icon){m.icon=js.icon;}
if(m.icon){if(m.icon.indexOf("/")===-1){tmp.children("ins").addClass(m.icon);}
else{tmp.children("ins").css("background","url('"+m.icon+"') center center no-repeat");}}
d.append(tmp);});d.prepend("<ins class='jstree-icon'>&#160;</ins>");if(obj===-1){obj=this.get_container();if(position==="before"){position="first";}
if(position==="after"){position="last";}}
switch(position){case"before":obj.before(d);tmp=this._get_parent(obj);break;case"after":obj.after(d);tmp=this._get_parent(obj);break;case"inside":case"first":if(!obj.children("ul").length){obj.append("<ul />");}
obj.children("ul").prepend(d);tmp=obj;break;case"last":if(!obj.children("ul").length){obj.append("<ul />");}
obj.children("ul").append(d);tmp=obj;break;default:if(!obj.children("ul").length){obj.append("<ul />");}
if(!position){position=0;}
tmp=obj.children("ul").children("li").eq(position);if(tmp.length){tmp.before(d);}
else{obj.children("ul").append(d);}
tmp=obj;break;}
if(tmp===-1||tmp.get(0)===this.get_container().get(0)){tmp=-1;}
this.clean_node(tmp);this.__callback({"obj":d,"parent":tmp});if(callback){callback.call(this,d);}
return d;},get_text:function(obj){obj=this._get_node(obj);if(!obj.length){return false;}
var s=this._get_settings().core.html_titles;obj=obj.children("a:eq(0)");if(s){obj=obj.clone();obj.children("INS").remove();return obj.html();}
else{obj=obj.contents().filter(function(){return this.nodeType==3;})[0];return obj.nodeValue;}},set_text:function(obj,val){obj=this._get_node(obj);if(!obj.length){return false;}
obj=obj.children("a:eq(0)");if(this._get_settings().core.html_titles){var tmp=obj.children("INS").clone();obj.html(val).prepend(tmp);this.__callback({"obj":obj,"name":val});return true;}
else{obj=obj.contents().filter(function(){return this.nodeType==3;})[0];this.__callback({"obj":obj,"name":val});return(obj.nodeValue=val);}},rename_node:function(obj,val){obj=this._get_node(obj);this.__rollback();if(obj&&obj.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))){this.__callback({"obj":obj,"name":val});}},delete_node:function(obj){obj=this._get_node(obj);if(!obj.length){return false;}
this.__rollback();var p=this._get_parent(obj),prev=$([]),t=this;obj.each(function(){prev=prev.add(t._get_prev(this));});obj=obj.detach();if(p!==-1&&p.find("> ul > li").length===0){p.removeClass("jstree-open jstree-closed").addClass("jstree-leaf");}
this.clean_node(p);this.__callback({"obj":obj,"prev":prev,"parent":p});return obj;},prepare_move:function(o,r,pos,cb,is_cb){var p={};p.ot=$.jstree._reference(o)||this;p.o=p.ot._get_node(o);p.r=r===-1?-1:this._get_node(r);p.p=(typeof pos==="undefined"||pos===false)?"last":pos;if(!is_cb&&prepared_move.o&&prepared_move.o[0]===p.o[0]&&prepared_move.r[0]===p.r[0]&&prepared_move.p===p.p){this.__callback(prepared_move);if(cb){cb.call(this,prepared_move);}
return;}
p.ot=$.jstree._reference(p.o)||this;p.rt=$.jstree._reference(p.r)||this;if(p.r===-1||!p.r){p.cr=-1;switch(p.p){case"first":case"before":case"inside":p.cp=0;break;case"after":case"last":p.cp=p.rt.get_container().find(" > ul > li").length;break;default:p.cp=p.p;break;}}
else{if(!/^(before|after)$/.test(p.p)&&!this._is_loaded(p.r)){return this.load_node(p.r,function(){this.prepare_move(o,r,pos,cb,true);});}
switch(p.p){case"before":p.cp=p.r.index();p.cr=p.rt._get_parent(p.r);break;case"after":p.cp=p.r.index()+1;p.cr=p.rt._get_parent(p.r);break;case"inside":case"first":p.cp=0;p.cr=p.r;break;case"last":p.cp=p.r.find(" > ul > li").length;p.cr=p.r;break;default:p.cp=p.p;p.cr=p.r;break;}}
p.np=p.cr==-1?p.rt.get_container():p.cr;p.op=p.ot._get_parent(p.o);p.cop=p.o.index();if(p.op===-1){p.op=p.ot?p.ot.get_container():this.get_container();}
if(!/^(before|after)$/.test(p.p)&&p.op&&p.np&&p.op[0]===p.np[0]&&p.o.index()<p.cp){p.cp++;}
p.or=p.np.find(" > ul > li:nth-child("+(p.cp+1)+")");prepared_move=p;this.__callback(prepared_move);if(cb){cb.call(this,prepared_move);}},check_move:function(){var obj=prepared_move,ret=true,r=obj.r===-1?this.get_container():obj.r;if(!obj||!obj.o||obj.or[0]===obj.o[0]){return false;}
if(obj.op&&obj.np&&obj.op[0]===obj.np[0]&&obj.cp-1===obj.o.index()){return false;}
obj.o.each(function(){if(r.parentsUntil(".jstree","li").andSelf().index(this)!==-1){ret=false;return false;}});return ret;},move_node:function(obj,ref,position,is_copy,is_prepared,skip_check){if(!is_prepared){return this.prepare_move(obj,ref,position,function(p){this.move_node(p,false,false,is_copy,true,skip_check);});}
if(is_copy){prepared_move.cy=true;}
if(!skip_check&&!this.check_move()){return false;}
this.__rollback();var o=false;if(is_copy){o=obj.o.clone(true);o.find("*[id]").andSelf().each(function(){if(this.id){this.id="copy_"+this.id;}});}
else{o=obj.o;}
if(obj.or.length){obj.or.before(o);}
else{if(!obj.np.children("ul").length){$("<ul />").appendTo(obj.np);}
obj.np.children("ul:eq(0)").append(o);}
try{obj.ot.clean_node(obj.op);obj.rt.clean_node(obj.np);if(!obj.op.find("> ul > li").length){obj.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove();}}catch(e){}
if(is_copy){prepared_move.cy=true;prepared_move.oc=o;}
this.__callback(prepared_move);return prepared_move;},_get_move:function(){return prepared_move;}}});})(jQuery);(function($){var scrollbar_width,e1,e2;$(function(){if(/msie/.test(navigator.userAgent.toLowerCase())){e1=$('<textarea cols="10" rows="2"></textarea>').css({position:'absolute',top:-1000,left:0}).appendTo('body');e2=$('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:'absolute',top:-1000,left:0}).appendTo('body');scrollbar_width=e1.width()-e2.width();e1.add(e2).remove();}
else{e1=$('<div />').css({width:100,height:100,overflow:'auto',position:'absolute',top:-1000,left:0}).prependTo('body').append('<div />').find('div').css({width:'100%',height:200});scrollbar_width=100-e1.width();e1.parent().remove();}});$.jstree.plugin("ui",{__init:function(){this.data.ui.selected=$();this.data.ui.last_selected=false;this.data.ui.hovered=null;this.data.ui.to_select=this.get_settings().ui.initially_select;this.get_container().delegate("a","click.jstree",$.proxy(function(event){event.preventDefault();event.currentTarget.blur();if(!$(event.currentTarget).hasClass("jstree-loading")){this.select_node(event.currentTarget,true,event);}},this)).delegate("a","mouseenter.jstree",$.proxy(function(event){if(!$(event.currentTarget).hasClass("jstree-loading")){this.hover_node(event.target);}},this)).delegate("a","mouseleave.jstree",$.proxy(function(event){if(!$(event.currentTarget).hasClass("jstree-loading")){this.dehover_node(event.target);}},this)).bind("reopen.jstree",$.proxy(function(){this.reselect();},this)).bind("get_rollback.jstree",$.proxy(function(){this.dehover_node();this.save_selected();},this)).bind("set_rollback.jstree",$.proxy(function(){this.reselect();},this)).bind("close_node.jstree",$.proxy(function(event,data){var s=this._get_settings().ui,obj=this._get_node(data.rslt.obj),clk=(obj&&obj.length)?obj.children("ul").find("a.jstree-clicked"):$(),_this=this;if(s.selected_parent_close===false||!clk.length){return;}
clk.each(function(){_this.deselect_node(this);if(s.selected_parent_close==="select_parent"){_this.select_node(obj);}});},this)).bind("delete_node.jstree",$.proxy(function(event,data){var s=this._get_settings().ui.select_prev_on_delete,obj=this._get_node(data.rslt.obj),clk=(obj&&obj.length)?obj.find("a.jstree-clicked"):[],_this=this;clk.each(function(){_this.deselect_node(this);});if(s&&clk.length){data.rslt.prev.each(function(){if(this.parentNode){_this.select_node(this);return false;}});}},this)).bind("move_node.jstree",$.proxy(function(event,data){if(data.rslt.cy){data.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked");}},this));},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:true,select_prev_on_delete:true,disable_selecting_children:false,initially_select:[]},_fn:{_get_node:function(obj,allow_multiple){if(typeof obj==="undefined"||obj===null){return allow_multiple?this.data.ui.selected:this.data.ui.last_selected;}
var $obj=$(obj,this.get_container());if($obj.is(".jstree")||obj==-1){return-1;}
$obj=$obj.closest("li",this.get_container());return $obj.length?$obj:false;},_ui_notify:function(n,data){if(data.selected){this.select_node(n,false);}},save_selected:function(){var _this=this;this.data.ui.to_select=[];this.data.ui.selected.each(function(){if(this.id){_this.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"));}});this.__callback(this.data.ui.to_select);},reselect:function(){var _this=this,s=this.data.ui.to_select;s=$.map($.makeArray(s),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:");});$.each(s,function(i,val){if(val&&val!=="#"){_this.select_node(val);}});this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode;});this.__callback();},refresh:function(obj){this.save_selected();return this.__call_old();},hover_node:function(obj){obj=this._get_node(obj);if(!obj.length){return false;}
if(!obj.hasClass("jstree-hovered")){this.dehover_node();}
this.data.ui.hovered=obj.children("a").addClass("jstree-hovered").parent();this._fix_scroll(obj);this.__callback({"obj":obj});},dehover_node:function(){var obj=this.data.ui.hovered,p;if(!obj||!obj.length){return false;}
p=obj.children("a").removeClass("jstree-hovered").parent();if(this.data.ui.hovered[0]===p[0]){this.data.ui.hovered=null;}
this.__callback({"obj":obj});},select_node:function(obj,check,e){obj=this._get_node(obj);if(obj==-1||!obj||!obj.length){return false;}
var s=this._get_settings().ui,is_multiple=(s.select_multiple_modifier=="on"||(s.select_multiple_modifier!==false&&e&&e[s.select_multiple_modifier+"Key"])),is_range=(s.select_range_modifier!==false&&e&&e[s.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==obj[0]&&this.data.ui.last_selected.parent()[0]===obj.parent()[0]),is_selected=this.is_selected(obj),proceed=true,t=this;if(check){if(s.disable_selecting_children&&is_multiple&&((obj.parentsUntil(".jstree","li").children("a.jstree-clicked").length)||(obj.children("ul").find("a.jstree-clicked:eq(0)").length))){return false;}
proceed=false;switch(!0){case(is_range):this.data.ui.last_selected.addClass("jstree-last-selected");obj=obj[obj.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").andSelf();if(s.select_limit==-1||obj.length<s.select_limit){this.data.ui.last_selected.removeClass("jstree-last-selected");this.data.ui.selected.each(function(){if(this!==t.data.ui.last_selected[0]){t.deselect_node(this);}});is_selected=false;proceed=true;}
else{proceed=false;}
break;case(is_selected&&!is_multiple):this.deselect_all();is_selected=false;proceed=true;break;case(!is_selected&&!is_multiple):if(s.select_limit==-1||s.select_limit>0){this.deselect_all();proceed=true;}
break;case(is_selected&&is_multiple):this.deselect_node(obj);break;case(!is_selected&&is_multiple):if(s.select_limit==-1||this.data.ui.selected.length+1<=s.select_limit){proceed=true;}
break;}}
if(proceed&&!is_selected){if(!is_range){this.data.ui.last_selected=obj;}
obj.children("a").addClass("jstree-clicked");if(s.selected_parent_open){obj.parents(".jstree-closed").each(function(){t.open_node(this,false,true);});}
this.data.ui.selected=this.data.ui.selected.add(obj);this._fix_scroll(obj.eq(0));this.__callback({"obj":obj,"e":e});}},_fix_scroll:function(obj){var c=this.get_container()[0],t;if(c.scrollHeight>c.offsetHeight){obj=this._get_node(obj);if(!obj||obj===-1||!obj.length||!obj.is(":visible")){return;}
t=obj.offset().top-this.get_container().offset().top;if(t<0){c.scrollTop=c.scrollTop+t-1;}
if(t+this.data.core.li_height+(c.scrollWidth>c.offsetWidth?scrollbar_width:0)>c.offsetHeight){c.scrollTop=c.scrollTop+(t-c.offsetHeight+this.data.core.li_height+1+(c.scrollWidth>c.offsetWidth?scrollbar_width:0));}}},deselect_node:function(obj){obj=this._get_node(obj);if(!obj.length){return false;}
if(this.is_selected(obj)){obj.children("a").removeClass("jstree-clicked");this.data.ui.selected=this.data.ui.selected.not(obj);if(this.data.ui.last_selected.get(0)===obj.get(0)){this.data.ui.last_selected=this.data.ui.selected.eq(0);}
this.__callback({"obj":obj});}},toggle_select:function(obj){obj=this._get_node(obj);if(!obj.length){return false;}
if(this.is_selected(obj)){this.deselect_node(obj);}
else{this.select_node(obj);}},is_selected:function(obj){return this.data.ui.selected.index(this._get_node(obj))>=0;},get_selected:function(context){return context?$(context).find("a.jstree-clicked").parent():this.data.ui.selected;},deselect_all:function(context){var ret=context?$(context).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();ret.children("a.jstree-clicked").removeClass("jstree-clicked");this.data.ui.selected=$([]);this.data.ui.last_selected=false;this.__callback({"obj":ret});}}});$.jstree.defaults.plugins.push("ui");})(jQuery);(function($){$.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",$.proxy(function(e,data){if(this._get_settings().crrm.move.open_onmove){var t=this;data.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){t.open_node(this,false,true);});}},this));},defaults:{input_width_limit:200,move:{always_copy:false,open_onmove:true,default_position:"last",check_move:function(m){return true;}}},_fn:{_show_input:function(obj,callback){obj=this._get_node(obj);var rtl=this._get_settings().core.rtl,w=this._get_settings().crrm.input_width_limit,w1=obj.children("ins").width(),w2=obj.find("> a:visible > ins").width()*obj.find("> a:visible > ins").length,t=this.get_text(obj),h1=$("<div />",{css:{"position":"absolute","top":"-200px","left":(rtl?"0px":"-1000px"),"visibility":"hidden"}}).appendTo("body"),h2=obj.css("position","relative").append($("<input />",{"value":t,"class":"jstree-rename-input","css":{"padding":"0","border":"1px solid silver","position":"absolute","left":(rtl?"auto":(w1+w2+4)+"px"),"right":(rtl?(w1+w2+4)+"px":"auto"),"top":"0px","height":(this.data.core.li_height-2)+"px","lineHeight":(this.data.core.li_height-2)+"px","width":"150px"},"blur":$.proxy(function(){var i=obj.children(".jstree-rename-input"),v=i.val();if(v===""){v=t;}
h1.remove();i.remove();this.set_text(obj,t);this.rename_node(obj,v);callback.call(this,obj,v,t);obj.css("position","");},this),"keyup":function(event){var key=event.keyCode||event.which;if(key==27){this.value=t;this.blur();return;}
else if(key==13){this.blur();return;}
else{h2.width(Math.min(h1.text("pW"+this.value).width(),w));}},"keypress":function(event){var key=event.keyCode||event.which;if(key==13){return false;}}})).children(".jstree-rename-input");this.set_text(obj,"");h1.css({fontFamily:h2.css('fontFamily')||'',fontSize:h2.css('fontSize')||'',fontWeight:h2.css('fontWeight')||'',fontStyle:h2.css('fontStyle')||'',fontStretch:h2.css('fontStretch')||'',fontVariant:h2.css('fontVariant')||'',letterSpacing:h2.css('letterSpacing')||'',wordSpacing:h2.css('wordSpacing')||''});h2.width(Math.min(h1.text("pW"+h2[0].value).width(),w))[0].select();},rename:function(obj){obj=this._get_node(obj);this.__rollback();var f=this.__callback;this._show_input(obj,function(obj,new_name,old_name){f.call(this,{"obj":obj,"new_name":new_name,"old_name":old_name});});},create:function(obj,position,js,callback,skip_rename){var t,_this=this;obj=this._get_node(obj);if(!obj){obj=-1;}
this.__rollback();t=this.create_node(obj,position,js,function(t){var p=this._get_parent(t),pos=$(t).index();if(callback){callback.call(this,t);}
if(p.length&&p.hasClass("jstree-closed")){this.open_node(p,false,true);}
if(!skip_rename){this._show_input(t,function(obj,new_name,old_name){_this.__callback({"obj":obj,"name":new_name,"parent":p,"position":pos});});}
else{_this.__callback({"obj":t,"name":this.get_text(t),"parent":p,"position":pos});}});return t;},remove:function(obj){obj=this._get_node(obj,true);var p=this._get_parent(obj),prev=this._get_prev(obj);this.__rollback();obj=this.delete_node(obj);if(obj!==false){this.__callback({"obj":obj,"prev":prev,"parent":p});}},check_move:function(){if(!this.__call_old()){return false;}
var s=this._get_settings().crrm.move;if(!s.check_move.call(this,this._get_move())){return false;}
return true;},move_node:function(obj,ref,position,is_copy,is_prepared,skip_check){var s=this._get_settings().crrm.move;if(!is_prepared){if(typeof position==="undefined"){position=s.default_position;}
if(position==="inside"&&!s.default_position.match(/^(before|after)$/)){position=s.default_position;}
return this.__call_old(true,obj,ref,position,is_copy,false,skip_check);}
if(s.always_copy===true||(s.always_copy==="multitree"&&obj.rt.get_index()!==obj.ot.get_index())){is_copy=true;}
this.__call_old(true,obj,ref,position,is_copy,true,skip_check);},cut:function(obj){obj=this._get_node(obj,true);if(!obj||!obj.length){return false;}
this.data.crrm.cp_nodes=false;this.data.crrm.ct_nodes=obj;this.__callback({"obj":obj});},copy:function(obj){obj=this._get_node(obj,true);if(!obj||!obj.length){return false;}
this.data.crrm.ct_nodes=false;this.data.crrm.cp_nodes=obj;this.__callback({"obj":obj});},paste:function(obj){obj=this._get_node(obj);if(!obj||!obj.length){return false;}
var nodes=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes){return false;}
if(this.data.crrm.ct_nodes){this.move_node(this.data.crrm.ct_nodes,obj);this.data.crrm.ct_nodes=false;}
if(this.data.crrm.cp_nodes){this.move_node(this.data.crrm.cp_nodes,obj,false,true);}
this.__callback({"obj":obj,"nodes":nodes});}}});})(jQuery);(function($){var themes_loaded=[];$.jstree._themes=false;$.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",$.proxy(function(){var s=this._get_settings().themes;this.data.themes.dots=s.dots;this.data.themes.icons=s.icons;},this)).bind("loaded.jstree",$.proxy(function(){if(!this.data.themes.dots){this.hide_dots();}
else{this.show_dots();}
if(!this.data.themes.icons){this.hide_icons();}
else{this.show_icons();}},this));},defaults:{theme:"default",url:false,dots:true,icons:true},_fn:{set_theme:function(theme_name,theme_url){if(!theme_name){return false;}
if(!theme_url){theme_url=$.jstree._themes+theme_name+'/style.css';}
if($.inArray(theme_url,themes_loaded)==-1){$.vakata.css.add_sheet({"url":theme_url});themes_loaded.push(theme_url);}
if(this.data.themes.theme!=theme_name){this.get_container().removeClass('jstree-'+this.data.themes.theme);this.data.themes.theme=theme_name;}
this.get_container().addClass('jstree-'+theme_name);if(!this.data.themes.dots){this.hide_dots();}
else{this.show_dots();}
if(!this.data.themes.icons){this.hide_icons();}
else{this.show_icons();}
this.__callback();},get_theme:function(){return this.data.themes.theme;},show_dots:function(){this.data.themes.dots=true;this.get_container().children("ul").removeClass("jstree-no-dots");},hide_dots:function(){this.data.themes.dots=false;this.get_container().children("ul").addClass("jstree-no-dots");},toggle_dots:function(){if(this.data.themes.dots){this.hide_dots();}else{this.show_dots();}},show_icons:function(){this.data.themes.icons=true;this.get_container().children("ul").removeClass("jstree-no-icons");},hide_icons:function(){this.data.themes.icons=false;this.get_container().children("ul").addClass("jstree-no-icons");},toggle_icons:function(){if(this.data.themes.icons){this.hide_icons();}else{this.show_icons();}}}});$(function(){if($.jstree._themes===false){$("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/)){$.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+'themes/';return false;}});}
if($.jstree._themes===false){$.jstree._themes="themes/";}});$.jstree.defaults.plugins.push("themes");})(jQuery);(function($){var bound=[];function exec(i,event){var f=$.jstree._focused(),tmp;if(f&&f.data&&f.data.hotkeys&&f.data.hotkeys.enabled){tmp=f._get_settings().hotkeys[i];if(tmp){return tmp.call(f,event);}}}
$.jstree.plugin("hotkeys",{__init:function(){if(typeof $.hotkeys==="undefined"){throw"jsTree hotkeys: jQuery hotkeys plugin not included.";}
if(!this.data.ui){throw"jsTree hotkeys: jsTree UI plugin not included.";}
$.each(this._get_settings().hotkeys,function(i,v){if(v!==false&&$.inArray(i,bound)==-1){$(document).bind("keydown",i,function(event){return exec(i,event);});bound.push(i);}});this.get_container().bind("lock.jstree",$.proxy(function(){if(this.data.hotkeys.enabled){this.data.hotkeys.enabled=false;this.data.hotkeys.revert=true;}},this)).bind("unlock.jstree",$.proxy(function(){if(this.data.hotkeys.revert){this.data.hotkeys.enabled=true;}},this));this.enable_hotkeys();},defaults:{"up":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(o));return false;},"ctrl+up":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(o));return false;},"shift+up":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(o));return false;},"down":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(o));return false;},"ctrl+down":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(o));return false;},"shift+down":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(o));return false;},"left":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o){if(o.hasClass("jstree-open")){this.close_node(o);}
else{this.hover_node(this._get_prev(o));}}
return false;},"ctrl+left":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o){if(o.hasClass("jstree-open")){this.close_node(o);}
else{this.hover_node(this._get_prev(o));}}
return false;},"shift+left":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o){if(o.hasClass("jstree-open")){this.close_node(o);}
else{this.hover_node(this._get_prev(o));}}
return false;},"right":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o&&o.length){if(o.hasClass("jstree-closed")){this.open_node(o);}
else{this.hover_node(this._get_next(o));}}
return false;},"ctrl+right":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o&&o.length){if(o.hasClass("jstree-closed")){this.open_node(o);}
else{this.hover_node(this._get_next(o));}}
return false;},"shift+right":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o&&o.length){if(o.hasClass("jstree-closed")){this.open_node(o);}
else{this.hover_node(this._get_next(o));}}
return false;},"space":function(){if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").click();}
return false;},"ctrl+space":function(event){event.type="click";if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").trigger(event);}
return false;},"shift+space":function(event){event.type="click";if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").trigger(event);}
return false;},"f2":function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected);},"del":function(){this.remove(this.data.ui.hovered||this._get_node(null));}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=true;},disable_hotkeys:function(){this.data.hotkeys.enabled=false;}}});})(jQuery);(function($){$.jstree.plugin("json_data",{__init:function(){var s=this._get_settings().json_data;if(s.progressive_unload){this.get_container().bind("after_close.jstree",function(e,data){data.rslt.obj.children("ul").remove();});}},defaults:{data:false,ajax:false,correct_state:true,progressive_render:false,progressive_unload:false},_fn:{load_node:function(obj,s_call,e_call){var _this=this;this.load_node_json(obj,function(){_this.__callback({"obj":_this._get_node(obj)});s_call.call(this);},e_call);},_is_loaded:function(obj){var s=this._get_settings().json_data;obj=this._get_node(obj);return obj==-1||!obj||(!s.ajax&&!s.progressive_render&&!$.isFunction(s.data))||obj.is(".jstree-open, .jstree-leaf")||obj.children("ul").children("li").length>0;},refresh:function(obj){obj=this._get_node(obj);var s=this._get_settings().json_data;if(obj&&obj!==-1&&s.progressive_unload&&($.isFunction(s.data)||!!s.ajax)){obj.removeData("jstree_children");}
return this.__call_old();},load_node_json:function(obj,s_call,e_call){var s=this.get_settings().json_data,d,error_func=function(){},success_func=function(){};obj=this._get_node(obj);if(obj&&obj!==-1&&(s.progressive_render||s.progressive_unload)&&!obj.is(".jstree-open, .jstree-leaf")&&obj.children("ul").children("li").length===0&&obj.data("jstree_children")){d=this._parse_json(obj.data("jstree_children"),obj);if(d){obj.append(d);if(!s.progressive_unload){obj.removeData("jstree_children");}}
this.clean_node(obj);if(s_call){s_call.call(this);}
return;}
if(obj&&obj!==-1){if(obj.data("jstree_is_loading")){return;}
else{obj.data("jstree_is_loading",true);}}
switch(!0){case(!s.data&&!s.ajax):throw"Neither data nor ajax settings supplied.";case($.isFunction(s.data)):s.data.call(this,obj,$.proxy(function(d){d=this._parse_json(d,obj);if(!d){if(obj===-1||!obj){if(s.correct_state){this.get_container().children("ul").empty();}}
else{obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(obj);}}
if(e_call){e_call.call(this);}}
else{if(obj===-1||!obj){this.get_container().children("ul").empty().append(d.children());}
else{obj.append(d).children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");}
this.clean_node(obj);if(s_call){s_call.call(this);}}},this));break;case(!!s.data&&!s.ajax)||(!!s.data&&!!s.ajax&&(!obj||obj===-1)):if(!obj||obj==-1){d=this._parse_json(s.data,obj);if(d){this.get_container().children("ul").empty().append(d.children());this.clean_node();}
else{if(s.correct_state){this.get_container().children("ul").empty();}}}
if(s_call){s_call.call(this);}
break;case(!s.data&&!!s.ajax)||(!!s.data&&!!s.ajax&&obj&&obj!==-1):error_func=function(x,t,e){var ef=this.get_settings().json_data.ajax.error;if(ef){ef.call(this,x,t,e);}
if(obj!=-1&&obj.length){obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(t==="success"&&s.correct_state){this.correct_state(obj);}}
else{if(t==="success"&&s.correct_state){this.get_container().children("ul").empty();}}
if(e_call){e_call.call(this);}};success_func=function(d,t,x){var sf=this.get_settings().json_data.ajax.success;if(sf){d=sf.call(this,d,t,x)||d;}
if(d===""||(d&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")==="")||(!$.isArray(d)&&!$.isPlainObject(d))){return error_func.call(this,x,t,"");}
d=this._parse_json(d,obj);if(d){if(obj===-1||!obj){this.get_container().children("ul").empty().append(d.children());}
else{obj.append(d).children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");}
this.clean_node(obj);if(s_call){s_call.call(this);}}
else{if(obj===-1||!obj){if(s.correct_state){this.get_container().children("ul").empty();if(s_call){s_call.call(this);}}}
else{obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(obj);if(s_call){s_call.call(this);}}}}};s.ajax.context=this;s.ajax.error=error_func;s.ajax.success=success_func;if(!s.ajax.dataType){s.ajax.dataType="json";}
if($.isFunction(s.ajax.url)){s.ajax.url=s.ajax.url.call(this,obj);}
if($.isFunction(s.ajax.data)){s.ajax.data=s.ajax.data.call(this,obj);}
$.ajax(s.ajax);break;}},_parse_json:function(js,obj,is_callback){var d=false,p=this._get_settings(),s=p.json_data,t=p.core.html_titles,tmp,i,j,ul1,ul2;if(!js){return d;}
if(s.progressive_unload&&obj&&obj!==-1){obj.data("jstree_children",d);}
if($.isArray(js)){d=$();if(!js.length){return false;}
for(i=0,j=js.length;i<j;i++){tmp=this._parse_json(js[i],obj,true);if(tmp.length){d=d.add(tmp);}}}
else{if(typeof js=="string"){js={data:js};}
if(!js.data&&js.data!==""){return d;}
d=$("<li />");if(js.attr){d.attr(js.attr);}
if(js.metadata){d.data(js.metadata);}
if(js.state){d.addClass("jstree-"+js.state);}
if(!$.isArray(js.data)){tmp=js.data;js.data=[];js.data.push(tmp);}
$.each(js.data,function(i,m){tmp=$("<a />");if($.isFunction(m)){m=m.call(this,js);}
if(typeof m=="string"){tmp.attr('href','#')[t?"html":"text"](m);}
else{if(!m.attr){m.attr={};}
if(!m.attr.href){m.attr.href='#';}
tmp.attr(m.attr)[t?"html":"text"](m.title);if(m.language){tmp.addClass(m.language);}}
tmp.prepend("<ins class='jstree-icon'>&#160;</ins>");if(!m.icon&&js.icon){m.icon=js.icon;}
if(m.icon){if(m.icon.indexOf("/")===-1){tmp.children("ins").addClass(m.icon);}
else{tmp.children("ins").css("background","url('"+m.icon+"') center center no-repeat");}}
d.append(tmp);});d.prepend("<ins class='jstree-icon'>&#160;</ins>");if(js.children){if(s.progressive_render&&js.state!=="open"){d.addClass("jstree-closed").data("jstree_children",js.children);}
else{if(s.progressive_unload){d.data("jstree_children",js.children);}
if($.isArray(js.children)&&js.children.length){tmp=this._parse_json(js.children,obj,true);if(tmp.length){ul2=$("<ul />");ul2.append(tmp);d.append(ul2);}}}}}
if(!is_callback){ul1=$("<ul />");ul1.append(d);d=ul1;}
return d;},get_json:function(obj,li_attr,a_attr,is_callback){var result=[],s=this._get_settings(),_this=this,tmp1,tmp2,li,a,t,lang;obj=this._get_node(obj);if(!obj||obj===-1){obj=this.get_container().find("> ul > li");}
li_attr=$.isArray(li_attr)?li_attr:["id","class"];if(!is_callback&&this.data.types){li_attr.push(s.types.type_attr);}
a_attr=$.isArray(a_attr)?a_attr:[];obj.each(function(){li=$(this);tmp1={data:[]};if(li_attr.length){tmp1.attr={};}
$.each(li_attr,function(i,v){tmp2=li.attr(v);if(tmp2&&tmp2.length&&tmp2.replace(/jstree[^ ]*/ig,'').length){tmp1.attr[v]=(" "+tmp2).replace(/ jstree[^ ]*/ig,'').replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"");}});if(li.hasClass("jstree-open")){tmp1.state="open";}
if(li.hasClass("jstree-closed")){tmp1.state="closed";}
if(li.data()){tmp1.metadata=li.data();}
a=li.children("a");a.each(function(){t=$(this);if(a_attr.length||$.inArray("languages",s.plugins)!==-1||t.children("ins").get(0).style.backgroundImage.length||(t.children("ins").get(0).className&&t.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,'').length)){lang=false;if($.inArray("languages",s.plugins)!==-1&&$.isArray(s.languages)&&s.languages.length){$.each(s.languages,function(l,lv){if(t.hasClass(lv)){lang=lv;return false;}});}
tmp2={attr:{},title:_this.get_text(t,lang)};$.each(a_attr,function(k,z){tmp2.attr[z]=(" "+(t.attr(z)||"")).replace(/ jstree[^ ]*/ig,'').replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"");});if($.inArray("languages",s.plugins)!==-1&&$.isArray(s.languages)&&s.languages.length){$.each(s.languages,function(k,z){if(t.hasClass(z)){tmp2.language=z;return true;}});}
if(t.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,'').replace(/^\s+$/ig,"").length){tmp2.icon=t.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,'').replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"");}
if(t.children("ins").get(0).style.backgroundImage.length){tmp2.icon=t.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","");}}
else{tmp2=_this.get_text(t);}
if(a.length>1){tmp1.data.push(tmp2);}
else{tmp1.data=tmp2;}});li=li.find("> ul > li");if(li.length){tmp1.children=_this.get_json(li,li_attr,a_attr,true);}
result.push(tmp1);});return result;}}});})(jQuery);(function($){$.jstree.plugin("languages",{__init:function(){this._load_css();},defaults:[],_fn:{set_lang:function(i){var langs=this._get_settings().languages,st=false,selector=".jstree-"+this.get_index()+' a';if(!$.isArray(langs)||langs.length===0){return false;}
if($.inArray(i,langs)==-1){if(!!langs[i]){i=langs[i];}
else{return false;}}
if(i==this.data.languages.current_language){return true;}
st=$.vakata.css.get_css(selector+"."+this.data.languages.current_language,false,this.data.languages.language_css);if(st!==false){st.style.display="none";}
st=$.vakata.css.get_css(selector+"."+i,false,this.data.languages.language_css);if(st!==false){st.style.display="";}
this.data.languages.current_language=i;this.__callback(i);return true;},get_lang:function(){return this.data.languages.current_language;},_get_string:function(key,lang){var langs=this._get_settings().languages,s=this._get_settings().core.strings;if($.isArray(langs)&&langs.length){lang=(lang&&$.inArray(lang,langs)!=-1)?lang:this.data.languages.current_language;}
if(s[lang]&&s[lang][key]){return s[lang][key];}
if(s[key]){return s[key];}
return key;},get_text:function(obj,lang){obj=this._get_node(obj)||this.data.ui.last_selected;if(!obj.size()){return false;}
var langs=this._get_settings().languages,s=this._get_settings().core.html_titles;if($.isArray(langs)&&langs.length){lang=(lang&&$.inArray(lang,langs)!=-1)?lang:this.data.languages.current_language;obj=obj.children("a."+lang);}
else{obj=obj.children("a:eq(0)");}
if(s){obj=obj.clone();obj.children("INS").remove();return obj.html();}
else{obj=obj.contents().filter(function(){return this.nodeType==3;})[0];return obj.nodeValue;}},set_text:function(obj,val,lang){obj=this._get_node(obj)||this.data.ui.last_selected;if(!obj.size()){return false;}
var langs=this._get_settings().languages,s=this._get_settings().core.html_titles,tmp;if($.isArray(langs)&&langs.length){lang=(lang&&$.inArray(lang,langs)!=-1)?lang:this.data.languages.current_language;obj=obj.children("a."+lang);}
else{obj=obj.children("a:eq(0)");}
if(s){tmp=obj.children("INS").clone();obj.html(val).prepend(tmp);this.__callback({"obj":obj,"name":val,"lang":lang});return true;}
else{obj=obj.contents().filter(function(){return this.nodeType==3;})[0];this.__callback({"obj":obj,"name":val,"lang":lang});return(obj.nodeValue=val);}},_load_css:function(){var langs=this._get_settings().languages,str="/* languages css */",selector=".jstree-"+this.get_index()+' a',ln;if($.isArray(langs)&&langs.length){this.data.languages.current_language=langs[0];for(ln=0;ln<langs.length;ln++){str+=selector+"."+langs[ln]+" {";if(langs[ln]!=this.data.languages.current_language){str+=" display:none; ";}
str+=" } ";}
this.data.languages.language_css=$.vakata.css.add_sheet({'str':str,'title':"jstree-languages"});}},create_node:function(obj,position,js,callback){var t=this.__call_old(true,obj,position,js,function(t){var langs=this._get_settings().languages,a=t.children("a"),ln;if($.isArray(langs)&&langs.length){for(ln=0;ln<langs.length;ln++){if(!a.is("."+langs[ln])){t.append(a.eq(0).clone().removeClass(langs.join(" ")).addClass(langs[ln]));}}
a.not("."+langs.join(", .")).remove();}
if(callback){callback.call(this,t);}});return t;}}});})(jQuery);(function($){$.jstree.plugin("cookies",{__init:function(){if(typeof $.cookie==="undefined"){throw"jsTree cookie: jQuery cookie plugin not included.";}
var s=this._get_settings().cookies,tmp;if(!!s.save_loaded){tmp=$.cookie(s.save_loaded);if(tmp&&tmp.length){this.data.core.to_load=tmp.split(",");}}
if(!!s.save_opened){tmp=$.cookie(s.save_opened);if(tmp&&tmp.length){this.data.core.to_open=tmp.split(",");}}
if(!!s.save_selected){tmp=$.cookie(s.save_selected);if(tmp&&tmp.length&&this.data.ui){this.data.ui.to_select=tmp.split(",");}}
this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",$.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",$.proxy(function(e){if(this._get_settings().cookies.auto_save){this.save_cookie((e.handleObj.namespace+e.handleObj.type).replace("jstree",""));}},this));},this));},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:true,cookie_options:{}},_fn:{save_cookie:function(c){if(this.data.core.refreshing){return;}
var s=this._get_settings().cookies;if(!c){if(s.save_loaded){this.save_loaded();$.cookie(s.save_loaded,this.data.core.to_load.join(","),s.cookie_options);}
if(s.save_opened){this.save_opened();$.cookie(s.save_opened,this.data.core.to_open.join(","),s.cookie_options);}
if(s.save_selected&&this.data.ui){this.save_selected();$.cookie(s.save_selected,this.data.ui.to_select.join(","),s.cookie_options);}
return;}
switch(c){case"open_node":case"close_node":if(!!s.save_opened){this.save_opened();$.cookie(s.save_opened,this.data.core.to_open.join(","),s.cookie_options);}
if(!!s.save_loaded){this.save_loaded();$.cookie(s.save_loaded,this.data.core.to_load.join(","),s.cookie_options);}
break;case"select_node":case"deselect_node":if(!!s.save_selected&&this.data.ui){this.save_selected();$.cookie(s.save_selected,this.data.ui.to_select.join(","),s.cookie_options);}
break;}}}});})(jQuery);(function($){$.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",$.proxy(function(e,data){var obj=this._get_node(data.rslt.obj);obj=obj===-1?this.get_container().children("ul"):obj.children("ul");this.sort(obj);},this)).bind("rename_node.jstree create_node.jstree create.jstree",$.proxy(function(e,data){this.sort(data.rslt.obj.parent());},this)).bind("move_node.jstree",$.proxy(function(e,data){var m=data.rslt.np==-1?this.get_container():data.rslt.np;this.sort(m.children("ul"));},this));},defaults:function(a,b){return this.get_text(a)>this.get_text(b)?1:-1;},_fn:{sort:function(obj){var s=this._get_settings().sort,t=this;obj.append($.makeArray(obj.children("li")).sort($.proxy(s,t)));obj.find("> li > ul").each(function(){t.sort($(this));});this.clean_node(obj);}}});})(jQuery);(function($){var o=false,r=false,m=false,ml=false,sli=false,sti=false,dir1=false,dir2=false,last_pos=false;$.vakata.dnd={is_down:false,is_drag:false,helper:false,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(e,data,html){if($.vakata.dnd.is_drag){$.vakata.drag_stop({});}
try{e.currentTarget.unselectable="on";e.currentTarget.onselectstart=function(){return false;};if(e.currentTarget.style){e.currentTarget.style.MozUserSelect="none";}}catch(err){}
$.vakata.dnd.init_x=e.pageX;$.vakata.dnd.init_y=e.pageY;$.vakata.dnd.user_data=data;$.vakata.dnd.is_down=true;$.vakata.dnd.helper=$("<div id='vakata-dragged' />").html(html);$(document).bind("mousemove",$.vakata.dnd.drag);$(document).bind("mouseup",$.vakata.dnd.drag_stop);return false;},drag:function(e){if(!$.vakata.dnd.is_down){return;}
if(!$.vakata.dnd.is_drag){if(Math.abs(e.pageX-$.vakata.dnd.init_x)>5||Math.abs(e.pageY-$.vakata.dnd.init_y)>5){$.vakata.dnd.helper.appendTo("body");$.vakata.dnd.is_drag=true;$(document).triggerHandler("drag_start.vakata",{"event":e,"data":$.vakata.dnd.user_data});}
else{return;}}
if(e.type==="mousemove"){var d=$(document),t=d.scrollTop(),l=d.scrollLeft();if(e.pageY-t<20){if(sti&&dir1==="down"){clearInterval(sti);sti=false;}
if(!sti){dir1="up";sti=setInterval(function(){$(document).scrollTop($(document).scrollTop()-$.vakata.dnd.scroll_spd);},150);}}
else{if(sti&&dir1==="up"){clearInterval(sti);sti=false;}}
if($(window).height()-(e.pageY-t)<20){if(sti&&dir1==="up"){clearInterval(sti);sti=false;}
if(!sti){dir1="down";sti=setInterval(function(){$(document).scrollTop($(document).scrollTop()+$.vakata.dnd.scroll_spd);},150);}}
else{if(sti&&dir1==="down"){clearInterval(sti);sti=false;}}
if(e.pageX-l<20){if(sli&&dir2==="right"){clearInterval(sli);sli=false;}
if(!sli){dir2="left";sli=setInterval(function(){$(document).scrollLeft($(document).scrollLeft()-$.vakata.dnd.scroll_spd);},150);}}
else{if(sli&&dir2==="left"){clearInterval(sli);sli=false;}}
if($(window).width()-(e.pageX-l)<20){if(sli&&dir2==="left"){clearInterval(sli);sli=false;}
if(!sli){dir2="right";sli=setInterval(function(){$(document).scrollLeft($(document).scrollLeft()+$.vakata.dnd.scroll_spd);},150);}}
else{if(sli&&dir2==="right"){clearInterval(sli);sli=false;}}}
$.vakata.dnd.helper.css({left:(e.pageX+$.vakata.dnd.helper_left)+"px",top:(e.pageY+$.vakata.dnd.helper_top)+"px"});$(document).triggerHandler("drag.vakata",{"event":e,"data":$.vakata.dnd.user_data});},drag_stop:function(e){if(sli){clearInterval(sli);}
if(sti){clearInterval(sti);}
$(document).unbind("mousemove",$.vakata.dnd.drag);$(document).unbind("mouseup",$.vakata.dnd.drag_stop);$(document).triggerHandler("drag_stop.vakata",{"event":e,"data":$.vakata.dnd.user_data});$.vakata.dnd.helper.remove();$.vakata.dnd.init_x=0;$.vakata.dnd.init_y=0;$.vakata.dnd.user_data={};$.vakata.dnd.is_down=false;$.vakata.dnd.is_drag=false;}};$(function(){var css_string='#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ';$.vakata.css.add_sheet({str:css_string,title:"vakata"});});$.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:false,after:false,inside:false,before:false,off:false,prepared:false,w:0,to1:false,to2:false,cof:false,cw:false,ch:false,i1:false,i2:false,mto:false};this.get_container().bind("mouseenter.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){if(this.data.themes){m.attr("class","jstree-"+this.data.themes.theme);if(ml){ml.attr("class","jstree-"+this.data.themes.theme);}
$.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme);}
if(e.currentTarget===e.target&&$.vakata.dnd.user_data.obj&&$($.vakata.dnd.user_data.obj).length&&$($.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==e.target){var tr=$.jstree._reference(e.target),dc;if(tr.data.dnd.foreign){dc=tr._get_settings().dnd.drag_check.call(this,{"o":o,"r":tr.get_container(),is_root:true});if(dc===true||dc.inside===true||dc.before===true||dc.after===true){$.vakata.dnd.helper.children("ins").attr("class","jstree-ok");}}
else{tr.prepare_move(o,tr.get_container(),"last");if(tr.check_move()){$.vakata.dnd.helper.children("ins").attr("class","jstree-ok");}}}}},this)).bind("mouseup.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree&&e.currentTarget===e.target&&$.vakata.dnd.user_data.obj&&$($.vakata.dnd.user_data.obj).length&&$($.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==e.target){var tr=$.jstree._reference(e.currentTarget),dc;if(tr.data.dnd.foreign){dc=tr._get_settings().dnd.drag_check.call(this,{"o":o,"r":tr.get_container(),is_root:true});if(dc===true||dc.inside===true||dc.before===true||dc.after===true){tr._get_settings().dnd.drag_finish.call(this,{"o":o,"r":tr.get_container(),is_root:true});}}
else{tr.move_node(o,tr.get_container(),"last",e[tr._get_settings().dnd.copy_modifier+"Key"]);}}},this)).bind("mouseleave.jstree",$.proxy(function(e){if(e.relatedTarget&&e.relatedTarget.id&&e.relatedTarget.id==="jstree-marker-line"){return false;}
if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1);}
if(this.data.dnd.i2){clearInterval(this.data.dnd.i2);}
if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1);}
if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2);}
if($.vakata.dnd.helper.children("ins").hasClass("jstree-ok")){$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");}}},this)).bind("mousemove.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){var cnt=this.get_container()[0];if(e.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1);}
this.data.dnd.i1=setInterval($.proxy(function(){this.scrollLeft+=$.vakata.dnd.scroll_spd;},cnt),100);}
else if(e.pageX-24<this.data.dnd.cof.left){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1);}
this.data.dnd.i1=setInterval($.proxy(function(){this.scrollLeft-=$.vakata.dnd.scroll_spd;},cnt),100);}
else{if(this.data.dnd.i1){clearInterval(this.data.dnd.i1);}}
if(e.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch){if(this.data.dnd.i2){clearInterval(this.data.dnd.i2);}
this.data.dnd.i2=setInterval($.proxy(function(){this.scrollTop+=$.vakata.dnd.scroll_spd;},cnt),100);}
else if(e.pageY-24<this.data.dnd.cof.top){if(this.data.dnd.i2){clearInterval(this.data.dnd.i2);}
this.data.dnd.i2=setInterval($.proxy(function(){this.scrollTop-=$.vakata.dnd.scroll_spd;},cnt),100);}
else{if(this.data.dnd.i2){clearInterval(this.data.dnd.i2);}}}},this)).bind("scroll.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree&&m&&ml){m.hide();ml.hide();}},this)).delegate("a","mousedown.jstree",$.proxy(function(e){if(e.which===1){this.start_drag(e.currentTarget,e);return false;}},this)).delegate("a","mouseenter.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){this.dnd_enter(e.currentTarget);}},this)).delegate("a","mousemove.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){if(!r||!r.length||r.children("a")[0]!==e.currentTarget){this.dnd_enter(e.currentTarget);}
if(typeof this.data.dnd.off.top==="undefined"){this.data.dnd.off=$(e.target).offset();}
this.data.dnd.w=(e.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height;if(this.data.dnd.w<0){this.data.dnd.w+=this.data.core.li_height;}
this.dnd_show();}},this)).delegate("a","mouseleave.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){if(e.relatedTarget&&e.relatedTarget.id&&e.relatedTarget.id==="jstree-marker-line"){return false;}
if(m){m.hide();}
if(ml){ml.hide();}
this.data.dnd.mto=setTimeout((function(t){return function(){t.dnd_leave(e);};})(this),0);}},this)).delegate("a","mouseup.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){this.dnd_finish(e);}},this));$(document).bind("drag_stop.vakata",$.proxy(function(){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1);}
if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2);}
if(this.data.dnd.i1){clearInterval(this.data.dnd.i1);}
if(this.data.dnd.i2){clearInterval(this.data.dnd.i2);}
this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;this.data.dnd.off=false;this.data.dnd.prepared=false;this.data.dnd.w=false;this.data.dnd.to1=false;this.data.dnd.to2=false;this.data.dnd.i1=false;this.data.dnd.i2=false;this.data.dnd.active=false;this.data.dnd.foreign=false;if(m){m.css({"top":"-2000px"});}
if(ml){ml.css({"top":"-2000px"});}},this)).bind("drag_start.vakata",$.proxy(function(e,data){if(data.data.jstree){var et=$(data.event.target);if(et.closest(".jstree").hasClass("jstree-"+this.get_index())){this.dnd_enter(et);}}},this));var s=this._get_settings().dnd;if(s.drag_target){$(document).delegate(s.drag_target,"mousedown.jstree-"+this.get_index(),$.proxy(function(e){o=e.target;$.vakata.dnd.drag_start(e,{jstree:true,obj:e.target},"<ins class='jstree-icon'></ins>"+$(e.target).text());if(this.data.themes){if(m){m.attr("class","jstree-"+this.data.themes.theme);}
if(ml){ml.attr("class","jstree-"+this.data.themes.theme);}
$.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme);}
$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var cnt=this.get_container();this.data.dnd.cof=cnt.offset();this.data.dnd.cw=parseInt(cnt.width(),10);this.data.dnd.ch=parseInt(cnt.height(),10);this.data.dnd.foreign=true;e.preventDefault();},this));}
if(s.drop_target){$(document).delegate(s.drop_target,"mouseenter.jstree-"+this.get_index(),$.proxy(function(e){if(this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{"o":o,"r":$(e.target),"e":e})){$.vakata.dnd.helper.children("ins").attr("class","jstree-ok");}},this)).delegate(s.drop_target,"mouseleave.jstree-"+this.get_index(),$.proxy(function(e){if(this.data.dnd.active){$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");}},this)).delegate(s.drop_target,"mouseup.jstree-"+this.get_index(),$.proxy(function(e){if(this.data.dnd.active&&$.vakata.dnd.helper.children("ins").hasClass("jstree-ok")){this._get_settings().dnd.drop_finish.call(this,{"o":o,"r":$(e.target),"e":e});}},this));}},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,drop_target:".jstree-drop",drop_check:function(data){return true;},drop_finish:$.noop,drag_target:".jstree-draggable",drag_finish:$.noop,drag_check:function(data){return{after:false,before:false,inside:true};}},_fn:{dnd_prepare:function(){if(!r||!r.length){return;}
this.data.dnd.off=r.offset();if(this._get_settings().core.rtl){this.data.dnd.off.right=this.data.dnd.off.left+r.width();}
if(this.data.dnd.foreign){var a=this._get_settings().dnd.drag_check.call(this,{"o":o,"r":r});this.data.dnd.after=a.after;this.data.dnd.before=a.before;this.data.dnd.inside=a.inside;this.data.dnd.prepared=true;return this.dnd_show();}
this.prepare_move(o,r,"before");this.data.dnd.before=this.check_move();this.prepare_move(o,r,"after");this.data.dnd.after=this.check_move();if(this._is_loaded(r)){this.prepare_move(o,r,"inside");this.data.dnd.inside=this.check_move();}
else{this.data.dnd.inside=false;}
this.data.dnd.prepared=true;return this.dnd_show();},dnd_show:function(){if(!this.data.dnd.prepared){return;}
var o=["before","inside","after"],r=false,rtl=this._get_settings().core.rtl,pos;if(this.data.dnd.w<this.data.core.li_height/3){o=["before","inside","after"];}
else if(this.data.dnd.w<=this.data.core.li_height*2/3){o=this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"];}
else{o=["after","inside","before"];}
$.each(o,$.proxy(function(i,val){if(this.data.dnd[val]){$.vakata.dnd.helper.children("ins").attr("class","jstree-ok");r=val;return false;}},this));if(r===false){$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");}
pos=rtl?(this.data.dnd.off.right-18):(this.data.dnd.off.left+10);switch(r){case"before":m.css({"left":pos+"px","top":(this.data.dnd.off.top-6)+"px"}).show();if(ml){ml.css({"left":(pos+8)+"px","top":(this.data.dnd.off.top-1)+"px"}).show();}
break;case"after":m.css({"left":pos+"px","top":(this.data.dnd.off.top+this.data.core.li_height-6)+"px"}).show();if(ml){ml.css({"left":(pos+8)+"px","top":(this.data.dnd.off.top+this.data.core.li_height-1)+"px"}).show();}
break;case"inside":m.css({"left":pos+(rtl?-4:4)+"px","top":(this.data.dnd.off.top+this.data.core.li_height/2-5)+"px"}).show();if(ml){ml.hide();}
break;default:m.hide();if(ml){ml.hide();}
break;}
last_pos=r;return r;},dnd_open:function(){this.data.dnd.to2=false;this.open_node(r,$.proxy(this.dnd_prepare,this),true);},dnd_finish:function(e){if(this.data.dnd.foreign){if(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside){this._get_settings().dnd.drag_finish.call(this,{"o":o,"r":r,"p":last_pos});}}
else{this.dnd_prepare();this.move_node(o,r,last_pos,e[this._get_settings().dnd.copy_modifier+"Key"]);}
o=false;r=false;m.hide();if(ml){ml.hide();}},dnd_enter:function(obj){if(this.data.dnd.mto){clearTimeout(this.data.dnd.mto);this.data.dnd.mto=false;}
var s=this._get_settings().dnd;this.data.dnd.prepared=false;r=this._get_node(obj);if(s.check_timeout){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1);}
this.data.dnd.to1=setTimeout($.proxy(this.dnd_prepare,this),s.check_timeout);}
else{this.dnd_prepare();}
if(s.open_timeout){if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2);}
if(r&&r.length&&r.hasClass("jstree-closed")){this.data.dnd.to2=setTimeout($.proxy(this.dnd_open,this),s.open_timeout);}}
else{if(r&&r.length&&r.hasClass("jstree-closed")){this.dnd_open();}}},dnd_leave:function(e){this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");m.hide();if(ml){ml.hide();}
if(r&&r[0]===e.target.parentNode){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1);this.data.dnd.to1=false;}
if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2);this.data.dnd.to2=false;}}},start_drag:function(obj,e){o=this._get_node(obj);if(this.data.ui&&this.is_selected(o)){o=this._get_node(null,true);}
var dt=o.length>1?this._get_string("multiple_selection"):this.get_text(o),cnt=this.get_container();if(!this._get_settings().core.html_titles){dt=dt.replace(/</ig,"&lt;").replace(/>/ig,"&gt;");}
$.vakata.dnd.drag_start(e,{jstree:true,obj:o},"<ins class='jstree-icon'></ins>"+dt);if(this.data.themes){if(m){m.attr("class","jstree-"+this.data.themes.theme);}
if(ml){ml.attr("class","jstree-"+this.data.themes.theme);}
$.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme);}
this.data.dnd.cof=cnt.offset();this.data.dnd.cw=parseInt(cnt.width(),10);this.data.dnd.ch=parseInt(cnt.height(),10);this.data.dnd.active=true;}}});$(function(){var css_string=''+'#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px; '+' -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; '+'} '+'#vakata-dragged .jstree-ok { background:green; } '+'#vakata-dragged .jstree-invalid { background:red; } '+'#jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } '+'#jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43; '+' cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666; '+' -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; '+'}'+'';$.vakata.css.add_sheet({str:css_string,title:"jstree"});m=$("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(e){m.hide();ml.hide();e.preventDefault();e.stopImmediatePropagation();return false;}).appendTo("body");ml=$("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(e){if(r&&r.length){r.children("a").trigger(e);e.preventDefault();e.stopImmediatePropagation();return false;}}).bind("mouseleave",function(e){var rt=$(e.relatedTarget);if(rt.is(".jstree")||rt.closest(".jstree").length===0){if(r&&r.length){r.children("a").trigger(e);m.hide();ml.hide();e.preventDefault();e.stopImmediatePropagation();return false;}}}).appendTo("body");$(document).bind("drag_start.vakata",function(e,data){if(data.data.jstree){m.show();if(ml){ml.show();}}});$(document).bind("drag_stop.vakata",function(e,data){if(data.data.jstree){m.hide();if(ml){ml.hide();}}});});})(jQuery);(function($){$.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui;if(this.data.ui&&this.data.checkbox.noui){this.select_node=this.deselect_node=this.deselect_all=$.noop;this.get_selected=this.get_checked;}
this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",$.proxy(function(e,data){this._prepare_checkboxes(data.rslt.obj);},this)).bind("loaded.jstree",$.proxy(function(e){this._prepare_checkboxes();},this)).delegate((this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox"),"click.jstree",$.proxy(function(e){e.preventDefault();if(this._get_node(e.target).hasClass("jstree-checked")){this.uncheck_node(e.target);}
else{this.check_node(e.target);}
if(this.data.ui&&this.data.checkbox.noui){this.save_selected();if(this.data.cookies){this.save_cookie("select_node");}}
else{e.stopImmediatePropagation();return false;}},this));},defaults:{override_ui:false,two_state:false,real_checkboxes:false,checked_parent_open:true,real_checkboxes_names:function(n){return[("check_"+(n[0].id||Math.ceil(Math.random()*10000))),1];}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove();},_fn:{_checkbox_notify:function(n,data){if(data.checked){this.check_node(n,false);}},_prepare_checkboxes:function(obj){obj=!obj||obj==-1?this.get_container().find("> ul > li"):this._get_node(obj);if(obj===false){return;}
var c,_this=this,t,ts=this._get_settings().checkbox.two_state,rc=this._get_settings().checkbox.real_checkboxes,rcn=this._get_settings().checkbox.real_checkboxes_names;obj.each(function(){t=$(this);c=t.is("li")&&(t.hasClass("jstree-checked")||(rc&&t.children(":checked").length))?"jstree-checked":"jstree-unchecked";t.find("li").andSelf().each(function(){var $t=$(this),nm;$t.children("a"+(_this.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(ts?"jstree-unchecked":c);if(rc){if(!$t.children(":checkbox").length){nm=rcn.call(_this,$t);$t.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+nm[0]+"' name='"+nm[0]+"' value='"+nm[1]+"' />");}
else{$t.children(":checkbox").addClass("jstree-real-checkbox");}}
if(!ts){if(c==="jstree-checked"||$t.hasClass("jstree-checked")||$t.children(':checked').length){$t.find("li").andSelf().addClass("jstree-checked").children(":checkbox").prop("checked",true);}}
else{if($t.hasClass("jstree-checked")||$t.children(':checked').length){$t.addClass("jstree-checked").children(":checkbox").prop("checked",true);}}});});if(!ts){obj.find(".jstree-checked").parent().parent().each(function(){_this._repair_state(this);});}},change_state:function(obj,state){obj=this._get_node(obj);var coll=false,rc=this._get_settings().checkbox.real_checkboxes;if(!obj||obj===-1){return false;}
state=(state===false||state===true)?state:obj.hasClass("jstree-checked");if(this._get_settings().checkbox.two_state){if(state){obj.removeClass("jstree-checked").addClass("jstree-unchecked");if(rc){obj.children(":checkbox").prop("checked",false);}}
else{obj.removeClass("jstree-unchecked").addClass("jstree-checked");if(rc){obj.children(":checkbox").prop("checked",true);}}}
else{if(state){coll=obj.find("li").andSelf();if(!coll.filter(".jstree-checked, .jstree-undetermined").length){return false;}
coll.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");if(rc){coll.children(":checkbox").prop("checked",false);}}
else{coll=obj.find("li").andSelf();if(!coll.filter(".jstree-unchecked, .jstree-undetermined").length){return false;}
coll.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");if(rc){coll.children(":checkbox").prop("checked",true);}
if(this.data.ui){this.data.ui.last_selected=obj;}
this.data.checkbox.last_selected=obj;}
obj.parentsUntil(".jstree","li").each(function(){var $this=$(this);if(state){if($this.children("ul").children("li.jstree-checked, li.jstree-undetermined").length){$this.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(rc){$this.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",false);}
return false;}
else{$this.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");if(rc){$this.children(":checkbox").prop("checked",false);}}}
else{if($this.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length){$this.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(rc){$this.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",false);}
return false;}
else{$this.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");if(rc){$this.children(":checkbox").prop("checked",true);}}}});}
if(this.data.ui&&this.data.checkbox.noui){this.data.ui.selected=this.get_checked();}
this.__callback(obj);return true;},check_node:function(obj){if(this.change_state(obj,false)){obj=this._get_node(obj);if(this._get_settings().checkbox.checked_parent_open){var t=this;obj.parents(".jstree-closed").each(function(){t.open_node(this,false,true);});}
this.__callback({"obj":obj});}},uncheck_node:function(obj){if(this.change_state(obj,true)){this.__callback({"obj":this._get_node(obj)});}},check_all:function(){var _this=this,coll=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");coll.each(function(){_this.change_state(this,false);});this.__callback();},uncheck_all:function(){var _this=this,coll=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");coll.each(function(){_this.change_state(this,true);});this.__callback();},is_checked:function(obj){obj=this._get_node(obj);return obj.length?obj.is(".jstree-checked"):false;},get_checked:function(obj,get_all){obj=!obj||obj===-1?this.get_container():this._get_node(obj);return get_all||this._get_settings().checkbox.two_state?obj.find(".jstree-checked"):obj.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked");},get_unchecked:function(obj,get_all){obj=!obj||obj===-1?this.get_container():this._get_node(obj);return get_all||this._get_settings().checkbox.two_state?obj.find(".jstree-unchecked"):obj.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked");},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes");},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes");},_repair_state:function(obj){obj=this._get_node(obj);if(!obj.length){return;}
if(this._get_settings().checkbox.two_state){obj.find('li').andSelf().not('.jstree-checked').removeClass('jstree-undetermined').addClass('jstree-unchecked').children(':checkbox').prop('checked',true);return;}
var rc=this._get_settings().checkbox.real_checkboxes,a=obj.find("> ul > .jstree-checked").length,b=obj.find("> ul > .jstree-undetermined").length,c=obj.find("> ul > li").length;if(c===0){if(obj.hasClass("jstree-undetermined")){this.change_state(obj,false);}}
else if(a===0&&b===0){this.change_state(obj,true);}
else if(a===c){this.change_state(obj,false);}
else{obj.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(rc){obj.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",false);}}},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var _this=this,s=this.data.ui.to_select;s=$.map($.makeArray(s),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:");});this.deselect_all();$.each(s,function(i,val){_this.check_node(val);});this.__callback();}
else{this.__call_old();}},save_loaded:function(){var _this=this;this.data.core.to_load=[];this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){if(this.id){_this.data.core.to_load.push("#"+this.id);}});}}});$(function(){var css_string='.jstree .jstree-real-checkbox { display:none; } ';$.vakata.css.add_sheet({str:css_string,title:"jstree"});});})(jQuery);(function($){$.vakata.xslt=function(xml,xsl,callback){var rs="",xm,xs,processor,support;if(document.recalc){xm=document.createElement('xml');xs=document.createElement('xml');xm.innerHTML=xml;xs.innerHTML=xsl;$("body").append(xm).append(xs);setTimeout((function(xm,xs,callback){return function(){callback.call(null,xm.transformNode(xs.XMLDocument));setTimeout((function(xm,xs){return function(){$(xm).remove();$(xs).remove();};})(xm,xs),200);};})(xm,xs,callback),100);return true;}
if(typeof window.DOMParser!=="undefined"&&typeof window.XMLHttpRequest!=="undefined"&&typeof window.XSLTProcessor==="undefined"){xml=new DOMParser().parseFromString(xml,"text/xml");xsl=new DOMParser().parseFromString(xsl,"text/xml");}
if(typeof window.DOMParser!=="undefined"&&typeof window.XMLHttpRequest!=="undefined"&&typeof window.XSLTProcessor!=="undefined"){processor=new XSLTProcessor();support=$.isFunction(processor.transformDocument)?(typeof window.XMLSerializer!=="undefined"):true;if(!support){return false;}
xml=new DOMParser().parseFromString(xml,"text/xml");xsl=new DOMParser().parseFromString(xsl,"text/xml");if($.isFunction(processor.transformDocument)){rs=document.implementation.createDocument("","",null);processor.transformDocument(xml,xsl,rs,null);callback.call(null,new XMLSerializer().serializeToString(rs));return true;}
else{processor.importStylesheet(xsl);rs=processor.transformToFragment(xml,document);callback.call(null,$("<div />").append(rs).html());return true;}}
return false;};var xsl={'nest':'<'+'?xml version="1.0" encoding="utf-8" ?>'+'<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" >'+'<xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" />'+'<xsl:template match="/">'+' <xsl:call-template name="nodes">'+'  <xsl:with-param name="node" select="/root" />'+' </xsl:call-template>'+'</xsl:template>'+'<xsl:template name="nodes">'+' <xsl:param name="node" />'+' <ul>'+' <xsl:for-each select="$node/item">'+'  <xsl:variable name="children" select="count(./item) &gt; 0" />'+'  <li>'+'   <xsl:attribute name="class">'+'    <xsl:if test="position() = last()">jstree-last </xsl:if>'+'    <xsl:choose>'+'     <xsl:when test="@state = \'open\'">jstree-open </xsl:when>'+'     <xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>'+'     <xsl:otherwise>jstree-leaf </xsl:otherwise>'+'    </xsl:choose>'+'    <xsl:value-of select="@class" />'+'   </xsl:attribute>'+'   <xsl:for-each select="@*">'+'    <xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">'+'     <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+'    </xsl:if>'+'   </xsl:for-each>'+' <ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>'+'   <xsl:for-each select="content/name">'+'    <a>'+'    <xsl:attribute name="href">'+'     <xsl:choose>'+'     <xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>'+'     <xsl:otherwise>#</xsl:otherwise>'+'     </xsl:choose>'+'    </xsl:attribute>'+'    <xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>'+'    <xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>'+'    <xsl:for-each select="@*">'+'     <xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">'+'      <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+'     </xsl:if>'+'    </xsl:for-each>'+'     <ins>'+'      <xsl:attribute name="class">jstree-icon '+'       <xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>'+'      </xsl:attribute>'+'      <xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>'+'      <xsl:text>&#xa0;</xsl:text>'+'     </ins>'+'     <xsl:copy-of select="./child::node()" />'+'    </a>'+'   </xsl:for-each>'+'   <xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>'+'  </li>'+' </xsl:for-each>'+' </ul>'+'</xsl:template>'+'</xsl:stylesheet>','flat':'<'+'?xml version="1.0" encoding="utf-8" ?>'+'<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" >'+'<xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" />'+'<xsl:template match="/">'+' <ul>'+' <xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">'+'  <xsl:call-template name="nodes">'+'   <xsl:with-param name="node" select="." />'+'   <xsl:with-param name="is_last" select="number(position() = last())" />'+'  </xsl:call-template>'+' </xsl:for-each>'+' </ul>'+'</xsl:template>'+'<xsl:template name="nodes">'+' <xsl:param name="node" />'+' <xsl:param name="is_last" />'+' <xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />'+' <li>'+' <xsl:attribute name="class">'+'  <xsl:if test="$is_last = true()">jstree-last </xsl:if>'+'  <xsl:choose>'+'   <xsl:when test="@state = \'open\'">jstree-open </xsl:when>'+'   <xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>'+'   <xsl:otherwise>jstree-leaf </xsl:otherwise>'+'  </xsl:choose>'+'  <xsl:value-of select="@class" />'+' </xsl:attribute>'+' <xsl:for-each select="@*">'+'  <xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">'+'  <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+'  </xsl:if>'+' </xsl:for-each>'+' <ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>'+' <xsl:for-each select="content/name">'+'  <a>'+'  <xsl:attribute name="href">'+'   <xsl:choose>'+'   <xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>'+'   <xsl:otherwise>#</xsl:otherwise>'+'   </xsl:choose>'+'  </xsl:attribute>'+'  <xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>'+'  <xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>'+'  <xsl:for-each select="@*">'+'   <xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">'+'    <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+'   </xsl:if>'+'  </xsl:for-each>'+'   <ins>'+'    <xsl:attribute name="class">jstree-icon '+'     <xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>'+'    </xsl:attribute>'+'    <xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>'+'    <xsl:text>&#xa0;</xsl:text>'+'   </ins>'+'   <xsl:copy-of select="./child::node()" />'+'  </a>'+' </xsl:for-each>'+' <xsl:if test="$children">'+'  <ul>'+'  <xsl:for-each select="//item[@parent_id=$node/attribute::id]">'+'   <xsl:call-template name="nodes">'+'    <xsl:with-param name="node" select="." />'+'    <xsl:with-param name="is_last" select="number(position() = last())" />'+'   </xsl:call-template>'+'  </xsl:for-each>'+'  </ul>'+' </xsl:if>'+' </li>'+'</xsl:template>'+'</xsl:stylesheet>'},escape_xml=function(string){return string.toString().replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&apos;');};$.jstree.plugin("xml_data",{defaults:{data:false,ajax:false,xsl:"flat",clean_node:false,correct_state:true,get_skip_empty:false,get_include_preamble:true},_fn:{load_node:function(obj,s_call,e_call){var _this=this;this.load_node_xml(obj,function(){_this.__callback({"obj":_this._get_node(obj)});s_call.call(this);},e_call);},_is_loaded:function(obj){var s=this._get_settings().xml_data;obj=this._get_node(obj);return obj==-1||!obj||(!s.ajax&&!$.isFunction(s.data))||obj.is(".jstree-open, .jstree-leaf")||obj.children("ul").children("li").size()>0;},load_node_xml:function(obj,s_call,e_call){var s=this.get_settings().xml_data,error_func=function(){},success_func=function(){};obj=this._get_node(obj);if(obj&&obj!==-1){if(obj.data("jstree_is_loading")){return;}
else{obj.data("jstree_is_loading",true);}}
switch(!0){case(!s.data&&!s.ajax):throw"Neither data nor ajax settings supplied.";case($.isFunction(s.data)):s.data.call(this,obj,$.proxy(function(d){this.parse_xml(d,$.proxy(function(d){if(d){d=d.replace(/ ?xmlns="[^"]*"/ig,"");if(d.length>10){d=$(d);if(obj===-1||!obj){this.get_container().children("ul").empty().append(d.children());}
else{obj.children("a.jstree-loading").removeClass("jstree-loading");obj.append(d);obj.removeData("jstree_is_loading");}
if(s.clean_node){this.clean_node(obj);}
if(s_call){s_call.call(this);}}
else{if(obj&&obj!==-1){obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(obj);if(s_call){s_call.call(this);}}}
else{if(s.correct_state){this.get_container().children("ul").empty();if(s_call){s_call.call(this);}}}}}},this));},this));break;case(!!s.data&&!s.ajax)||(!!s.data&&!!s.ajax&&(!obj||obj===-1)):if(!obj||obj==-1){this.parse_xml(s.data,$.proxy(function(d){if(d){d=d.replace(/ ?xmlns="[^"]*"/ig,"");if(d.length>10){d=$(d);this.get_container().children("ul").empty().append(d.children());if(s.clean_node){this.clean_node(obj);}
if(s_call){s_call.call(this);}}}
else{if(s.correct_state){this.get_container().children("ul").empty();if(s_call){s_call.call(this);}}}},this));}
break;case(!s.data&&!!s.ajax)||(!!s.data&&!!s.ajax&&obj&&obj!==-1):error_func=function(x,t,e){var ef=this.get_settings().xml_data.ajax.error;if(ef){ef.call(this,x,t,e);}
if(obj!==-1&&obj.length){obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(t==="success"&&s.correct_state){this.correct_state(obj);}}
else{if(t==="success"&&s.correct_state){this.get_container().children("ul").empty();}}
if(e_call){e_call.call(this);}};success_func=function(d,t,x){d=x.responseText;var sf=this.get_settings().xml_data.ajax.success;if(sf){d=sf.call(this,d,t,x)||d;}
if(d===""||(d&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")==="")){return error_func.call(this,x,t,"");}
this.parse_xml(d,$.proxy(function(d){if(d){d=d.replace(/ ?xmlns="[^"]*"/ig,"");if(d.length>10){d=$(d);if(obj===-1||!obj){this.get_container().children("ul").empty().append(d.children());}
else{obj.children("a.jstree-loading").removeClass("jstree-loading");obj.append(d);obj.removeData("jstree_is_loading");}
if(s.clean_node){this.clean_node(obj);}
if(s_call){s_call.call(this);}}
else{if(obj&&obj!==-1){obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(obj);if(s_call){s_call.call(this);}}}
else{if(s.correct_state){this.get_container().children("ul").empty();if(s_call){s_call.call(this);}}}}}},this));};s.ajax.context=this;s.ajax.error=error_func;s.ajax.success=success_func;if(!s.ajax.dataType){s.ajax.dataType="xml";}
if($.isFunction(s.ajax.url)){s.ajax.url=s.ajax.url.call(this,obj);}
if($.isFunction(s.ajax.data)){s.ajax.data=s.ajax.data.call(this,obj);}
$.ajax(s.ajax);break;}},parse_xml:function(xml,callback){var s=this._get_settings().xml_data;$.vakata.xslt(xml,xsl[s.xsl],callback);},get_xml:function(tp,obj,li_attr,a_attr,is_callback){var result="",s=this._get_settings(),_this=this,tmp1,tmp2,li,a,lang;if(!tp){tp="flat";}
if(!is_callback){is_callback=0;}
obj=this._get_node(obj);if(!obj||obj===-1){obj=this.get_container().find("> ul > li");}
li_attr=$.isArray(li_attr)?li_attr:["id","class"];if(!is_callback&&this.data.types&&$.inArray(s.types.type_attr,li_attr)===-1){li_attr.push(s.types.type_attr);}
a_attr=$.isArray(a_attr)?a_attr:[];if(!is_callback){if(s.xml_data.get_include_preamble){result+='<'+'?xml version="1.0" encoding="UTF-8"?'+'>';}
result+="<root>";}
obj.each(function(){result+="<item";li=$(this);$.each(li_attr,function(i,v){var t=li.attr(v);if(!s.xml_data.get_skip_empty||typeof t!=="undefined"){result+=" "+v+"=\""+escape_xml((" "+(t||"")).replace(/ jstree[^ ]*/ig,'').replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+"\"";}});if(li.hasClass("jstree-open")){result+=" state=\"open\"";}
if(li.hasClass("jstree-closed")){result+=" state=\"closed\"";}
if(tp==="flat"){result+=" parent_id=\""+escape_xml(is_callback)+"\"";}
result+=">";result+="<content>";a=li.children("a");a.each(function(){tmp1=$(this);lang=false;result+="<name";if($.inArray("languages",s.plugins)!==-1){$.each(s.languages,function(k,z){if(tmp1.hasClass(z)){result+=" lang=\""+escape_xml(z)+"\"";lang=z;return false;}});}
if(a_attr.length){$.each(a_attr,function(k,z){var t=tmp1.attr(z);if(!s.xml_data.get_skip_empty||typeof t!=="undefined"){result+=" "+z+"=\""+escape_xml((" "+t||"").replace(/ jstree[^ ]*/ig,'').replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+"\"";}});}
if(tmp1.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,'').replace(/^\s+$/ig,"").length){result+=' icon="'+escape_xml(tmp1.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,'').replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"';}
if(tmp1.children("ins").get(0).style.backgroundImage.length){result+=' icon="'+escape_xml(tmp1.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/ig,"").replace(/"/ig,""))+'"';}
result+=">";result+="<![CDATA["+_this.get_text(tmp1,lang)+"]]>";result+="</name>";});result+="</content>";tmp2=li[0].id||true;li=li.find("> ul > li");if(li.length){tmp2=_this.get_xml(tp,li,li_attr,a_attr,tmp2);}
else{tmp2="";}
if(tp=="nest"){result+=tmp2;}
result+="</item>";if(tp=="flat"){result+=tmp2;}});if(!is_callback){result+="</root>";}
return result;}}});})(jQuery);(function($){$.expr[':'].jstree_contains=function(a,i,m){return(a.textContent||a.innerText||"").toLowerCase().indexOf(m[3].toLowerCase())>=0;};$.expr[':'].jstree_title_contains=function(a,i,m){return(a.getAttribute("title")||"").toLowerCase().indexOf(m[3].toLowerCase())>=0;};$.jstree.plugin("search",{__init:function(){this.data.search.str="";this.data.search.result=$();if(this._get_settings().search.show_only_matches){this.get_container().bind("search.jstree",function(e,data){$(this).children("ul").find("li").hide().removeClass("jstree-last");data.rslt.nodes.parentsUntil(".jstree").andSelf().show().filter("ul").each(function(){$(this).children("li:visible").eq(-1).addClass("jstree-last");});}).bind("clear_search.jstree",function(){$(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1);});}},defaults:{ajax:false,search_method:"jstree_contains",show_only_matches:false},_fn:{search:function(str,skip_async){if($.trim(str)===""){this.clear_search();return;}
var s=this.get_settings().search,t=this,error_func=function(){},success_func=function(){};this.data.search.str=str;if(!skip_async&&s.ajax!==false&&this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length>0){this.search.supress_callback=true;error_func=function(){};success_func=function(d,t,x){var sf=this.get_settings().search.ajax.success;if(sf){d=sf.call(this,d,t,x)||d;}
this.data.search.to_open=d;this._search_open();};s.ajax.context=this;s.ajax.error=error_func;s.ajax.success=success_func;if($.isFunction(s.ajax.url)){s.ajax.url=s.ajax.url.call(this,str);}
if($.isFunction(s.ajax.data)){s.ajax.data=s.ajax.data.call(this,str);}
if(!s.ajax.data){s.ajax.data={"search_string":str};}
if(!s.ajax.dataType||/^json/.exec(s.ajax.dataType)){s.ajax.dataType="json";}
$.ajax(s.ajax);return;}
if(this.data.search.result.length){this.clear_search();}
this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+(s.search_method)+"("+this.data.search.str+")");this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){t.open_node(this,false,true);});this.__callback({nodes:this.data.search.result,str:str});},clear_search:function(str){this.data.search.result.removeClass("jstree-search");this.__callback(this.data.search.result);this.data.search.result=$();},_search_open:function(is_callback){var _this=this,done=true,current=[],remaining=[];if(this.data.search.to_open.length){$.each(this.data.search.to_open,function(i,val){if(val=="#"){return true;}
if($(val).length&&$(val).is(".jstree-closed")){current.push(val);}
else{remaining.push(val);}});if(current.length){this.data.search.to_open=remaining;$.each(current,function(i,val){_this.open_node(val,function(){_this._search_open(true);});});done=false;}}
if(done){this.search(this.data.search.str,true);}}}});})(jQuery);(function($){$.vakata.context={hide_on_mouseleave:false,cnt:$("<div id='vakata-contextmenu' />"),vis:false,tgt:false,par:false,func:false,data:false,rtl:false,show:function(s,t,x,y,d,p,rtl){$.vakata.context.rtl=!!rtl;var html=$.vakata.context.parse(s),h,w;if(!html){return;}
$.vakata.context.vis=true;$.vakata.context.tgt=t;$.vakata.context.par=p||t||null;$.vakata.context.data=d||null;$.vakata.context.cnt.html(html).css({"visibility":"hidden","display":"block","left":0,"top":0});if($.vakata.context.hide_on_mouseleave){$.vakata.context.cnt.one("mouseleave",function(e){$.vakata.context.hide();});}
h=$.vakata.context.cnt.height();w=$.vakata.context.cnt.width();if(x+w>$(document).width()){x=$(document).width()-(w+5);$.vakata.context.cnt.find("li > ul").addClass("right");}
if(y+h>$(document).height()){y=y-(h+t[0].offsetHeight);$.vakata.context.cnt.find("li > ul").addClass("bottom");}
$.vakata.context.cnt.css({"left":x,"top":y}).find("li:has(ul)").bind("mouseenter",function(e){var w=$(document).width(),h=$(document).height(),ul=$(this).children("ul").show();if(w!==$(document).width()){ul.toggleClass("right");}
if(h!==$(document).height()){ul.toggleClass("bottom");}}).bind("mouseleave",function(e){$(this).children("ul").hide();}).end().css({"visibility":"visible"}).show();$(document).triggerHandler("context_show.vakata");},hide:function(){$.vakata.context.vis=false;$.vakata.context.cnt.attr("class","").css({"visibility":"hidden"});$(document).triggerHandler("context_hide.vakata");},parse:function(s,is_callback){if(!s){return false;}
var str="",tmp=false,was_sep=true;if(!is_callback){$.vakata.context.func={};}
str+="<ul>";$.each(s,function(i,val){if(!val){return true;}
$.vakata.context.func[i]=val.action;if(!was_sep&&val.separator_before){str+="<li class='vakata-separator vakata-separator-before'></li>";}
was_sep=false;str+="<li class='"+(val._class||"")+(val._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ";if(val.icon&&val.icon.indexOf("/")===-1){str+=" class='"+val.icon+"' ";}
if(val.icon&&val.icon.indexOf("/")!==-1){str+=" style='background:url("+val.icon+") center center no-repeat;' ";}
str+=">&#160;</ins><a href='#' rel='"+i+"'>";if(val.submenu){str+="<span style='float:"+($.vakata.context.rtl?"left":"right")+";'>&raquo;</span>";}
str+=val.label+"</a>";if(val.submenu){tmp=$.vakata.context.parse(val.submenu,true);if(tmp){str+=tmp;}}
str+="</li>";if(val.separator_after){str+="<li class='vakata-separator vakata-separator-after'></li>";was_sep=true;}});str=str.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,"");str+="</ul>";$(document).triggerHandler("context_parse.vakata");return str.length>10?str:false;},exec:function(i){if($.isFunction($.vakata.context.func[i])){$.vakata.context.func[i].call($.vakata.context.data,$.vakata.context.par);return true;}
else{return false;}}};$(function(){var css_string=''+'#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } '+'#vakata-contextmenu ul { min-width:180px; *width:180px; } '+'#vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } '+'#vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } '+'#vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } '+'#vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } '+'#vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } '+'#vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } '+'#vakata-contextmenu .right { right:100%; left:auto; } '+'#vakata-contextmenu .bottom { bottom:-1px; top:auto; } '+'#vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ';$.vakata.css.add_sheet({str:css_string,title:"vakata"});$.vakata.context.cnt.delegate("a","click",function(e){e.preventDefault();}).delegate("a","mouseup",function(e){if(!$(this).parent().hasClass("jstree-contextmenu-disabled")&&$.vakata.context.exec($(this).attr("rel"))){$.vakata.context.hide();}
else{$(this).blur();}}).delegate("a","mouseover",function(){$.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover");}).appendTo("body");$(document).bind("mousedown",function(e){if($.vakata.context.vis&&!$.contains($.vakata.context.cnt[0],e.target)){$.vakata.context.hide();}});if(typeof $.hotkeys!=="undefined"){$(document).bind("keydown","up",function(e){if($.vakata.context.vis){var o=$.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();if(!o.length){o=$.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last();}
o.addClass("vakata-hover");e.stopImmediatePropagation();e.preventDefault();}}).bind("keydown","down",function(e){if($.vakata.context.vis){var o=$.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();if(!o.length){o=$.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first();}
o.addClass("vakata-hover");e.stopImmediatePropagation();e.preventDefault();}}).bind("keydown","right",function(e){if($.vakata.context.vis){$.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover");e.stopImmediatePropagation();e.preventDefault();}}).bind("keydown","left",function(e){if($.vakata.context.vis){$.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover");e.stopImmediatePropagation();e.preventDefault();}}).bind("keydown","esc",function(e){$.vakata.context.hide();e.preventDefault();}).bind("keydown","space",function(e){$.vakata.context.cnt.find(".vakata-hover").last().children("a").click();e.preventDefault();});}});$.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",$.proxy(function(e){e.preventDefault();if(!$(e.currentTarget).hasClass("jstree-loading")){this.show_contextmenu(e.currentTarget,e.pageX,e.pageY);}},this)).delegate("a","click.jstree",$.proxy(function(e){if(this.data.contextmenu){$.vakata.context.hide();}},this)).bind("destroy.jstree",$.proxy(function(){if(this.data.contextmenu){$.vakata.context.hide();}},this));$(document).bind("context_hide.vakata",$.proxy(function(){this.data.contextmenu=false;},this));},defaults:{select_node:false,show_at_node:true,items:{"create":{"separator_before":false,"separator_after":true,"label":"Create","action":function(obj){this.create(obj);}},"rename":{"separator_before":false,"separator_after":false,"label":"Rename","action":function(obj){this.rename(obj);}},"remove":{"separator_before":false,"icon":false,"separator_after":false,"label":"Delete","action":function(obj){if(this.is_selected(obj)){this.remove();}else{this.remove(obj);}}},"ccp":{"separator_before":true,"icon":false,"separator_after":false,"label":"Edit","action":false,"submenu":{"cut":{"separator_before":false,"separator_after":false,"label":"Cut","action":function(obj){this.cut(obj);}},"copy":{"separator_before":false,"icon":false,"separator_after":false,"label":"Copy","action":function(obj){this.copy(obj);}},"paste":{"separator_before":false,"icon":false,"separator_after":false,"label":"Paste","action":function(obj){this.paste(obj);}}}}}},_fn:{show_contextmenu:function(obj,x,y){obj=this._get_node(obj);var s=this.get_settings().contextmenu,a=obj.children("a:visible:eq(0)"),o=false,i=false;if(s.select_node&&this.data.ui&&!this.is_selected(obj)){this.deselect_all();this.select_node(obj,true);}
if(s.show_at_node||typeof x==="undefined"||typeof y==="undefined"){o=a.offset();x=o.left;y=o.top+this.data.core.li_height;}
i=obj.data("jstree")&&obj.data("jstree").contextmenu?obj.data("jstree").contextmenu:s.items;if($.isFunction(i)){i=i.call(this,obj);}
this.data.contextmenu=true;$.vakata.context.show(i,a,x,y,this,obj,this._get_settings().core.rtl);if(this.data.themes){$.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context");}}}});})(jQuery);(function($){$.jstree.plugin("types",{__init:function(){var s=this._get_settings().types;this.data.types.attach_to=[];this.get_container().bind("init.jstree",$.proxy(function(){var types=s.types,attr=s.type_attr,icons_css="",_this=this;$.each(types,function(i,tp){$.each(tp,function(k,v){if(!/^(max_depth|max_children|icon|valid_children)$/.test(k)){_this.data.types.attach_to.push(k);}});if(!tp.icon){return true;}
if(tp.icon.image||tp.icon.position){if(i=="default"){icons_css+='.jstree-'+_this.get_index()+' a > .jstree-icon { ';}
else{icons_css+='.jstree-'+_this.get_index()+' li['+attr+'="'+i+'"] > a > .jstree-icon { ';}
if(tp.icon.image){icons_css+=' background-image:url('+tp.icon.image+'); ';}
if(tp.icon.position){icons_css+=' background-position:'+tp.icon.position+'; ';}
else{icons_css+=' background-position:0 0; ';}
icons_css+='} ';}});if(icons_css!==""){$.vakata.css.add_sheet({'str':icons_css,title:"jstree-types"});}},this)).bind("before.jstree",$.proxy(function(e,data){var s,t,o=this._get_settings().types.use_data?this._get_node(data.args[0]):false,d=o&&o!==-1&&o.length?o.data("jstree"):false;if(d&&d.types&&d.types[data.func]===false){e.stopImmediatePropagation();return false;}
if($.inArray(data.func,this.data.types.attach_to)!==-1){if(!data.args[0]||(!data.args[0].tagName&&!data.args[0].jquery)){return;}
s=this._get_settings().types.types;t=this._get_type(data.args[0]);if(((s[t]&&typeof s[t][data.func]!=="undefined")||(s["default"]&&typeof s["default"][data.func]!=="undefined"))&&this._check(data.func,data.args[0])===false){e.stopImmediatePropagation();return false;}}},this));if(is_ie6){this.get_container().bind("load_node.jstree set_type.jstree",$.proxy(function(e,data){var r=data&&data.rslt&&data.rslt.obj&&data.rslt.obj!==-1?this._get_node(data.rslt.obj).parent():this.get_container_ul(),c=false,s=this._get_settings().types;$.each(s.types,function(i,tp){if(tp.icon&&(tp.icon.image||tp.icon.position)){c=i==="default"?r.find("li > a > .jstree-icon"):r.find("li["+s.type_attr+"='"+i+"'] > a > .jstree-icon");if(tp.icon.image){c.css("backgroundImage","url("+tp.icon.image+")");}
c.css("backgroundPosition",tp.icon.position||"0 0");}});},this));}},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:false,type_attr:"rel",types:{"default":{"max_children":-1,"max_depth":-1,"valid_children":"all"}}},_fn:{_types_notify:function(n,data){if(data.type&&this._get_settings().types.use_data){this.set_type(data.type,n);}},_get_type:function(obj){obj=this._get_node(obj);return(!obj||!obj.length)?false:obj.attr(this._get_settings().types.type_attr)||"default";},set_type:function(str,obj){obj=this._get_node(obj);var ret=(!obj.length||!str)?false:obj.attr(this._get_settings().types.type_attr,str);if(ret){this.__callback({obj:obj,type:str});}
return ret;},_check:function(rule,obj,opts){obj=this._get_node(obj);var v=false,t=this._get_type(obj),d=0,_this=this,s=this._get_settings().types,data=false;if(obj===-1){if(!!s[rule]){v=s[rule];}
else{return;}}
else{if(t===false){return;}
data=s.use_data?obj.data("jstree"):false;if(data&&data.types&&typeof data.types[rule]!=="undefined"){v=data.types[rule];}
else if(!!s.types[t]&&typeof s.types[t][rule]!=="undefined"){v=s.types[t][rule];}
else if(!!s.types["default"]&&typeof s.types["default"][rule]!=="undefined"){v=s.types["default"][rule];}}
if($.isFunction(v)){v=v.call(this,obj);}
if(rule==="max_depth"&&obj!==-1&&opts!==false&&s.max_depth!==-2&&v!==0){obj.children("a:eq(0)").parentsUntil(".jstree","li").each(function(i){if(s.max_depth!==-1&&s.max_depth-(i+1)<=0){v=0;return false;}
d=(i===0)?v:_this._check(rule,this,false);if(d!==-1&&d-(i+1)<=0){v=0;return false;}
if(d>=0&&(d-(i+1)<v||v<0)){v=d-(i+1);}
if(s.max_depth>=0&&(s.max_depth-(i+1)<v||v<0)){v=s.max_depth-(i+1);}});}
return v;},check_move:function(){if(!this.__call_old()){return false;}
var m=this._get_move(),s=m.rt._get_settings().types,mc=m.rt._check("max_children",m.cr),md=m.rt._check("max_depth",m.cr),vc=m.rt._check("valid_children",m.cr),ch=0,d=1,t;if(vc==="none"){return false;}
if($.isArray(vc)&&m.ot&&m.ot._get_type){m.o.each(function(){if($.inArray(m.ot._get_type(this),vc)===-1){d=false;return false;}});if(d===false){return false;}}
if(s.max_children!==-2&&mc!==-1){ch=m.cr===-1?this.get_container().find("> ul > li").not(m.o).length:m.cr.find("> ul > li").not(m.o).length;if(ch+m.o.length>mc){return false;}}
if(s.max_depth!==-2&&md!==-1){d=0;if(md===0){return false;}
if(typeof m.o.d==="undefined"){t=m.o;while(t.length>0){t=t.find("> ul > li");d++;}
m.o.d=d;}
if(md-m.o.d<0){return false;}}
return true;},create_node:function(obj,position,js,callback,is_loaded,skip_check){if(!skip_check&&(is_loaded||this._is_loaded(obj))){var p=(typeof position=="string"&&position.match(/^before|after$/i)&&obj!==-1)?this._get_parent(obj):this._get_node(obj),s=this._get_settings().types,mc=this._check("max_children",p),md=this._check("max_depth",p),vc=this._check("valid_children",p),ch;if(typeof js==="string"){js={data:js};}
if(!js){js={};}
if(vc==="none"){return false;}
if($.isArray(vc)){if(!js.attr||!js.attr[s.type_attr]){if(!js.attr){js.attr={};}
js.attr[s.type_attr]=vc[0];}
else{if($.inArray(js.attr[s.type_attr],vc)===-1){return false;}}}
if(s.max_children!==-2&&mc!==-1){ch=p===-1?this.get_container().find("> ul > li").length:p.find("> ul > li").length;if(ch+1>mc){return false;}}
if(s.max_depth!==-2&&md!==-1&&(md-1)<0){return false;}}
return this.__call_old(true,obj,position,js,callback,is_loaded,skip_check);}}});})(jQuery);(function($){$.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(true);this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return this.nodeType==3;}).remove();},defaults:{data:false,ajax:false,correct_state:true},_fn:{load_node:function(obj,s_call,e_call){var _this=this;this.load_node_html(obj,function(){_this.__callback({"obj":_this._get_node(obj)});s_call.call(this);},e_call);},_is_loaded:function(obj){obj=this._get_node(obj);return obj==-1||!obj||(!this._get_settings().html_data.ajax&&!$.isFunction(this._get_settings().html_data.data))||obj.is(".jstree-open, .jstree-leaf")||obj.children("ul").children("li").size()>0;},load_node_html:function(obj,s_call,e_call){var d,s=this.get_settings().html_data,error_func=function(){},success_func=function(){};obj=this._get_node(obj);if(obj&&obj!==-1){if(obj.data("jstree_is_loading")){return;}
else{obj.data("jstree_is_loading",true);}}
switch(!0){case($.isFunction(s.data)):s.data.call(this,obj,$.proxy(function(d){if(d&&d!==""&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")!==""){d=$(d);if(!d.is("ul")){d=$("<ul />").append(d);}
if(obj==-1||!obj){this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS";}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");}
else{obj.children("a.jstree-loading").removeClass("jstree-loading");obj.append(d).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS";}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");obj.removeData("jstree_is_loading");}
this.clean_node(obj);if(s_call){s_call.call(this);}}
else{if(obj&&obj!==-1){obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(obj);if(s_call){s_call.call(this);}}}
else{if(s.correct_state){this.get_container().children("ul").empty();if(s_call){s_call.call(this);}}}}},this));break;case(!s.data&&!s.ajax):if(!obj||obj==-1){this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS";}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");this.clean_node();}
if(s_call){s_call.call(this);}
break;case(!!s.data&&!s.ajax)||(!!s.data&&!!s.ajax&&(!obj||obj===-1)):if(!obj||obj==-1){d=$(s.data);if(!d.is("ul")){d=$("<ul />").append(d);}
this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS";}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");this.clean_node();}
if(s_call){s_call.call(this);}
break;case(!s.data&&!!s.ajax)||(!!s.data&&!!s.ajax&&obj&&obj!==-1):obj=this._get_node(obj);error_func=function(x,t,e){var ef=this.get_settings().html_data.ajax.error;if(ef){ef.call(this,x,t,e);}
if(obj!=-1&&obj.length){obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(t==="success"&&s.correct_state){this.correct_state(obj);}}
else{if(t==="success"&&s.correct_state){this.get_container().children("ul").empty();}}
if(e_call){e_call.call(this);}};success_func=function(d,t,x){var sf=this.get_settings().html_data.ajax.success;if(sf){d=sf.call(this,d,t,x)||d;}
if(d===""||(d&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")==="")){return error_func.call(this,x,t,"");}
if(d){d=$(d);if(!d.is("ul")){d=$("<ul />").append(d);}
if(obj==-1||!obj){this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS";}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");}
else{obj.children("a.jstree-loading").removeClass("jstree-loading");obj.append(d).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS";}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");obj.removeData("jstree_is_loading");}
this.clean_node(obj);if(s_call){s_call.call(this);}}
else{if(obj&&obj!==-1){obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(obj);if(s_call){s_call.call(this);}}}
else{if(s.correct_state){this.get_container().children("ul").empty();if(s_call){s_call.call(this);}}}}};s.ajax.context=this;s.ajax.error=error_func;s.ajax.success=success_func;if(!s.ajax.dataType){s.ajax.dataType="html";}
if($.isFunction(s.ajax.url)){s.ajax.url=s.ajax.url.call(this,obj);}
if($.isFunction(s.ajax.data)){s.ajax.data=s.ajax.data.call(this,obj);}
$.ajax(s.ajax);break;}}}});$.jstree.defaults.plugins.push("html_data");})(jQuery);(function($){$.jstree.plugin("themeroller",{__init:function(){var s=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",function(e){if(!$(e.currentTarget).hasClass("jstree-loading")){$(this).addClass(s.item_h);}}).delegate("a","mouseleave.jstree",function(){$(this).removeClass(s.item_h);}).bind("init.jstree",$.proxy(function(e,data){data.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh");this._themeroller(data.inst.get_container().find("> ul > li"));},this)).bind("open_node.jstree create_node.jstree",$.proxy(function(e,data){this._themeroller(data.rslt.obj);},this)).bind("loaded.jstree refresh.jstree",$.proxy(function(e){this._themeroller();},this)).bind("close_node.jstree",$.proxy(function(e,data){this._themeroller(data.rslt.obj);},this)).bind("delete_node.jstree",$.proxy(function(e,data){this._themeroller(data.rslt.parent);},this)).bind("correct_state.jstree",$.proxy(function(e,data){data.rslt.obj.children("ins.jstree-icon").removeClass(s.opened+" "+s.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")===-1;}).removeClass(s.item_open+" "+s.item_clsd).addClass(s.item_leaf||"jstree-no-icon");},this)).bind("select_node.jstree",$.proxy(function(e,data){data.rslt.obj.children("a").addClass(s.item_a);},this)).bind("deselect_node.jstree deselect_all.jstree",$.proxy(function(e,data){this.get_container().find("a."+s.item_a).removeClass(s.item_a).end().find("a.jstree-clicked").addClass(s.item_a);},this)).bind("dehover_node.jstree",$.proxy(function(e,data){data.rslt.obj.children("a").removeClass(s.item_h);},this)).bind("hover_node.jstree",$.proxy(function(e,data){this.get_container().find("a."+s.item_h).not(data.rslt.obj).removeClass(s.item_h);data.rslt.obj.children("a").addClass(s.item_h);},this)).bind("move_node.jstree",$.proxy(function(e,data){this._themeroller(data.rslt.o);this._themeroller(data.rslt.op);},this));},__destroy:function(){var s=this._get_settings().themeroller,c=["ui-icon"];$.each(s,function(i,v){v=v.split(" ");if(v.length){c=c.concat(v);}});this.get_container().removeClass("ui-widget-content").find("."+c.join(", .")).removeClass(c.join(" "));},_fn:{_themeroller:function(obj){var s=this._get_settings().themeroller;obj=!obj||obj==-1?this.get_container_ul():this._get_node(obj).parent();obj.find("li.jstree-closed").children("ins.jstree-icon").removeClass(s.opened).addClass("ui-icon "+s.closed).end().children("a").addClass(s.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")===-1;}).removeClass(s.item_leaf+" "+s.item_open).addClass(s.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(s.closed).addClass("ui-icon "+s.opened).end().children("a").addClass(s.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")===-1;}).removeClass(s.item_leaf+" "+s.item_clsd).addClass(s.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(s.closed+" ui-icon "+s.opened).end().children("a").addClass(s.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")===-1;}).removeClass(s.item_clsd+" "+s.item_open).addClass(s.item_leaf||"jstree-no-icon");}},defaults:{"opened":"ui-icon-triangle-1-se","closed":"ui-icon-triangle-1-e","item":"ui-state-default","item_h":"ui-state-hover","item_a":"ui-state-active","item_open":"ui-icon-folder-open","item_clsd":"ui-icon-folder-collapsed","item_leaf":"ui-icon-document"}});$(function(){var css_string=''+'.jstree-themeroller .ui-icon { overflow:visible; } '+'.jstree-themeroller a { padding:0 2px; } '+'.jstree-themeroller .jstree-no-icon { display:none; }';$.vakata.css.add_sheet({str:css_string,title:"jstree"});});})(jQuery);(function($){$.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",$.proxy(function(e,data){var nms=[],res=true,p,t;if(data.func=="move_node"){if(data.args[4]===true){if(data.args[0].o&&data.args[0].o.length){data.args[0].o.children("a").each(function(){nms.push($(this).text().replace(/^\s+/g,""));});res=this._check_unique(nms,data.args[0].np.find("> ul > li").not(data.args[0].o),"move_node");}}}
if(data.func=="create_node"){if(data.args[4]||this._is_loaded(data.args[0])){p=this._get_node(data.args[0]);if(data.args[1]&&(data.args[1]==="before"||data.args[1]==="after")){p=this._get_parent(data.args[0]);if(!p||p===-1){p=this.get_container();}}
if(typeof data.args[2]==="string"){nms.push(data.args[2]);}
else if(!data.args[2]||!data.args[2].data){nms.push(this._get_string("new_node"));}
else{nms.push(data.args[2].data);}
res=this._check_unique(nms,p.find("> ul > li"),"create_node");}}
if(data.func=="rename_node"){nms.push(data.args[1]);t=this._get_node(data.args[0]);p=this._get_parent(t);if(!p||p===-1){p=this.get_container();}
res=this._check_unique(nms,p.find("> ul > li").not(t),"rename_node");}
if(!res){e.stopPropagation();return false;}},this));},defaults:{error_callback:$.noop},_fn:{_check_unique:function(nms,p,func){var cnms=[];p.children("a").each(function(){cnms.push($(this).text().replace(/^\s+/g,""));});if(!cnms.length||!nms.length){return true;}
cnms=cnms.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");if((cnms.length+nms.length)!=cnms.concat(nms).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length){this._get_settings().unique.error_callback.call(null,nms,p,func);return false;}
return true;},check_move:function(){if(!this.__call_old()){return false;}
var p=this._get_move(),nms=[];if(p.o&&p.o.length){p.o.children("a").each(function(){nms.push($(this).text().replace(/^\s+/g,""));});return this._check_unique(nms,p.np.find("> ul > li").not(p.o),"check_move");}
return true;}}});})(jQuery);(function($){$.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui){throw"jsTree wholerow: jsTree UI plugin not included.";}
this.data.wholerow.html=false;this.data.wholerow.to=false;this.get_container().bind("init.jstree",$.proxy(function(e,data){this._get_settings().core.animation=0;},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",$.proxy(function(e,data){this._prepare_wholerow_span(data&&data.rslt&&data.rslt.obj?data.rslt.obj:-1);},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",$.proxy(function(e,data){if(this.data.to){clearTimeout(this.data.to);}
this.data.to=setTimeout((function(t,o){return function(){t._prepare_wholerow_ul(o);};})(this,data&&data.rslt&&data.rslt.obj?data.rslt.obj:-1),0);},this)).bind("deselect_all.jstree",$.proxy(function(e,data){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""));},this)).bind("select_node.jstree deselect_node.jstree ",$.proxy(function(e,data){data.rslt.obj.each(function(){var ref=data.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+(parseInt((($(this).offset().top-data.inst.get_container().offset().top+data.inst.get_container()[0].scrollTop)/ data.inst.data.core.li_height),10))+")");ref.children("a").attr("class",data.rslt.obj.children("a").attr("class"));});},this)).bind("hover_node.jstree dehover_node.jstree",$.proxy(function(e,data){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));if(e.type==="hover_node"){var ref=this.get_container().find(" > .jstree-wholerow li:visible:eq("+(parseInt(((data.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/ this.data.core.li_height),10))+")");ref.children("a").attr("class",data.rslt.obj.children(".jstree-hovered").attr("class"));}},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(e){var n=$(e.currentTarget);if(e.target.tagName==="A"||(e.target.tagName==="INS"&&n.closest("li").is(".jstree-open, .jstree-closed"))){return;}
n.closest("li").children("a:visible:eq(0)").click();e.stopImmediatePropagation();}).delegate("li","mouseover.jstree",$.proxy(function(e){e.stopImmediatePropagation();if($(e.currentTarget).children(".jstree-hovered, .jstree-clicked").length){return false;}
this.hover_node(e.currentTarget);return false;},this)).delegate("li","mouseleave.jstree",$.proxy(function(e){if($(e.currentTarget).children("a").hasClass("jstree-hovered").length){return;}
this.dehover_node(e.currentTarget);},this));if(is_ie7||is_ie6){$.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"});}},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove();this.get_container().find(".jstree-wholerow-span").remove();},_fn:{_prepare_wholerow_span:function(obj){obj=!obj||obj==-1?this.get_container().find("> ul > li"):this._get_node(obj);if(obj===false){return;}
obj.each(function(){$(this).find("li").andSelf().each(function(){var $t=$(this);if($t.children(".jstree-wholerow-span").length){return true;}
$t.prepend("<span class='jstree-wholerow-span' style='width:"+($t.parentsUntil(".jstree","li").length*18)+"px;'>&#160;</span>");});});},_prepare_wholerow_ul:function(){var o=this.get_container().children("ul").eq(0),h=o.html();o.addClass("jstree-wholerow-real");if(this.data.wholerow.last_html!==h){this.data.wholerow.last_html=h;this.get_container().children(".jstree-wholerow").remove();this.get_container().append(o.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(o.parent()[0].scrollWidth).css("top",(o.height()+(is_ie7?5:0))*-1).find("li[id]").each(function(){this.removeAttribute("id");}).end());}}}});$(function(){var css_string=''+'.jstree .jstree-wholerow-real { position:relative; z-index:1; } '+'.jstree .jstree-wholerow-real li { cursor:pointer; } '+'.jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } '+'.jstree .jstree-wholerow { position:relative; z-index:0; height:0; } '+'.jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } '+'.jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } '+'.jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }'+'.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }'+'.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } '+'.jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }';if(is_ff2){css_string+=''+'.jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } '+'.jstree .jstree-wholerow-real a { border-color:transparent !important; } ';}
if(is_ie7||is_ie6){css_string+=''+'.jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } '+'.jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } ';}
$.vakata.css.add_sheet({str:css_string,title:"jstree"});});})(jQuery);(function($){var nodeInterface=["getChildren","getChildrenCount","getAttr","getName","getProps"],validateInterface=function(obj,inter){var valid=true;obj=obj||{};inter=[].concat(inter);$.each(inter,function(i,v){if(!$.isFunction(obj[v])){valid=false;return false;}});return valid;};$.jstree.plugin("model",{__init:function(){if(!this.data.json_data){throw"jsTree model: jsTree json_data plugin not included.";}
this._get_settings().json_data.data=function(n,b){var obj=(n==-1)?this._get_settings().model.object:n.data("jstree_model");if(!validateInterface(obj,nodeInterface)){return b.call(null,false);}
if(this._get_settings().model.async){obj.getChildren($.proxy(function(data){this.model_done(data,b);},this));}
else{this.model_done(obj.getChildren(),b);}};},defaults:{object:false,id_prefix:false,async:false},_fn:{model_done:function(data,callback){var ret=[],s=this._get_settings(),_this=this;if(!$.isArray(data)){data=[data];}
$.each(data,function(i,nd){var r=nd.getProps()||{};r.attr=nd.getAttr()||{};if(nd.getChildrenCount()){r.state="closed";}
r.data=nd.getName();if(!$.isArray(r.data)){r.data=[r.data];}
if(_this.data.types&&$.isFunction(nd.getType)){r.attr[s.types.type_attr]=nd.getType();}
if(r.attr.id&&s.model.id_prefix){r.attr.id=s.model.id_prefix+r.attr.id;}
if(!r.metadata){r.metadata={};}
r.metadata.jstree_model=nd;ret.push(r);});callback.call(null,ret);}}});})(jQuery);})();
/* End of File include/javascript/jquery/jquery.jstree.js */

!function($){"use strict"
var PopoverExt=function(element,options){this.init('popoverext',element,options);}
PopoverExt.prototype=$.extend({},$.fn.popover.Constructor.prototype,{constructor:PopoverExt,init:function(type,element,options){var eventIn,eventOut;this.type=type;this.$element=$(element);this.options=this.getOptions(options);this.enabled=true;if(this.options.trigger!='manual'){eventIn=this.options.trigger=='hover'?'mouseenter':'focus';eventOut=this.options.trigger=='hover'?'mouseleave':'blur';this.$element.on(eventIn,this.options.selector,$.proxy(this.enter,this));this.$element.on(eventOut,this.options.selector,$.proxy(this.leave,this));}
var $tip=this.tip();this.options.selector?(this._options=$.extend({},this.options,{trigger:'manual',selector:''})):this.fixTitle();},setContent:function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent(),footer=this.getFooter();$tip.find('.popover-title')[$.type(title)=='object'?'append':'html'](title);$tip.find('.popover-content > *')[$.type(content)=='object'?'append':'html'](content);$tip.find('.popover-footer')[$.type(footer)=='object'?'append':'html'](footer);$tip.removeClass('fade top bottom left right in');},hasContent:function(){return this.getTitle()||this.getContent();},setId:function(){var $tip;if(this.options.id){$tip=this.tip();$tip.attr("id",this.$element.attr("id")+"Popover");}},show:function(){var $tip,inside,pos,actualWidth,actualHeight,placement,tp;if(this.hasContent()&&this.enabled){$tip=this.tip();this.setContent();this.setId();if(this.options.animation){$tip.addClass('fade');}
placement=typeof this.options.placement=='function'?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement;inside=/in/.test(placement);$tip.remove().css({top:0,left:0,display:'block'}).appendTo(inside?this.$element:document.body);if(this.options.hideOnBlur){$tip.attr("tabindex","-1").on("blur",$.proxy(this.hide,this)).trigger("focus");}
pos=this.getPosition(inside);actualWidth=$tip[0].offsetWidth;actualHeight=$tip[0].offsetHeight;switch(inside?placement.split(' ')[1]:placement){case'bottom':tp={top:pos.top+pos.height+this.options.topOffset,left:pos.left+pos.width / 2-actualWidth / 2};break;case'bottom left':tp={top:pos.top+pos.height+this.options.topOffset,left:pos.left+this.options.leftOffset};break;case'bottom right':tp={top:pos.top+pos.height+this.options.topOffset,left:(pos.left+pos.width)-actualWidth-this.options.leftOffset};break;case'top':tp={top:pos.top-actualHeight+this.options.topOffset,left:pos.left+(pos.width / 2-actualWidth / 2)+this.options.leftOffset};break;case'top right':tp={top:pos.top-actualHeight+this.options.topOffset,left:(pos.left+pos.width)-actualWidth-this.options.leftOffset};break;case'top left':tp={top:pos.top-actualHeight+this.options.topOffset,left:pos.left+this.options.leftOffset};break;case'left':tp={top:pos.top+pos.height / 2-actualHeight / 2,left:pos.left-actualWidth};break;case'right':tp={top:pos.top+pos.height / 2-actualHeight / 2,left:pos.left+pos.width};break;}
$tip.css(tp).addClass(placement).addClass('in');if(this.options.fixed==true){$tip.css("position","fixed");}}
this.options.onShow();},getFooter:function(){var footer,$e=this.$element,o=this.options;footer=$e.attr('data-footer')||(typeof o.content=='function'?o.footer.call($e[0]):o.footer);footer=footer.toString().replace(/(^\s*|\s*$)/,"");return footer;}})
$.fn.popoverext=function(option){return this.each(function(){var $this=$(this),data=$this.data('popoverext'),options=typeof option=='object'&&option;if(!data)$this.data('popoverext',(data=new PopoverExt(this,options)))
if(typeof option=='string')data[option]();})}
$.fn.popoverext.Constructor=PopoverExt
$.fn.popoverext.defaults=$.extend({},$.fn.popover.defaults,{fixed:false,template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div><div class="popover-footer"></div></div></div>',id:false,footer:'',onShow:$.empty,leftOffset:0,topOffset:0,hideOnBlur:false})}(window.jQuery);
/* End of File include/javascript/jquery/jquery.popoverext.js */


/*!
     * jQuery UI Effects Bounce 1.8.21
     *
     * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
     * Dual licensed under the MIT or GPL Version 2 licenses.
     * http://jquery.org/license
     *
     * http://docs.jquery.com/UI/Effects/Bounce
     *
     * Depends:
     *	jquery.effects.core.js
     */

/*!
 * jQuery UI Effects Bounce 1.8.21
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Bounce
 *
 * Depends:
 *	jquery.effects.core.js
 */

(function($,undefined){$.effects.custombounce=function(o){return this.queue(function(){var el=$(this),props=['position','top','bottom','left','right'];var mode=$.effects.setMode(el,o.options.mode||'effect');var direction=o.options.direction||'up';var gravity=(o.options.gravity=="undefined")?true:o.options.gravity;var distance=o.options.distance||20;var times=o.options.times||5;var speed=o.duration||250;if(/show|hide/.test(mode))props.push('opacity');$.effects.save(el,props);el.show();$.effects.createWrapper(el);var ref,ref2,motion;if(direction=='up'||direction=='down'){ref='top';}else if(direction=='up right'||direction=='down right'||direction=='up left'||direction=='down left'){ref='top';ref2='left';}else{ref='left';}
var motion=(direction=='up'||direction=='left')?'pos':'neg';if(direction=="up"||direction=="left"){motion="pos";}else{motion="neg";}
var distance=o.options.distance||(ref=='top'?el.outerHeight({margin:true})/ 3:el.outerWidth({margin:true})/ 3);if(mode=='show')el.css('opacity',0).css(ref,motion=='pos'?-distance:distance);if(mode=='hide')distance=distance /(times*2);if(mode!='hide')times--;if(mode=='show'){var animation={opacity:1};animation[ref]=(motion=='pos'?'+=':'-=')+distance;el.animate(animation,speed / 2,o.options.easing);distance=distance / 2;times--;};for(var i=0;i<times;i++){var animation1={},animation2={};animation1[ref]=(motion=='pos'?'-=':'+=')+distance;animation2[ref]=(motion=='pos'?'+=':'-=')+distance;var rtl=rtl=="undefined"?false:rtl;if(ref2!="undefined"){if(!rtl){if(direction=="up right"||direction=="down left"){animation1[ref2]=(motion=='pos'?'-=':'+=')+distance;animation2[ref2]=(motion=='pos'?'+=':'-=')+distance;}else{animation1[ref2]=(motion=='pos'?'+=':'-=')+distance;animation2[ref2]=(motion=='pos'?'-=':'+=')+distance;}}else{if(direction=="down right"||direction=="up left"){animation1[ref2]=(motion=='pos'?'-=':'+=')+distance;animation2[ref2]=(motion=='pos'?'+=':'-=')+distance;}else{animation1[ref2]=(motion=='pos'?'+=':'-=')+distance;animation2[ref2]=(motion=='pos'?'-=':'+=')+distance;}}}
el.animate(animation1,speed / 2,o.options.easing).animate(animation2,speed / 2,o.options.easing);if(gravity){distance=(mode=='hide')?distance*2:distance / 2;}};if(mode=='hide'){var animation={opacity:0};animation[ref]=(motion=='pos'?'-=':'+=')+distance;el.animate(animation,speed / 2,o.options.easing,function(){el.hide();$.effects.restore(el,props);$.effects.removeWrapper(el);if(o.callback)o.callback.apply(this,arguments);});}else{var animation1={},animation2={};animation1[ref]=(motion=='pos'?'-=':'+=')+distance;animation2[ref]=(motion=='pos'?'+=':'-=')+distance;if(ref2!="undefined"){animation1[ref2]=(motion=='pos'?'+=':'-=')+distance;animation2[ref2]=(motion=='pos'?'-=':'+=')+distance;}
el.animate(animation1,speed / 2,o.options.easing).animate(animation2,speed / 2,o.options.easing,function(){$.effects.restore(el,props);$.effects.removeWrapper(el);if(o.callback)o.callback.apply(this,arguments);});};el.queue('fx',function(){el.dequeue();});el.dequeue();});};})(jQuery);
/* End of File include/javascript/jquery/jquery.effects.custombounce.js */

(function($){$.fn.noUiSlider=function(method,options){function neg(a){return a<0;}
function abs(a){return Math.abs(a);}
function roundTo(a,b){return Math.round(a / b)*b;}
function dup(a){return jQuery.extend(true,{},a);}
var defaults,methods,helpers,options=options||[],functions,touch=('ontouchstart'in document.documentElement);defaults={'handles':2,'connect':true,'scale':[0,100],'start':[25,75],'to':0,'handle':0,'change':'','end':'','step':false,'save':false,'click':true};helpers={scale:function(a,b,c){var d=b[0],e=b[1];if(neg(d)){a=a+abs(d);e=e+abs(d);}else{a=a-d;e=e-d;}
return(a*c)/e;},deScale:function(a,b,c){var d=b[0],e=b[1];e=neg(d)?e+abs(d):e-d;return((a*e)/c)+d;},connect:function(api){if(api.connect){if(api.handles.length>1){api.connect.css({'left':api.low.left(),'right':(api.slider.innerWidth()-api.up.left())});}else{api.low?api.connect.css({'left':api.low.left(),'right':0}):api.connect.css({'left':0,'right':(api.slider.innerWidth()-api.up.left())});}}},left:function(){return parseFloat($(this).css('left'));},call:function(f,t,n){if(typeof(f)=="function"){f.call(t,n)}},bounce:function(api,n,c,handle){var go=false;if(handle.is(api.up)){if(api.low&&n<api.low.left()){n=api.low.left();go=true;}}else{if(api.up&&n>api.up.left()){n=api.up.left();go=true;}}
if(n>api.slider.innerWidth()){n=api.slider.innerWidth()
go=true;}else if(n<0){n=0;go=true;}
return[n,go];}};methods={init:function(){return this.each(function(){var s,slider,api;slider=$(this).css('position','relative');api=new Object();api.options=$.extend(defaults,options);s=api.options;typeof s.start=='object'?1:s.start=[s.start];api.slider=slider;api.low=$('<div class="noUi-handle noUi-lowerHandle"><div></div></div>');api.up=$('<div class="noUi-handle noUi-upperHandle"><div></div></div>');api.connect=$('<div class="noUi-midBar"></div>');s.connect?api.connect.appendTo(api.slider):api.connect=false;if(s.knobs){s.handles=s.knobs;}
if(s.handles===1){if(s.connect===true||s.connect==='lower'){api.low=false;api.up=api.up.appendTo(api.slider);api.handles=[api.up];}else if(s.connect==='upper'||!s.connect){api.low=api.low.prependTo(api.slider);api.up=false;api.handles=[api.low];}}else{api.low=api.low.prependTo(api.slider);api.up=api.up.appendTo(api.slider);api.handles=[api.low,api.up];}
if(api.low){api.low.left=helpers.left;}
if(api.up){api.up.left=helpers.left;}
api.slider.children().css('position','absolute');$.each(api.handles,function(index){$(this).css({'left':helpers.scale(s.start[index],api.options.scale,api.slider.innerWidth()),'zIndex':index+1}).children().bind(touch?'touchstart.noUi':'mousedown.noUi',functions.start);});if(s.click){api.slider.click(functions.click).find('*:not(.noUi-midBar)').click(functions.flse);}
helpers.connect(api);api.options=s;api.slider.data('api',api);});},move:function(){var api,bounce,to,handle,scale;api=dup($(this).data('api'));api.options=$.extend(api.options,options);if(api.options.knob){api.options.handle=api.options.knob;}
handle=api.options.handle;handle=api.handles[handle=='lower'||handle==0||typeof handle=='undefined'?0:1];bounce=helpers.bounce(api,helpers.scale(api.options.to,api.options.scale,api.slider.innerWidth()),handle.left(),handle);handle.css('left',bounce[0]);if((handle.is(api.up)&&handle.left()==0)||(handle.is(api.low)&&handle.left()==api.slider.innerWidth())){handle.css('zIndex',parseInt(handle.css('zIndex'))+2);}
if(options.save===true){api.options.scale=options.scale;$(this).data('api',api);}
helpers.connect(api);helpers.call(api.options.change,api.slider,'move');helpers.call(api.options.end,api.slider,'move');},value:function(){var val1,val2,api;api=dup($(this).data('api'));api.options=$.extend(api.options,options);val1=api.low?Math.round(helpers.deScale(api.low.left(),api.options.scale,api.slider.innerWidth())):false;val2=api.up?Math.round(helpers.deScale(api.up.left(),api.options.scale,api.slider.innerWidth())):false;if(options.save){api.options.scale=options.scale;$(this).data('api',api);}
return[val1,val2];},api:function(){return $(this).data('api');},disable:function(){return this.each(function(){$(this).addClass('disabled');});},enable:function(){return this.each(function(){$(this).removeClass('disabled');});}},functions={start:function(e){if(!$(this).parent().parent().hasClass('disabled')){e.preventDefault();$('body').bind('selectstart.noUi',functions.flse);$(this).addClass('noUi-activeHandle');$(document).bind(touch?'touchmove.noUi':'mousemove.noUi',functions.move);touch?$(this).bind('touchend.noUi',functions.end):$(document).bind('mouseup.noUi',functions.end);}},move:function(e){var a,b,h,api,go=false,handle,bounce;h=$('.noUi-activeHandle');api=h.parent().parent().data('api');handle=h.parent().is(api.low)?api.low:api.up;a=e.pageX-Math.round(api.slider.offset().left);if(isNaN(a)){a=e.originalEvent.touches[0].pageX-Math.round(api.slider.offset().left);}
b=handle.left();bounce=helpers.bounce(api,a,b,handle);a=bounce[0];go=bounce[1];if(api.options.step&&!go){var v1=api.options.scale[0];var v2=api.options.scale[1];if(neg(v2)){v2=abs(v1-v2);}
var con=helpers.scale(api.options.step,[0,v2+abs(v1)],api.slider.innerWidth());if(Math.abs(b-a)>=con){a=a<b?b-con:b+con;go=true;}}else{go=true;}
if(a===b){go=false;}
if(go){handle.css('left',a);if((handle.is(api.up)&&handle.left()==0)||(handle.is(api.low)&&handle.left()==api.slider.innerWidth())){handle.css('zIndex',parseInt(handle.css('zIndex'))+2);}
helpers.connect(api);helpers.call(api.options.change,api.slider,'slide');}},end:function(){var h,api;h=$('.noUi-activeHandle');api=h.parent().parent().data('api');$(document).add('body').add(h.removeClass('noUi-activeHandle').parent()).unbind('.noUi');helpers.call(api.options.end,api.slider,'slide');},click:function(e){if(!$(this).hasClass('disabled')){var api=$(this).data('api');var s=api.options;var c=e.pageX-api.slider.offset().left;c=s.step?roundTo(c,helpers.scale(s.step,s.scale,api.slider.innerWidth())):c;if(api.low&&api.up){c<((api.low.left()+api.up.left())/2)?api.low.css("left",c):api.up.css("left",c);}else{api.handles[0].css('left',c);}
helpers.connect(api);helpers.call(s.change,api.slider,'click');helpers.call(s.end,api.slider,'click');}},flse:function(){return false;}}
if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments);}else{$.error('No such method: '+method);}};})(jQuery);
/* End of File include/javascript/jquery/jquery.nouislider.js */


/*! NProgress (c) 2013, Rico Sta. Cruz
     *  http://ricostacruz.com/nprogress */

/*! NProgress (c) 2013, Rico Sta. Cruz
 *  http://ricostacruz.com/nprogress */
;(function(factory){if(typeof module==='function'){module.exports=factory();}else if(typeof define==='function'&&define.amd){define(factory);}else{this.NProgress=factory();}})(function(){var NProgress={};NProgress.version='0.1.3';var Settings=NProgress.settings={minimum:0.08,easing:'ease',positionUsing:'',speed:200,trickle:true,trickleRate:0.02,trickleSpeed:800,showSpinner:true,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};NProgress.configure=function(options){var key,value;for(key in options){value=options[key];if(value!==undefined&&options.hasOwnProperty(key))Settings[key]=value;}
return this;};NProgress.status=null;NProgress.set=function(n){var started=NProgress.isStarted();n=clamp(n,Settings.minimum,1);NProgress.status=(n===1?null:n);var progress=NProgress.render(!started),bar=progress.querySelector(Settings.barSelector),speed=Settings.speed,ease=Settings.easing;progress.offsetWidth;queue(function(next){if(Settings.positionUsing==='')Settings.positionUsing=NProgress.getPositioningCSS();css(bar,barPositionCSS(n,speed,ease));if(n===1){css(progress,{transition:'none',opacity:1});progress.offsetWidth;setTimeout(function(){css(progress,{transition:'all '+speed+'ms linear',opacity:0});setTimeout(function(){NProgress.remove();next();},speed);},speed);}else{setTimeout(next,speed);}});return this;};NProgress.isStarted=function(){return typeof NProgress.status==='number';};NProgress.start=function(){if(!NProgress.status)NProgress.set(0);var work=function(){setTimeout(function(){if(!NProgress.status)return;NProgress.trickle();work();},Settings.trickleSpeed);};if(Settings.trickle)work();return this;};NProgress.done=function(force){if(!force&&!NProgress.status)return this;return NProgress.inc(0.3+0.5*Math.random()).set(1);};NProgress.inc=function(amount){var n=NProgress.status;if(!n){return NProgress.start();}else{if(typeof amount!=='number'){amount=(1-n)*clamp(Math.random()*n,0.1,0.95);}
n=clamp(n+amount,0,0.994);return NProgress.set(n);}};NProgress.trickle=function(){return NProgress.inc(Math.random()*Settings.trickleRate);};(function(){var initial=0,current=0;NProgress.promise=function($promise){if(!$promise||$promise.state()=="resolved"){return this;}
if(current==0){NProgress.start();}
initial++;current++;$promise.always(function(){current--;if(current==0){initial=0;NProgress.done();}else{NProgress.set((initial-current)/ initial);}});return this;};})();NProgress.render=function(fromStart){if(NProgress.isRendered())return document.getElementById('nprogress');addClass(document.documentElement,'nprogress-busy');var progress=document.createElement('div');progress.id='nprogress';progress.innerHTML=Settings.template;var bar=progress.querySelector(Settings.barSelector),perc=fromStart?'-100':toBarPerc(NProgress.status||0),spinner;css(bar,{transition:'all 0 linear',transform:'translate3d('+perc+'%,0,0)'});if(!Settings.showSpinner){spinner=progress.querySelector(Settings.spinnerSelector);spinner&&removeElement(spinner);}
document.body.appendChild(progress);return progress;};NProgress.remove=function(){removeClass(document.documentElement,'nprogress-busy');var progress=document.getElementById('nprogress');progress&&removeElement(progress);};NProgress.isRendered=function(){return!!document.getElementById('nprogress');};NProgress.getPositioningCSS=function(){var bodyStyle=document.body.style;var vendorPrefix=('WebkitTransform'in bodyStyle)?'Webkit':('MozTransform'in bodyStyle)?'Moz':('msTransform'in bodyStyle)?'ms':('OTransform'in bodyStyle)?'O':'';if(vendorPrefix+'Perspective'in bodyStyle){return'translate3d';}else if(vendorPrefix+'Transform'in bodyStyle){return'translate';}else{return'margin';}};function clamp(n,min,max){if(n<min)return min;if(n>max)return max;return n;}
function toBarPerc(n){return(-1+n)*100;}
function barPositionCSS(n,speed,ease){var barCSS;if(Settings.positionUsing==='translate3d'){barCSS={transform:'translate3d('+toBarPerc(n)+'%,0,0)'};}else if(Settings.positionUsing==='translate'){barCSS={transform:'translate('+toBarPerc(n)+'%,0)'};}else{barCSS={'margin-left':toBarPerc(n)+'%'};}
barCSS.transition='all '+speed+'ms '+ease;return barCSS;}
var queue=(function(){var pending=[];function next(){var fn=pending.shift();if(fn){fn(next);}}
return function(fn){pending.push(fn);if(pending.length==1)next();};})();var css=(function(){var cssPrefixes=['Webkit','O','Moz','ms'],cssProps={};function camelCase(string){return string.replace(/^-ms-/,'ms-').replace(/-([\da-z])/gi,function(match,letter){return letter.toUpperCase();});}
function getVendorProp(name){var style=document.body.style;if(name in style)return name;var i=cssPrefixes.length,capName=name.charAt(0).toUpperCase()+name.slice(1),vendorName;while(i--){vendorName=cssPrefixes[i]+capName;if(vendorName in style)return vendorName;}
return name;}
function getStyleProp(name){name=camelCase(name);return cssProps[name]||(cssProps[name]=getVendorProp(name));}
function applyCss(element,prop,value){prop=getStyleProp(prop);element.style[prop]=value;}
return function(element,properties){var args=arguments,prop,value;if(args.length==2){for(prop in properties){value=properties[prop];if(value!==undefined&&properties.hasOwnProperty(prop))applyCss(element,prop,value);}}else{applyCss(element,args[1],args[2]);}}})();function hasClass(element,name){var list=typeof element=='string'?element:classList(element);return list.indexOf(' '+name+' ')>=0;}
function addClass(element,name){var oldList=classList(element),newList=oldList+name;if(hasClass(oldList,name))return;element.className=newList.substring(1);}
function removeClass(element,name){var oldList=classList(element),newList;if(!hasClass(element,name))return;newList=oldList.replace(' '+name+' ',' ');element.className=newList.substring(1,newList.length-1);}
function classList(element){return(' '+(element.className||'')+' ').replace(/\s+/gi,' ');}
function removeElement(element){element&&element.parentNode&&element.parentNode.removeChild(element);}
return NProgress;});
/* End of File include/javascript/nprogress/nprogress.js */

!function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("ar-ma",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("ar",{months:"/  _/ _/ _/ _/ _/ _/ _/ _/ _/  _/  _/  ".split("_"),monthsShort:"/  _/ _/ _/ _/ _/ _/ _/ _/ _/  _/  _/  ".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("bg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"H:mm",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:case 5:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},ordinal:function(a){var b=a%10,c=a%100;return 0===a?a+"-":0===c?a+"-":c>10&&20>c?a+"-":1===b?a+"-":2===b?a+"-":7===b||8===b?a+"-":a+"-"},week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b,c){var d={mm:"munutenn",MM:"miz",dd:"devezh"};return a+" "+e(d[c],a)}function c(a){switch(d(a)){case 1:case 3:case 4:case 5:case 9:return a+" bloaz";default:return a+" vloaz"}}function d(a){return a>9?d(a%10):a}function e(a,b){return 2===b?f(a):a}function f(a){var b={m:"v",b:"v",d:"z"};return void 0===b[a.charAt(0)]?a:b[a.charAt(0)]+a.substring(1)}return a.lang("br",{months:"Genver_C'hwevrer_Meurzh_Ebrel_Mae_Mezheven_Gouere_Eost_Gwengolo_Here_Du_Kerzu".split("_"),monthsShort:"Gen_C'hwe_Meu_Ebr_Mae_Eve_Gou_Eos_Gwe_Her_Du_Ker".split("_"),weekdays:"Sul_Lun_Meurzh_Merc'her_Yaou_Gwener_Sadorn".split("_"),weekdaysShort:"Sul_Lun_Meu_Mer_Yao_Gwe_Sad".split("_"),weekdaysMin:"Su_Lu_Me_Mer_Ya_Gw_Sa".split("_"),longDateFormat:{LT:"h[e]mm A",L:"DD/MM/YYYY",LL:"D [a viz] MMMM YYYY",LLL:"D [a viz] MMMM YYYY LT",LLLL:"dddd, D [a viz] MMMM YYYY LT"},calendar:{sameDay:"[Hiziv da] LT",nextDay:"[Warc'hoazh da] LT",nextWeek:"dddd [da] LT",lastDay:"[Dec'h da] LT",lastWeek:"dddd [paset da] LT",sameElse:"L"},relativeTime:{future:"a-benn %s",past:"%s 'zo",s:"un nebeud segondenno",m:"ur vunutenn",mm:b,h:"un eur",hh:"%d eur",d:"un devezh",dd:b,M:"ur miz",MM:b,y:"ur bloaz",yy:c},ordinal:function(a){var b=1===a?"a":"vet";return a+b},week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b,c){var d=a+" ";switch(c){case"m":return b?"jedna minuta":"jedne minute";case"mm":return d+=1===a?"minuta":2===a||3===a||4===a?"minute":"minuta";case"h":return b?"jedan sat":"jednog sata";case"hh":return d+=1===a?"sat":2===a||3===a||4===a?"sata":"sati";case"dd":return d+=1===a?"dan":"dana";case"MM":return d+=1===a?"mjesec":2===a||3===a||4===a?"mjeseca":"mjeseci";case"yy":return d+=1===a?"godina":2===a||3===a||4===a?"godine":"godina"}}return a.lang("bs",{months:"januar_februar_mart_april_maj_juni_juli_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),longDateFormat:{LT:"H:mm",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",m:b,mm:b,h:b,hh:b,d:"dan",dd:b,M:"mjesec",MM:b,y:"godinu",yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("ca",{months:"gener_febrer_mar_abril_maig_juny_juliol_agost_setembre_octubre_novembre_desembre".split("_"),monthsShort:"gen._febr._mar._abr._mai._jun._jul._ag._set._oct._nov._des.".split("_"),weekdays:"diumenge_dilluns_dimarts_dimecres_dijous_divendres_dissabte".split("_"),weekdaysShort:"dg._dl._dt._dc._dj._dv._ds.".split("_"),weekdaysMin:"Dg_Dl_Dt_Dc_Dj_Dv_Ds".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:function(){return"[avui a "+(1!==this.hours()?"les":"la")+"] LT"},nextDay:function(){return"[dem a "+(1!==this.hours()?"les":"la")+"] LT"},nextWeek:function(){return"dddd [a "+(1!==this.hours()?"les":"la")+"] LT"},lastDay:function(){return"[ahir a "+(1!==this.hours()?"les":"la")+"] LT"},lastWeek:function(){return"[el] dddd [passat a "+(1!==this.hours()?"les":"la")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"fa %s",s:"uns segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},ordinal:"%d",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a){return a>1&&5>a&&1!==~~(a/10)}function c(a,c,d,e){var f=a+" ";switch(d){case"s":return c||e?"pr vtein":"pr vteinami";case"m":return c?"minuta":e?"minutu":"minutou";case"mm":return c||e?f+(b(a)?"minuty":"minut"):f+"minutami";break;case"h":return c?"hodina":e?"hodinu":"hodinou";case"hh":return c||e?f+(b(a)?"hodiny":"hodin"):f+"hodinami";break;case"d":return c||e?"den":"dnem";case"dd":return c||e?f+(b(a)?"dny":"dn"):f+"dny";break;case"M":return c||e?"msc":"mscem";case"MM":return c||e?f+(b(a)?"msce":"msc"):f+"msci";break;case"y":return c||e?"rok":"rokem";case"yy":return c||e?f+(b(a)?"roky":"let"):f+"lety"}}var d="leden_nor_bezen_duben_kvten_erven_ervenec_srpen_z_jen_listopad_prosinec".split("_"),e="led_no_be_dub_kv_vn_vc_srp_z_j_lis_pro".split("_");return a.lang("cs",{months:d,monthsShort:e,monthsParse:function(a,b){var c,d=[];for(c=0;12>c;c++)d[c]=new RegExp("^"+a[c]+"$|^"+b[c]+"$","i");return d}(d,e),weekdays:"nedle_pondl_ter_steda_tvrtek_ptek_sobota".split("_"),weekdaysShort:"ne_po_t_st_t_p_so".split("_"),weekdaysMin:"ne_po_t_st_t_p_so".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd D. MMMM YYYY LT"},calendar:{sameDay:"[dnes v] LT",nextDay:"[ztra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve stedu v] LT";case 4:return"[ve tvrtek v] LT";case 5:return"[v ptek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[vera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou nedli v] LT";case 1:case 2:return"[minul] dddd [v] LT";case 3:return"[minulou stedu v] LT";case 4:case 5:return"[minul] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"ped %s",s:c,m:c,mm:c,h:c,hh:c,d:c,dd:c,M:c,MM:c,y:c,yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("cv",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",L:"DD-MM-YYYY",LL:"YYYY [] MMMM [] D[-]",LLL:"YYYY [] MMMM [] D[-], LT",LLLL:"dddd, YYYY [] MMMM [] D[-], LT"},calendar:{sameDay:"[] LT []",nextDay:"[] LT []",lastDay:"[] LT []",nextWeek:"[] dddd LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:function(a){var b=/$/i.exec(a)?"":/$/i.exec(a)?"":"";return a+b},past:"%s ",s:"- ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},ordinal:"%d-",week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("cy",{months:"Ionawr_Chwefror_Mawrth_Ebrill_Mai_Mehefin_Gorffennaf_Awst_Medi_Hydref_Tachwedd_Rhagfyr".split("_"),monthsShort:"Ion_Chwe_Maw_Ebr_Mai_Meh_Gor_Aws_Med_Hyd_Tach_Rhag".split("_"),weekdays:"Dydd Sul_Dydd Llun_Dydd Mawrth_Dydd Mercher_Dydd Iau_Dydd Gwener_Dydd Sadwrn".split("_"),weekdaysShort:"Sul_Llun_Maw_Mer_Iau_Gwe_Sad".split("_"),weekdaysMin:"Su_Ll_Ma_Me_Ia_Gw_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Heddiw am] LT",nextDay:"[Yfory am] LT",nextWeek:"dddd [am] LT",lastDay:"[Ddoe am] LT",lastWeek:"dddd [diwethaf am] LT",sameElse:"L"},relativeTime:{future:"mewn %s",past:"%s yn l",s:"ychydig eiliadau",m:"munud",mm:"%d munud",h:"awr",hh:"%d awr",d:"diwrnod",dd:"%d diwrnod",M:"mis",MM:"%d mis",y:"blwyddyn",yy:"%d flynedd"},ordinal:function(a){var b=a,c="",d=["","af","il","ydd","ydd","ed","ed","ed","fed","fed","fed","eg","fed","eg","eg","fed","eg","eg","fed","eg","fed"];return b>20?c=40===b||50===b||60===b||80===b||100===b?"fed":"ain":b>0&&(c=d[b]),a+c},week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("da",{months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_man_tir_ons_tor_fre_lr".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D. MMMM, YYYY LT"},calendar:{sameDay:"[I dag kl.] LT",nextDay:"[I morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[I gr kl.] LT",lastWeek:"[sidste] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"f sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en mned",MM:"%d mneder",y:"et r",yy:"%d r"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b,c){var d={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[a+" Tage",a+" Tagen"],M:["ein Monat","einem Monat"],MM:[a+" Monate",a+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[a+" Jahre",a+" Jahren"]};return b?d[c][0]:d[c][1]}return a.lang("de",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),longDateFormat:{LT:"H:mm [Uhr]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Heute um] LT",sameElse:"L",nextDay:"[Morgen um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gestern um] LT",lastWeek:"[letzten] dddd [um] LT"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:b,mm:"%d Minuten",h:b,hh:"%d Stunden",d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("el",{monthsNominativeEl:"___________".split("_"),monthsGenitiveEl:"___________".split("_"),months:function(a,b){return/D/.test(b.substring(0,b.indexOf("MMMM")))?this._monthsGenitiveEl[a.month()]:this._monthsNominativeEl[a.month()]},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),meridiem:function(a,b,c){return a>11?c?"":"":c?"":""},longDateFormat:{LT:"h:mm A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendarEl:{sameDay:"[ {}] LT",nextDay:"[ {}] LT",nextWeek:"dddd [{}] LT",lastDay:"[ {}] LT",lastWeek:"[ ] dddd [{}] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendarEl[a],d=b&&b.hours();return c.replace("{}",d%12===1?"":"")},relativeTime:{future:" %s",past:"%s ",s:"",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},ordinal:function(a){return a+""},week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("en-au",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c},week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("en-ca",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"YYYY-MM-DD",LL:"D MMMM, YYYY",LLL:"D MMMM, YYYY LT",LLLL:"dddd, D MMMM, YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c},week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("eo",{months:"januaro_februaro_marto_aprilo_majo_junio_julio_agusto_septembro_oktobro_novembro_decembro".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_ag_sep_okt_nov_dec".split("_"),weekdays:"Dimano_Lundo_Mardo_Merkredo_ado_Vendredo_Sabato".split("_"),weekdaysShort:"Dim_Lun_Mard_Merk_a_Ven_Sab".split("_"),weekdaysMin:"Di_Lu_Ma_Me_a_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"D[-an de] MMMM, YYYY",LLL:"D[-an de] MMMM, YYYY LT",LLLL:"dddd, [la] D[-an de] MMMM, YYYY LT"},meridiem:function(a,b,c){return a>11?c?"p.t.m.":"P.T.M.":c?"a.t.m.":"A.T.M."},calendar:{sameDay:"[Hodia je] LT",nextDay:"[Morga je] LT",nextWeek:"dddd [je] LT",lastDay:"[Hiera je] LT",lastWeek:"[pasinta] dddd [je] LT",sameElse:"L"},relativeTime:{future:"je %s",past:"anta %s",s:"sekundoj",m:"minuto",mm:"%d minutoj",h:"horo",hh:"%d horoj",d:"tago",dd:"%d tagoj",M:"monato",MM:"%d monatoj",y:"jaro",yy:"%d jaroj"},ordinal:"%da",week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:"ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"Do_Lu_Ma_Mi_Ju_Vi_S".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},ordinal:"%d",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b,c,d){var e={s:["mne sekundi","mni sekund","paar sekundit"],m:["he minuti","ks minut"],mm:[a+" minuti",a+" minutit"],h:["he tunni","tund aega","ks tund"],hh:[a+" tunni",a+" tundi"],d:["he peva","ks pev"],M:["kuu aja","kuu aega","ks kuu"],MM:[a+" kuu",a+" kuud"],y:["he aasta","aasta","ks aasta"],yy:[a+" aasta",a+" aastat"]};return b?e[c][2]?e[c][2]:e[c][1]:d?e[c][0]:e[c][1]}return a.lang("et",{months:"jaanuar_veebruar_mrts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"),monthsShort:"jaan_veebr_mrts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"),weekdays:"phapev_esmaspev_teisipev_kolmapev_neljapev_reede_laupev".split("_"),weekdaysShort:"P_E_T_K_N_R_L".split("_"),weekdaysMin:"P_E_T_K_N_R_L".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Tna,] LT",nextDay:"[Homme,] LT",nextWeek:"[Jrgmine] dddd LT",lastDay:"[Eile,] LT",lastWeek:"[Eelmine] dddd LT",sameElse:"L"},relativeTime:{future:"%s prast",past:"%s tagasi",s:b,m:b,mm:b,h:b,hh:b,d:b,dd:"%d peva",M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("eu",{months:"urtarrila_otsaila_martxoa_apirila_maiatza_ekaina_uztaila_abuztua_iraila_urria_azaroa_abendua".split("_"),monthsShort:"urt._ots._mar._api._mai._eka._uzt._abu._ira._urr._aza._abe.".split("_"),weekdays:"igandea_astelehena_asteartea_asteazkena_osteguna_ostirala_larunbata".split("_"),weekdaysShort:"ig._al._ar._az._og._ol._lr.".split("_"),weekdaysMin:"ig_al_ar_az_og_ol_lr".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"YYYY[ko] MMMM[ren] D[a]",LLL:"YYYY[ko] MMMM[ren] D[a] LT",LLLL:"dddd, YYYY[ko] MMMM[ren] D[a] LT",l:"YYYY-M-D",ll:"YYYY[ko] MMM D[a]",lll:"YYYY[ko] MMM D[a] LT",llll:"ddd, YYYY[ko] MMM D[a] LT"},calendar:{sameDay:"[gaur] LT[etan]",nextDay:"[bihar] LT[etan]",nextWeek:"dddd LT[etan]",lastDay:"[atzo] LT[etan]",lastWeek:"[aurreko] dddd LT[etan]",sameElse:"L"},relativeTime:{future:"%s barru",past:"duela %s",s:"segundo batzuk",m:"minutu bat",mm:"%d minutu",h:"ordu bat",hh:"%d ordu",d:"egun bat",dd:"%d egun",M:"hilabete bat",MM:"%d hilabete",y:"urte bat",yy:"%d urte"},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){var b={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},c={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return a.lang("fa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},meridiem:function(a){return 12>a?"  ":"  "},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(a){return a.replace(/[-]/g,function(a){return c[a]}).replace(//g,",")},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]}).replace(/,/g,"")},ordinal:"%d",week:{dow:6,doy:12}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b,d,e){var f="";switch(d){case"s":return e?"muutaman sekunnin":"muutama sekunti";case"m":return e?"minuutin":"minuutti";case"mm":f=e?"minuutin":"minuuttia";break;case"h":return e?"tunnin":"tunti";case"hh":f=e?"tunnin":"tuntia";break;case"d":return e?"pivn":"piv";case"dd":f=e?"pivn":"piv";break;case"M":return e?"kuukauden":"kuukausi";case"MM":f=e?"kuukauden":"kuukautta";break;case"y":return e?"vuoden":"vuosi";case"yy":f=e?"vuoden":"vuotta"}return f=c(a,e)+" "+f}function c(a,b){return 10>a?b?e[a]:d[a]:a}var d="nolla yksi kaksi kolme nelj viisi kuusi seitsemn kahdeksan yhdeksn".split(" "),e=["nolla","yhden","kahden","kolmen","neljn","viiden","kuuden",d[7],d[8],d[9]];return a.lang("fi",{months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_keskuu_heinkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kes_hein_elo_syys_loka_marras_joulu".split("_"),weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),longDateFormat:{LT:"HH.mm",L:"DD.MM.YYYY",LL:"Do MMMM[ta] YYYY",LLL:"Do MMMM[ta] YYYY, [klo] LT",LLLL:"dddd, Do MMMM[ta] YYYY, [klo] LT",l:"D.M.YYYY",ll:"Do MMM YYYY",lll:"Do MMM YYYY, [klo] LT",llll:"ddd, Do MMM YYYY, [klo] LT"},calendar:{sameDay:"[tnn] [klo] LT",nextDay:"[huomenna] [klo] LT",nextWeek:"dddd [klo] LT",lastDay:"[eilen] [klo] LT",lastWeek:"[viime] dddd[na] [klo] LT",sameElse:"L"},relativeTime:{future:"%s pst",past:"%s sitten",s:b,m:b,mm:b,h:b,hh:b,d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("fo",{months:"januar_februar_mars_aprl_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sunnudagur_mnadagur_tsdagur_mikudagur_hsdagur_frggjadagur_leygardagur".split("_"),weekdaysShort:"sun_mn_ts_mik_hs_fr_ley".split("_"),weekdaysMin:"su_m_t_mi_h_fr_le".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D. MMMM, YYYY LT"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgin kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gjr kl.] LT",lastWeek:"[sstu] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"um %s",past:"%s sani",s:"f sekund",m:"ein minutt",mm:"%d minuttir",h:"ein tmi",hh:"%d tmar",d:"ein dagur",dd:"%d dagar",M:"ein mnai",MM:"%d mnair",y:"eitt r",yy:"%d r"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("fr-ca",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(a){return a+(1===a?"er":"")}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("fr",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(a){return a+(1===a?"er":"")},week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("gl",{months:"Xaneiro_Febreiro_Marzo_Abril_Maio_Xuo_Xullo_Agosto_Setembro_Outubro_Novembro_Decembro".split("_"),monthsShort:"Xan._Feb._Mar._Abr._Mai._Xu._Xul._Ago._Set._Out._Nov._Dec.".split("_"),weekdays:"Domingo_Luns_Martes_Mrcores_Xoves_Venres_Sbado".split("_"),weekdaysShort:"Dom._Lun._Mar._Mr._Xov._Ven._Sb.".split("_"),weekdaysMin:"Do_Lu_Ma_M_Xo_Ve_S".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:function(){return"[hoxe "+(1!==this.hours()?"s":"")+"] LT"
},nextDay:function(){return"[ma "+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd ["+(1!==this.hours()?"s":"a")+"] LT"},lastDay:function(){return"[onte "+(1!==this.hours()?"":"a")+"] LT"},lastWeek:function(){return"[o] dddd [pasado "+(1!==this.hours()?"s":"a")+"] LT"},sameElse:"L"},relativeTime:{future:function(a){return"uns segundos"===a?"nuns segundos":"en "+a},past:"hai %s",s:"uns segundos",m:"un minuto",mm:"%d minutos",h:"unha hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ano",yy:"%d anos"},ordinal:"%d",week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("he",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D []MMMM YYYY",LLL:"D []MMMM YYYY LT",LLLL:"dddd, D []MMMM YYYY LT",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY LT",llll:"ddd, D MMM YYYY LT"},calendar:{sameDay:"[ ]LT",nextDay:"[ ]LT",nextWeek:"dddd [] LT",lastDay:"[ ]LT",lastWeek:"[] dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",m:"",mm:"%d ",h:"",hh:function(a){return 2===a?"":a+" "},d:"",dd:function(a){return 2===a?"":a+" "},M:"",MM:function(a){return 2===a?"":a+" "},y:"",yy:function(a){return 2===a?"":a+" "}}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){var b={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},c={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return a.lang("hi",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(a){return a.replace(/[]/g,function(a){return c[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]})},meridiem:function(a){return 4>a?"":10>a?"":17>a?"":20>a?"":""},week:{dow:0,doy:6}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b,c){var d=a+" ";switch(c){case"m":return b?"jedna minuta":"jedne minute";case"mm":return d+=1===a?"minuta":2===a||3===a||4===a?"minute":"minuta";case"h":return b?"jedan sat":"jednog sata";case"hh":return d+=1===a?"sat":2===a||3===a||4===a?"sata":"sati";case"dd":return d+=1===a?"dan":"dana";case"MM":return d+=1===a?"mjesec":2===a||3===a||4===a?"mjeseca":"mjeseci";case"yy":return d+=1===a?"godina":2===a||3===a||4===a?"godine":"godina"}}return a.lang("hr",{months:"sjeanj_veljaa_oujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_"),monthsShort:"sje._vel._ou._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),longDateFormat:{LT:"H:mm",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",m:b,mm:b,h:b,hh:b,d:"dan",dd:b,M:"mjesec",MM:b,y:"godinu",yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b,c,d){var e=a;switch(c){case"s":return d||b?"nhny msodperc":"nhny msodperce";case"m":return"egy"+(d||b?" perc":" perce");case"mm":return e+(d||b?" perc":" perce");case"h":return"egy"+(d||b?" ra":" rja");case"hh":return e+(d||b?" ra":" rja");case"d":return"egy"+(d||b?" nap":" napja");case"dd":return e+(d||b?" nap":" napja");case"M":return"egy"+(d||b?" hnap":" hnapja");case"MM":return e+(d||b?" hnap":" hnapja");case"y":return"egy"+(d||b?" v":" ve");case"yy":return e+(d||b?" v":" ve")}return""}function c(a){return(a?"":"[mlt] ")+"["+d[this.day()]+"] LT[-kor]"}var d="vasrnap htfn kedden szerdn cstrtkn pnteken szombaton".split(" ");return a.lang("hu",{months:"janur_februr_mrcius_prilis_mjus_jnius_jlius_augusztus_szeptember_oktber_november_december".split("_"),monthsShort:"jan_feb_mrc_pr_mj_jn_jl_aug_szept_okt_nov_dec".split("_"),weekdays:"vasrnap_htf_kedd_szerda_cstrtk_pntek_szombat".split("_"),weekdaysShort:"vas_ht_kedd_sze_cst_pn_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),longDateFormat:{LT:"H:mm",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D., LT",LLLL:"YYYY. MMMM D., dddd LT"},calendar:{sameDay:"[ma] LT[-kor]",nextDay:"[holnap] LT[-kor]",nextWeek:function(){return c.call(this,!0)},lastDay:"[tegnap] LT[-kor]",lastWeek:function(){return c.call(this,!1)},sameElse:"L"},relativeTime:{future:"%s mlva",past:"%s",s:b,m:b,mm:b,h:b,hh:b,d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b){var c={nominative:"___________".split("_"),accusative:"___________".split("_")},d=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function c(a){var b="___________".split("_");return b[a.month()]}function d(a){var b="______".split("_");return b[a.day()]}return a.lang("hy-am",{months:b,monthsShort:c,weekdays:d,weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., LT",LLLL:"dddd, D MMMM YYYY ., LT"},calendar:{sameDay:"[] LT",nextDay:"[] LT",lastDay:"[] LT",nextWeek:function(){return"dddd [ ] LT"},lastWeek:function(){return"[] dddd [ ] LT"},sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},meridiem:function(a){return 4>a?"":12>a?"":17>a?"":""},ordinal:function(a,b){switch(b){case"DDD":case"w":case"W":case"DDDo":return 1===a?a+"-":a+"-";default:return a}},week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("id",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nov_Des".split("_"),weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] LT",LLLL:"dddd, D MMMM YYYY [pukul] LT"},meridiem:function(a){return 11>a?"pagi":15>a?"siang":19>a?"sore":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Besok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kemarin pukul] LT",lastWeek:"dddd [lalu pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a){return a%100===11?!0:a%10===1?!1:!0}function c(a,c,d,e){var f=a+" ";switch(d){case"s":return c||e?"nokkrar sekndur":"nokkrum sekndum";case"m":return c?"mnta":"mntu";case"mm":return b(a)?f+(c||e?"mntur":"mntum"):c?f+"mnta":f+"mntu";case"hh":return b(a)?f+(c||e?"klukkustundir":"klukkustundum"):f+"klukkustund";case"d":return c?"dagur":e?"dag":"degi";case"dd":return b(a)?c?f+"dagar":f+(e?"daga":"dgum"):c?f+"dagur":f+(e?"dag":"degi");case"M":return c?"mnuur":e?"mnu":"mnui";case"MM":return b(a)?c?f+"mnuir":f+(e?"mnui":"mnuum"):c?f+"mnuur":f+(e?"mnu":"mnui");case"y":return c||e?"r":"ri";case"yy":return b(a)?f+(c||e?"r":"rum"):f+(c||e?"r":"ri")}}return a.lang("is",{months:"janar_febrar_mars_aprl_ma_jn_jl_gst_september_oktber_nvember_desember".split("_"),monthsShort:"jan_feb_mar_apr_ma_jn_jl_g_sep_okt_nv_des".split("_"),weekdays:"sunnudagur_mnudagur_rijudagur_mivikudagur_fimmtudagur_fstudagur_laugardagur".split("_"),weekdaysShort:"sun_mn_ri_mi_fim_fs_lau".split("_"),weekdaysMin:"Su_M_r_Mi_Fi_F_La".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] LT",LLLL:"dddd, D. MMMM YYYY [kl.] LT"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgun kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gr kl.] LT",lastWeek:"[sasta] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"eftir %s",past:"fyrir %s san",s:c,m:c,mm:c,h:"klukkustund",hh:c,d:c,dd:c,M:c,MM:c,y:c,yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("it",{months:"Gennaio_Febbraio_Marzo_Aprile_Maggio_Giugno_Luglio_Agosto_Settembre_Ottobre_Novembre_Dicembre".split("_"),monthsShort:"Gen_Feb_Mar_Apr_Mag_Giu_Lug_Ago_Set_Ott_Nov_Dic".split("_"),weekdays:"Domenica_Luned_Marted_Mercoled_Gioved_Venerd_Sabato".split("_"),weekdaysShort:"Dom_Lun_Mar_Mer_Gio_Ven_Sab".split("_"),weekdaysMin:"D_L_Ma_Me_G_V_S".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:"[lo scorso] dddd [alle] LT",sameElse:"L"},relativeTime:{future:function(a){return(/^[0-9].+$/.test(a)?"tra":"in")+" "+a},past:"%s fa",s:"alcuni secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},ordinal:"%d",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("ja",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"Ahm",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMDLT",LLLL:"YYYYMDLT dddd"},meridiem:function(a){return 12>a?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd LT",lastDay:"[] LT",lastWeek:"[]dddd LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:"",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b){var c={nominative:"___________".split("_"),accusative:"___________".split("_")},d=/D[oD] *MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function c(a,b){var c={nominative:"______".split("_"),accusative:"______".split("_")},d=/(|)/.test(b)?"accusative":"nominative";return c[d][a.day()]}return a.lang("ka",{months:b,monthsShort:"___________".split("_"),weekdays:c,weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"h:mm A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[] LT[-]",nextDay:"[] LT[-]",lastDay:"[] LT[-]",nextWeek:"[] dddd LT[-]",lastWeek:"[] dddd LT-",sameElse:"L"},relativeTime:{future:function(a){return/(|||)/.test(a)?a.replace(/$/,""):a+""},past:function(a){return/(||||)/.test(a)?a.replace(/(|)$/," ")://.test(a)?a.replace(/$/," "):void 0},s:" ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},ordinal:function(a){return 0===a?a:1===a?a+"-":20>a||100>=a&&a%20===0||a%100===0?"-"+a:a+"-"},week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("ko",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h mm",L:"YYYY.MM.DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D LT",LLLL:"YYYY MMMM D dddd LT"},meridiem:function(a){return 12>a?"":""},calendar:{sameDay:" LT",nextDay:" LT",nextWeek:"dddd LT",lastDay:" LT",lastWeek:" dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"",ss:"%d",m:"",mm:"%d",h:"",hh:"%d",d:"",dd:"%d",M:"",MM:"%d",y:"",yy:"%d"},ordinal:"%d",meridiemParse:/(|)/,isPM:function(a){return""===a}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b,c){var d={m:["eng Minutt","enger Minutt"],h:["eng Stonn","enger Stonn"],d:["een Dag","engem Dag"],dd:[a+" Deeg",a+" Deeg"],M:["ee Mount","engem Mount"],MM:[a+" Mint",a+" Mint"],y:["ee Joer","engem Joer"],yy:[a+" Joer",a+" Joer"]};return b?d[c][0]:d[c][1]}function c(a){var b=a.substr(0,a.indexOf(" "));return g(b)?"a "+a:"an "+a}function d(a){var b=a.substr(0,a.indexOf(" "));return g(b)?"viru "+a:"virun "+a}function e(){var a=this.format("d");return f(a)?"[Leschte] dddd [um] LT":"[Leschten] dddd [um] LT"}function f(a){switch(a=parseInt(a,10)){case 0:case 1:case 3:case 5:case 6:return!0;default:return!1}}function g(a){if(a=parseInt(a,10),isNaN(a))return!1;if(0>a)return!0;if(10>a)return a>=4&&7>=a?!0:!1;if(100>a){var b=a%10,c=a/10;return 0===b?g(c):g(b)}if(1e4>a){for(;a>=10;)a/=10;return g(a)}return a/=1e3,g(a)}return a.lang("lb",{months:"Januar_Februar_Merz_Abrll_Mee_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Abr._Mee_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),weekdays:"Sonndeg_Mindeg_Dnschdeg_Mttwoch_Donneschdeg_Freideg_Samschdeg".split("_"),weekdaysShort:"So._M._D._M._Do._Fr._Sa.".split("_"),weekdaysMin:"So_M_D_M_Do_Fr_Sa".split("_"),longDateFormat:{LT:"H:mm [Auer]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Haut um] LT",sameElse:"L",nextDay:"[Muer um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gschter um] LT",lastWeek:e},relativeTime:{future:c,past:d,s:"e puer Sekonnen",m:b,mm:"%d Minutten",h:b,hh:"%d Stonnen",d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b,c,d){return b?"kelios sekunds":d?"keli sekundi":"kelias sekundes"}function c(a,b,c,d){return b?e(c)[0]:d?e(c)[1]:e(c)[2]}function d(a){return a%10===0||a>10&&20>a}function e(a){return h[a].split("_")}function f(a,b,f,g){var h=a+" ";return 1===a?h+c(a,b,f[0],g):b?h+(d(a)?e(f)[1]:e(f)[0]):g?h+e(f)[1]:h+(d(a)?e(f)[1]:e(f)[2])}function g(a,b){var c=-1===b.indexOf("dddd LT"),d=i[a.weekday()];return c?d:d.substring(0,d.length-2)+""}var h={m:"minut_minuts_minut",mm:"minuts_minui_minutes",h:"valanda_valandos_valand",hh:"valandos_valand_valandas",d:"diena_dienos_dien",dd:"dienos_dien_dienas",M:"mnuo_mnesio_mnes",MM:"mnesiai_mnesi_mnesius",y:"metai_met_metus",yy:"metai_met_metus"},i="pirmadienis_antradienis_treiadienis_ketvirtadienis_penktadienis_etadienis_sekmadienis".split("_");return a.lang("lt",{months:"sausio_vasario_kovo_balandio_gegus_birlio_liepos_rugpjio_rugsjo_spalio_lapkriio_gruodio".split("_"),monthsShort:"sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),weekdays:g,weekdaysShort:"Sek_Pir_Ant_Tre_Ket_Pen_e".split("_"),weekdaysMin:"S_P_A_T_K_Pn_".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], LT [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, LT [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], LT [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, LT [val.]"},calendar:{sameDay:"[iandien] LT",nextDay:"[Rytoj] LT",nextWeek:"dddd LT",lastDay:"[Vakar] LT",lastWeek:"[Prajus] dddd LT",sameElse:"L"},relativeTime:{future:"po %s",past:"prie %s",s:b,m:c,mm:f,h:c,hh:f,d:c,dd:f,M:c,MM:f,y:c,yy:f},ordinal:function(a){return a+"-oji"},week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b,c){var d=a.split("_");return c?b%10===1&&11!==b?d[2]:d[3]:b%10===1&&11!==b?d[0]:d[1]}function c(a,c,e){return a+" "+b(d[e],a,c)}var d={mm:"minti_mintes_minte_mintes",hh:"stundu_stundas_stunda_stundas",dd:"dienu_dienas_diena_dienas",MM:"mnesi_mneus_mnesis_mnei",yy:"gadu_gadus_gads_gadi"};return a.lang("lv",{months:"janvris_februris_marts_aprlis_maijs_jnijs_jlijs_augusts_septembris_oktobris_novembris_decembris".split("_"),monthsShort:"jan_feb_mar_apr_mai_jn_jl_aug_sep_okt_nov_dec".split("_"),weekdays:"svtdiena_pirmdiena_otrdiena_trediena_ceturtdiena_piektdiena_sestdiena".split("_"),weekdaysShort:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysMin:"Sv_P_O_T_C_Pk_S".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"YYYY. [gada] D. MMMM",LLL:"YYYY. [gada] D. MMMM, LT",LLLL:"YYYY. [gada] D. MMMM, dddd, LT"},calendar:{sameDay:"[odien pulksten] LT",nextDay:"[Rt pulksten] LT",nextWeek:"dddd [pulksten] LT",lastDay:"[Vakar pulksten] LT",lastWeek:"[Pagju] dddd [pulksten] LT",sameElse:"L"},relativeTime:{future:"%s vlk",past:"%s agrk",s:"daas sekundes",m:"minti",mm:c,h:"stundu",hh:c,d:"dienu",dd:c,M:"mnesi",MM:c,y:"gadu",yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("mk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"e_o_____a".split("_"),longDateFormat:{LT:"H:mm",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:case 5:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},ordinal:function(a){var b=a%10,c=a%100;return 0===a?a+"-":0===c?a+"-":c>10&&20>c?a+"-":1===b?a+"-":2===b?a+"-":7===b||8===b?a+"-":a+"-"},week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("ml",{months:"___________".split("_"),monthsShort:"._._._.___._._._._._.".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm -",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiem:function(a){return 4>a?"":12>a?"":17>a?" ":20>a?"":""}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){var b={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},c={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return a.lang("mr",{months:"___________".split("_"),monthsShort:"._._._._._._._._._._._.".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(a){return a.replace(/[]/g,function(a){return c[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]})},meridiem:function(a){return 4>a?"":10>a?"":17>a?"":20>a?"":""},week:{dow:0,doy:6}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("ms-my",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] LT",LLLL:"dddd, D MMMM YYYY [pukul] LT"},meridiem:function(a){return 11>a?"pagi":15>a?"tengahari":19>a?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("nb",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_april_mai_juni_juli_aug._sep._okt._nov._des.".split("_"),weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"s._ma._ti._on._to._fr._l.".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"H.mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] LT",LLLL:"dddd D. MMMM YYYY [kl.] LT"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[forrige] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"for %s siden",s:"noen sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en mned",MM:"%d mneder",y:"ett r",yy:"%d r"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){var b={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},c={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return a.lang("ne",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"._.__._._._.".split("_"),longDateFormat:{LT:"A h:mm ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},preparse:function(a){return a.replace(/[]/g,function(a){return c[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]})},meridiem:function(a){return 3>a?"":10>a?"":15>a?"":18>a?"":20>a?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd[,] LT",lastDay:"[] LT",lastWeek:"[] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){var b="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),c="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_");return a.lang("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(a,d){return/-MMM-/.test(d)?c[a.month()]:b[a.month()]},weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"Zo_Ma_Di_Wo_Do_Vr_Za".split("_"),longDateFormat:{LT:"HH:mm",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},ordinal:function(a){return a+(1===a||8===a||a>=20?"ste":"de")},week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("nn",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sundag_mndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"sun_mn_tys_ons_tor_fre_lau".split("_"),weekdaysMin:"su_m_ty_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[I dag klokka] LT",nextDay:"[I morgon klokka] LT",nextWeek:"dddd [klokka] LT",lastDay:"[I gr klokka] LT",lastWeek:"[Fregende] dddd [klokka] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"for %s siden",s:"noen sekund",m:"ett minutt",mm:"%d minutt",h:"en time",hh:"%d timar",d:"en dag",dd:"%d dagar",M:"en mnad",MM:"%d mnader",y:"ett r",yy:"%d r"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a){return 5>a%10&&a%10>1&&~~(a/10)%10!==1}function c(a,c,d){var e=a+" ";switch(d){case"m":return c?"minuta":"minut";case"mm":return e+(b(a)?"minuty":"minut");case"h":return c?"godzina":"godzin";case"hh":return e+(b(a)?"godziny":"godzin");case"MM":return e+(b(a)?"miesice":"miesicy");case"yy":return e+(b(a)?"lata":"lat")}}var d="stycze_luty_marzec_kwiecie_maj_czerwiec_lipiec_sierpie_wrzesie_padziernik_listopad_grudzie".split("_"),e="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrzenia_padziernika_listopada_grudnia".split("_");return a.lang("pl",{months:function(a,b){return/D MMMM/.test(b)?e[a.month()]:d[a.month()]},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_pa_lis_gru".split("_"),weekdays:"niedziela_poniedziaek_wtorek_roda_czwartek_pitek_sobota".split("_"),weekdaysShort:"nie_pon_wt_r_czw_pt_sb".split("_"),weekdaysMin:"N_Pn_Wt_r_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Dzi o] LT",nextDay:"[Jutro o] LT",nextWeek:"[W] dddd [o] LT",lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zesz niedziel o] LT";case 3:return"[W zesz rod o] LT";case 6:return"[W zesz sobot o] LT";
default:return"[W zeszy] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",m:c,mm:c,h:c,hh:c,d:"1 dzie",dd:"%d dni",M:"miesic",MM:c,y:"rok",yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("pt-br",{months:"Janeiro_Fevereiro_Maro_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Dom_2_3_4_5_6_Sb".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrs",s:"segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinal:"%d"})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("pt",{months:"Janeiro_Fevereiro_Maro_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Dom_2_3_4_5_6_Sb".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrs",s:"segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinal:"%d",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b,c){var d={mm:"minute",hh:"ore",dd:"zile",MM:"luni",yy:"ani"},e=" ";return(a%100>=20||a>=100&&a%100===0)&&(e=" de "),a+e+d[c]}return a.lang("ro",{months:"ianuarie_februarie_martie_aprilie_mai_iunie_iulie_august_septembrie_octombrie_noiembrie_decembrie".split("_"),monthsShort:"ian_feb_mar_apr_mai_iun_iul_aug_sep_oct_noi_dec".split("_"),weekdays:"duminic_luni_mari_miercuri_joi_vineri_smbt".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_S".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[azi la] LT",nextDay:"[mine la] LT",nextWeek:"dddd [la] LT",lastDay:"[ieri la] LT",lastWeek:"[fosta] dddd [la] LT",sameElse:"L"},relativeTime:{future:"peste %s",past:"%s n urm",s:"cteva secunde",m:"un minut",mm:b,h:"o or",hh:b,d:"o zi",dd:b,M:"o lun",MM:b,y:"un an",yy:b},week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b,c){var d=a+" ";switch(c){case"m":return b?"jedna minuta":"jedne minute";case"mm":return d+=1===a?"minuta":2===a||3===a||4===a?"minute":"minuta";case"h":return b?"jedan sat":"jednog sata";case"hh":return d+=1===a?"sat":2===a||3===a||4===a?"sata":"sati";case"dd":return d+=1===a?"dan":"dana";case"MM":return d+=1===a?"mesec":2===a||3===a||4===a?"meseca":"meseci";case"yy":return d+=1===a?"godina":2===a||3===a||4===a?"godine":"godina"}}return a.lang("rs",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),weekdays:"nedelja_ponedeljak_utorak_sreda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sre._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),longDateFormat:{LT:"H:mm",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedelju] [u] LT";case 3:return"[u] [sredu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pre %s",s:"par sekundi",m:b,mm:b,h:b,hh:b,d:"dan",dd:b,M:"mesec",MM:b,y:"godinu",yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b){var c=a.split("_");return b%10===1&&b%100!==11?c[0]:b%10>=2&&4>=b%10&&(10>b%100||b%100>=20)?c[1]:c[2]}function c(a,c,d){var e={mm:"__",hh:"__",dd:"__",MM:"__",yy:"__"};return"m"===d?c?"":"":a+" "+b(e[d],+a)}function d(a,b){var c={nominative:"___________".split("_"),accusative:"___________".split("_")},d=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function e(a,b){var c={nominative:"___________".split("_"),accusative:"___________".split("_")},d=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function f(a,b){var c={nominative:"______".split("_"),accusative:"______".split("_")},d=/\[ ?[] ?(?:|)? ?\] ?dddd/.test(b)?"accusative":"nominative";return c[d][a.day()]}return a.lang("ru",{months:d,monthsShort:e,weekdays:f,weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),monthsParse:[/^/i,/^/i,/^/i,/^/i,/^[|]/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., LT",LLLL:"dddd, D MMMM YYYY ., LT"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:function(){return 2===this.day()?"[] dddd [] LT":"[] dddd [] LT"},lastWeek:function(){switch(this.day()){case 0:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT";case 3:case 5:case 6:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:c,mm:c,h:"",hh:c,d:"",dd:c,M:"",MM:c,y:"",yy:c},meridiem:function(a){return 4>a?"":12>a?"":17>a?"":""},ordinal:function(a,b){switch(b){case"M":case"d":case"DDD":return a+"-";case"D":return a+"-";case"w":case"W":return a+"-";default:return a}},week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a){return a>1&&5>a}function c(a,c,d,e){var f=a+" ";switch(d){case"s":return c||e?"pr seknd":"pr sekundami";case"m":return c?"minta":e?"mintu":"mintou";case"mm":return c||e?f+(b(a)?"minty":"mint"):f+"mintami";break;case"h":return c?"hodina":e?"hodinu":"hodinou";case"hh":return c||e?f+(b(a)?"hodiny":"hodn"):f+"hodinami";break;case"d":return c||e?"de":"dom";case"dd":return c||e?f+(b(a)?"dni":"dn"):f+"dami";break;case"M":return c||e?"mesiac":"mesiacom";case"MM":return c||e?f+(b(a)?"mesiace":"mesiacov"):f+"mesiacmi";break;case"y":return c||e?"rok":"rokom";case"yy":return c||e?f+(b(a)?"roky":"rokov"):f+"rokmi"}}var d="janur_februr_marec_aprl_mj_jn_jl_august_september_oktber_november_december".split("_"),e="jan_feb_mar_apr_mj_jn_jl_aug_sep_okt_nov_dec".split("_");return a.lang("sk",{months:d,monthsShort:e,monthsParse:function(a,b){var c,d=[];for(c=0;12>c;c++)d[c]=new RegExp("^"+a[c]+"$|^"+b[c]+"$","i");return d}(d,e),weekdays:"nedea_pondelok_utorok_streda_tvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_t_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_t_pi_so".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd D. MMMM YYYY LT"},calendar:{sameDay:"[dnes o] LT",nextDay:"[zajtra o] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedeu o] LT";case 1:case 2:return"[v] dddd [o] LT";case 3:return"[v stredu o] LT";case 4:return"[vo tvrtok o] LT";case 5:return"[v piatok o] LT";case 6:return"[v sobotu o] LT"}},lastDay:"[vera o] LT",lastWeek:function(){switch(this.day()){case 0:return"[minul nedeu o] LT";case 1:case 2:return"[minul] dddd [o] LT";case 3:return"[minul stredu o] LT";case 4:case 5:return"[minul] dddd [o] LT";case 6:return"[minul sobotu o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pred %s",s:c,m:c,mm:c,h:c,hh:c,d:c,dd:c,M:c,MM:c,y:c,yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b,c){var d=a+" ";switch(c){case"m":return b?"ena minuta":"eno minuto";case"mm":return d+=1===a?"minuta":2===a?"minuti":3===a||4===a?"minute":"minut";case"h":return b?"ena ura":"eno uro";case"hh":return d+=1===a?"ura":2===a?"uri":3===a||4===a?"ure":"ur";case"dd":return d+=1===a?"dan":"dni";case"MM":return d+=1===a?"mesec":2===a?"meseca":3===a||4===a?"mesece":"mesecev";case"yy":return d+=1===a?"leto":2===a?"leti":3===a||4===a?"leta":"let"}}return a.lang("sl",{months:"januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),weekdays:"nedelja_ponedeljek_torek_sreda_etrtek_petek_sobota".split("_"),weekdaysShort:"ned._pon._tor._sre._et._pet._sob.".split("_"),weekdaysMin:"ne_po_to_sr_e_pe_so".split("_"),longDateFormat:{LT:"H:mm",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[danes ob] LT",nextDay:"[jutri ob] LT",nextWeek:function(){switch(this.day()){case 0:return"[v] [nedeljo] [ob] LT";case 3:return"[v] [sredo] [ob] LT";case 6:return"[v] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[v] dddd [ob] LT"}},lastDay:"[veraj ob] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[prejnja] dddd [ob] LT";case 1:case 2:case 4:case 5:return"[prejnji] dddd [ob] LT"}},sameElse:"L"},relativeTime:{future:"ez %s",past:"%s nazaj",s:"nekaj sekund",m:b,mm:b,h:b,hh:b,d:"en dan",dd:b,M:"en mesec",MM:b,y:"eno leto",yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("sq",{months:"Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_Nntor_Dhjetor".split("_"),monthsShort:"Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_Nn_Dhj".split("_"),weekdays:"E Diel_E Hn_E Marte_E Mrkure_E Enjte_E Premte_E Shtun".split("_"),weekdaysShort:"Die_Hn_Mar_Mr_Enj_Pre_Sht".split("_"),weekdaysMin:"D_H_Ma_M_E_P_Sh".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Sot n] LT",nextDay:"[Neser n] LT",nextWeek:"dddd [n] LT",lastDay:"[Dje n] LT",lastWeek:"dddd [e kaluar n] LT",sameElse:"L"},relativeTime:{future:"n %s",past:"%s me par",s:"disa sekonda",m:"nj minut",mm:"%d minuta",h:"nj or",hh:"%d or",d:"nj dit",dd:"%d dit",M:"nj muaj",MM:"%d muaj",y:"nj vit",yy:"%d vite"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("sv",{months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mndag_tisdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_mn_tis_ons_tor_fre_lr".split("_"),weekdaysMin:"s_m_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Idag] LT",nextDay:"[Imorgon] LT",lastDay:"[Igr] LT",nextWeek:"dddd LT",lastWeek:"[Frra] dddd[en] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"fr %s sedan",s:"ngra sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en mnad",MM:"%d mnader",y:"ett r",yy:"%d r"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"e":1===b?"a":2===b?"a":3===b?"e":"e";return a+c},week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("ta",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[ ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",m:" ",mm:"%d ",h:"  ",hh:"%d  ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},ordinal:function(a){return a+""},meridiem:function(a){return a>=6&&10>=a?" ":a>=10&&14>=a?" ":a>=14&&18>=a?" ":a>=18&&20>=a?" ":a>=20&&24>=a?" ":a>=0&&6>=a?" ":void 0},week:{dow:0,doy:6}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("th",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"._._._._._._.".split("_"),longDateFormat:{LT:"H  m ",L:"YYYY/MM/DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY  LT",LLLL:"dddd D MMMM YYYY  LT"},meridiem:function(a){return 12>a?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd[ ] LT",lastDay:"[ ] LT",lastWeek:"[]dddd[ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("tl-ph",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM DD, YYYY LT"},calendar:{sameDay:"[Ngayon sa] LT",nextDay:"[Bukas sa] LT",nextWeek:"dddd [sa] LT",lastDay:"[Kahapon sa] LT",lastWeek:"dddd [huling linggo] LT",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},ordinal:function(a){return a},week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){var b={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'nc",4:"'nc",100:"'nc",6:"'nc",9:"'uncu",10:"'uncu",30:"'uncu",60:"'nc",90:"'nc"};return a.lang("tr",{months:"Ocak_ubat_Mart_Nisan_Mays_Haziran_Temmuz_Austos_Eyll_Ekim_Kasm_Aralk".split("_"),monthsShort:"Oca_ub_Mar_Nis_May_Haz_Tem_Au_Eyl_Eki_Kas_Ara".split("_"),weekdays:"Pazar_Pazartesi_Sal_aramba_Perembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_ar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_a_Pe_Cu_Ct".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[yarn saat] LT",nextWeek:"[haftaya] dddd [saat] LT",lastDay:"[dn] LT",lastWeek:"[geen hafta] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s nce",s:"birka saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir yl",yy:"%d yl"},ordinal:function(a){if(0===a)return a+"'nc";var c=a%10,d=a%100-c,e=a>=100?100:null;return a+(b[c]||b[d]||b[e])},week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("tzm-la",{months:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),monthsShort:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),weekdays:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysShort:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysMin:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[asdkh g] LT",nextDay:"[aska g] LT",nextWeek:"dddd [g] LT",lastDay:"[assant g] LT",lastWeek:"dddd [g] LT",sameElse:"L"},relativeTime:{future:"dadkh s yan %s",past:"yan %s",s:"imik",m:"minu",mm:"%d minu",h:"saa",hh:"%d tassain",d:"ass",dd:"%d ossan",M:"ayowr",MM:"%d iyyirn",y:"asgas",yy:"%d isgasn"},week:{dow:6,doy:12}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("tzm",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] LT",sameElse:"L"},relativeTime:{future:"   %s",past:" %s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d o",M:"o",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b){var c=a.split("_");return b%10===1&&b%100!==11?c[0]:b%10>=2&&4>=b%10&&(10>b%100||b%100>=20)?c[1]:c[2]}function c(a,c,d){var e={mm:"__",hh:"__",dd:"__",MM:"__",yy:"__"};return"m"===d?c?"":"":"h"===d?c?"":"":a+" "+b(e[d],+a)}function d(a,b){var c={nominative:"___________".split("_"),accusative:"___________".split("_")},d=/D[oD]? *MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function e(a,b){var c={nominative:"______".split("_"),accusative:"______".split("_"),genitive:"______".split("_")},d=/(\[[]\]) ?dddd/.test(b)?"accusative":/\[?(?:|)? ?\] ?dddd/.test(b)?"genitive":"nominative";return c[d][a.day()]}function f(a){return function(){return a+""+(11===this.hours()?"":"")+"] LT"}}return a.lang("uk",{months:d,monthsShort:"___________".split("_"),weekdays:e,weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., LT",LLLL:"dddd, D MMMM YYYY ., LT"},calendar:{sameDay:f("[ "),nextDay:f("[ "),lastDay:f("[ "),nextWeek:f("[] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return f("[] dddd [").call(this);case 1:case 2:case 4:return f("[] dddd [").call(this)}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:c,mm:c,h:"",hh:c,d:"",dd:c,M:"",MM:c,y:"",yy:c},meridiem:function(a){return 4>a?"":12>a?"":17>a?"":""},ordinal:function(a,b){switch(b){case"M":case"d":case"DDD":case"w":case"W":return a+"-";case"D":return a+"-";default:return a}},week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("uz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"D MMMM YYYY, dddd LT"},calendar:{sameDay:"[ ] LT []",nextDay:"[] LT []",nextWeek:"dddd [ ] LT []",lastDay:"[ ] LT []",lastWeek:"[] dddd [ ] LT []",sameElse:"L"},relativeTime:{future:" %s ",past:"  %s ",s:"",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:1,doy:7}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("vn",{months:"thng 1_thng 2_thng 3_thng 4_thng 5_thng 6_thng 7_thng 8_thng 9_thng 10_thng 11_thng 12".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),weekdays:"ch nht_th hai_th ba_th t_th nm_th su_th by".split("_"),weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM [nm] YYYY",LLL:"D MMMM [nm] YYYY LT",LLLL:"dddd, D MMMM [nm] YYYY LT",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY LT",llll:"ddd, D MMM YYYY LT"},calendar:{sameDay:"[Hm nay lc] LT",nextDay:"[Ngy mai lc] LT",nextWeek:"dddd [tun ti lc] LT",lastDay:"[Hm qua lc] LT",lastWeek:"dddd [tun ri lc] LT",sameElse:"L"},relativeTime:{future:"%s ti",past:"%s trc",s:"vi giy",m:"mt pht",mm:"%d pht",h:"mt gi",hh:"%d gi",d:"mt ngy",dd:"%d ngy",M:"mt thng",MM:"%d thng",y:"mt nm",yy:"%d nm"},ordinal:function(a){return a},week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("zh-cn",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"Ahmm",L:"YYYY-MM-DD",LL:"YYYYMMMD",LLL:"YYYYMMMDLT",LLLL:"YYYYMMMDddddLT",l:"YYYY-MM-DD",ll:"YYYYMMMD",lll:"YYYYMMMDLT",llll:"YYYYMMMDddddLT"},meridiem:function(a,b){var c=100*a+b;return 600>c?"":900>c?"":1130>c?"":1230>c?"":1800>c?"":""},calendar:{sameDay:function(){return 0===this.minutes()?"[]Ah[]":"[]LT"},nextDay:function(){return 0===this.minutes()?"[]Ah[]":"[]LT"},lastDay:function(){return 0===this.minutes()?"[]Ah[]":"[]LT"},nextWeek:function(){var b,c;return b=a().startOf("week"),c=this.unix()-b.unix()>=604800?"[]":"[]",0===this.minutes()?c+"dddAh":c+"dddAhmm"},lastWeek:function(){var b,c;return b=a().startOf("week"),c=this.unix()<b.unix()?"[]":"[]",0===this.minutes()?c+"dddAh":c+"dddAhmm"},sameElse:"LL"},ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"";case"M":return a+"";case"w":case"W":return a+"";default:return a}},relativeTime:{future:"%s",past:"%s",s:"",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"},week:{dow:1,doy:4}})}),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){return a.lang("zh-tw",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"Ahmm",L:"YYYYMMMD",LL:"YYYYMMMD",LLL:"YYYYMMMDLT",LLLL:"YYYYMMMDddddLT",l:"YYYYMMMD",ll:"YYYYMMMD",lll:"YYYYMMMDLT",llll:"YYYYMMMDddddLT"},meridiem:function(a,b){var c=100*a+b;return 900>c?"":1130>c?"":1230>c?"":1800>c?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"";case"M":return a+"";case"w":case"W":return a+"";default:return a}},relativeTime:{future:"%s",past:"%s",s:"",m:"",mm:"%d",h:"",hh:"%d",d:"",dd:"%d",M:"",MM:"%d",y:"",yy:"%d"}})});
/* End of File sidecar/lib/momentjs/min/langs.min.js */


if(typeof(SUGAR)=='undefined')SUGAR={};if(typeof(SUGAR.util)=='undefined')SUGAR.util={};if(typeof(SUGAR.expressions)=='undefined')SUGAR.expressions={};(function(){SUGAR.util.extend=SUGAR.util.extend||(SUGAR.App?SUGAR.App.utils.extendFrom:null);var SEE=SUGAR.expressions.Expression=function(context){this.context=context;};SEE.INFINITY=-1;SEE.STRING_TYPE="string";SEE.NUMERIC_TYPE="number";SEE.DATE_TYPE="date";SEE.TIME_TYPE="time";SEE.BOOLEAN_TYPE="boolean";SEE.ENUM_TYPE="enum";SEE.RELATE_TYPE="relate";SEE.GENERIC_TYPE="generic";SEE.TRUE="true";SEE.FALSE="false";SEE.isTruthy=function(v){return _.isString(v)?(v=="1"||v==SEE.TRUE):!!v;};SUGAR.expressions.NumericConstants={pi:3.14159265,e:2.718281828459045}
SEE.prototype.init=function(params){if(params instanceof Array&&params.length==1){this.params=params[0];}
else{this.params=params;}
this.validateParameters();};SEE.prototype.getParameters=function(){return this.params;};SEE.prototype.validateParameters=function(){var params=this.getParameters();var count=this.getParamCount();var types=this.getParameterTypes();if(typeof(count)!='number'){throw(this.getClass()+": Number of paramters required must be a number");}
if(typeof(types)!='string'&&!(types instanceof Array)){throw(this.getClass()+": Parameter types must be valid and match the parameter count");}
if(types instanceof Array&&count!=SEE.INFINITY&&count!=types.length){throw(this.getClass()+": Parameter types must be valid and match the parameter count");}
if(typeof(types)=='string'){if(SEE.TYPE_MAP[types]==null){throw(this.getClass()+": Invalid type requirement '"+types+"'");}}else{for(var i=0;i<types.length;i++){if(typeof(SEE.TYPE_MAP[types[i]])=='undefined'){throw(this.getClass()+": Invalid type requirement '"+types[i]+"'");}}}
if(count==0&&typeof(params)=='undefined'){return;}
if(count==1&&this.isProperType(params,types)){return;}
if(count>1&&!(params instanceof Array)){throw(this.getClass()+": Requires exactly "+count+" parameter(s)");}
if(count==1&&params instanceof Array){throw(this.getClass()+": Requires exactly 1 parameter");}
if(count!=SEE.INFINITY&&params instanceof Array&&params.length!=count){throw(this.getClass()+": Requires exactly "+count+" parameter(s)");}
if(typeof(types)=='string'){if(!(params instanceof Array)){if(this.isProperType(params,types)){return;}
throw(this.getClass()+": Parameter must be of type '"+types+"'");}
for(var i=0;i<params.length;i++){if(!this.isProperType(params[i],types)){throw(this.getClass()+": All parameters must be of type '"+types+"'");}}}
else{if(!(params instanceof Array)){if(this.isProperType(params,types[0])){return;}
throw(this.getClass()+": Parameter must be of type '"+types[0]+"'");}
for(var i=0;i<types.length;i++){if(!this.isProperType(params[i],types[i])){throw(this.getClass()+": The parameter at index "+i+" must be of type "+types[i]);}}}};SEE.prototype.getParamCount=function(){return SEE.INFINITY;};SEE.prototype.isProperType=function(variable,type){var see=SEE;if(type instanceof Array){return false;}
var c=see.TYPE_MAP[type];if(typeof(c)=='undefined'||c==null||c==''){return false;}
if(variable instanceof c||variable instanceof see.TYPE_MAP.generic||type==see.GENERIC_TYPE)
return true;if(variable instanceof see){variable=variable.evaluate();}
switch(type){case see.STRING_TYPE:return(typeof(variable)=='string'||typeof(variable)=='number'||variable instanceof see.TYPE_MAP[see.NUMERIC_TYPE]);break;case see.NUMERIC_TYPE:return(typeof(variable)=='number'||SUGAR.expressions.isNumeric(variable));break;case see.BOOLEAN_TYPE:return variable==see.TRUE||variable==see.FALSE||variable===1||variable===0||variable==='1'||variable==='0'||variable==='';break;case see.DATE_TYPE:case see.TIME_TYPE:if(variable===null||variable===''||(typeof(variable)=='string'&&SUGAR.util.DateUtils.guessFormat(variable)))
return true;break;case see.RELATE_TYPE:return true;break;}
return false;};SEE.prototype.evaluate=function(){};SEE.prototype.getClass=function(exp){for(var i in SUGAR.FunctionMap){if(typeof SUGAR.FunctionMap[i]=="function"&&SUGAR.FunctionMap[i].prototype&&this instanceof SUGAR.FunctionMap[i])
return i;}
return false;};SEE.prototype.getParameterTypes=function(){};SUGAR.expressions.GenericExpression=function(params){};SUGAR.util.extend(SUGAR.expressions.GenericExpression,SEE,{getParameterTypes:function(){return SEE.GENERIC_TYPE;}});SUGAR.expressions.NumericExpression=function(params){};SUGAR.util.extend(SUGAR.expressions.NumericExpression,SEE,{getParameterTypes:function(){return SEE.NUMERIC_TYPE;}});SUGAR.expressions.StringExpression=function(params){};SUGAR.util.extend(SUGAR.expressions.StringExpression,SEE,{getParameterTypes:function(){return SEE.STRING_TYPE;}});SUGAR.expressions.BooleanExpression=function(params){};SUGAR.util.extend(SUGAR.expressions.BooleanExpression,SEE,{getParameterTypes:function(){return SEE.BOOLEAN_TYPE;}});SUGAR.expressions.EnumExpression=function(params){};SUGAR.util.extend(SUGAR.expressions.EnumExpression,SEE,{getParameterTypes:function(){return SEE.ENUM_TYPE;}});SUGAR.expressions.DateExpression=function(params){};SUGAR.util.extend(SUGAR.expressions.DateExpression,SEE,{getParameterTypes:function(){return SEE.DATE_TYPE;}});SUGAR.expressions.TimeExpression=function(params){};SUGAR.util.extend(SUGAR.expressions.TimeExpression,SEE,{getParameterTypes:function(){return SEE.TIME_TYPE;}});SUGAR.expressions.RelateExpression=function(params){};SUGAR.util.extend(SUGAR.expressions.RelateExpression,SEE,{getParameterTypes:function(){return SEE.GENERIC_TYPE;}});SEE.TYPE_MAP={"number":SUGAR.expressions.NumericExpression,"string":SUGAR.expressions.StringExpression,"date":SUGAR.expressions.DateExpression,"time":SUGAR.expressions.TimeExpression,"boolean":SUGAR.expressions.BooleanExpression,"enum":SUGAR.expressions.EnumExpression,"relate":SUGAR.expressions.RelateExpression,"generic":SUGAR.expressions.GenericExpression};SUGAR.expressions.ConstantExpression=function(params){this.init(params);}
SUGAR.util.extend(SUGAR.expressions.ConstantExpression,SUGAR.expressions.NumericExpression,{evaluate:function(){return this.getParameters();},getParamCount:function(){return 1;}});SUGAR.expressions.StringLiteralExpression=function(params){this.init(params);}
SUGAR.util.extend(SUGAR.expressions.StringLiteralExpression,SUGAR.expressions.StringExpression,{evaluate:function(){return this.getParameters();},getParamCount:function(){return 1;}});SUGAR.expressions.FalseExpression=function(params){this.init(params);}
SUGAR.util.extend(SUGAR.expressions.FalseExpression,SUGAR.expressions.BooleanExpression,{evaluate:function(){return SEE.FALSE;},getParamCount:function(){return 0;}});SUGAR.expressions.TrueExpression=function(params){this.init(params);}
SUGAR.util.extend(SUGAR.expressions.TrueExpression,SUGAR.expressions.BooleanExpression,{evaluate:function(){return SEE.TRUE;},getParamCount:function(){return 0;}});var SEP=SUGAR.expressions.ExpressionParser=function(){};SEP.prototype.getFieldsFromExpression=function(expression)
{var re=/[^$]*?\$(\w+)[^$]*?/g,matches=[],result;while(result=re.exec(expression))
{matches.push(result[result.length-1]);}
return matches;}
SEP.prototype._generateRange=function(prefix,start,end)
{var str="";var i=parseInt(start);if(typeof(end)=='undefined')
while(this.getElement(prefix+''+i)!=null)
str+='$'+prefix+''+(i++)+',';else
for(;i<=end;i++){var t=prefix+''+i;if(this.getElement(t)!=null)
str+='$'+t+',';}
return str.substring(0,str.length-1);}
SEP.prototype._valueReplace=function(val){if(!(/^\$.*$/).test(val))
{return val;}
return this.getValue(val.substring(1));}
SEP.prototype._performRangeReplace=function(expression)
{var isInQuotes=false;var prev;var inRange;for(var i=0;;i++){if(i==expression.length)break;var ch=expression.charAt(i);if(ch=='"'&&prev!='\\')isInQuotes=!isInQuotes;if(!isInQuotes&&ch=='%'){inRange=true;var loc_start=expression.indexOf('[',i+1);var loc_comma=expression.indexOf(',',loc_start);var loc_end=expression.indexOf(']',loc_start);if(loc_start<0||loc_end<0)throw("Invalid range syntax");var prefix=expression.substring(i+1,loc_start);var start,end;if(loc_comma>-1&&loc_comma<loc_end){start=expression.substring(loc_start+1,loc_comma);end=expression.substring(loc_comma+1,loc_end);}else{start=expression.substring(loc_start+1,loc_end);}
if(loc_comma>-1&&loc_comma<loc_end)end=expression.substring(loc_comma+1,loc_end);var result=this._generateRange(prefix,this._valueReplace(start),this._valueReplace(end));if(typeof(end)=='undefined')
expression=expression.replace('%'+prefix+'['+start+']',result);else
expression=expression.replace('%'+prefix+'['+start+','+end+']',result);i=i+result.length-1;}
prev=ch;}
return expression;}
SEP.prototype.validate=function(expr)
{if(typeof(expr)!='string')throw"ExpressionParser requires a string expression.";var fixed=this.toConstant(expr);if(fixed!=null&&typeof(fixed)!='undefined')
return true;if((/^[\w\-]+\(.*\)$/).exec(expr)==null){throw("Syntax Error (Expression Format Incorrect '"+expr+"' )");}
if(expr.indexOf('(')<0)
throw("Syntax Error (No opening paranthesis found)");return true;}
SEP.prototype.tokenize=function(expr)
{var fixed=this.toConstant(expr);if(fixed!=null&&typeof(fixed)!='undefined')
{return{type:"constant",returnType:this.getType(fixed),value:fixed.evaluate()}}
if(/^[$]\w+$/.test(expr))
{return{type:"variable",name:$.trim(expr).substr(1)}}
if(/^[$]\w+\.\w+$/.test(expr))
{expr=$.trim(expr);return{type:"variable",name:expr.substr(1,expr.indexOf('.')-1),relate:expr.substr(expr.indexOf('.')+1)}}
var open_paren_loc=expr.indexOf('(');if(open_paren_loc<1)
throw(expr+": Syntax Error, no open parentheses found");if(expr.charAt(expr.length-1)!=')')
throw(expr+": Syntax Error, no close parentheses found");var func=expr.substring(0,open_paren_loc);var params=expr.substring(open_paren_loc+1,expr.length-1);var level=0;var length=params.length;var argument="";var args=new Array();var currChar=null;var lastCharRead=null;var justReadString=false;var justReadComma=false;var isInQuotes=false;var isPrevCharBK=false;for(var i=0;i<=length;i++){lastCharRead=currChar;justReadComma=false;if(i==length){argument=$.trim(argument);if(argument!="")
args[args.length]=this.tokenize(argument);break;}
isPrevCharBK=(lastCharRead=='\\');currChar=params.charAt(i);if(isInQuotes&&currChar!='"'&&!isPrevCharBK){argument+=currChar;continue;}
if(currChar=='"'&&!isPrevCharBK&&level==0)
{if(isInQuotes){var end_reg=params.indexOf(",",i);if(end_reg<0)end_reg=params.length-1;var start_reg=(i<length-1?i+1:length-1);var temp=params.substring(start_reg,end_reg);if((/^\s*$/).exec(temp)==null)
throw(func+": Syntax Error (Improperly Terminated String '"+temp+"')"+(start_reg)+" "+end_reg);}
isInQuotes=!isInQuotes;}
if(currChar=='('){level++;}else if(currChar==')'){level--;}
else if(currChar==','&&level==0){argument=$.trim(argument);if(argument=="")
throw("Syntax Error: Unexpected ','");args[args.length]=this.tokenize(argument);argument="";justReadComma=true;continue;}
argument+=currChar;}
if(isInQuotes)throw("Syntax Error (Unterminated String Literal)");if(level!=0)throw("Syntax Error (Incorrectly Matched Parantheses)");if(justReadComma)throw("Syntax Error (No parameter after comma near <b>"+func+"</b>)");return{type:"function",name:$.trim(func),args:args}}
SEP.prototype.getType=function(variable){for(var type in SEE.TYPE_MAP)
{if(variable instanceof SEE.TYPE_MAP[type])
{return type;}}
return false;};SEP.prototype.evaluate=function(expr,context)
{if(typeof(expr)!='string')throw"ExpressionParser requires a string expression.";expr=expr.replace(/^\s+|\s+$|\n/g,"");var fixed=this.toConstant(expr);if(fixed!=null&&typeof(fixed)!='undefined')
return fixed;if(expr.match(/^\$\w+$/))
{if(typeof(context)=="undefined")
throw("Syntax Error: variable "+expr+" without context");return context.getValue(expr.substring(1));}
if(expr.match(/^\$\w+\.\w+$/))
{return context.getRelatedValue(expr.substr(1,expr.indexOf('.')-1),expr.substr(expr.indexOf('.')+1));}
if((/^[\w\-]+\(.*\)$/).exec(expr)==null){throw("Syntax Error (Expression Format Incorrect '"+expr+"' )");}
var open_paren_loc=expr.indexOf('(');if(open_paren_loc<0)
throw("Syntax Error (No opening paranthesis found)");var func=expr.substring(0,open_paren_loc);if(SUGAR.FunctionMap[func]==null)
throw(func+": No such function defined");var params=expr.substring(open_paren_loc+1,expr.length-1);var level=0;var length=params.length;var argument="";var args=new Array();var currChar=null;var lastCharRead=null;var justReadString=false;var isInQuotes=false;var isPrevCharBK=false;var isInVar=false;if(length>0){for(var i=0;i<=length;i++){lastCharRead=currChar;if(i==length){args[args.length]=this.evaluate(argument,context);break;}
isPrevCharBK=(lastCharRead=='\\');currChar=params.charAt(i);if(isInQuotes&&currChar!='"'&&!isPrevCharBK){argument+=currChar;continue;}
if(isInVar&&(currChar==" "||currChar==","))
isInVar=false;if(currChar=='"'&&!isPrevCharBK&&level==0)
{if(isInQuotes){var end_reg=params.indexOf(",",i);if(end_reg<0)end_reg=params.length-1;var start_reg=(i<length-1?i+1:length-1);var temp=params.substring(start_reg,end_reg);if((/^\s*$/).exec(temp)==null)
throw(func+": Syntax Error (Improperly Terminated String '"+temp+"')"+(start_reg)+" "+end_reg);}
isInQuotes=!isInQuotes;}
if(currChar=='$'&&!isPrevCharBK&&!isInQuotes&&level==0)
{if(isInVar)
throw(func+": Syntax Error (unexpeted '$' in  '"+argument+"')");else{isInVar=true;}}
if(currChar=='('){level++;}else if(currChar==')'){level--;}
else if(currChar==','&&level==0){args[args.length]=this.evaluate(argument,context);argument="";continue;}
argument+=currChar;}}
if(isInQuotes)throw("Syntax Error (Unterminated String Literal)");if(level!=0)throw("Syntax Error (Incorrectly Matched Parantheses)");return new SUGAR.FunctionMap[func](args,context);}
SEP.prototype.toConstant=function(expr){if(isFinite(expr)&&!isNaN(parseFloat(expr))){return new SUGAR.expressions.ConstantExpression(parseFloat(expr));}
var fixed=SUGAR.expressions.NumericConstants[expr];if(fixed!=null&&typeof(fixed)!='undefined')
return new SUGAR.expressions.ConstantExpression(parseFloat(fixed));if((/^"[\s\S]*"$/).exec(expr)!=null){expr=expr.substring(1,expr.length-1);return new SUGAR.expressions.StringLiteralExpression(expr);}
if(expr=='')
{return new SUGAR.expressions.StringLiteralExpression(expr);}
if(expr=="true"){return new SUGAR.expressions.TrueExpression();}else if(expr=="false"){return new SUGAR.expressions.FalseExpression();}
if((/^(0[0-9]|1[0-2])\/([0-2][0-9]|3[0-1])\/[0-3][0-9]{3,3}$/).exec(expr)!=null){var day=parseFloat(expr.substring(0,2));var month=parseFloat(expr.substring(3,2));var year=parseFloat(expr.substring(6,4));return new SUGAR.DateExpression([day,month,year]);}
if((/^([0-1][0-9]|2[0-4]):[0-5][0-9]:[0-5][0-9]$/).exec(expr)!=null){var hour=parseFloat(expr.substring(0,2));var minute=parseFloat(expr.substring(3,2));var second=parseFloat(expr.substring(6,2));return new SUGAR.TimeExpression([hour,minute,second]);}
return null;};SEP.prototype.getRelatedFieldsFromFormula=function(expr){var fields=[],relateFunctions=["related","count","rollupSum","rollupMax",'rollupMin',"rollupAve","rollupCurrencySum"];var recurseTokens=function(t){if(t.type=="variable"&&t.relate){fields.push({type:"related",link:t.name,relate:t.relate});}else if(t.type=="function"&&relateFunctions.indexOf(t.name)!=-1)
{switch(t.name){case"related":if(t.args[1].type=="constant")
fields.push({type:"related",link:t.args[0].name,relate:t.args[1].value});break;case"count":fields.push({type:"count",link:t.args[0].name});break;default:if(t.args[1].type=="constant")
{fields.push({type:t.name,link:t.args[0].name,relate:t.args[1].value});}}}else if(t.type=="function"){for(var i=0;i<t.args.length;i++){recurseTokens(t.args[i]);}}}
try{var t=this.tokenize(expr);recurseTokens(t);}
catch(e){}
return fields;}
var SEC=SUGAR.expressions.ExpressionContext=function()
{}
SEC.prototype.getValue=function(varname)
{return"";}
SEC.prototype.setValue=function(varname,value)
{return"";}
SEC.prototype.addListener=function(varname,callback,scope)
{return"";}
SEC.prototype.getRelatedValue=function(linkField,relField)
{return new SUGAR.RelatedFieldExpression([new SUGAR.expressions.StringLiteralExpression(linkField),new SUGAR.expressions.StringLiteralExpression(relField)]);}
SUGAR.expressions.isNumeric=function(str){if(typeof(str)!='number'&&typeof(str)!='string'){return false;}
str=SUGAR.expressions.unFormatNumber(str);return(isFinite(str)&&!isNaN(parseFloat(str)));};SUGAR.expressions.unFormatNumber=function(num){if(typeof num=='string')
{var SE=SUGAR.expressions;var ts=",",ds=".";if(SE.userPrefs){ts=SE.userPrefs.num_grp_sep;ds=SE.userPrefs.dec_sep;};num=SE.replaceAll(num,ts,"");num=SE.replaceAll(num,ds,".");}
return num;};SUGAR.expressions.replaceAll=function(haystack,needle,rpl){if(needle==rpl||haystack==""||needle=="")return haystack;var str=haystack;while(str.indexOf(needle)>-1){str=str.replace(needle,rpl);}
return str;};SUGAR.util.DateUtils={parse:function(date,oldFormat){if(date instanceof Date)
return date;if(oldFormat=="user")
{if(SUGAR.expressions.userPrefs&&SUGAR.expressions.userPrefs.datef){oldFormat=SUGAR.expressions.userPrefs.datef+" "+SUGAR.expressions.userPrefs.timef;}else{oldFormat=SUGAR.util.DateUtils.guessFormat(date);}}
if(oldFormat==null||oldFormat==""){oldFormat=SUGAR.util.DateUtils.guessFormat(date);}
if(oldFormat==false){if(/^\d+$/.test(date))
return new Date(date);return false;}
var jsDate=new Date("Jan 1, 1970 00:00:00");var part="";var dateRemain=$.trim(date);oldFormat=$.trim(oldFormat)+" ";for(var j=0;j<oldFormat.length;j++){var c=oldFormat.charAt(j);if(c==':'||c=='/'||c=='-'||c=='.'||c==" "||c=='a'||c=="A"||c=="T"){var i=dateRemain.indexOf(c);if(i==-1)i=dateRemain.length;var v=dateRemain.substring(0,i);dateRemain=dateRemain.substring(i+1);switch(part){case'm':if(!(v>0&&v<13))return false;jsDate.setMonth(v-1);break;case'd':if(!(v>0&&v<32))return false;jsDate.setDate(v);break;case'Y':if(!(v>0))return false;jsDate.setYear(v);break;case'h':var timeformat=oldFormat.substring(oldFormat.length-4);if(timeformat.toLowerCase()=="i a "||timeformat.toLowerCase()==c+"ia "){if(dateRemain.substring(dateRemain.length-2).toLowerCase()=='pm'){v=v*1;if(v<12){v+=12;}}}
case'H':jsDate.setHours(v);break;case'i':v=v.substring(0,2);jsDate.setMinutes(v);break;}
part="";}else{part=c;}}
return jsDate;},guessFormat:function(date){if(typeof date!="string")
return false;var time="";var dateTimeSep;if(date.indexOf(" ")!=-1){dateTimeSep=" ";}else if(date.indexOf("T")!=-1){dateTimeSep="T";}
if(dateTimeSep){time=date.substring(date.indexOf(dateTimeSep)+1,date.length);date=date.substring(0,date.indexOf(dateTimeSep));}
var dateSep="/";if(date.indexOf("/")!=-1){}
else if(date.indexOf("-")!=-1)
{dateSep="-";}
else if(date.indexOf(".")!=-1)
{dateSep=".";}
else
{return false;}
var dateParts=date.split(dateSep);var dateFormat="";var jsDate=new Date("Jan 1, 1970 00:00:00");if(dateParts[0].length==4)
{dateFormat="Y"+dateSep+"m"+dateSep+"d";}
else if(dateParts[2].length==4)
{dateFormat="m"+dateSep+"d"+dateSep+"Y";}
else
{return false;}
if(time!="")
{var timeFormat="";var timeSep=":";if(time.indexOf(".")==2){timeSep=".";}
if(time.indexOf(" ")!=-1){var timeParts=time.split(" ");if(timeParts[1]=="am"||timeParts[1]=="pm"){return dateFormat+dateTimeSep+"h"+timeSep+"i a";}else if(timeParts[1]=="AM"||timeParts[1]=="PM"){return dateFormat+dateTimeSep+"h"+timeSep+"i A";}}
else
{var timeEnd=time.substring(time.length-2,time.length);if(timeEnd=="AM"||timeEnd=="PM"){return dateFormat+dateTimeSep+"h"+timeSep+"iA";}
if(timeEnd=="am"||timeEnd=="pm"){return dateFormat+dateTimeSep+"h"+timeSep+"iA";}
return dateFormat+dateTimeSep+"H"+timeSep+"i";}}
return dateFormat;},formatDate:function(date,useTime,format)
{if(!format&&SUGAR.expressions.userPrefs.datef&&SUGAR.expressions.userPrefs.timef){if(useTime)
format=SUGAR.expressions.userPrefs.datef+" "+SUGAR.expressions.userPrefs.timef;else
format=SUGAR.expressions.userPrefs.datef;}
var out="";for(var i=0;i<format.length;i++){var c=format.charAt(i);switch(c){case'm':var m=date.getMonth()+1;out+=m<10?"0"+m:m;break;case'd':var d=date.getDate();out+=d<10?"0"+d:d;break;case'Y':out+=date.getFullYear();break;case'H':case'h':var h=date.getHours();if(c=="h")h=h>12?h-12:h;out+=h<10?"0"+h:h;break;case'i':var m=date.getMinutes();out+=m<10?"0"+m:m;break;case'a':if(date.getHours()<12)
out+="am";else
out+="pm";break;case'A':if(date.getHours()<12)
out+="AM";else
out+="PM";break;default:out+=c;}}
return out;},roundTime:function(date)
{var min=date.getMinutes();if(min<1){min=0;}
else if(min<16){min=15;}
else if(min<31){min=30;}
else if(min<46){min=45;}
else{min=0;date.setHours(date.getHours()+1)}
date.setMinutes(min);return date;},getUserTime:function()
{var date=new Date();if(SUGAR.expressions.userPrefs&&typeof(SUGAR.expressions.userPrefs.gmt_offset)!='undefined')
{var offset=SUGAR.expressions.userPrefs.gmt_offset;date.setMinutes(date.getMinutes()+(date.getTimezoneOffset()+offset));}
return date;}};})();
/* End of File sidecar/lib/sugarlogic/expressions.js */


(function(){SUGAR.forms=SUGAR.forms||{};SUGAR.forms.animation=SUGAR.forms.animation||{};var SE=SUGAR.expressions,SEC=SE.SidecarExpressionContext=function(view){this.view=view;this.model=view.model||view.context.get("model");};SUGAR.util.extend(SEC,SE.ExpressionContext,{getValue:function(varname)
{var value=this.model.get(varname),def=this.model.fields[varname],result;if(def.type=="link")
value=varname;if(typeof(value)=="string")
{value=value.replace(/\n/g,"");if((/^(\s*)$/).exec(value)!=null||value==="")
{result=SEC.parser.toConstant('""');}
else if(def.type!=='currency'&&SE.isNumeric(value)){result=SEC.parser.toConstant(SE.unFormatNumber(value));}
else{result=SEC.parser.toConstant('"'+value+'"');}}else if(typeof(value)=="object"&&value!=null&&value.getTime){var d=new SE.DateExpression("");d.evaluate=function(){return this.value};d.value=value;result=d;}else if(typeof(value)=="number"){result=SEC.parser.toConstant(""+value);}else if(_.isBoolean(value)){result=value?new SUGAR.expressions.TrueExpression():new SUGAR.expressions.FalseExpression();}else{result=SEC.parser.toConstant('""');}
return result;},setValue:function(varname,value)
{if(typeof(this.model.fields[varname])!='object'){return;}
var targetDef=this.model.fields[varname];this.lockedFields=this.lockedFields||[];if(typeof(value)=='object'&&value.length>0&&targetDef.type!='multienum'){value=value.join(', ');}else if(value&&targetDef.type==='date'){value=App.date(value).formatServer(true);}else if(value&&targetDef.type==='datetimecombo'){value=App.date(value).format();}
if(targetDef.type=='bool'&&_.isString(value)){value=SUGAR.expressions.Expression.isTruthy(value);}
if(value&&(targetDef.type==='decimal'||targetDef.type==='float')){value=App.utils.formatNumber(value,targetDef.round||6,targetDef.precision||6,',','.');}
if(!this.lockedFields[varname])
{this.lockedFields[varname]=true;var el=this.getElement(varname);if(el){SUGAR.forms.FlashField($(el).parents('[data-fieldname="'+varname+'"]'),null,varname);}
var ret=this.model.set(varname,value);this.lockedFields=[];return ret;}},addListener:function(varname,callback,scope)
{if(this.view.collection){this.view.collection.off("change:"+varname,callback,scope);this.view.collection.on("change:"+varname,callback,scope);}else{this.model.off("change:"+varname,callback,scope);this.model.on("change:"+varname,callback,scope);}},getElement:function(varname){var field=this.getField(varname);if(field&&field.el)
return field.el;},getField:function(varname){return this.view.getField(varname,this.model);},addClass:function(varname,css_class,includeLabel){var def=this.view.getFieldMeta(varname),props=includeLabel?["css_class","cell_css"]:["css_class"],el=this.getElement(varname),parent=$(el).closest('div.record-cell');_.each(props,function(prop){if(!def[prop]){def[prop]=css_class;}else if(def[prop].indexOf(css_class)==-1){def[prop]+=" "+css_class;}});this.view.setFieldMeta(varname,def);$(el).addClass(css_class);if(includeLabel&&parent){parent.addClass(css_class);}},removeClass:function(varname,css_class,includeLabel){var def=this.view.getFieldMeta(varname),field=this.view.getField(varname),props=includeLabel?["css_class","cell_css"]:["css_class"],el=this.getElement(varname),parent=$(el).closest('div.record-cell');_.each([field.def,def],function(d){_.each(props,function(prop){if(d[prop]&&d[prop].indexOf(css_class)!=-1){d[prop]=$.trim((" "+d[prop]+" ").replace(new RegExp(' '+css_class+' '),""));}});});this.view.setFieldMeta(varname,def);$(el).removeClass(css_class);if(includeLabel&&parent){parent.removeClass(css_class);parent.find("."+css_class).removeClass(css_class);}},getLink:function(variable){var model=this.model;if(model&&model.fields&&model.fields[variable])
return model.fields[variable];},showError:function(variable,error)
{},clearError:function(variable)
{},setStyle:function(variable,styles)
{},setRelatedFields:function(fields,silent){silent=!!silent;var model=this.model;for(var link in fields)
{var currValue=model.get(link),forceChangeEvent=!!currValue,value=currValue||{};_.each(fields[link],function(values,type){if(_.isObject(values)){value[type]=_.extend(value[type]||{},values);}else{value[type]=values;}});var toSet={};toSet[link]=value;model.set(toSet,{silent:silent});if(!silent&&forceChangeEvent){model.trigger("change:"+link,model);}}},getRelatedFieldValues:function(fields,module,record,silent)
{var self=this,api=App.api;if(fields.length>0){module=module||this.view.context.get("module");record=record||this.model.get("id");for(var i=0;i<fields.length;i++){var link=fields[i].link,toSet={};if(fields[i].type=="related"){var linkDef=this.model.fields[link];if(linkDef&&linkDef.id_name&&linkDef.module){var relId=this.model.get(linkDef.id_name);if(relId){fields[i].relId=relId
fields[i].relModule=linkDef.module;}}}
if(fields[i].relate){toSet[link]={};toSet[link][fields[i].type]={};toSet[link][fields[i].type][fields[i].relate]="";self.setRelatedFields(toSet,true);}}
var data={id:record,action:"related"},params={module:module,fields:JSON.stringify(fields)};api.call("read",api.buildURL("ExpressionEngine","related",data,params),data,params,{success:function(resp){self.setRelatedFields(resp,silent);return resp;}});}
return null;},getRelatedField:function(link,ftype,field){var linkValues=this.model.get(link)||{};if(ftype=="related"&&!this.inCollection){return this._handleRelateExpression(link,field);}
if(typeof(linkValues[ftype])!="undefined"){if(!field){return linkValues[ftype];}else if(typeof(linkValues[ftype][field])!="undefined"){return linkValues[ftype][field];}}
if(this.inCollection){linkValues[ftype]=linkValues[ftype]||{};linkValues[ftype][field]=linkValues[ftype][field]||"";this.model.set(link,linkValues,{silent:true});return"";}
if(!this.model.get("id")){return"";}
var params={link:link,type:ftype};if(field){params.relate=field;}
this.getRelatedFieldValues([params]);if(typeof(linkValues[ftype])=="undefined")
return"";return linkValues[ftype];},_handleRelateExpression:function(link,field){this.view.context.set("model",this.model);var relContext=this.view.context.getChildContext({link:link});relContext.prepare();var col=relContext.get("collection"),fields=relContext.get('fields')||[],self=this,rField=_.find(this.model.fields,function(def){return(def.type&&def.type=="relate"&&def.id_name&&def.link&&def.link==link)}),relModel=relContext.get("model");if(relContext.isDataFetched()&&!relContext.get("modelId")){relModel=col.length>0?col.models[0]:null;}
if(rField&&(!this.model.get(rField.id_name)||(relModel&&relModel.get("id")!=this.model.get(rField.id_name)))){relContext.set({model:null});relContext.resetLoadFlag();if(!this.model.get(rField.id_name))
return"";}
if(field&&(!relContext.isDataFetched()||(relModel&&_.isUndefined(relModel.get(field))))){if(!_.contains(fields,field)){fields.push(field);}
this._loadRelatedData(link,fields,relContext,rField);}
else if(relModel){return relModel.get(field);}else if(!col.page){var model=this.model;SUGAR.App.utils.doWhen(function(){return col.page>0},function(){model.trigger("change:"+link,model);});}
return"";},_loadRelatedData:function(link,fields,relContext,rField){var self=this;if(rField&&this.model.get(rField.id_name)){var modelId=this.model.get(rField.id_name),model=relContext.get("model")||SUGAR.App.data.createRelatedBean(this.model,this.model.get(rField.id_name),link);relContext.set({modelId:modelId,model:model});}else{if(_.isEmpty(this.model.get("id")))
return"";}
relContext.prepare();relContext.set({'fields':_.union(relContext.get("fields")||[],fields),skipFetch:false});if(relContext.isDataFetched()){relContext.resetLoadFlag();}
if(rField)relContext.attributes.link=null;var model=this.model;relContext.loadData({success:function(){model.trigger("change:"+link,model);}});if(rField)relContext.attributes.link=link;},_setupLinks:function(relatedFields){_.each(relatedFields,function(field){if(field.link&&field.relate&&field.type=="related"){var relContext=this.view.context.getChildContext({link:field.link});if(relContext){relContext.set("fields",_.union(relContext.get("fields")||[],[field.relate]));}}},this);},_requestRollups:function(relatedFields){if(this.model.get("id")){this.getRelatedFieldValues(relatedFields,null,null,true);}},fireOnLoad:function(dep){},getAppListStrings:function(list){return SUGAR.App.lang.getAppListStrings(list);},parseDate:function(date,type){return SUGAR.App.date.parse(date);},setFieldDisabled:function(target,disabled){disabled=(_.isUndefined(disabled))?true:disabled;var field=this.getField(target);if(field){field.setDisabled(disabled);if(disabled){this.view.$("span.record-edit-link-wrapper[data-name="+target+"]").hide();}else{this.view.$("span.record-edit-link-wrapper[data-name="+target+"]").show();}
if(_.isEqual(disabled,false)&&!_.isEqual(field.currentState,'edit')&&_.isEqual(this.view.currentState,'edit')&&!_.isEqual(this.view.inlineEditMode,true)){field.setMode('edit');this.view.editableFields.push(field);}
if(_.isFunction(this.view.setEditableFields)){this.view.setEditableFields();}}},setFieldRequired:function(target,required){required=SUGAR.expressions.Expression.isTruthy(required);var field=this.view.getField(target,this.model);if(field){field.def.required=required;field.render();}},setModel:function(model){this.model=model;},add:function(start,add){return SUGAR.App.math.add(start,add,6,true);},subtract:function(start,subtract){return SUGAR.App.math.sub(start,subtract,6,true);},multiply:function(start,multiply){return SUGAR.App.math.mul(start,multiply,6,true);},divide:function(start,divide){return SUGAR.App.math.div(start,divide,6,true);},round:function(start,precision){return SUGAR.App.math.round(start,precision,true);}});SEC.parser=new SUGAR.expressions.ExpressionParser();SEC.evalVariableExpression=function(expression,view)
{return SEC.parser.evaluate(expression,new SEC(view));}
SUGAR.forms.Dependency=function(trigger,actions,falseActions,testOnLoad,context)
{this.actions=actions;this.falseActions=falseActions;this.context=context;this.testOnLoad=testOnLoad;trigger.setContext(this.context);trigger.setDependency(this);this.trigger=trigger;if(testOnLoad){context.fireOnLoad(this);}}
SUGAR.forms.Dependency.fromMeta=function(meta,context){var condition=meta.trigger||"true",triggerFields=meta.triggerFields||SE.ExpressionParser.prototype.getFieldsFromExpression(condition),actions=meta.actions||[],falseActions=meta.notActions||[],onLoad=meta.onload||false,isNew=context.model&&_.isEmpty(context.model.get("id")),actionObjects=[],falseActionObjects=[];if(_.isEmpty(triggerFields)&&!onLoad&&!isNew)
return null;if(_.isEmpty(actions)&&_.isEmpty(falseActions))
return null;_.each(actions,function(actionDef){if(!actionDef.action||!SUGAR.forms[actionDef.action+'Action'])
return;var addAction=true;if(actionDef.action==='SetValue'&&actionDef.params.target){addAction=App.acl.hasAccess('edit',this.model.module,undefined,actionDef.params.target);}
if(addAction){actionObjects.push(new SUGAR.forms[actionDef.action+'Action'](actionDef.params));}},context);_.each(falseActions,function(actionDef){if(!actionDef.action||!SUGAR.forms[actionDef.action+'Action'])
return;var addAction=true;if(actionDef.action==='SetValue'&&actionDef.params.target){addAction=App.acl.hasAccess('edit',this.model.module,undefined,actionDef.params.target);}
if(addAction){falseActionObjects.push(new SUGAR.forms[actionDef.action+'Action'](actionDef.params));}},context);return new SUGAR.forms.Dependency(new SUGAR.forms.Trigger(triggerFields,condition,context),actionObjects,falseActionObjects,onLoad,context);}
SUGAR.forms.Dependency.prototype.fireLinkOnlyDependency=function()
{if(!this.testOnLoad){return false;}
var fire=true;if(this.context.model.fields){_.each(this.trigger.variables,function(field){fire=(fire&&this.context.model.fields[field]&&this.context.model.fields[field].type=="link");},this);}
return fire;}
SUGAR.forms.Dependency.prototype.fire=function(undo)
{if(this.context.view.disposed||!this.context.view.context){return;}
try{var model=this.context.model;this.lastTriggeredActions=this.lastTriggeredActions||[];if(model.inSync&&!this.testOnLoad){return;}
var actions=this.actions;if(undo&&this.falseActions!=null)
actions=this.falseActions;_.each(this.lastTriggeredActions,function(action){this.context.view.off(null,null,action);},this);if(actions instanceof SUGAR.forms.AbstractAction)
actions=[actions];for(var i in actions){var action=actions[i];if(typeof action.exec=="function"){action.setContext(this.context);action.exec();if(this.testOnLoad&&action.afterRender){this.context.view.on('render',action.exec,action);}}}
this.lastTriggeredActions=actions;}catch(e){if(!SUGAR.isIE&&console&&console.log){console.log('ERROR: '+e);}
return;}};SUGAR.forms.Dependency.prototype.getRelatedFields=function(){var parser=SEC.parser,fields=parser.getRelatedFieldsFromFormula(this.trigger.condition);var parse=function(actions){if(actions instanceof SUGAR.forms.AbstractAction){actions=[actions];}
for(var i in actions){var action=actions[i];if(typeof action.exec=="function"){for(var p in action){if(typeof action[p]=="string")
fields=$.merge(fields,parser.getRelatedFieldsFromFormula(action[p]));}}}}
parse(this.actions);parse(this.falseActions);return fields;}
SUGAR.forms.AbstractAction=function(target){this.target=target;};SUGAR.forms.AbstractAction.prototype.exec=function(){}
SUGAR.forms.AbstractAction.prototype.setContext=function(context){this.context=context;}
SUGAR.forms.AbstractAction.prototype.evalExpression=function(exp,context){context=context||this.context;return SEC.parser.evaluate(exp,context).evaluate();}
SUGAR.forms.Trigger=function(variables,condition,context){this.variables=variables;this.condition=condition;this.context=context;this.dependency={};this._attachListeners();}
SUGAR.forms.Trigger.prototype._attachListeners=function(){if(!(this.variables instanceof Array)){this.variables=[this.variables];}
for(var i=0;i<this.variables.length;i++){this.context.addListener(this.variables[i],SUGAR.forms.Trigger.fire,this,true);}}
SUGAR.forms.Trigger.prototype.setDependency=function(dep){this.dependency=dep;}
SUGAR.forms.Trigger.prototype.setContext=function(context){this.context=context;}
SUGAR.forms.Trigger.fire=function(model){var eval,val;if(model){this.context.setModel(model);}
try{eval=SEC.parser.evaluate(this.condition,this.context);}catch(e){if(!SUGAR.isIE&&console&&console.log){console.log('ERROR:'+e+"; in Condition: "+this.condition);}}
if(typeof(eval)!='undefined')
val=eval.evaluate();if(val==SUGAR.expressions.Expression.TRUE){if(this.dependency instanceof SUGAR.forms.Dependency){this.dependency.fire(false);return;}}else if(val==SUGAR.expressions.Expression.FALSE){if(this.dependency instanceof SUGAR.forms.Dependency){this.dependency.fire(true);return;}}}
SUGAR.forms.flashInProgress={};SUGAR.forms.FlashField=function(field,to_color,key){if(typeof(field)=='undefined'||(!key&&!field.id))
return;key=key||field.id;if(SUGAR.forms.flashInProgress[key])
return;SUGAR.forms.flashInProgress[key]=true;to_color=to_color||'#FF8F8F';var original=field.style&&field.style.backgroundColor?field.style.backgroundColor:'#FFFFFF';$(field).css("backgroundColor",original);$(field).animate({backgroundColor:to_color},200,function(){$(field).animate({backgroundColor:original},200,function(){delete SUGAR.forms.flashInProgress[key];});});};if(SUGAR.App&&SUGAR.App.plugins){SUGAR.App.plugins.register('SugarLogic','view',{onAttach:function(){this.on("init",function(){this.deps=[];var slContext=this.slContext=new SUGAR.expressions.SidecarExpressionContext(this),meta=_.extend({},this.meta,this.options.meta),relatedFields=[],updateCollection=function(collection,trigger){trigger.context.inCollection=true;collection.each(function(model){SUGAR.forms.Trigger.fire.apply(trigger,[model]);});trigger.context.inCollection=null;};_.each(meta.dependencies,function(dep){var newDep=SUGAR.forms.Dependency.fromMeta(dep,slContext);if(newDep){relatedFields=_.union(relatedFields,newDep.getRelatedFields());if(this.context.isCreate()||newDep.fireLinkOnlyDependency()){SUGAR.forms.Trigger.fire.apply(newDep.trigger);this.trigger('sugarlogic:initialize');}
if(newDep.testOnLoad){this.context.on("list:editrow:fire",SUGAR.forms.Trigger.fire,newDep.trigger);if(this.collection){this.collection.on("sync",function(synced){if(synced instanceof Backbone.Collection){_.defer(updateCollection,synced,newDep.trigger);}else{SUGAR.forms.Trigger.fire.apply(newDep.trigger,[synced]);}},this);}}
this.deps.push(newDep);}},this);slContext._setupLinks(relatedFields);slContext._requestRollups(relatedFields);});this.on('render',function(){_.each(this.deps,function(dep){if(this.context.isCreate()||dep.fireLinkOnlyDependency()){SUGAR.forms.Trigger.fire.apply(dep.trigger);this.trigger('sugarlogic:initialize');}},this);});},getFieldNames:function(){var getFields=SE.ExpressionParser.prototype.getFieldsFromExpression,fields=Object.getPrototypeOf(this).getFieldNames.apply(this,arguments),meta=_.extend({},this.meta,this.options.meta);_.each(meta.dependencies,function(dep){if(dep.trigger){fields=_.union(fields,getFields(dep.trigger));}
_.each(dep.actions,function(action){if(action.params){_.each(action.params,function(param){if(_.isString(param)){fields=_.union(fields,getFields(param));}});}});});if(this.model){fields=_.filter(fields,function(field){return this.model.fields[field]&&this.model.fields[field].type!="link";},this);}
return fields;}});}else if(console.error){console.error("unable to find the plugin manager");}})();
/* End of File sidecar/lib/sugarlogic/sidecarExpressionContext.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('FieldErrorCollection',['view'],{_errorCollection:undefined,onAttach:function(component,plugin){this._errorCollection=new Backbone.Collection();this.once('init',function(){this.context.on('field:error',this.handleErrorEvent,this);},this);},onDetach:function(component,plugin){this.context.off('field:error',null,this);},handleErrorEvent:function(field,addError){addError=_.isUndefined(addError)?true:addError;if(addError){this._errorCollection.add(field.model);}else{this._errorCollection.remove(field.model);}
this.context.trigger('plugin:fieldErrorCollection:hasFieldErrors',this._errorCollection,this.hasFieldErrors());},hasFieldErrors:function(){return(this._errorCollection.length>0);}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/FieldErrorCollection.js */


(function(app){app.events.on("app:init",function(){var sync=function(method,model,options){options=app.data.parseOptionsForSync(method,model,options);var callbacks=app.data.getSyncCallbacks(method,model,options),path=(this.dashboardModule==='Home'||model.id)?this.apiModule:this.apiModule+'/'+this.dashboardModule;app.api.records(method,path,model.attributes,options.params,callbacks);},Dashlet=app.Bean.extend({sync:sync,apiModule:'Dashboards',module:'Home'});app.plugins.register('Dashlet','view',{rowHeight:42,maxHeightTarget:'',onAttach:function(){this.on("init",function(){this.dashletConfig=app.metadata.getView(this.module,this.name);this.dashModel=this.layout.context.get("model");var settings=_.extend({},this.meta),viewName='main',buildGrid=false;delete settings.panels;delete settings.action;delete settings.dependencies;this.settings=new Dashlet(settings);if(settings.module){this.model=this.context.parent.get("model");}
if(this.meta&&this.meta.config){viewName='config';this.createMode=true;this.action='edit';this.model=this.context.parent.get("model");this.dashModel.set(settings);this.dashModel.set("componentType",(this instanceof app.view.Layout)?"layout":"view");this.settings.on("change",function(model){this.dashModel.set(model.changed);},this);this.model.isNotEmpty=true;this.meta.panels=this.dashletConfig.panels;var templateName=this.name+'.dashlet-config';this.template=app.template.getView(templateName,this.module)||app.template.getView(templateName);if(!this.template){this.template=app.template.getView('dashletconfiguration-edit')||app.template.empty;var originalPlugins=this.plugins;this.plugins=['GridBuilder'];app.plugins.attach(this,'view');this.plugins=_.union(this.plugins,originalPlugins);buildGrid=true;}}else if(this.meta&&this.meta.preview){viewName='preview';this.settings.module=this.module;var templateName=this.name+'.dashlet-preview';this.template=app.template.getView(templateName,this.module)||app.template.getView(templateName)||this.template;}else{this.settings.module=this.module;}
if(this.initDashlet&&_.isFunction(this.initDashlet)){this.initDashlet(viewName);var height=this.calculateMaxHeight();if(_.isNumber(height)){var $target=this.$(this.maxHeightTarget||this.$el);$target.css('max-height',height+'px');}}
if(buildGrid){this._buildGridsFromPanelsMetadata();}});this.once('render',function(){app.analytics.trackPageView('/dashlet/'+this.name);});},_buildGridsFromPanelsMetadata:function(){_.each(this.meta.panels,function(panel){_.each(panel.fields,function(field,index){if(_.isString(field)){panel.fields[index]=field={name:field};}},this);if(_.isUndefined(panel.labels)){panel.labels=true;}
if(_.isFunction(this.getGridBuilder)){var options={fields:panel.fields,columns:panel.columns,labels:panel.labels,labelsOnTop:panel.labelsOnTop,tabIndex:0},gridResults=this.getGridBuilder(options).build();panel.grid=gridResults.grid;}},this);},calculateMaxHeight:function(){if(!this.triggerBefore('calculateMaxHeight')){return false;}
if(!this.meta.config&&this.settings.has('limit')){return this.settings.get('limit')*this.rowHeight;}},onDetach:function(){this.settings.off();delete this.dashletConfig;delete this.dashModel;}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/Dashlet.js */


(function(app){app.events.on("app:init",function(){var hashKey=null;var pinged=false;app.plugins.register('Connector',['view'],{checkConnector:function(name,successCall,errorCall,connectorCriteria){var connectors,connector=null;var successCallWrapper=_.bind(function(){this.checkConnector(name,successCall,errorCall,connectorCriteria);},this);if(hashKey===null){pinged=true;this.getConnectors(name,successCallWrapper);}
else{connectors=app.cache.get(hashKey);if(connectors&&connectors[name]){connector=connectors[name];}
if((connector)&&(this.checkCriteria(connector,connectorCriteria))){connector.connectorHash=hashKey;successCall(connector);}
else{if(pinged===false){pinged=true;this.getConnectors(name,successCallWrapper);}
else{pinged=false;errorCall(connector);}}}},checkCriteria:function(connector,criteria){var check=true;_.each(criteria,function(criterion){if(criterion==='test_passed'){if(connector.testing_enabled){check=check&&connector.test_passed;}}
else{check=check&&connector[criterion];}
if(!check){return check;}});return check;},getConnectorModuleFieldMapping:function(connector,module){var connectors=app.cache.get(hashKey);var mappings={};if(connectors[connector]&&connectors[connector].field_mapping&&connectors[connector].field_mapping.beans&&connectors[connector].field_mapping.beans[module]){mappings=connectors[connector].field_mapping.beans[module];}
return mappings;},getConnectors:function(name,successCall){var connectorURL=app.api.buildURL('connectors');app.api.call('GET',connectorURL,{},{success:function(data){hashKey=data['_hash'];app.cache.set(hashKey,data['connectors']);successCall();}});}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/Connector.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('Tooltip',['layout','view','field'],{_$pluginTooltips:null,_pluginTooltipCssSelector:'[rel=tooltip]',onAttach:function(){if(app.utils.isTouchDevice()){return;}
if((this instanceof app.view.View)||(this instanceof app.view.Field)){this.before('render',function(){this.destroyAllPluginTooltips();},this);this.on('render',function(){this.initializeAllPluginTooltips();},this);this.on('dismiss',this.removePluginTooltips,this);}else if(this instanceof app.view.Layout){this.on('init',function(){this.initializeAllPluginTooltips();},this);}},onDetach:function(){this.destroyAllPluginTooltips();},initializeAllPluginTooltips:function(){this.removePluginTooltips();this.addPluginTooltips();},destroyAllPluginTooltips:function(){this.removePluginTooltips();this._$pluginTooltips=null;},addPluginTooltips:function($element){var $tooltips=this._getPluginTooltips($element);if($tooltips.length>0){this._$pluginTooltips=(this._$pluginTooltips||$()).add(app.utils.tooltip.initialize($tooltips));$tooltips.on('click.tooltip',function(){var element=this,tooltip=app.utils.tooltip.get(element);if(tooltip&&tooltip.options&&tooltip.options.trigger.indexOf('click')===-1){_.defer(function(){app.utils.tooltip.hide(element);});}});app.accessibility.run($tooltips,'click');}},removePluginTooltips:function($element){var $tooltips;if($element){$tooltips=this._getPluginTooltips($element);}else{$tooltips=this._$pluginTooltips;}
if($tooltips&&$tooltips.length>0){app.utils.tooltip.destroy($tooltips);}},_getPluginTooltips:function($element){var selector=this.pluginTooltipCssSelector||this._pluginTooltipCssSelector;return $element?$element.find(selector):this.$(selector);}});});})(SUGAR.App);(function($){$(function(){if(!Modernizr.touch){return;}
$.fn.tooltip=function(){return this;};});})(jQuery);
/* End of File include/javascript/sugar7/plugins/Tooltip.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('Audit',['view'],{onAttach:function(component,plugin){this.on('init',function(){this.context.on('button:audit_button:click',this.auditClicked,this);});},auditClicked:function(){var context=this.context.getChildContext({module:'Audit'});app.drawer.open({layout:'audit',context:context});},onDetach:function(component,plugin){this.context.off('button:audit_button:click',this.auditClicked,this);}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/Audit.js */


(function(app){app.events.on('app:init',function(){var createDuplicateCollection=function(dupeCheckModel,module){var collection=app.data.createBeanCollection(module||this.module),collectionSync=collection.sync;_.extend(collection,{dupeCheckModel:dupeCheckModel,sync:function(method,model,options){options=options||{};if(_.isEmpty(model.filterDef)){options.endpoint=_.bind(this.endpoint,this);}
collectionSync(method,model,options);},endpoint:function(method,model,options,callbacks){var url=app.api.buildURL(this.module,'duplicateCheck');var data=app.data.getEditableFields(this.dupeCheckModel);return app.api.call('create',url,data,callbacks);}});return collection;};app.plugins.register('FindDuplicates',['view'],{onAttach:function(component,plugin){this.on('init',function(){this.context.on('button:find_duplicates_button:click',this.findDuplicatesClicked,this);});},findDuplicatesClicked:function(){this.findDuplicates(this.model);},findDuplicates:function(dupeCheckModel){app.drawer.open({layout:'find-duplicates',context:{layoutName:'records',dupelisttype:'dupecheck-list-multiselect',collection:this.createDuplicateCollection(dupeCheckModel),model:app.data.createBean(this.module)}},_.bind(function(refresh,primaryRecord){if(refresh&&dupeCheckModel.id===primaryRecord.id){app.router.refresh();}else if(refresh){app.navigate(this.context,primaryRecord);}},this));},createDuplicateCollection:createDuplicateCollection,onDetach:function(component,plugin){this.context.off('button:find_duplicates_button:click',this.findDuplicatesClicked,this);}});app.plugins.register('FindDuplicates',['layout'],{createDuplicateCollection:createDuplicateCollection});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/FindDuplicates.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('MergeDuplicates',['view'],{_minRecordsToMerge:2,_maxRecordsToMerge:5,mergeDuplicates:function(mergeCollection,primaryRecord){if(_.isEmpty(mergeCollection)){return;}
if(!_.isEmpty(primaryRecord)){mergeCollection.add(primaryRecord,{at:0,silent:true});}
var models=this._validateModelsForMerge(mergeCollection.models);if(!this.triggerBefore('mergeduplicates',models)){return;}
if(this._validateAcl(models,mergeCollection)===false){this._showAclAlert(models,mergeCollection,primaryRecord);return;}
if(this._validateIsAnyEditable(models)===false){this._showNoEditAlert();return;}
if(this._validateSize(models)===false){this._showSizeAlert();return;}
this._openMergeDrawer(models,mergeCollection,primaryRecord);},_validateAcl:function(models,collection){return models.length===collection.models.length;},_showAclAlert:function(models,collection,primary){var self=this;app.alert.show('invalid-record-access',{level:'confirmation',messages:app.lang.get('LBL_MERGE_NO_ACCESS_TO_A_FEW_RECORDS',this.module),onConfirm:function(){if(self._validateIsAnyEditable(models)===false){self._showNoEditAlert();return;}
if(self._validateSize(models)===false){self._showSizeAlert();return;}
self._openMergeDrawer(models,collection,primary);}});},_validateIsAnyEditable:function(models){return _.some(models,function(model){return app.acl.hasAccessToModel('edit',model);});},_showNoEditAlert:function(){var msg=app.lang.get('LBL_MERGE_NO_ACCESS',this.module);app.alert.show('no-record-to-edit',{level:'error',messages:msg});},_validateSize:function(models){var isValidSize=models.length&&models.length>=this._minRecordsToMerge&&models.length<=this._maxRecordsToMerge;return isValidSize;},_showSizeAlert:function(){var msg=app.lang.get('TPL_MERGE_INVALID_NUMBER_RECORDS',this.module,{minRecords:this._minRecordsToMerge,maxRecords:this._maxRecordsToMerge});app.alert.show('invalid-record-count',{level:'error',messages:msg});},_openMergeDrawer:function(models,collection,primary){var primaryId=(primary&&primary.id)||null;app.drawer.open({layout:'merge-duplicates',context:{primary:primary||null,selectedDuplicates:models}},_.bind(function(refresh,primary){if(refresh){this.trigger('mergeduplicates:complete',primary);collection.reset();}else{collection.remove(primaryId);}},this));},_validateModelsForMerge:function(models){return _.filter(models,function(model){return _.every(['view','delete'],function(acl){return app.acl.hasAccessToModel(acl,model);});},this);}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/MergeDuplicates.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('DragdropAttachments',['view'],{events:{'dragenter .attachable':'expandNewPost','dragover .attachable':'dragoverNewPost','dragleave .attachable':'shrinkNewPost','drop .attachable':'dropAttachment'},expandNewPost:function(event){this.$(event.currentTarget).addClass('dragdrop');return false;},dragoverNewPost:function(event){return false;},shrinkNewPost:function(event){event.stopPropagation();event.preventDefault();this.$(event.currentTarget).removeClass('dragdrop');return false;},dropAttachment:function(event){var text=$.trim(event.originalEvent.dataTransfer.getData('text')),container=this.$(event.currentTarget);this.shrinkNewPost(event);if(text.length){container.append(' '+text).trigger('change');}
_.each(event.originalEvent.dataTransfer.files,function(file,i){var fileReader=new FileReader();fileReader.onload=(function(file,view){return function(e){var container,sizes=['B','KB','MB','GB'],size_index=0,size=file.size,unique=_.uniqueId('activitystream_attachment');while(size>1024&&size_index<sizes.length-1){size_index++;size /=1024;}
size=Math.round(size);view.dragdrop_attachments=view.dragdrop_attachments||{};view.dragdrop_attachments[unique]=file;container=$("<div class='activitystream-pending-attachment' id='"+unique+"'></div>");var $close=$('<a class="close">&times;</a>');$close.on('click',function(e){container.trigger('close');}).appendTo(container);app.accessibility.run($close,'click');container.append(file.name+' ('+size+' '+sizes[size_index]+')');if(file.type.indexOf('image/')!==-1){container.append("<img style='display:block;' src='"+e.target.result+"' />");}else{container.append('<div>No preview available</div>');}
container.appendTo(view.$(event.currentTarget).parent());container.on('close',function(){$(this).remove();delete view.dragdrop_attachments[container.attr('id')];view.trigger('attachments:remove');});view.trigger('attachments:add');};})(file,this);fileReader.readAsDataURL(file);},this);event.stopPropagation();event.preventDefault();},getAttachments:function(){return this.dragdrop_attachments||{};},clearAttachments:function(){this.$('.activitystream-pending-attachment').trigger('close');this.dragdrop_attachments={};},onAttach:function(component,plugin){component.on('render',function(){this.$('.attachable').attr('dropzone','copy');});component.on('attachments:process',function(){var self=this,attachments=this.getAttachments(),callback=_.after(_.size(attachments),this.clearAttachments),noteAttrs=this._mapNoteParentAttributes();component.trigger('attachments:start');_.each(attachments,function(file){var note=app.data.createBean('Notes');note.set(_.extend({'name':file.name,'assigned_user_id':app.user.id},noteAttrs));async.waterfall([function(callback){note.save(null,{success:function(noteModel){callback(null,noteModel);}});},function(note,callback){var data=new FormData(),url=app.api.buildFileURL({module:note.module,id:note.id,field:'filename'});data.append('filename',file);data.append('OAuth-Token',app.api.getOAuthToken());$.ajax({url:url,type:'POST',data:data,processData:false,contentType:false}).then(function(){callback(null);});},function(callback){var activity=app.data.createBean('Activities'),payload={activity_type:'attach',parent_id:noteAttrs.parent_id||null,parent_type:noteAttrs.parent_type||null,data:{noteId:note.id,filename:file.name,mimetype:file.type,size:file.size}};activity.save(payload,{success:function(activityModel){self.collection.add(activityModel);callback(null,activityModel);}});}],function(err,activity){component.trigger('attachments:end');if(err){var errorMessage=app.lang.get('LBL_EMAIL_ATTACHMENT_UPLOAD_FAILED');app.alert.show('upload_error',errorMessage);}else{self.context.reloadData({recursive:false});self.clearAttachments.call(self);}});});});},_mapNoteParentAttributes:function(){var parentId=this.context.parent.get('model').id,parentType=this.context.parent.get('model').module;if(parentType&&parentId){switch(parentType){case'Contacts':return{'parent_id':parentId,'parent_type':parentType,'contact_id':parentId};case'Home':return{'parent_type':parentType};default:return{'parent_id':parentId,'parent_type':parentType};}}else if(parentType&&parentType==='Activities'){return{'parent_type':parentType};}
return{};}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/DragdropAttachments.js */


(function(app){app.events.on("app:init",function(){app.plugins.register('FileDragoff',['view'],{events:{'dragstart .dragoff':'saveAttachment'},saveAttachment:function(event){if(event.dataTransfer&&event.dataTransfer.constructor==Clipboard&&event.dataTransfer.setData('DownloadURL','http://www.sugarcrm.com')){var el=$(event.currentTarget),mime,name,file;while(el!==this.$el&&!el.data("url")){el=el.parent();}
mime=el.data("mime");name=el.data("filename");file=el.data("url");event.dataTransfer.setData("DownloadURL",mime+":"+name+":"+file);}}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/FileDragoff.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('Dropdown',['layout','view'],{events:{'keydown':'handleDropdownKeydown'},onAttach:function(component,plugin){this.on('init',function(){this.listenTo(app.bwc,'clicked',this.closeDropdown);app.routing.before('route',this.closeDropdown,this,true);});},isDropdownOpen:function(){return!!this.$('[data-toggle="dropdown"]').parent().hasClass('open');},handleDropdownKeydown:function(event){var $items,$focusItem,keysCaptured;if(!this.isDropdownOpen()){return;}
if(event.keyCode===$.ui.keyCode.ESCAPE||event.keyCode===$.ui.keyCode.TAB){this.closeDropdown();}else{$items=this._getDropdownItems();$focusItem=$items.filter(':focus');this._focusSubmenuItem(event.keyCode,$items.index($focusItem),$items);if(event.keyCode===$.ui.keyCode.RIGHT||event.keyCode===$.ui.keyCode.LEFT){this._toggleSubmenu($focusItem);}}
keysCaptured=[$.ui.keyCode.ESCAPE,$.ui.keyCode.UP,$.ui.keyCode.DOWN,$.ui.keyCode.LEFT,$.ui.keyCode.RIGHT];if(_.contains(keysCaptured,event.keyCode)){event.stopPropagation();event.preventDefault();}},_getDropdownItems:function(){return this.$(this.dropdownItemSelector||'[role=menu] li:not(.divider) a:visible');},_focusSubmenuItem:function(key,index,$items){var $menuItemToFocus;if(key===$.ui.keyCode.UP&&index>0){index--;}
if(key===$.ui.keyCode.DOWN&&index<$items.length-1){index++;}
if(!~index){index=0;}
$menuItemToFocus=$items.eq(index).focus();this._scrollToMenuItem($menuItemToFocus);},_scrollToMenuItem:function($menuItem){var $dropdownMenu=this.$('.dropdown-menu'),menuHeight,menuItemHeight,menuItemTopPosition;if($dropdownMenu.hasClass('scroll')){menuHeight=$dropdownMenu.height();menuItemHeight=$menuItem.height();menuItemTopPosition=$menuItem.position().top;if((menuItemTopPosition+menuItemHeight)>menuHeight){$dropdownMenu.scrollTop($dropdownMenu.scrollTop()+menuHeight/2);}else if(menuItemTopPosition<0){$dropdownMenu.scrollTop($dropdownMenu.scrollTop()-menuHeight/2);}}},_toggleSubmenu:function($dropdown){var $submenuButton=$dropdown.find('.dropdown-submenu');if($submenuButton.length>0){$submenuButton.click();}},closeDropdown:function(){this.$('.open .dropdown-menu').trigger('click.bs.dropdown');},unbindBeforeHandler:function(){app.routing.offBefore('route',this.closeDropdown,this);},onDetach:function(){app.events.off('app:view:change',null,this);app.routing.offBefore('route',this.closeDropdown,this);this.unbindBeforeHandler();}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/Dropdown.js */


(function(app){app.events.on("app:init",function(){app.plugins.register('EllipsisInline',['view','field'],{events:{'mouseenter .ellipsis_inline':'_showEllipsisTooltip','mouseleave .ellipsis_inline':'_hideEllipsisTooltip'},_$ellipsisTooltips:null,onAttach:function(){this.before('render',function(){this.destroyEllipsisTooltips();},this);this.on('render',function(){this.initializeEllipsisTooltips();},this);},onDetach:function(){this.destroyEllipsisTooltips();},initializeEllipsisTooltips:function(){var self=this;if(this._$ellipsisTooltips){app.utils.tooltip.destroy(this._$ellipsisTooltips);}
_.defer(function($element,options,direction){self._$ellipsisTooltips=app.utils.tooltip.initialize($element,options,direction);},this.$('.ellipsis_inline'),{trigger:'manual'},this.dir);},destroyEllipsisTooltips:function(){app.utils.tooltip.destroy(this._$ellipsisTooltips);this._$ellipsisTooltips=null;},_showEllipsisTooltip:function(event){var target=event.currentTarget;if(this._shouldShowEllipsisTooltip(target)){app.utils.tooltip.show(target);}},_hideEllipsisTooltip:function(event){var target=event.currentTarget;if(this._shouldHideEllipsisTooltip(target)){app.utils.tooltip.hide(target);}},_shouldShowEllipsisTooltip:function(target){return app.utils.tooltip.has(target)&&(target.offsetWidth<target.scrollWidth);},_shouldHideEllipsisTooltip:function(target){var plugin=app.utils.tooltip.get(target);return plugin&&plugin.tip().hasClass('in');}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/EllipsisInline.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('ListColumnEllipsis',['view'],{events:{'click [data-field-toggle]':'toggleColumn'},toggleColumn:function(event){var column=$(event.currentTarget).data('fieldToggle');if(this.isLastColumnVisible(column)){event.stopPropagation();return;}
this._toggleColumn(column);this.render();this._reopenFieldsDropdown(event);},_toggleColumn:function(column){var changedColumn={};var f=this._fields._byId[column];if(f){f.selected=!f.selected;changedColumn=f;}
this._fields.visible=_.where(this._fields.all,{selected:true});this.trigger('list:toggle:column',column,changedColumn.selected,changedColumn);},isLastColumnVisible:function(column){if(this._fields.visible.length===1){var f=this._fields._byId[column];return f&&f.selected;}
return false;},_reopenFieldsDropdown:function(event){this.$('[data-action="fields-toggle"]').dropdown('toggle');event.stopPropagation();},onAttach:function(component,plugin){this.before('render',function(){var lastActionColumn=_.last(this.rightColumns);if(lastActionColumn){lastActionColumn.isColumnDropdown=true;}},null,this);}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/ListColumnEllipsis.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('ReorderableColumns',['view'],{_listDragColumnSelector:'th[data-fieldname]',_listDragItemSelector:'th[data-fieldname] [data-draggable="true"]',_listDragColumn:[],_makeColumnReorderable:function(){if(this.disposed){return;}
if(!this.$('table').hasClass('reorderable-columns')){app.logger.error('ReorderableColumns plugin expects the table to have .draggable-columns class '+'in order to work.');return;}
this._listDragColumn=_.map(this.$(this._listDragColumnSelector),function(column){return $(column).data('fieldname');});this.$(this._listDragItemSelector).draggable({revert:'invalid',axis:'x',stop:_.bind(function(event,ui){if(ui.helper._renderView&&!this.disposed){this.render();}},this)});this.$('.th-droppable-placeholder').droppable({accept:this._listDragItemSelector,hoverClass:'th-droppable-placeholder-highlight',tolerance:'touch',drop:_.bind(this._onColumnDrop,this)});},_onColumnDrop:function(event,ui){var $draggedItem=$(ui.draggable),$droppedInItem=$(event.target),draggedIndex,droppedInIndex,initialOrder,visibleOrder,hasChanged;draggedIndex=$draggedItem.closest('th').find('.th-droppable-placeholder:first').data('droppableindex');droppedInIndex=$droppedInItem.data('droppableindex');if(droppedInIndex>draggedIndex){droppedInIndex--;}
initialOrder=_.clone(this._listDragColumn);visibleOrder=_.moveIndex(this._listDragColumn,draggedIndex,droppedInIndex);hasChanged=!_.isEqual(visibleOrder,initialOrder);if(!hasChanged){$draggedItem.draggable('option','revert',true);return;}
var newOrder=this._calculateNewOrder($draggedItem,$droppedInItem);this.trigger('list:reorder:columns',this._fields,newOrder);ui.draggable._renderView=true;},_calculateNewOrder:function($draggedItem,$droppedInItem){var globalOrder,draggedIndex,droppedInIndex;globalOrder=_.pluck(this._fields.all,'name');draggedIndex=_.indexOf(globalOrder,$draggedItem.closest('th').data('fieldname'));droppedInIndex=_.indexOf(globalOrder,$droppedInItem.closest('th').data('fieldname'));if($droppedInItem.hasClass('th-droppable-placeholder-last')){droppedInIndex++;}
if(droppedInIndex>draggedIndex){droppedInIndex--;}
return _.moveIndex(globalOrder,draggedIndex,droppedInIndex);},onAttach:function(component,plugin){this.on('render',_.debounce(this._makeColumnReorderable,200),this);}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/ReorderableColumns.js */


var __bind=function(fn,me){return function(){return fn.apply(me,arguments);};},__slice=[].slice;(function($,window){var ResizableColumns,pointerX,stripPx,_parseWidth,_setWidth;var uniqueIds=0;stripPx=function(width){if(!width){return 0;}else{if(typeof width==='string'){return width.replace('px','');}else{return width;}}};_parseWidth=function(_usePixels,node){return parseFloat((node.offsetWidth+'').replace((_usePixels?'px':'%'),''));};_setWidth=function(_usePixels,node,width){if(_usePixels){width=width.toFixed(2);$(node).children().width(width);width=width+'px';node.style.minWidth=width;node.style.width=width;node.style.maxWidth=width;}else{width=width.toFixed(2);width=""+width+"%";node.style.width=width;}
return width;};pointerX=function(e){if(e.type.indexOf('touch')===0){return(e.originalEvent.touches[0]||e.originalEvent.changedTouches[0]).pageX;}
return e.pageX;};ResizableColumns=(function(){ResizableColumns.prototype.defaults={usePixels:false,selector:'tr th:visible',store:window.store,syncHandlers:true,resizeFromBody:true,maxWidth:null,minWidth:null};function ResizableColumns($table,options){this.pointerdown=__bind(this.pointerdown,this);this.constrainWidth=__bind(this.constrainWidth,this);var usePixels;this.options=$.extend({},this.defaults,options);this.$table=$table;usePixels=this.options.usePixels;this.parseWidth=function(node){return _parseWidth(usePixels,node);};this.setWidth=function(node,width){return _setWidth(usePixels,node,width);};this.setHeaders();if(this.options.store!=null){this.restoreColumnWidths();}
this.syncHandleWidths();this._uniqueId=++uniqueIds;$(window).on('resize.rc'+this._uniqueId,((function(_this){return function(){var sync=_this.syncHandleWidths();var minTableWidth=_this.options.getMinTableWidth&&_this.options.getMinTableWidth();if(minTableWidth){_this._minTableWidth=minTableWidth;}
if(_this.options.restore){_this.options.restore();}
_this._currentTableWidth=_this.$table.width();return sync;};})(this)));if(this.options.start){this.$table.bind('column:resize:start.rc',this.options.start);}
if(this.options.resize){this.$table.bind('column:resize.rc',this.options.resize);}
if(this.options.stop){this.$table.bind('column:resize:stop.rc',this.options.stop);}
if(this.options.restore){this.$table.bind('column:resize:restore.rc',this.options.restore);}}
ResizableColumns.prototype.triggerEvent=function(type,args,original){var event;event=$.Event(type);event.originalEvent=$.extend({},original);return this.$table.trigger(event,[this].concat(args||[]));};ResizableColumns.prototype.getColumnId=function($el){return this.$table.data('resizable-columns-id')+'-'+$el.data('resizable-column-id');};ResizableColumns.prototype.setHeaders=function(){this._leftoverWidth=this.$table.width();this.$tableHeaders=this.$table.find(this.options.selector);var i=this.$tableHeaders.length;var width;while(i){i--;width=$(this.$tableHeaders[i]).outerWidth();this._leftoverWidth-=width;}
if(this.options.usePixels){this.assignPixelWidths();}else{this.assignPercentageWidths();}
return this.createHandles();};ResizableColumns.prototype.destroy=function(){$(window).off('resize.rc'+this._uniqueId);this.$handleContainer.remove();this.$table.removeData('resizableColumns');};ResizableColumns.prototype.assignPercentageWidths=function(){return this.$tableHeaders.each((function(_this){return function(_,el){var $el;$el=$(el);return _this.setWidth($el[0],$el.outerWidth()/ _this.$table.width()*100);};})(this));};ResizableColumns.prototype.assignPixelWidths=function(){var columns=[];var self=this;this.$tableHeaders.each((function(_this){return function(_,el){var $el;$el=$(el);columns.push($el.outerWidth()-stripPx($el.css('paddingLeft')-stripPx($el.css('paddingRight'))));};})(this));return this.$tableHeaders.each(function(i,el){return self.setWidth(el,columns[i]);});};ResizableColumns.prototype.createHandles=function(){var _ref;if((_ref=this.$handleContainer)!=null){_ref.remove();}
this.$table.before((this.$handleContainer=$("<div class='rc-handle-container' />")));this.$tableHeaders.each((function(_this){return function(i,el){var $handle;if(_this.$tableHeaders.eq(i+1).length===0||(_this.$tableHeaders.eq(i).attr('data-noresize')!=null)||(_this.$tableHeaders.eq(i+1).attr('data-noresize')!=null)){return;}
$handle=$("<div class='rc-handle' />");$handle.data('th',$(el));return $handle.appendTo(_this.$handleContainer);};})(this));return this.$handleContainer.on('mousedown touchstart','.rc-handle',this.pointerdown);};ResizableColumns.prototype.syncHandleWidths=function(){if(this.options.usePixels){return this.syncHandleWidthsPx();}
return this.$handleContainer.width(this.$table.width()).find('.rc-handle').each((function(_this){return function(_,el){var $el;$el=$(el);return $el.css({left:$el.data('th').outerWidth()+($el.data('th').offset().left-_this.$handleContainer.offset().left),height:_this.options.resizeFromBody?_this.$table.height():_this.$table.find('thead').height()});};})(this));};ResizableColumns.prototype.saveColumnWidths=function(){var columns;columns=[];this.$tableHeaders.each((function(_this){return function(_,el){var $el,width;$el=$(el);if($el.attr('data-noresize')==null){width=_this.parseWidth($el[0]);columns.push(width);if(_this.options.store!=null){return _this.options.store.set(_this.getColumnId($el),width);}}};})(this));return this.$table.trigger('column:resize:save',[columns]);};ResizableColumns.prototype.restoreColumnWidths=function(){return this.$tableHeaders.each((function(_this){return function(_,el){var $el,width;$el=$(el);if((_this.options.store!=null)&&(width=_this.options.store.get(_this.getColumnId($el)))){return _this.setWidth($el[0],width);}};})(this));};ResizableColumns.prototype.totalColumnWidths=function(){var total;if(this.options.usePixels){return this.totalColumnWidthsPx();}
total=0;this.$tableHeaders.each((function(_this){return function(_,el){return total+=parseFloat($(el)[0].style.width.replace('%',''));};})(this));return total;};ResizableColumns.prototype.syncHandleWidthsPx=function(){return this.$handleContainer.css('minWidth','100%').find('.rc-handle').each((function(_this){return function(_,el){var $el,height,left;$el=$(el);left=$el.data('th').innerWidth();left-=stripPx($el.css('paddingLeft'));left-=stripPx($el.css('paddingRight'));left+=$el.data('th').offset().left;left-=_this.$handleContainer.offset().left;height=_this.options.resizeFromBody?_this.$table.height():_this.$table.find('thead').height();return $el.css({left:left,height:height});};})(this));};ResizableColumns.prototype.totalColumnWidthsPx=function(){var total;total=0;this.$table.each((function(_this){return function(_,el){var $el;$el=$(el);return total+=parseFloat(stripPx($el.outerWidth()));};})(this));return total;};ResizableColumns.prototype.constrainWidth=function(width){if(this.options.minWidth!=null){width=Math.max(this.options.minWidth,width);}
if(this.options.maxWidth!=null){width=Math.min(this.options.maxWidth,width);}
return width;};ResizableColumns.prototype.pointerdown=function(e){var $currentGrip,$leftColumn,$ownerDocument,$rightColumn,isLtr,newWidths,startPosition,widths;e.preventDefault();isLtr=this.$table.css('direction')!=='rtl';$ownerDocument=$(e.currentTarget.ownerDocument);startPosition=pointerX(e);$currentGrip=$(e.currentTarget);if(isLtr){$leftColumn=$currentGrip.data('th');$rightColumn=this.$tableHeaders.eq(this.$tableHeaders.index($leftColumn)+1);}else{$rightColumn=$currentGrip.data('th');$leftColumn=this.$tableHeaders.eq(this.$tableHeaders.index($rightColumn)-1);}
widths={left:this.parseWidth($leftColumn[0]),right:this.parseWidth($rightColumn[0])};newWidths={left:widths.left,right:widths.right};this.$handleContainer.add(this.$table).addClass('rc-table-resizing');$leftColumn.add($rightColumn).add($currentGrip).addClass('rc-column-resizing');this.triggerEvent('column:resize:start',[$leftColumn,$rightColumn,newWidths.left,newWidths.right],e);$ownerDocument.on('mousemove.rc touchmove.rc',(function(_this){return function(e){var difference;var localWidths={left:newWidths.left,right:newWidths.right};difference=pointerX(e)-startPosition;startPosition=pointerX(e);if(!isLtr){difference=-difference;}
if(!_this.options.usePixels){difference=difference / _this.$table.width()*100;}
if(_this.options.usePixels){_this._currentTableWidth=_this.$table.width()+difference;var shouldRestrict=_this._minTableWidth&&(_this._currentTableWidth<_this._minTableWidth);if(shouldRestrict){_this.setWidth($rightColumn[0],newWidths.right=_this.constrainWidth(localWidths.right-difference));}
_this.setWidth($leftColumn[0],newWidths.left=_this.constrainWidth(localWidths.left+difference));}else{_this.setWidth($leftColumn[0],newWidths.left=_this.constrainWidth(widths.left+difference));_this.setWidth($rightColumn[0],newWidths.right=_this.constrainWidth(widths.right-difference));}
if(_this.options.syncHandlers!=null){_this.syncHandleWidths();}
return _this.triggerEvent('column:resize',[$leftColumn,$rightColumn,newWidths.left,newWidths.right],e);};})(this));return $ownerDocument.one('mouseup touchend',(function(_this){return function(){$ownerDocument.off('mousemove.rc touchmove.rc');_this.$handleContainer.add(_this.$table).removeClass('rc-table-resizing');$leftColumn.add($rightColumn).add($currentGrip).removeClass('rc-column-resizing');_this.syncHandleWidths();_this.saveColumnWidths();return _this.triggerEvent('column:resize:stop',[$leftColumn,$rightColumn,newWidths.left,newWidths.right],e);};})(this));};return ResizableColumns;})();return $.fn.extend({resizableColumns:function(){var args,option;option=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[];return this.each(function(){var $table,data;$table=$(this);data=$table.data('resizableColumns');if(!data){$table.data('resizableColumns',(data=new ResizableColumns($table,option)));}
if(typeof option==='string'){return data[option].apply(data,args);}});}});})(window.jQuery,window);
/* End of File include/javascript/jquery/sugar.resizableColumns.js */


(function(app){var _sum=function(array){return _.reduce(array,function(memo,num){return memo+num;},0);};var _mapClassesToPixels={'xxsmall':21,'xsmall':42,'small':68,'medium':110,'large':178,'xlarge':288,'xxlarge':466};app.events.on('app:init',function(){app.plugins.register('ResizableColumns',['view'],{_listResizableColumnSelector:'thead tr:first-child th[data-fieldname]',_makeColumnResizable:function(){if(this.disposed){return;}
var proto=Object.getPrototypeOf(this);var getMinTableWidth;if(_.isFunction(proto.getMinTableWidth)){getMinTableWidth=_.bind(proto.getMinTableWidth,this);}
var self=this;var $table=this.$('table');$table.resizableColumns({usePixels:true,selector:this._listResizableColumnSelector,minWidth:1,store:null,restore:function(event,columns){if(self.disposed){return;}
var resizableColumns=$table.data('resizableColumns');if(columns){resizableColumns._expectedWidths=columns;}else{columns=resizableColumns._expectedWidths;}
var expectedWidth=_sum(columns);var availableWidth=resizableColumns.options.getMinTableWidth()-resizableColumns._leftoverWidth;availableWidth=availableWidth-columns.length;var rate=expectedWidth / availableWidth;if(rate<1){columns=_.map(columns,function(col){return parseInt(col / rate,10);});}
var i=0;resizableColumns.$tableHeaders.each(function(index,el){var $el,width;$el=$(el);width=columns[i++];if($el.attr('data-noresize')==null&&width){return resizableColumns.setWidth($el[0],width);}});resizableColumns.syncHandleWidths();},getMinTableWidth:!_.isUndefined(getMinTableWidth)?getMinTableWidth:function(){return $table.parent().width();}});var cachedSizes=this.getCacheWidths();if(_.isEmpty(cachedSizes)){cachedSizes=_.map(this._fields.visible,function(field){var width=field.expectedWidth||'medium';return _mapClassesToPixels[width]||width;});}
$table.trigger('column:resize:restore',[cachedSizes]);$(window).resize();$table.on('column:resize:save',_.bind(function(event,columns){this.trigger('list:column:resize:save',columns);},this));},_unbindResizableColumns:function(){if(this.disposed){return;}
var $table=this.$('table');$table.off('column:resize:save');$table.resizableColumns('destroy');},onAttach:function(component,plugin){this.before('render',this._unbindResizableColumns);this.on('render',_.debounce(this._makeColumnResizable,100));},onDetach:function(component,plugin){this._unbindResizableColumns();}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/ResizableColumns.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('ToggleMoreLess',['view'],{events:{'click [data-moreless]':'moreLessClicked'},MORE_LESS_KEY:'show_more',MORE_LESS_STATUS:{MORE:'more',LESS:'less'},onAttach:function(){this.on('init',function(){this.meta=this.meta||{};this.meta.last_state=this.meta.last_state||{id:this.name+'_view',defaults:{}};this.meta.last_state['defaults'][this.MORE_LESS_KEY]='less';this.SHOW_MORE_KEY=app.user.lastState.key(this.MORE_LESS_KEY,this);app.user.lastState.register(this);});this.before('render',function(){var lastStatus=app.user.lastState.get(this.SHOW_MORE_KEY);if(_.contains(this.MORE_LESS_STATUS,lastStatus)){this._setVisibility(lastStatus);}},this);},moreLessClicked:function(evt){var moreLess=this.$(evt.currentTarget).data('moreless');this.toggleMoreLess(moreLess);},toggleMoreLess:function(moreLess,skipSetState){this._setVisibility(moreLess);this.$('[data-moreless=more]').toggleClass('hide',this.hideMoreButton);this.$('[data-moreless=less]').toggleClass('hide',this.hideLessButton);var target=this.$('[data-moreless='+moreLess+']').data('target')||'.panel-hidden';this.$(target).toggleClass('hide',this.hidePanel);if(!skipSetState){app.user.lastState.set(this.SHOW_MORE_KEY,moreLess);}
this.trigger('more-less:toggled',moreLess);},_setVisibility:function(moreLess){this.hideMoreButton=(moreLess===this.MORE_LESS_STATUS.MORE);this.hideLessButton=(moreLess===this.MORE_LESS_STATUS.LESS);this.hidePanel=(moreLess===this.MORE_LESS_STATUS.LESS);}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/ToggleMoreLess.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('ContactsPortalMetadataFilter',['view'],{removePortalFieldsIfPortalNotActive:function(meta){if(!_.isObject(meta)){return;}
var portalFields=['portal_name','portal_active','portal_password'];var serverInfo=app.metadata.getServerInfo();if(!serverInfo.portal_active){_.each(meta.panels,function(panel){panel.fields=_.reject(panel.fields,function(field){var name=_.isObject(field)?field.name:field;return _.contains(portalFields,name);});});}}});});})(SUGAR.App);
/* End of File modules/Contacts/clients/base/plugins/ContactsPortalMetadataFilter.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('HistoricalSummary',['view'],{onAttach:function(component,plugin){this.on('init',function(){this.context.on('button:historical_summary_button:click',this.historicalSummaryClicked,this);});},historicalSummaryClicked:function(){var context=this.context.getChildContext({module:'History'});app.drawer.open({layout:'history-summary',context:context});},onDetach:function(component,plugin){this.context.off('button:historical_summary_button:click',this.auditClicked,this);}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/HistoricalSummary.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('MetadataEventDriven',['field'],{triggerMetadataEvent:function(domEvent,metadataEvent){if(this.view.context){this.view.context.trigger(metadataEvent,this.model);}
if(this.view.layout){this.view.layout.trigger(metadataEvent,this.model);}}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/MetadataEventDriven.js */


(function(app){app.events.on("app:init",function(){app.plugins.register('DisableDelete',["field"],{onAttach:function(component,plugin){this.on("render",this.removeDelete,this);},removeDelete:function(){var config=app.metadata.getModule('Forecasts','config')||{},sales_stage_won=null,sales_stage_lost=null,label_key='_STAGE',closed_RLI_count=0,message=null,status=null,button=null;if(_.contains(["list:deleterow:fire","button:delete_button:click"],this.def.event)){sales_stage_won=config.sales_stage_won||['Closed Won'];sales_stage_lost=config.sales_stage_lost||['Closed Lost'];if(app.metadata.getModule('Opportunities','config').opps_view_by==='RevenueLineItems'){status=this.model.get('sales_status');closed_RLI_count=this.model.get('closed_revenue_line_items');if(_.isNull(closed_RLI_count)){closed_RLI_count=0;}
label_key='_STATUS';}
if(_.isEmpty(status)){status=this.model.get('sales_stage');}
if(closed_RLI_count>0){message=app.lang.get('NOTICE_NO_DELETE_CLOSED_RLIS','Opportunities');}
if(_.contains(sales_stage_won,status)||_.contains(sales_stage_lost,status)){message=app.lang.get('NOTICE_NO_DELETE_CLOSED'+label_key);}
if(!_.isEmpty(message)){this.setDisabled(true);button=this.getFieldElement();button.addClass('disabled');button.attr('data-event','');button.tooltip({title:message});}}
return message;}});});})(SUGAR.App);
/* End of File modules/Forecasts/clients/base/plugins/DisableDelete.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('DisableMassDelete',['view'],{onAttach:function(component,plugin){this.once('init',function(){this.layout.off('list:massdelete:fire',this.warnDelete,this);this.layout.on('list:massdelete:fire',this._warnDelete,this);},this);},_warnDelete:function(){var config=app.metadata.getModule('Forecasts','config')||{},sales_stage_won=config.sales_stage_won||['Closed Won'],sales_stage_lost=config.sales_stage_lost||['Closed Lost'],closed_RLI_count=0,label_key='_STAGE',message=null,status=null,massUpdateModel=this.getMassUpdateModel(this.module),progressView=this.getProgressView(),opp_view_by=app.metadata.getModule('Opportunities','config').opps_view_by,closedModels=_.filter(massUpdateModel.models,function(model){status=null;if(opp_view_by==='RevenueLineItems'){status=model.get('sales_status');closed_RLI_count=model.get('closed_revenue_line_items');if(_.isNull(closed_RLI_count)){closed_RLI_count=0;}
label_key='_STATUS';}
if(_.isEmpty(status)){status=model.get('sales_stage');}
if(_.contains(sales_stage_won,status)||_.contains(sales_stage_lost,status)){message=app.lang.get('WARNING_NO_DELETE_SELECTED'+label_key);return true;}
if(closed_RLI_count>0){message=app.lang.get('WARNING_NO_DELETE_CLOSED_SELECTED'+label_key,'Opportunities');return true;}
return false;});if(closedModels.length>0){var massCollection=this.context.get('mass_collection');massCollection.remove(closedModels);_.each(closedModels,function(item){var id=item.module+'_'+item.id;$("[name='"+id+"'] input").attr('checked',false);});app.alert.show('delete_warning',{level:'warning',messages:message});progressView.dispose();this.layout.removeComponent(progressView);}else if(massUpdateModel.models.length>0){this.warnDelete();}
return message;}});});})(SUGAR.App);
/* End of File modules/Forecasts/clients/base/plugins/DisableMassDelete.js */


(function(app){app.events.on("app:init",function(){app.plugins.register('MassQuote',["view"],{onAttach:function(component,plugin){this.once('init',function(){this.layout.on("list:massquote:fire",this.massQuote,this);},this);},massQuote:function(){this.hideAll();var massQuote=this.context.get("mass_collection"),options={},callbacks={},errors={'LBL_CONVERT_INVALID_RLI_PRODUCT_PLURAL':[],'LBL_CONVERT_INVALID_RLI_ALREADYQUOTED_PLURAL':[]};var invalidItems=massQuote.filter(function(model){if(_.isEmpty(model.get('product_template_id'))&&!_.isEmpty(model.get('category_id'))){errors['LBL_CONVERT_INVALID_RLI_PRODUCT_PLURAL'].push(model);return true;}else if(!_.isEmpty(model.get('quote_id'))){errors['LBL_CONVERT_INVALID_RLI_ALREADYQUOTED_PLURAL'].push(model);return true;}
return false;},this);if(!_.isEmpty(invalidItems)){var messageTpl=app.template.getView('massupdate.invalid_link',this.module);_.each(errors,function(val,key){if(val.length!=0){var messages=[];messages.push(app.lang.get(key,this.module)+'<br>');_.each(val,function(item){messages.push(messageTpl(item.attributes));});app.alert.show(('invalid_items_'+key),{level:'error',title:app.lang.get('LBL_ALERT_TITLE_ERROR',this.module)+':',messages:messages,onLinkClick:function(){app.alert.dismiss('invalid_items_'+key);}});}},this);return;}
if(massQuote){var alert=app.alert.show('info_quote',{level:'info',autoClose:false,closeable:false,title:app.lang.get("LBL_CONVERT_TO_QUOTE_INFO",this.module)+":",messages:[app.lang.get("LBL_CONVERT_TO_QUOTE_INFO_MESSAGE",this.module)]});alert.$('a.close').remove();var url=app.api.buildURL(this.context.get('module'),'multi-quote');options.success=_.bind(function(model,data,options){app.alert.dismiss('info_quote');app.router.navigate(app.bwc.buildRoute('Quotes',data.id,'EditView',{return_module:this.context.parent.get('module'),return_id:this.context.parent.get('model').get('id')}),{trigger:true});},this);options.error=_.bind(function(){app.alert.dismiss('info_quote');app.alert.show('error_xhr',{level:'error',title:app.lang.get("LBL_CONVERT_TO_QUOTE_ERROR",this.context.module)+":",messages:[app.lang.get("LBL_CONVERT_TO_QUOTE_ERROR_MESSAGE",this.context.module)]});},this);var data={'records':massQuote.pluck('id'),'opportunity_id':this.context.parent.get('model').get('id'),'account_id':this.context.parent.get('model').get('account_id')};callbacks=app.data.getSyncCallbacks('create',massQuote,options);app.api.call("create",url,data,callbacks);}}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/MassQuote.js */


(function(app){app.events.on("app:init",function(){var tagTemplate=Handlebars.compile('<span class="label label-{{module}} sugar_tag"><a href="#{{buildRoute module=module id=id}}">{{name}}</a></span>'),tagInEditTemplate=Handlebars.compile('<span class="label label-{{module}} sugar_tag" contenteditable="false"><a>{{name}}</a></span>'),tagListOptionTemplate=Handlebars.compile('<li{{#if noAccess}} class="disabled"{{/if}}><a><div class="label label-module-mini label-{{module}} pull-left">{{moduleIconLabel module}}</div>{{{htmlName}}}{{#if noAccess}}<div class="add-on">{{str "LBL_NO_ACCESS_LOWER"}}</div>{{/if}}</a></li>'),tagTextTemplate=Handlebars.compile('@[{{module}}:{{id}}:{{name}}]'),taggingHtml='<span class="sugar_tagging">&nbsp;</span>',tagListContainerHtml='<ul class="dropdown-menu activitystream-tag-dropdown"></ul>',mention='@',reference='#',keycode_at=64,keycode_hash=35,keycode_esc=27,keycode_enter=13,keycode_tab=9,keycode_up=38,keycode_down=40,tagRegExp=/@\[([\w]+):([\d\w\-]+):(.+?)\]/g,nbspRegExp=/&nbsp;/g;app.plugins.register('Taggable',['view'],{events:{'keypress .taggable':'_checkForReferenceOrMention','keydown .taggable':'_onKeydown','keyup .taggable':'_onKeyup','mouseover .activitystream-tag-dropdown li':'_setListOptionAsActive','click .activitystream-tag-dropdown li':'_insertTag'},taggableSearchAfter:2,taggableListLength:8,onAttach:function(component,plugin){this._searchForTags=_.debounce(this._searchForTags,300);$(document).on('click.'+component.cid,function(event){var $target=$(event.target),clickedOutsideDropdown=($target.parents('.activitystream-tag-dropdown').length===0),clickedOutsideTaggingSpan=!$target.hasClass('sugar_tagging');if(component._taggableEnabled&&clickedOutsideDropdown&&clickedOutsideTaggingSpan){component._resetTaggable();}});},onDetach:function(component,plugin){$(document).off('click.'+component.cid);},unformatTags:function($input){var text='',tags=[];$input.contents().each(function(){var $node=$(this),data=$node.data();if(this.nodeType===Node.TEXT_NODE){text+=this.nodeValue.replace(nbspRegExp,' ');}else if(data&&data.module&&data.id&&data.name){text+=tagTextTemplate(data);tags.push(data);}else{text+=$node.text();}});return{value:$.trim(text),tags:this._filterOutDuplicateTags(tags)};},formatTags:function(text){var html='';if(text&&(text.length>0)){html=text.replace(tagRegExp,function(str,module,id,name){name=new Handlebars.SafeString(name);module=(module==='Users')?'Employees':module;return tagTemplate({module:module,id:id,name:name});});}
return $.trim(html);},setTaggableRecord:function(module,id){this._taggableModuleName=module;this._taggableModelId=id;},_taggableEnabled:false,_taggableModuleName:null,_taggableModelId:null,_taggableLastSearchTerm:null,_taggableListOpen:null,_checkForReferenceOrMention:function(event){if(!this._taggableEnabled){switch(event.which){case keycode_at:case keycode_hash:this._enableTaggable();break;}}},_onKeydown:function(event){if(this._taggableEnabled&&!this._taggableListOpen){switch(event.which){case keycode_esc:case keycode_enter:case keycode_tab:event.preventDefault();this._resetTaggable();break;}}
if(this._taggableEnabled&&(this._taggableListOpen===true)){switch(event.which){case keycode_esc:event.preventDefault();this._resetTaggable();break;case keycode_enter:case keycode_tab:event.preventDefault();this._getCurrentlyActiveOption().click();break;case keycode_up:event.preventDefault();this._selectNextListOption(false);break;case keycode_down:event.preventDefault();this._selectNextListOption(true);break;}}},_onKeyup:function(event){var selection=window.getSelection(),range,$container,searchTerm;if(this._taggableEnabled){if(this._taggableListOpen&&(event.which===keycode_enter||event.which===keycode_tab||event.which==keycode_up||event.which==keycode_down)){return;}
if(selection.rangeCount>0){range=selection.getRangeAt(0);$container=$(range.startContainer.parentNode);searchTerm=$.trim($container.text());if(!$container.hasClass('sugar_tagging')){this._resetTaggable();}else if(this._taggableListOpen&&(searchTerm.length<=this.taggableSearchAfter)){this._getDropdown().hide();this._taggableListOpen=null;this._taggableLastSearchTerm=null;}else{if((searchTerm.indexOf(mention)===0)||(searchTerm.indexOf(reference)===0)){this._searchForTags(searchTerm);}else{this._resetTaggable();}}}}},_enableTaggable:function(){var selection=window.getSelection(),range=selection.getRangeAt(0),tagElement=$(taggingHtml),textNode=tagElement.contents()[0],cursorPosition=$.browser.webkit?1:0;if(this._shouldEnableTaggable(range)){range.insertNode(tagElement.get(0));range.setStart(textNode,cursorPosition);range.setEnd(textNode,cursorPosition);selection.removeAllRanges();selection.addRange(range);this._taggableEnabled=true;}},_shouldEnableTaggable:function(range){var text=range.startContainer.nodeValue,charBeforeCursor,result=false;if((range.startContainer.nodeType===Node.ELEMENT_NODE)||(text.length===0)||(range.startOffset===0)){result=true;}else{charBeforeCursor=text.charAt(range.startOffset-1);if((charBeforeCursor===String.fromCharCode(160))||(charBeforeCursor===String.fromCharCode(32))){result=true;}}
return result;},_resetTaggable:function(){var $taggable=this._getTaggableInput().focus(),selection=window.getSelection(),range=selection.getRangeAt(0),$taggingSpan;if(this._taggableEnabled){$taggingSpan=$taggable.find('.sugar_tagging');if($taggingSpan.length>0){range.selectNodeContents($taggingSpan.get(0));range.collapse(false);selection.removeAllRanges();selection.addRange(range);$taggingSpan.before($.trim($taggingSpan.text())).remove();}else{$taggable.blur().focus();}
this._removeDropdown();this._taggableEnabled=false;this._taggableListOpen=null;this._taggableLastSearchTerm=null;}},_insertTag:function(event){var $selected=$(event.currentTarget),$taggable=this._getTaggableInput(),taggableData=$selected.data(),$tagToReplace=$taggable.find('.sugar_tagging'),selection,range,$tagHtml;if(!$selected.hasClass('disabled')){$taggable.focus();selection=window.getSelection();range=selection.getRangeAt(0);$tagHtml=$(tagInEditTemplate(taggableData));range.selectNode($tagToReplace.get(0));range.insertNode($tagHtml.get(0));range.selectNode($tagHtml.get(0));range.collapse(false);selection.removeAllRanges();selection.addRange(range);$tagToReplace.before('&nbsp;').remove();$tagHtml.data({id:taggableData.id,name:taggableData.name,module:taggableData.module});this._removeDropdown();this._taggableEnabled=false;this._taggableListOpen=null;this._taggableLastSearchTerm=null;}
event.preventDefault();},_searchForTags:function(searchTerm){var searchParams,referenceSearchFields=['name','first_name','last_name'],tagAction=searchTerm.charAt(0);searchTerm=$.trim(searchTerm.substr(1));if((searchTerm.length>=this.taggableSearchAfter)&&(searchTerm!==this._taggableLastSearchTerm)){searchParams={q:searchTerm,max_num:this.taggableListLength,fields:'name'};if((this._taggableListOpen===false)&&(searchTerm.indexOf(this._taggableLastSearchTerm)===0)){this._resetTaggable();}else{if(tagAction===mention){app.data.createBeanCollection("Users").fetch({success:_.bind(function(collection,resp){if(this._taggableEnabled&&resp){this._populateTagList(collection,searchTerm);}},this),filter:this.getFilterDef("Users",searchTerm),params:{has_access_module:this._taggableModuleName,has_access_record:this._taggableModelId}});}else if(tagAction===reference){searchParams.search_fields=referenceSearchFields.join();app.api.search(searchParams,{success:_.bind(function(response){if(this._taggableEnabled&&response){this._populateTagList(app.data.createMixedBeanCollection(response.records),searchTerm);}},this)});}
this._taggableLastSearchTerm=searchTerm;}}},_populateTagList:function(collection,searchTerm){var $tagList=this._initializeDropdown(),currentSearchTerm;if(collection.length>0){searchTerm=$.trim(searchTerm);currentSearchTerm=$.trim(this._getTaggableInput().find('.sugar_tagging').text());if($.trim(currentSearchTerm.substr(1))!==searchTerm){this._taggableLastSearchTerm=null;return;}
collection.each(function(model,index){var name=Handlebars.Utils.escapeExpression(model.get('name')),htmlName=name.replace(new RegExp('('+searchTerm+')','ig'),function($1,match){return'<strong>'+match+'</strong>';}),data={module:model.get('_module'),id:model.get('id'),name:model.get('name'),htmlName:htmlName,noAccess:(model.get('has_access')===false)},$tagListOption=$(tagListOptionTemplate(data)).data(data);$tagList.append($tagListOption);},this);this._selectNextListOption(true);this._taggableListOpen=true;$tagList.show();}else{this._taggableListOpen=false;$tagList.hide();}},_initializeDropdown:function(){var $dropdown=this._getDropdown(),$taggable=this._getTaggableInput();if($dropdown.length===0){$dropdown=$(tagListContainerHtml).hide().appendTo($taggable.parent()).css('top',$taggable.outerHeight());}else{$dropdown.empty();}
return $dropdown;},_getDropdown:function(){return this.$('.activitystream-tag-dropdown');},_removeDropdown:function(){this.$('.activitystream-tag-dropdown').remove();},_getCurrentlyActiveOption:function(){return this._getDropdown().find('.active');},_selectNextListOption:function(down,$current){var $next;$current=$current||this._getCurrentlyActiveOption();if($current.length===0){$next=this._getDropdown().children().first();}else{$next=down?$current.next():$current.prev();}
if($next.length>0){$current.removeClass('active');if($next.hasClass('disabled')){this._selectNextListOption(down,$next);}else{$next.addClass('active');}}},_setListOptionAsActive:function(event){var currentTarget=this.$(event.currentTarget);if(!currentTarget.hasClass('disabled')){this._getDropdown().find('.active').removeClass('active');currentTarget.addClass('active');}},_getTaggableInput:function(){return this.$('.taggable');},_filterOutDuplicateTags:function(tags){tags=_.uniq(tags,function(tag){return tag.id;});return tags;}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/Taggable.js */


(function(app){if(!$.fn.liverelativedate){return;}
app.events.on('app:init',function(){app.plugins.register('RelativeTime',['view','field'],{onAttach:function(component){component.on('render',function(){component.$('[datetime]').liverelativedate();});},_render:function(){this.$('[datetime]').liverelativedate('destroy');Object.getPrototypeOf(this)._render.call(this);},onDetach:function(component){component.$('[datetime]').liverelativedate('destroy');}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/RelativeTime.js */


(function(app){app.events.on("app:init",function(){app.plugins.register('ErrorDecoration',['view'],{onAttach:function(component,plugin){this.on('init',function(){this.model.on('validation:start validation:success',this.clearValidationErrors,this);},this);},events:{'focus input':'showTooltip','blur input':'hideTooltip','focus textarea':'showTooltip','blur textarea':'hideTooltip'},showTooltip:function(e){_.defer(function(){var $addon=this.$(e.currentTarget).nextAll('.add-on').first();app.utils.tooltip.show($addon);},this);},hideTooltip:function(e){var $addon=this.$(e.currentTarget).nextAll('.add-on').first();app.utils.tooltip.hide($addon);},clearValidationErrors:function(fields){fields=fields||_.toArray(this.fields);if(fields.length>0){_.defer(function(){_.each(fields,function(field){if(_.isFunction(field.clearErrorDecoration)&&field.disposed!==true){field.isErrorState=false;field.clearErrorDecoration();}});},fields);}
_.defer(function(){if(this.disposed){return;}
this.$('.error').removeClass('error');this.$('.error-tooltip').remove();this.$('[data-toggle="tab"] .fa-exclamation-circle').remove();},this);}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/ErrorDecoration.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('QuickSearchFilter',['layout','view','field'],{getModuleQuickSearchMeta:function(searchModule){app.logger.warn('Plugins.QuickSearchFilter.getModuleQuickSearchMeta is deprecated since 7.6. '+'Please update your code to use Data.FiltersBean.getModuleQuickSearchMeta');var filtersBeanPrototype=app.data.getBeanClass('Filters').prototype;return filtersBeanPrototype.getModuleQuickSearchMeta(searchModule);},getModuleQuickSearchFields:function(searchModule){app.logger.warn('Plugins.QuickSearchFilter.getModuleQuickSearchFields is deprecated since 7.6. '+'Please update your code to use Data.FiltersBean.getModuleQuickSearchMeta');var filtersBeanPrototype=app.data.getBeanClass('Filters').prototype;return filtersBeanPrototype.getModuleQuickSearchMeta(searchModule).fieldNames;},getFilterDef:function(searchModule,searchTerm){app.logger.warn('Plugins.QuickSearchFilter.getFilterDef is deprecated since 7.6. '+'Please update your code to use Data.FiltersBean.buildSearchTermFilter');var filtersBeanPrototype=app.data.getBeanClass('Filters').prototype;return filtersBeanPrototype.buildSearchTermFilter(searchModule,searchTerm);}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/QuickSearchFilter.js */


(function(app){app.events.on("app:init",function(){app.plugins.register('CteTabbing',['view'],{currentIndex:-1,currentCTEList:[],onAttach:function(component,plugin){this.once('init',function(){this.context.on('field:editable:click',this.handleClickIndex,this);$(window).on('keydown.'+this.cid,_.bind(function(e){if(this.layout.isVisible()){this.handleKeyDown(e);}},this));this.on('render',this.resetCTEList,this);},this);},onDetach:function(component,plugin){this.context.off('field:editable:click');$(window).off('keydown.'+this.cid);},handleKeyDown:function(e){if(e.which==9){e.preventDefault();if(!e.shiftKey){if(this.currentIndex+1<this.currentCTEList.length){this.currentIndex++;}else{this.currentIndex=0;}}else{if(this.currentIndex-1>=0){this.currentIndex--;}else{this.currentIndex=this.currentCTEList.length-1;}}
$(this.currentCTEList[this.currentIndex]).find("div.clickToEdit").click();}},resetCTEList:function(){var oldLength=this.currentCTEList.length
this.currentCTEList=this.$el.find('.isEditable');if(oldLength>this.currentCTEList.length){this.currentIndex--;}},handleClickIndex:function(field){_.find(this.currentCTEList,function(el,idx,list){var $el=$(el);if(_.isEqual($el.find("div.clickToEdit").data('cid'),field.cid)){this.currentIndex=idx;return true;}},this);}});app.plugins.register('ClickToEdit',['field'],{events:{'mouseenter div.clickToEdit':'showClickToEdit','mouseleave div.clickToEdit':'hideClickToEdit','click div.clickToEdit':'handleFieldClick'},isIe9Or10:$.browser.msie&&($.browser.version==='9.0'||($.browser.version==='10.0'&&!!navigator.userAgent.match(/Trident\/6\./))),_canEdit:false,_isInEdit:false,errorMessage:'',isErrorState:false,onAttach:function(component,plugin){this.once('init',_.bind(function(){if(this.checkIfCanEdit()){this.bindPluginEvents();}},this));},onDetach:function(){$(document).off('mousedown.record'+this.cid);app.utils.tooltip.destroy(this.$('[rel=tooltip]'));},bindPluginEvents:function(){this.context.on('field:editable:open',function(cid){if(this.isErrorState){this.context.trigger('field:editable:error',this.cid);}else if(this._isInEdit==true&&this.cid!==cid){if(this.type=='enum'){this.$("select").select2("close");}
if(this.type!='date'){this.setMode('list');}}},this);this.context.on('field:editable:error',function(cid){if(!_.isEqual(cid,this.cid)&&this.options.viewName=='edit'){this.setMode('list');}},this);this.on('render',function(){var cteClass='clickToEdit';if(this.action==='edit'){cteClass+=' active';this.$el.addClass('active');}else{this.$el.removeClass('active');}
this.$el.addClass('isEditable');this.$el.wrapInner('<div class="'+cteClass+'" data-cid="'+this.cid+'" />');},this);if(this.context.parent){this.context.parent.on('change:selectedUser',function(){if(this.isErrorState){this.clearErrorDecoration();}},this);}},checkIfCanEdit:function(){var isEnforce=(!_.isUndefined(this.def.enforced)&&this.def.enforced===true),isClickToEdit=(!_.isUndefined(this.def.click_to_edit)&&this.def.click_to_edit===true);if(!isEnforce&&isClickToEdit){var ctx=this.context.parent||this.context;var selectedUser=ctx.get('selectedUser')||app.user.toJSON();this._canEdit=_.isEqual(app.user.get('id'),selectedUser.id);this._canEdit=(this._canEdit&&app.acl.hasAccess('write',this.module,app.user.get('id'),this.name));if(this._canEdit&&this.model.has('sales_stage')){var salesStage=this.model.get('sales_stage'),disableIfSalesStageIs=_.union(app.metadata.getModule('Forecasts','config').sales_stage_won,app.metadata.getModule('Forecasts','config').sales_stage_lost);if(salesStage&&_.indexOf(disableIfSalesStageIs,salesStage)!=-1){this._canEdit=false;}}}
return this._canEdit;},bindDomChange:function(){if(this.type==='date')return;if(!(this.model instanceof Backbone.Model))return;var self=this;var el=this.$el.find(this.fieldTag);el.on("change",function(){var value=self.validateField(self,el.val());if(value!==false){if(self.isErrorState){self.clearErrorDecoration();}
self.model.set(self.name,self.unformat(value));}else{var hb=Handlebars.compile("{{str key module context}}"),args={field_name:app.lang.get(self.def.label,self.module)};self.errorMessage=hb({'key':'LBL_EDITABLE_INVALID','module':self.module,'context':args});self.showErrors();el.select();}});if(this.isIe9Or10&&el.is("input")){_.defer(function(el){el.on("input",function(){el.focus();});},el);}},showErrors:function(){var $errorTooltips;if(this.isErrorState===false){this.isErrorState=true;var ctx=this.context.parent||this.context;ctx.trigger('field:error',this,true);this.$el.addClass('error');this.$('.error-tooltip').addClass('add-on local').removeClass('hide').css('display','inline-block');this.$('input').addClass('local-error');$errorTooltips=this.$('[rel=tooltip]');app.utils.tooltip.initialize($errorTooltips,{title:this.errorMessage,trigger:'manual'});$errorTooltips.each(function(){app.utils.tooltip.show(this);});$errorTooltips.hide();}},clearErrorDecoration:function(){app.utils.tooltip.destroy(this.$('[rel=tooltip]'));this.isErrorState=false;var ctx=this.context.parent||this.context;ctx.trigger('field:error',this,false);this.errorMessage='';},showClickToEdit:function(event){if(this._canEdit&&!this._isInEdit){var target=$(event.currentTarget);var icon='<span class="edit-icon"><i class="fa fa-pencil fa-sm"></i></span>';if(target.has('label.original').length==1){target=target.find('label.original').next();}
if(target.has('div.ellipsis_inline').length==1){target=target.find('div.ellipsis_inline');}
target.prepend(icon);}},hideClickToEdit:function(event){if(this._canEdit&&!this._isInEdit){$(event.currentTarget).find('span.edit-icon').remove();}},handleFieldClick:function(event){if(this._canEdit&&!this._isInEdit){this.context.trigger("field:editable:click",this);this.setMode('edit');if(_.isFunction(this.focus)){this.focus();}else{var $el=this.$(this.fieldTag+":first");$el.focus().val($el.val()).select();}
if(this.type!=='image'){if(_.isFunction(this.bindKeyDown)){this.bindKeyDown(_.bind(this.keyDowned,this));}else{this.$(this.fieldTag).on("keydown.record"+this.cid,{field:this},_.bind(this.keyDowned,this));}
$(document).on("mousedown.record"+this.cid,{field:this},_.bind(this.mouseClicked,this));}
if(this.type==="enum"){this.model.once('change:'+this.name,function(){this.setMode('list');},this);}
if(this.type==="date"){this.$el.closest('td').addClass('td-inline-edit');}}},keyDowned:function(evt){this.handleKeyDown.call(this,evt,evt.data.field);},mouseClicked:_.debounce(function(evt){this.fieldClose.call(this,evt,evt.data.field);},0),fieldClose:function(evt,field){var currFieldParent=field.$el,targetPlaceHolder=this.$(evt.target).parents("span[sfuuid='"+field.sfId+"']"),preventPlaceholder=this.$(evt.target).closest('.prevent-mousedown');if(preventPlaceholder.length>0||targetPlaceHolder.length>0||currFieldParent.find(":focus").length>0||!_.isEmpty(app.drawer._components)){return;}
if(this.isErrorState){this.$el.find(this.fieldTag).focus().select();return;}
this.setMode('list');},handleKeyDown:function(e,field){if(field.disposed){return;}
if(e.which==27){this.setMode('list');}else if(e.which==13){if(this.fieldValueChanged(field)){this.model.once('change:'+field.name,function(){this.setMode('list');},this);}else{this.setMode('list');}}},fieldValueChanged:function(field){var elVal=field.$el.find(field.fieldTag).val();if(field.type=='currency'||field.type=='int'){elVal=this._parsePercentage(elVal,(field.type=='currency')?undefined:0);}
if(field.type=='currency'){var diff=Math.abs(this.unformat(elVal)-this.unformat(field.value));return((Math.round(diff*100))!=0)}else if(field.type=='date'){if(_.isUndefined(elVal)){elVal=field.$el.find('div').html();}
return!_.isEqual(this.unformat(elVal),this.unformat(field.value));}else{return!_.isEqual(this.unformat(elVal),this.unformat(field.value));}},setMode:function(name){if(name==="list"){this.$(this.fieldTag).off("keydown.record"+this.cid);$(document).off("mousedown.record"+this.cid);}
if(this.isErrorState){this.clearErrorDecoration();}
app.view.Field.prototype.setMode.call(this,name);this._isInEdit=(this.action==='edit');if(this._isInEdit){this.context.trigger('field:editable:open',this.cid);}else{this.$el.removeClass('error');}
if(this.action!=='edit'&&this.type=='date'){this.$el.closest('td').removeClass('td-inline-edit');}},validateField:function(field,newValue){if(_.isUndefined(newValue)||_.isEmpty(newValue)){newValue=this.$el.find(this.fieldTag).val();}
if(field.type==='int'){newValue=this._parsePercentage(newValue,0);if(this._verifyIntValue(newValue)){return newValue;}}else if(field.type==='currency'){newValue=this._parsePercentage(newValue);if(this._verifyCurrencyValue(newValue)){return newValue;}}else if(field.type==='date'){if(this._verifyDateString(newValue)){return newValue;}}else{return newValue;}
return false;},_verifyCurrencyValue:function(value){value=value.toString().trim();var config=app.metadata.getConfig(),d_separator=app.user.getPreference('decimal_separator')||config.defaultDecimalSeparator||'.',ug_separator=app.user.getPreference('number_grouping_separator'),g_separator=!_.isUndefined(ug_separator)?ug_separator:config.defaultNumberGroupingSeparator||',',currency=app.user.getPreference('currency_id')||app.currency.getBaseCurrencyId(),currency_symbol=app.currency.getCurrencySymbol(currency),regex=new RegExp("^("+this._escapeRegexCharacter(currency_symbol)+")?(([\\d]{1,3}(?:"+this._escapeRegexCharacter(g_separator)+"?[\\d]{3})*)?((?:"+this._escapeRegexCharacter(d_separator)+"[\\d]+)))"),parts=value.match(regex);if(value.length==0||_.isNull(parts)||_.isEmpty(parts[0])||parts[0]!=value){return false;}
return true;},_escapeRegexCharacter:function(character){var needs_escape=['.','\\','+','*','?','[','^',']','$','(',')','{','}','=','!','<','>','|',':','-'];if(_.indexOf(needs_escape,character)!=-1){character='\\'+character;}
return character;},_verifyIntValue:function(value){var regex=new RegExp("^\\d+$"),match=value.toString().match(regex);if(_.isNull(match)){return false;}
if(!_.isUndefined(this.def.validation)&&this.def.validation.type=='range'){if(!_.isUndefined(this.def.validation.min)&&!_.isUndefined(this.def.validation.max)){if(value<this.def.validation.min||value>this.def.validation.max){return false}}}
return true;},_verifyDateString:function(value){return _.isUndefined(app.validation.validators.datetime(this,value))},_parsePercentage:function(value,decimals){var orig=this.model.get(this.name),config=app.metadata.getConfig(),d_separator=app.user.getPreference('decimal_separator')||config.defaultDecimalSeparator||'.',ug_separator=app.user.getPreference('number_grouping_separator'),g_separator=(!_.isUndefined(ug_separator))?ug_separator:config.defaultNumberGroupingSeparator||',',regex=new RegExp("^([+-])(([\\d]{1,3}(?:"+this._escapeRegexCharacter(g_separator)+"[\\d]{3})*|(?:[\\d]))*((?:"+this._escapeRegexCharacter(d_separator)+"[\\d]+))?)(\\%)?"),parts=value.toString().match(regex),is_percent=(parts&&parts[5]=="%"),do_addition=(parts&&parts[1]=="+"),do_subtraction=(parts&&parts[1]=="-");if(parts&&parts[0]==value&&parts[2]!="0"){var amount=this.unformat(parts[2]);if(is_percent){value=app.math.mul(app.math.div(amount,100),orig);}else{value=amount;}
if(do_addition){value=app.math.add(orig,value);}else if(do_subtraction){value=app.math.sub(orig,value);}
value=app.math.round(value,decimals);}
return this.format(value.toString());},handleHideDatePicker:function(){var $field=this.$(this.fieldTag),value=$field.val();if(_.isEmpty(value)){$field.val(this.format());return;}
value=this.unformat(value);if(!_.isEmpty(value)){this.model.set(this.name,value);this.setMode('list');return;}}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/ClickToEdit.js */


(function(app){app.events.on("app:init",function(){app.plugins.register("GridBuilder",["view"],{getGridBuilder:function(params){function Row(options){this.initialize(options);}
_.extend(Row.prototype,{initialize:function(options){this.cells=[];this.span=0;this.maxSpan=options.maxSpan||12;this.maxCells=options.maxCells||1;},addCell:function(field,tabIndex){if(!_.isEmpty(tabIndex)){field.index=tabIndex;}
this.cells.push(field);this.span+=field.cellSpan;},hasMoreRoom:function(cellSpan){if(this.cells.length==this.maxCells||(this.span+cellSpan)>this.maxSpan){return false;}
return true;}});function GridBuilder(options){this.initialize(options);}
_.extend(GridBuilder.prototype,{initialize:function(options){options=options||{};options.fields=options.fields||{};this.grid=[];this.fields=app.utils.deepCopy(options.fields);this.maxRowSpan=12;this.maxColumns=options.columns||1;this.tabIndex=options.tabIndex||0;},build:function(){var grid=[];_.each(this.grid,function(row,index){grid[index]=[];_.each(row.cells,function(cell){grid[index].push(cell);},this);},this);this.grid=grid;return this._getGrid();},addRow:function(){var row=new Row({maxSpan:this.maxRowSpan,maxCells:this.maxColumns});this.grid.push(row);return row;},addField:function(field){var currentRow;if(this.grid.length<1){currentRow=this.addRow();}else{currentRow=this.grid[this.grid.length-1];}
if(!currentRow.hasMoreRoom(field.cellSpan)){currentRow=this.addRow();}
currentRow.addCell(field,++this.tabIndex);},_getGrid:function(){return{grid:this.grid,lastTabIndex:this.tabIndex};},_calculateFieldSpan:function(field){if(_.isUndefined(field.span)){field.span=Math.floor(this.maxRowSpan / this.maxColumns);}
if(field.span<1){field.span=1;}
if(field.span>this.maxRowSpan){field.span=this.maxRowSpan;}
field.cellSpan=field.span;}});var LabelsInlineGridBuilder=function(options){this.initialize(options);}
app.utils.extendFrom(LabelsInlineGridBuilder,GridBuilder,{build:function(){_.each(this.fields,function(field){this._calculateFieldSpan(field);if(_.isUndefined(field.labelSpan)){field.labelSpan=Math.floor(4 / this.maxColumns);}
if(field.labelSpan<1){field.labelSpan=1;}
if(_.isUndefined(field.dismiss_label)){field.dismiss_label=false;}
if(field.dismiss_label!==true){field.span-=field.labelSpan;if(field.span<1){field.span=1;}}
this.addField(field);},this);return GridBuilder.prototype.build.call(this);}});var LabelsOnTopGridBuilder=function(options){this.initialize(options);}
app.utils.extendFrom(LabelsOnTopGridBuilder,GridBuilder,{build:function(){_.each(this.fields,function(field){this._calculateFieldSpan(field);if(_.isUndefined(field.labelSpan)){field.labelSpan=field.span}
if(_.isUndefined(field.dismiss_label)){field.dismiss_label=false;}
this.addField(field);},this);return GridBuilder.prototype.build.call(this);}});var options={fields:params.fields,columns:params.columns,tabIndex:params.tabIndex};if(params.labelsOnTop===false&&params.labels){return new LabelsInlineGridBuilder(options);}else{return new LabelsOnTopGridBuilder(options);}}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/GridBuilder.js */


(function(app){app.events.on("app:init",function(){app.plugins.register('ListDisableSort',['view'],{onAttach:function(component,plugin){component._createCatalog=_.wrap(component._createCatalog,function(func,fields){_.each(fields,function(field){field.sortable=false;});return func.call(component,fields);});}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/ListDisableSort.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('Editable',['view'],{onAttach:function(component,plugin){this.editableKeyDowned=_.bind(function(evt){this.editableHandleKeyDown.call(this,evt,evt.data.field);},this);this.editableMouseClicked=_.bind(function(evt){this.editableHandleMouseDown.call(this,evt,evt.data.field);},this);this.on('init',function(){app.routing.before('route',this.beforeRouteChange,this,true);$(window).on('beforeunload.'+this.cid,_.bind(this.warnUnsavedChangesOnRefresh,this));this.before('unsavedchange',this.beforeViewChange,this,true);if(_.isEmpty(app.additionalComponents['drawer'])){return;}
app.drawer.before('reset',this.beforeRouteChange,this,true);app.events.on('editable:beforehandlers:off',this.unbindBeforeHandler,this);this._currentUrl=Backbone.history.getFragment();});},beforeRouteChange:function(params){var onConfirm=_.bind(this.onConfirmRoute,this);return this.warnUnsavedChanges(onConfirm);},beforeViewChange:function(param){if(!(param&&_.isFunction(param.callback))){app.logger.error('Custom unsavedchange must contain callback function.');return true;}
var onConfirm=_.bind(function(){if(param.callback&&_.isFunction(param.callback)){param.callback.call(this);}},this);return this.warnUnsavedChanges(onConfirm,param.message);},warnUnsavedChanges:function(onConfirm,customMessage,onCancel){if(this.resavingAfterMetadataSync){return false;}
this.$(':focus').trigger('change');if(_.isFunction(this.hasUnsavedChanges)&&this.hasUnsavedChanges()){this._targetUrl=Backbone.history.getFragment();app.router.navigate(this._currentUrl,{trigger:false,replace:true});app.alert.show('leave_confirmation',{level:'confirmation',messages:app.lang.get(customMessage||'LBL_WARN_UNSAVED_CHANGES',this.module),onConfirm:onConfirm,onCancel:onCancel||$.noop});return false;}
return true;},warnUnsavedChangesOnRefresh:function(){if(this.resavingAfterMetadataSync){return false;}
if(_.isFunction(this.hasUnsavedChanges)&&this.hasUnsavedChanges()){return app.lang.get('LBL_WARN_UNSAVED_CHANGES',this.module);}
return;},onConfirmRoute:function(){app.events.trigger('editable:beforehandlers:off');if(this._currentUrl===this._targetUrl){app.router.refresh();}else{app.router.navigate(this._targetUrl,{trigger:true});}},toggleFields:function(fields,isEdit,callback){if(!_.isArray(fields)){return;}
var viewName=!!isEdit?'edit':this.action,numOfToggledFields=fields.length;_.each(fields,function(field){if(field.action===viewName){numOfToggledFields--;return;}
var meta=field.def;if(meta&&isEdit&&meta.readonly){numOfToggledFields--;return;}
_.defer(function(field){if(field.disposed!==true){field.setMode(viewName);field.$el.closest('.record-cell').toggleClass('edit',(viewName==='edit'));numOfToggledFields--;if((numOfToggledFields===0)&&_.isFunction(callback)){callback();}}},field);this.turnOffFieldEvents(field);},this);},turnOffFieldEvents:function(field){if(_.isFunction(field.unbindKeyDown)){field.unbindKeyDown(this.editableKeyDowned);}else{field.$(field.fieldTag).off('keydown.record',this.editableKeyDowned);}
$(document).off('mousedown.record'+field.name,this.editableMouseClicked);},turnOffEvents:function(fields){_.each(fields,function(field){this.turnOffFieldEvents(field);},this);},toggleField:function(field,isEdit){var viewName;if(_.isUndefined(isEdit)){viewName=(field.tplName===this.action)?'edit':this.action;}else{viewName=!!isEdit?'edit':this.action;}
if(!field.triggerBefore('toggleField',viewName)){return false;}
field.setMode(viewName);if(viewName==='edit'){if(_.isFunction(field.focus)){field.focus();}else{var $el=field.$(field.fieldTag+':first');$el.focus().val($el.val());}
if(_.isFunction(field.bindKeyDown)){field.bindKeyDown(this.editableKeyDowned);}else{field.$(field.fieldTag).on('keydown.record',{field:field},this.editableKeyDowned);}
if(_.isFunction(field.bindDocumentMouseDown)){field.bindDocumentMouseDown(this.editableMouseClicked);}else{$(document).on('mousedown.record'+field.name,{field:field},this.editableMouseClicked);}
field.$el.closest('.record-cell').toggleClass('edit',true);}else{if(_.isFunction(field.unbindKeyDown)){field.unbindKeyDown();}else{field.$(field.fieldTag).off('keydown.record');}
$(document).off('mousedown.record'+field.name);field.$el.closest('.record-cell').toggleClass('edit',false);}},nextField:function(field,direction){if(!field){return;}
field.$(field.fieldTag).trigger('change');direction=_.contains(['nextField','prevField'],direction)?direction:'nextField';var nextField=field[direction];if(!nextField){return;}
if(_.isFunction(this.toggleMoreLess)&&nextField.$el.closest('.panel_hidden').hasClass('hide')){this.toggleMoreLess('more');}
this.toggleField(field,false);while(nextField.isDisabled()){if(nextField[direction]){nextField=nextField[direction];}else{break;}}
if(!nextField.isDisabled()){this.toggleField(nextField,true);}},editableHandleMouseDown:function(evt,field){if(field.tplName===this.action){return;}
var currFieldParent=field.$el,targetPlaceHolder=this.$(evt.target).parents("span[sfuuid='"+field.sfId+"']"),preventPlaceholder=this.$(evt.target).closest('.prevent-mousedown');var inPreventPlaceholder=(preventPlaceholder.length>0);var inTargetPlaceholder=(targetPlaceHolder.length>0);var isFocusInField=(currFieldParent.find(':focus').length>0);var drawerOpened=!_.isEmpty(app.drawer._components);if(inPreventPlaceholder||inTargetPlaceholder||isFocusInField||drawerOpened){return;}
this.toggleField(field,false);this.trigger('editable:mousedown',evt,field);},editableHandleKeyDown:function(evt,field){if(evt.which==27){this.toggleField(field,false);}
this.trigger('editable:keydown',evt,field);},unbindBeforeHandler:function(){app.routing.offBefore('route',this.beforeRouteChange,this);$(window).off('beforeunload.'+this.cid);if(_.isEmpty(app.additionalComponents['drawer'])){return;}
app.drawer.offBefore('reset',this.beforeRouteChange,this);this.offBefore('unsavedchange');},onDetach:function(){$(document).off('mousedown',this.editableMouseClicked);this.editableKeyDowned=null;this.editableMouseClicked=null;app.events.off('editable:beforehandlers:off',null,this);this.unbindBeforeHandler();}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/Editable.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('ListEditable',['field'],{_loadTemplate:function(){Object.getPrototypeOf(this)._loadTemplate.call(this);if(this.view.action==='list'&&_.contains(['edit','disabled'],this.tplName)){var tplName='list-'+this.tplName;this.template=app.template.getField(this.type,tplName,this.module,this.tplName)||app.template.empty;this.tplName=tplName;}}});})})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/ListEditable.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('ListRemoveLinks',['view'],{onAttach:function(component,plugin){var removeLinks=function(){component.$('a:not(.rowaction, .dropdown-toggle, .dropdown-menu *)').contents().unwrap();};component.on('render',removeLinks,null,component);app.events.on('list:preview:decorate',removeLinks,this);},onDetach:function(){app.events.off('list:preview:decorate',null,this);}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/ListRemoveLinks.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('File',['field'],{bindKeyDown:function(){},bindDocumentMouseDown:function(){}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/File.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('FieldDuplicate',['field'],{_duplicateBeanId:null,_duplicateBeanModule:null,duplicateFromModel:function(id,module){this._duplicateBeanId=id;this._duplicateBeanModule=module;},_onFieldDuplicate:function(model){var id=null,module=null;if(model instanceof Backbone.Model){id=model.get('id');module=model.module;}
this.duplicateFromModel((this.model&&this.model.get('id')===id)?null:id,(this.module&&this.module===module)?null:module);if(_.isFunction(this.onFieldDuplicate)){this.onFieldDuplicate.call(this,model);}},_beforeFieldDuplicate:function(params){if(_.isFunction(this.beforeFieldDuplicate)){return this.beforeFieldDuplicate.call(this,params);}
return true;},_formatFieldForDuplicate:function(){if(!this.disposed&&_.isFunction(this.formatFieldForDuplicate)){this.formatFieldForDuplicate.call(this);this.render();}},_unformatFieldForDuplicate:function(){if(_.isFunction(this.unformatFieldForDuplicate)){this.unformatFieldForDuplicate.call(this);}},onAttach:function(component,plugin){this.on('init',function(){if(this.model){this.model.on('change:'+this.name,function(){this._onFieldDuplicate();},this);this.model.on('duplicate:field',this._onFieldDuplicate,this);this.model.on('duplicate:field:'+this.name,this._onFieldDuplicate,this);this.model.on('data:sync:start',function(method,options){if(!_.isNull(this._duplicateBeanId)&&(method=='update'||method=='create')){options.params=options.params||{};options.params[this.name+'_duplicateBeanId']=this._duplicateBeanId;}},this);this.model.on('duplicate:field:prepare:save',function(model){if(this.model.get(this.name)){model[this.name+'_duplicateBeanId']=this._duplicateBeanId;}},this);this.model.on('duplicate:format:field',this._formatFieldForDuplicate,this);this.model.on('duplicate:unformat:field',this._unformatFieldForDuplicate,this);}
if(this.view){this.view.before('duplicate:field',this._beforeFieldDuplicate,{},this);}});},onDetach:function(component,plugin){if(this.view){this.view.offBefore('duplicate:field');}}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/FieldDuplicate.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('LinkedModel',['view','field'],{createLinkModel:function(parentModel,link){if(this.context&&this.context.parent&&this.context.parent.isCreate())
{return app.data.createBean(app.data.getRelatedModule(parentModel.module,link));}
var model=app.data.createRelatedBean(parentModel,null,link),relatedFields=app.data.getRelateFields(parentModel.module,link),parentModule=app.metadata.getModule(parentModel.module);if(parentModule&&parentModule.fields[link]&&parentModule.fields[link].populate_list){model.relatedAttributes=model.relatedAttributes||{};this._parsePopulateList(parentModule.fields[link].populate_list,parentModel,model);}
if(!_.isEmpty(relatedFields)){model.relatedAttributes=model.relatedAttributes||{};_.each(relatedFields,function(field){var parentValue=parentModel.get(field.rname);if(!parentValue&&parentModel.fields[field.rname]&&parentModel.fields[field.rname].type=='fullname'){parentValue=parentModel.get('full_name');}
model.set(field.name,parentValue);model.set(field.id_name,parentModel.get('id'));model.relatedAttributes[field.name]=parentModel.get(field.rname);model.relatedAttributes[field.id_name]=parentModel.get('id');if(field.populate_list){this._parsePopulateList(field.populate_list,parentModel,model);}},this);}
this.populateParentFields(model,parentModel);return model;},_parsePopulateList:function(populate_list,parentModel,model){_.each(populate_list,function(target,source){source=_.isNumber(source)?target:source;if(!_.isUndefined(parentModel.get(source))&&app.acl.hasAccessToModel('edit',model,target)){model.set(target,parentModel.get(source));model.relatedAttributes[target]=parentModel.get(source);}},this);},createRelatedRecord:function(module,link,id){var bwcExceptions=['Emails'],moduleMeta=app.metadata.getModule(module);if(moduleMeta&&moduleMeta.isBwcEnabled&&!_.contains(bwcExceptions,module)){this.routeToBwcCreate(module,id);}else{this.openCreateDrawer(module,link);}},routeToBwcCreate:function(module,id){var proto=Object.getPrototypeOf(this);if(_.isFunction(proto.routeToBwcCreate)){return proto.routeToBwcCreate.call(this,module);}
var parentModel=this.context.parent.get('model'),link=this.context.get('link');app.bwc.createRelatedRecord(module,parentModel,link,id);},openCreateDrawer:function(module,link){var proto=Object.getPrototypeOf(this);if(_.isFunction(proto.openCreateDrawer)){return proto.openCreateDrawer.call(this,module,link);}
link=link||this.context.get('link');var context=(this.context.get('name')==='tabbed-dashlet')?this.context:(this.context.parent||this.context);var parentModel=context.get('model')||context.parent.get('model'),model=this.createLinkModel(parentModel,link),self=this;app.drawer.open({layout:'create-actions',context:{create:true,module:model.module,model:model}},function(context,model){if(!model){return;}
self.context.resetLoadFlag();self.context.set('skipFetch',false);if(_.isFunction(self.loadData)){self.loadData();}});},populateParentFields:function(model,parentModel){var parentModule=parentModel.module||parentModel.get("module")||parentModel.get("_module");_.each(model.fields,function(def,name){if(def.type&&def.type=="parent"){if(app.lang.getAppListStrings(def.options)[parentModule]){model.set(def.type_name,parentModule);if(parentModel.get("id")){model.set(def.id_name,parentModel.get("id"));model.set(def.name,parentModel.get("full_name")||parentModel.get("document_name")||parentModel.get("name")||"");}}}});if(parentModule=="Contacts"&&parentModel.get("account_id")&&model.get("contact_id")){model.set({parent_type:"Accounts",parent_id:parentModel.get("account_id"),parent_name:parentModel.get("account_name")});}}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/LinkedModel.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('ToggleVisibility','view',{events:{'click [data-action=visibility-switcher]':'visibilitySwitcher'},visibilityKey:'visibility',defaultVisibility:'user',onAttach:function(){this.on('init',function(){if(!this.meta.last_state){this.meta.last_state={id:this.dashModel.get('id')+':'+this.name,defaults:{}};}
this._initVisibility();});},_initVisibility:function(){var config=app.metadata.getView(this.module,this.name),visibilityField=_.chain(config.panels).map(function(obj){return obj.fields;}).flatten().findWhere({name:this.visibilityKey}).value();if(!visibilityField){return;}
if(_.contains(this.plugins,'Dashlet')){this.settings.on('change:'+this.visibilityKey,function(model,value){this._setVisibilityLastState(value);},this);this.settings.set(this.visibilityKey,this.getVisibility());}else{if(!this.hasVisibility()){this.setVisibility(this.getVisibility());}}},_setVisibilityLastState:function(visibility){if(!this.meta.last_state.defaults[this.visibilityKey]){this.meta.last_state.defaults[this.visibilityKey]=visibility;}
app.user.lastState.register(this);var specificVisibilityKey=app.user.lastState.key(this.visibilityKey,this);app.user.lastState.set(specificVisibilityKey,visibility);},visibilitySwitcher:function(event){var proto=Object.getPrototypeOf(this),visibility=this.$(event.currentTarget).val();if(visibility===this.getVisibility()){return;}
this.setVisibility(visibility);if(_.isFunction(proto.visibilitySwitcher)){proto.visibilitySwitcher.call(this,event);}
this.loadData();},getVisibility:function(){var visibility=app.user.lastState.get(app.user.lastState.key(this.visibilityKey,this),this);if(!visibility&&this.settings){visibility=this.settings.get(this.visibilityKey);}
return visibility||this.defaultVisibility;},setVisibility:function(visibility){if(_.contains(this.plugins,'Dashlet')){this.settings.set(this.visibilityKey,visibility);}else{this._setVisibilityLastState(visibility);}},hasVisibility:function(){var visibility=app.user.lastState.get(app.user.lastState.key(this.visibilityKey,this),this);if(!visibility&&this.settings){visibility=this.settings.has(this.visibilityKey);}
return!!visibility;}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/ToggleVisibility.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('Pagination',['view'],{onAttach:function(component,plugin){this.on('init',function(){this.rowTemplate=app.template.getView(this.name+'.row',this.module)||app.template.getView(this.name+'.row')||this.rowTemplate;if(!_.contains(this.plugins,'Dashlet')||this.meta.config){return;}
if(this.layout){this.layout.on('init',this._initPaginationBottom,this);}},this);this.on('render',function(){this.$tableBody=this.$(this.tbodyTag||'tbody');},this);},_initPaginationBottom:function(){if(!this.layout){return;}
var pageComponent=this.layout.getComponent('list-bottom');if(pageComponent){return;}
pageComponent=app.view.createView({context:this.context,name:'list-bottom',meta:{template:'list-bottom.dashlet-bottom'},module:this.module,primary:false,layout:this.layout});this.layout.addComponent(pageComponent);},getNextPagination:function(options){var beanCollection;if(_.isFunction(this.getPaginationCollection)){beanCollection=this.getPaginationCollection();}
beanCollection=beanCollection||this.collection;if(!beanCollection.dataFetched){return;}
options=options||{};var originalOptions=_.extend({},this.collection.options,options);var defaultOnSuccess=options.success;options.success=null;if(_.isFunction(this.getPaginationOptions)){options=_.extend({},options,this.getPaginationOptions()||{});}
options.add=true;var origOnSuccess=options.success;options.success=_.bind(function(collection,data){if(_.isFunction(defaultOnSuccess)){defaultOnSuccess(collection,data);}
if(_.isFunction(origOnSuccess)){origOnSuccess(collection,data);}
if(this.disposed){return;}
if(this.module!==collection.module){this.rowTemplate=app.template.getView(this.name+'.row',collection.module)||this.rowTemplate;}
if(_.isEmpty(this.$tableBody)||!this.rowTemplate){app.logger.warn('Create a row.hbs template to avoid a full render.');this.render();return;}
if(!this.triggerBefore('render:rows',data)){return false;}
_.each(data,function(model){this._renderRow(this.collection.get(model.id));},this);this.trigger('render:rows');this.trigger('render');},this);if(this.limit){options.limit=this.limit;}
var _complete=options.complete;options.complete=_.bind(function(xhr,status){if(_.isFunction(_complete)){_complete.call(this,xhr,status);}
this.collection.options=originalOptions;},this);beanCollection.paginate(options);},_renderRow:function(model){this.rowModel=model;var $row=$(this.rowTemplate(this)),self=this;this.$tableBody.append($row);$row.find('span[sfuuid]').each(function(){var $this=$(this),sfId=$this.attr('sfuuid');if(self.fields[sfId]){self.fields[sfId].setElement($this);self.fields[sfId].render();}});}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/Pagination.js */


(function(app){app.events.on('app:init',function(){var getShortcutList=function(layout){return layout.options.meta.shortcuts||layout.shortcuts;};app.plugins.register('ShortcutSession',['layout'],{onAttach:function(){var shortcutList=getShortcutList(this);if(shortcutList){app.shortcuts.createSession(shortcutList,this);}}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/ShortcutSession.js */


(function(app){app.events.on("app:sync:complete",function(){if(!app.data.getModelClasses()['Contacts']){return;}
var contactsClass=app.data.getBeanClass("Contacts");contactsClass.prototype._doValidatePortalName=function(fields,errors,callback){var self=this,skip=false;if(_.isUndefined(this.get("id"))){if(!this.has("portal_name")||this.get("portal_name")===""){skip=true;}}else{if(_.isUndefined(this.changedAttributes(this.getSyncedAttributes())["portal_name"])){skip=true;}}
if(skip){callback(null,fields,errors);return;}
var currentName=self.get("portal_name");var alertOptions={title:app.lang.get("LBL_VALIDATING"),level:"process"};app.alert.show('validation',alertOptions);app.api.records('read','Contacts',null,{filter:[{portal_name:currentName}]},{success:function(data){if(data.records&&data.records.length>0){if(data.records.length>1||data.records[0].id!=self.get("id")){errors['portal_name']={ERR_EXISTING_PORTAL_USERNAME:''};}}},error:function(){errors['portal_name']={ERR_PORTAL_NAME_CHECK:''};},complete:function(){app.alert.dismiss('validation');callback(null,fields,errors);}});return;};contactsClass.prototype.initialize=function(options){app.data.beanModel.prototype.initialize.call(this,options);this.addValidationTask('portal_name_unique',_.bind(this._doValidatePortalName,this));};});})(SUGAR.App);
/* End of File modules/Contacts/clients/base/lib/bean.js */


(function(app){app.events.on("app:init",function(){app.plugins.register('DirtyCollection',['view'],{dirtyModels:new Backbone.Collection(),dirtyTimeperiod:undefined,dirtyUser:undefined,dirtyCanEdit:undefined,onAttach:function(component,plugin){this.on('init',function(){this.attachListeners();},this);},onDetach:function(){this.dirtyModels.off(null,null,this);},attachListeners:function(){this.collection.on('reset',this.cleanUpDirtyModels,this);this.collection.on("change",this._collectionChangeAddToDirtyModels,this);},_collectionChangeAddToDirtyModels:function(model){if(_.isUndefined(this.dirtyTimeperiod)||_.isUndefined(this.dirtyUser)){var ctx=this.context.parent||this.context;this.dirtyTimeperiod=ctx.get('selectedTimePeriod');this.dirtyUser=ctx.get('selectedUser');this.dirtyCanEdit=(this.dirtyUser.id==app.user.get('id'));;}
this.dirtyModels.add(model);},isDirty:function(){return(this.dirtyModels.length>0);},cleanUpDirtyModels:function(){this.dirtyModels.reset();this.dirtyTimeperiod=undefined;this.dirtyUser=undefined;this.dirtyCanEdit=undefined;}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/DirtyCollection.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('Prettify',['layout','view'],{_scriptReady:false,_pageReady:false,onAttach:function(component,plugin){this.on('init',function(){var self=this;if(window.prettyPrint){this._scriptReady=true;return;}
$.getScript('styleguide/content/js/google-code-prettify/prettify.js',function(){self._scriptReady=true;if(self._pageReady){prettyPrint();}});},null,component);this.on('render',function(){this._pageReady=true;if(this._scriptReady){prettyPrint();}},null,component);}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/Prettify.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('Chart',['view'],{chart_loaded:false,chartCollection:null,chart:null,total:0,onAttach:function(component,plugin){this.on('init',function(){if(this.meta.config){return;}
app.events.on('preview:close',function(){if(_.isUndefined(app.drawer)||app.drawer.isActive(this.$el)){this.resize();}},this);this.layout.on('dashlet:collapse',function(collapse){if(!collapse){this.resize();}},this);this.layout.context.on('dashlet:draggable:stop',function(){this.resize();},this);$(window).on('resize.'+this.cid,_.debounce(_.bind(this.resize,this),100));this.handlePrinting('on');if(!_.isFunction(this.chartResize)){this.chartResize=this._chartResize;}
if(!_.isFunction(this.hasChartData)){this.hasChartData=this._hasChartData;}},this);this.on('render',function(){this.$('.nv-chart').on('click',_.bind(this.chart.dispatch.chartClick,this));this.renderChart();},this);},_hasChartData:function(){return this.total!==0;},_chartResize:function(){this.chart.update();},onDetach:function(){if(this.meta.config){return;}
if(this.layout){this.layout.off(null,null,this);}
if(this.layout&&this.layout.context){this.layout.context.off(null,null,this);}
$(window).off('resize.'+this.cid);this.handlePrinting('off');},isChartReady:function(){if(this.meta.config||this.disposed){return false;}
if(!this.$el||(this.$el.parents().length>0&&!this.$el.is(':visible'))){return false;}
if(!_.isFunction(this.chart)||!this.hasChartData()){this.chart_loaded=false;this.displayNoData(true);return false;}
this.displayNoData(false);return true;},resize:function(){if(!this.chart_loaded){return;}
if(!this.$el||(this.$el.parents().length>0&&!this.$el.is(':visible'))){return;}
this.chartResize();},handlePrinting:function(state){var self=this,mediaQueryList=window.matchMedia&&window.matchMedia('print');var pausecomp=function(millis){var date=new Date(),curDate=null;do{curDate=new Date();}while(curDate-date<millis);};var printResize=function(mql){if(mql.matches){if(!_.isUndefined(self.chart.legend)&&_.isFunction(self.chart.legend.showAll)){self.chart.legend.showAll(true);}
self.chart.width(640).height(320);self.resize();pausecomp(200);}else{browserResize();}};var browserResize=function(){if(!_.isUndefined(self.chart.legend)&&_.isFunction(self.chart.legend.showAll)){self.chart.legend.showAll(false);}
self.chart.width(null).height(null);self.resize();};if(state==='on'){if(window.matchMedia){mediaQueryList.addListener(printResize);}else if(window.attachEvent){window.attachEvent('onbeforeprint',printResize);window.attachEvent('onafterprint',browserResize);}else{window.onbeforeprint=printResize;window.onafterprint=browserResize;}}else{if(window.matchMedia){mediaQueryList.removeListener(printResize);}else if(window.detachEvent){window.detachEvent('onbeforeprint',printResize);window.detachEvent('onafterprint',browserResize);}else{window.onbeforeprint=null;window.onafterprint=null;}}},displayNoData:function(state){this.$('[data-content="chart"]').toggleClass('hide',state);this.$('[data-content="nodata"]').toggleClass('hide',!state);}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/Chart.js */


(function(app){app.events.on("app:init",function(){app.plugins.register('EmailClientLaunch',['view','field'],{events:{'click a[data-action="email"]':'launchEmailClient'},launchEmailClient:function(event){var $link=$(event.currentTarget);if(this.useSugarEmailClient()){this.launchSugarEmailClient(this._retrieveEmailOptions($link));}},launchSugarEmailClient:function(options){_.each(['to_addresses','cc_addresses','bcc_addresses'],function(recipientType){if(options[recipientType]){options[recipientType]=this._retrieveValidRecipients(options[recipientType]);}},this);app.drawer.open({layout:'compose',context:{create:'true',module:'Emails',prepopulate:options}},_.bind(function(model){if(model){this.trigger('emailclient:close');}},this));},_retrieveValidRecipients:function(recipients){var validRecipients=[],email;recipients=_.isArray(recipients)?recipients:[recipients];_.each(recipients,function(recipient){if(recipient.bean&&_.isUndefined(recipient.email)){email=this._retrieveEmailAddressFromModel(recipient.bean);if(email){validRecipients.push(_.extend({email:email},recipient));}}else{validRecipients.push(recipient);}},this);return validRecipients;},useSugarEmailClient:function(){var emailClientPreference=app.user.getPreference('email_client_preference');return(emailClientPreference&&emailClientPreference.type==='sugar'&&app.acl.hasAccess('edit','Emails'));},addEmailOptions:function(options){this.emailOptions=this.emailOptions||{};options=options||{};if(options.related){options.related=this._cloneRelatedModel(options.related);}
this.emailOptions=_.extend({},this.emailOptions,options);},_cloneRelatedModel:function(model){var relatedModel;if(model&&model.module){relatedModel=app.data.createBean(model.module);relatedModel.set(app.utils.deepCopy(model.attributes));}
return relatedModel;},_getEmailHref:function(options){if(this.useSugarEmailClient()){return'javascript:void(0)';}else{return this._buildMailToURL(options);}},_buildMailToURL:function(options){var mailToUrl='mailto:',formattedOptions={},queryParams=[];if(options.to_addresses){mailToUrl+=this._formatRecipientsToString(options.to_addresses);}
formattedOptions.cc=this._formatRecipientsToString(options.cc_addresses);formattedOptions.bcc=this._formatRecipientsToString(options.bcc_addresses);formattedOptions.subject=options.subject;formattedOptions.body=options.text_body;_.each(['cc','bcc','subject','body'],function(option){var param;if(!_.isEmpty(formattedOptions[option])){param=option+'='+encodeURIComponent(formattedOptions[option]);queryParams.push(param);}});if(!_.isEmpty(queryParams)){mailToUrl=mailToUrl+'?'+queryParams.join('&');}
return mailToUrl;},_formatRecipientsToString:function(recipients){var emailDelim=',',emails=[],email;if(_.isArray(recipients)){_.each(recipients,function(recipient){if(_.isString(recipient)){emails.push(recipient);}else if(recipient.email){emails.push(recipient.email);}else if(recipient.bean){email=this._retrieveEmailAddressFromModel(recipient.bean);if(email){emails.push(email);}}},this);}else{emails.push(recipients);}
return emails.join(emailDelim);},_retrieveEmailAddressFromModel:function(model){var emails=model.get('email');if(_.isUndefined(emails)){return model.get('email1');}
var email,isValidEmail=function(email){return(!_.isUndefined(email)&&!_.isEmpty(email.email_address)&&email.opt_out!==true&&email.invalid_email!==true);},isValidPrimaryEmail=function(email){return isValidEmail(email)&&email.primary_address;};email=_.find(emails,isValidPrimaryEmail)||_.find(emails,isValidEmail)||{};return email.email_address;},_retrieveEmailOptions:function($link){var optionsFromLink=$link.data()||{},optionsFromController=this.emailOptions||{};if(_.isFunction(this._retrieveEmailOptionsFromLink)){optionsFromLink=this._retrieveEmailOptionsFromLink($link);}
return _.extend({},optionsFromController,optionsFromLink);},onAttach:function(){this.on('render',function(){var self=this,$emailLinks=this.$('a[data-action="email"]');$emailLinks.each(function(){var options=self._retrieveEmailOptions($(this)),href=self._getEmailHref(options);$(this).attr('href',href);});},this);}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/EmailClientLaunch.js */


(function(app){app.events.on('app:init',function(){var BeanOverrides,Link,VirtualCollection;Link=app.BeanCollection.extend({initialize:function(models,options){options||(options={});if(options.module){this.module=options.module;delete options.module;}
this.defaults=[];app.BeanCollection.prototype.initialize.call(this,models,options);},isDefault:function(model){return _.contains(this.defaults,model.id);},transpose:function(){var actions;actions=this.reduce(function(json,model){switch(model.get('_action')){case'delete':json.delete.push(model.id);break;default:json.add.push(model.id);}
return json;},{add:[],delete:[]});if(actions.add.length===0){delete actions.add;}
if(actions.delete.length===0){delete actions.delete;}
return actions;},linkRecord:function(model){model.set('_action',this.isDefault(model)?'update':'create');this.add(model,{merge:true});return this;},unlinkRecord:function(model){if(this.isDefault(model)){model.set('_action','delete');this.add(model,{merge:true});}else{this.undo(model);}
return this;},undo:function(model){this.remove(model);return this;},setDefaults:function(models){var undos=[];this.defaults=_.isArray(models)?models.slice():this.pluck('id');this.each(function(model){if(_.contains(this.defaults,model.id)){undos.push(model);}},this);_.each(undos,this.undo,this);return this;},clearAndUpdateDefaults:function(){var linked,unlinked;linked=_.union(this.where({'_action':'create'}),this.where({'_action':'update'}));unlinked=this.where({'_action':'delete'});this.setDefaults(_.union(this.defaults,_.pluck(linked,'id')));this.setDefaults(_.difference(this.defaults,_.pluck(unlinked,'id')));return this;},addDefault:function(model){this.defaults.push(model.id);this.undo(model);return this;}},false);VirtualCollection=app.MixedBeanCollection.extend({constructor:function(models,options){options||(options={});app.MixedBeanCollection.prototype.constructor.call(this,models,options);this.offsets=options.offsets||{};_.each(this.links,function(link){link.setDefaults();if(_.isUndefined(this.offsets[link.link.name])){this.offsets[link.link.name]=link.defaults.length;}},this);},initialize:function(models,options){options||(options={});this.parent=options.parent;delete options.parent;this.fieldName=options.fieldName;delete options.fieldName;this.context=options.context;delete options.context;this.relatedModules={};this.links=_.reduce(options.links,function(memo,link){var module,options;module=app.data.getRelatedModule(this.parent.module,link);this.relatedModules[module]=link;options={link:{name:link,bean:this.parent},module:module};memo[link]=new Link([],options);return memo;},{},this);delete options.links;this.parent.on('sync',function(){_.each(this.links,function(link){link.clearAndUpdateDefaults();});},this);app.MixedBeanCollection.prototype.initialize.call(this,models,options);},_prepareModel:function(model,options){model=app.MixedBeanCollection.prototype._prepareModel.call(this,model,options);model.link=this.links[this.relatedModules[model.module]].link;return model;},add:function(models,options){var added=[];options||(options={});models=_.isArray(models)?models.slice():[models];if(_.compact(models).length===0){return this;}
_.each(models,function(model){var existingModel,relationship;model=this._prepareModel(model,options);existingModel=this.get(model.id);relationship=this.links[model.link.name];if(existingModel){if(options.merge){relationship.linkRecord(model);}}else{if(relationship.isDefault(model)){relationship.undo(model);}else{relationship.linkRecord(model);}}
if(!existingModel||options.merge){app.MixedBeanCollection.prototype.add.call(this,model,options);added.push(this.get(model.id));}},this);if(!options.silent&&added.length>0){this._triggerChange(added,options);}
return this;},remove:function(models,options){var removed=[];options||(options={});models=_.isArray(models)?models.slice():[models];if(_.compact(models).length===0){return this;}
_.each(models,function(model){var existingModel,relationship;existingModel=this.get(model);if(existingModel){relationship=this.links[existingModel.link.name];relationship.unlinkRecord(existingModel);app.MixedBeanCollection.prototype.remove.call(this,existingModel,options);removed.push(existingModel);}},this);if(!options.silent&&removed.length>0){this._triggerChange(removed,options);}
return this;},reset:function(models,options){var existingModels;options||(options={});models=_.isArray(models)?models.slice():[models];this.revert(_.extend({},options,{silent:true}));existingModels=this.models.slice();app.MixedBeanCollection.prototype.reset.call(this,models,options);_.each(existingModels,function(existingModel){var relationship=this.links[existingModel.link.name];function match(newModel){return(newModel.id===existingModel.id&&newModel.module===existingModel.module);}
relationship.undo(existingModel);if(!this.find(match)){relationship.unlinkRecord(existingModel);}},this);if(!options.silent){this._triggerChange(this.models,options);}
return this;},revert:function(options){var add,remove;options||(options={});add=[];remove=[];_.each(this.links,function(relationship){relationship.each(function(model){if(relationship.isDefault(model)){add.push(model);}else{remove.push(model);}});});this.remove(remove,{silent:true});this.add(add,{merge:true,silent:true});if(!options.silent){this._triggerChange(this.models,options);this.trigger('reset',this,options);}
return this;},hasChanged:function(){var changed=false;_.each(this.links,function(link){if(link.length>0){changed=true;}},this);return changed;},hasMore:function(){return _.some(this.offsets,function(offset){return(offset>-1);});},fetch:function(options){var callbacks,complete,error,params,success,url;options||(options={});params={};params.fields=options.fields?options.fields:['name'];params.order_by=options.order_by||this.parent.fields[this.fieldName].order_by;if(!_.isArray(params.order_by)){params.order_by=[params.order_by];}
_.each(params.order_by,function(sort){var field=sort.split(':')[0];if(!_.contains(params.fields,field)){params.fields.push(field);}});params.module_list=_.keys(this.relatedModules).join(',');params.fields=params.fields.join(',');params.order_by=params.order_by.join(',');params.max_num=options.limit||app.config.maxSubpanelResult;if(options.offset){params.offset=options.offset;}
callbacks={};success=options.success;error=options.error;complete=options.complete;callbacks.success=_.bind(function(data,request){if(success){success(data,request);}
this.parent.trigger('sync:'+this.fieldName,this,data,options,request);},this);if(error){callbacks.error=error;}
if(complete){callbacks.complete=complete;}
url=[app.api.serverUrl,this.parent.module,this.parent.id,'collection',this.fieldName].join('/');_.each(params,function(value,key){if(value===null||value===undefined){delete params[key];}});params=$.param(params);if(params.length>0){url+='?'+params;}
return app.api.call('read',url,null,callbacks);},paginate:function(options){var success;options||(options={});options.offset=this.offsets;success=options.success;options.success=_.bind(function(data,request){var offsets,records;data||(data={});records=data.records||[];offsets=data.next_offset||{};_.each(offsets,function(offset,link){this.offsets[link]=offset;},this);this.add(records,{merge:true});_.each(records,function(record){var model;model=this._prepareModel(record);this.links[model.link.name].addDefault(model);},this);if(success){success(data,request);}},this);this.fetch(options);},search:function(options){var callbacks,params,url;params={};options||(options={});params.q=options.query;params.max_num=options.limit;params.search_fields=options.search_fields?options.search_fields.join(','):'name';params.fields=options.fields?options.fields.join(','):'name';if(this.links){params.module_list=_.map(this.links,function(link){return link.module;}).join(',');}
callbacks={};callbacks.success=function(data,request){if(options.success){options.success(app.data.createMixedBeanCollection(data.records),request);}};if(options.error){callbacks.error=options.error;}
if(options.complete){callbacks.complete=options.complete;}
url=app.api.buildURL('Calendar','invitee_search',null,params);return app.api.call('read',url,null,callbacks);},_triggerChange:function(change,options){this.parent.trigger('change:'+this.fieldName,this.parent,this,change,options);this.parent.trigger('change',this,options);}});BeanOverrides=function(model){this.model=model;};BeanOverrides.prototype.toJSON=function(collections,links,options){var json={},fields=_.unique(_.union(collections,_.keys(links)));_.each(fields,function(attribute){var field=this.get(attribute);if(!field){return;}
if(_.contains(collections,attribute)){json[attribute]=field.toJSON(options);}
_.each(links[attribute],function(link){var actions=field.links[link].transpose();if(actions.add||actions.delete){json[link]=actions;}});},this.model);return json;};BeanOverrides.prototype.copy=function(source,fields,options){var attrs,clone,vardefs;attrs={};vardefs=app.metadata.getModule(this.model.module).fields;clone=function(model){var attributes=_.clone(model.attributes);delete attributes._action;return attributes;};_.each(fields,function(name){attrs[name]=[];});if(_.size(attrs)>0){this.model.set(attrs,options);}
_.each(fields,function(name){var def=vardefs[name],collection;if(def&&def.duplicate_on_record_copy!=='no'&&(def.duplicate_on_record_copy==='always'||!def.auto_increment)&&source.has(name)){collection=this.get(name);collection.add(source.get(name).map(clone));}},this.model);};BeanOverrides.prototype.set=function(attr,options){_.each(attr,function(models,key){var collection;options=_.extend({},options,{parent:this,fieldName:key,links:this.fields[key].links});if(!_.isArray(models)){if(models instanceof Backbone.Collection){models=models.models;}else if(models){if(models.next_offset){options.offsets=models.next_offset;}
if(models.records){models=models.records;}else{models=[models];}}else{models=[];}}
collection=new VirtualCollection(models,options);this.attributes[key]=collection;this.setDefault(key,collection);},this.model);return this.model;};BeanOverrides.prototype.hasChanged=function(attr){if(attr==null){attr=this.model.getCollectionFieldNames();}else if(_.contains(this.model.getCollectionFieldNames(),attr)){attr=[attr];}else{attr=[];}
return _.some(attr,function(attribute){var collection=this.get(attribute);return(collection&&collection.hasChanged());},this.model);};BeanOverrides.prototype.changedAttributes=function(diff){var changed={};_.each(this.model.getCollectionFieldNames(),function(attr){var collection=this.get(attr);if(collection&&collection.hasChanged()){changed[attr]=collection;}},this.model);return changed;};BeanOverrides.prototype.revertAttributes=function(options){_.each(this.model.getCollectionFieldNames(),function(attr){var collection=this.get(attr);if(collection){collection.revert(options);}},this.model);};BeanOverrides.prototype.getSyncedAttributes=function(){var syncedAttributes={};_.reduce(this.model.getCollectionFieldNames(),function(memo,attr){var collection=this.get(attr);if(collection){memo[attr]=collection;}},syncedAttributes,this.model);return syncedAttributes;};app.plugins.register('VirtualCollection',['model'],{onAttach:function(model,plugin){var overrides=new BeanOverrides(this);this.toJSON=_.wrap(this.toJSON,function(_super,options){var attrs,fields,collectionFieldNames,collections,links,nonAttrFields,collectionsToJSON,attrToJSON;fields=(options&&options.fields)?options.fields:_.keys(this.attributes);collectionFieldNames=this.getCollectionFieldNames();collections=_.intersection(collectionFieldNames,fields);links={};nonAttrFields=_.clone(collections);_.each(collectionFieldNames,function(fieldName){var field=this.get(fieldName);if(_.isObject(field)&&field.links){_.each(field.links,function(link){if(_.contains(fields,link.link.name)){(links[fieldName]||(links[fieldName]=[])).push(link.link.name);nonAttrFields.push(link.link.name);}});}},this);attrs=_.difference(fields,_.unique(nonAttrFields));collectionsToJSON=overrides.toJSON(collections,links,options);attrToJSON=_super.call(this,_.extend({},options,{fields:attrs}));return _.extend(attrToJSON,collectionsToJSON);});this.copy=_.wrap(this.copy,function(_super,source,fields,options){var attrs,collections,collectionFieldNames,vardefs;vardefs=app.metadata.getModule(this.module).fields;fields=fields||_.pluck(vardefs,'name');collectionFieldNames=this.getCollectionFieldNames();collections=_.intersection(collectionFieldNames,fields);attrs=_.difference(fields,collectionFieldNames);overrides.copy(source,collections,options);_super.call(this,source,attrs,options);});this.set=_.wrap(this.set,function(_super,key,val,options){var attrs,collections;if(key==null){return this;}
if(typeof key==='object'){attrs=key;options=val;}else{(attrs={})[key]=val;}
options||(options={});collections=_.pick(attrs,this.getCollectionFieldNames());attrs=_.omit(attrs,_.keys(collections));overrides.set(collections,options);return _super.call(this,attrs,options);});this.hasChanged=_.wrap(this.hasChanged,function(_super,attr){return _super.call(this,attr)||overrides.hasChanged(attr);});this.changedAttributes=_.wrap(this.changedAttributes,function(_super,diff){var changed=_.extend(_super.call(this,diff)||{},overrides.changedAttributes(diff));return _.isEmpty(changed)?false:changed;});this.revertAttributes=_.wrap(this.revertAttributes,function(_super,options){overrides.revertAttributes(options);_super.call(this,options);});this.getSyncedAttributes=_.wrap(this.getSyncedAttributes,function(_super){return _.extend(app.utils.deepCopy(_super.call(this)||{}),overrides.getSyncedAttributes());});},getCollectionFieldNames:function(){return _.chain(this.fields).where({type:'collection'}).pluck('name').value();}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/VirtualCollection.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('SearchForMore',['field'],{addSearchForMoreButton:function($el){var $button=$('<div/>').addClass('select2-result-label').attr('name','search_for_more').html(app.lang.get('LBL_SEARCH_FOR_MORE',this.module));$el.on('select2-open',_.bind(function(){var $dropdown,$result;$dropdown=$el.select2('dropdown');if($dropdown.find('[name=search_for_more]').length===0){$result=$('<li class="select2-result">').append($button).mousedown(_.bind(function(){$el.select2('close');this.searchForMore($el);},this));$dropdown.append($('<ul class="select2-results">').append($result));}},this));},searchForMore:function($el){var layout,module,modules;if(!_.isUndefined(this.def.links)){layout='selection-list-module-switch';modules=_.chain(this.def.links).map(function(link){return app.data.getRelatedModule(this.module,link);},this).value();module=_.first(modules);}else{layout='selection-list';module=this.module;modules=[module];}
app.drawer.open({layout:layout,context:{module:module,filterList:modules}},function(model){if(model){$el.data('select2').triggerChange({added:{attributes:model}});}});}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/SearchForMore.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('EditAllRecurrences',['view'],{onAttach:function(){this.on('init',function(){this.context.on('all_recurrences:edit',this.editAllRecurrences,this);if(this.context.get('all_recurrences')===true){this.toggleAllRecurrencesMode(true);this.context.unset('all_recurrences');}else{this.toggleAllRecurrencesMode(false);}
this.model.on('sync',function(model,data,options){if(options&&options.refetch_list_collection){this._refetchListCollection();}
if(!this._isRecurringEvent(this.model)){this.toggleAllRecurrencesMode(true);if(this.context.get('action')==='edit'){this.toggleEdit(true);}}},this);});this.cancelClicked=_.wrap(this.cancelClicked,function(_super,event){_super.call(this,event);this.toggleAllRecurrencesMode(false);});this.setEditableFields=_.wrap(this.setEditableFields,function(_super){this.toggleEditRecurrenceFields(this.allRecurrencesMode);_super.call(this);});this.setRoute=_.wrap(this.setRoute,function(_super,action){if(this.allRecurrencesMode&&this._isRecurringEvent(this.model)&&action==='edit'){action='edit/all_recurrences';}
_super.call(this,action);});this.handleSave=_.wrap(this.handleSave,function(_super){_super.call(this);this._doAfterSave();});this.getCustomSaveOptions=_.wrap(this.getCustomSaveOptions,_.bind(function(_super,options){return _.extend(_super.call(this,options),this.addRecurrenceOptionsForSave(options));},this));},editAllRecurrences:function(){var parentId=this.model.get('repeat_parent_id');if(!_.isEmpty(parentId)&&parentId!==this.model.id){this.editAllRecurrencesFromParent(parentId);}else{this.toggleAllRecurrencesMode(true);this.context.trigger('button:edit_button:click');}},toggleAllRecurrencesMode:function(enabled){if(!this._isRecurringEvent(this.model)){enabled=true;}
this.allRecurrencesMode=enabled;this.setEditableFields();},toggleEditRecurrenceFields:function(editable){var getEditLink=function(fieldName){return this.$('span.record-edit-link-wrapper[data-name="'+fieldName+'"]');};_.each(['repeat_type','recurrence','repeat_interval','repeat_dow','repeat_until','repeat_count'],function(field){if(editable){this.noEditFields=_.without(this.noEditFields,field);getEditLink(field).show();}else{this.noEditFields.push(field);getEditLink(field).hide();}},this);},editAllRecurrencesFromParent:function(parentId){var route=app.router.buildRoute(this.module,parentId,'edit/all-recurrences');app.router.navigate('#'+route,{trigger:true});},addRecurrenceOptionsForSave:function(options){options=options||{};if(this.allRecurrencesMode){options.params=options.params||{};options.params.all_recurrences=true;options.refetch_list_collection=true;}
return options;},_isRecurringEvent:function(model){return(model.get('repeat_type')!=='');},_doAfterSave:function(){if(this.allRecurrencesMode){this._disableNextPrevButtons();}
this.toggleAllRecurrencesMode(false);},_disableNextPrevButtons:function(){var $nextPrevButtons=this.$('.btn-group-previous-next');$nextPrevButtons.find('.next-row').addClass('disabled');$nextPrevButtons.find('.previous-row').addClass('disabled');},_enableNextPrevButtons:function(listCollection){var $nextPrevButtons=this.$('.btn-group-previous-next');if(listCollection.hasNextModel(this.model)){$nextPrevButtons.find('.next-row').removeClass('disabled');}
if(listCollection.hasPreviousModel(this.model)){$nextPrevButtons.find('.previous-row').removeClass('disabled');}},_refetchListCollection:function(){var self=this,listCollection=this.context.get('listCollection');if(listCollection&&listCollection.models&&listCollection.models.length>1){listCollection.fetch({success:function(){self._enableNextPrevButtons(listCollection);}});}}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/EditAllRecurrences.js */


(function(app){app.events.on('app:init',function(){app.plugins.register('AddAsInvitee',['view'],{onAttach:function(){this.once('render',function(){this.turnOffAutoInviteParent();if(this.isFieldPrepopulatedOnCreate('parent_name')){this.handleParentChange(this.model);}
if(this.isFieldPrepopulatedOnCreate('assigned_user_name')){this.handleAssignedUserChange(this.model);}
if(this.isFieldPrepopulatedOnCreate('contact_id')){this.addContactFromContactIdField(this.model);}
if(this.model.isNew()){this.addChangeListener('parent_name',this.handleParentChange);this.addChangeListener('assigned_user_name',this.handleAssignedUserChange);}else{this.model.once('sync',function(){this.addChangeListener('parent_name',this.handleParentChange);this.addChangeListener('assigned_user_name',this.handleAssignedUserChange);},this);}},this);},isFieldPrepopulatedOnCreate:function(fieldName){return this.model.isNew()&&!_.isUndefined(this.model.get(fieldName));},addChangeListener:function(fieldName,callback){this.model.on('change:'+fieldName,callback,this);},handleParentChange:function(model){var parent=app.data.createBean(model.get('parent_type'),{id:model.get('parent_id'),name:model.get('parent_name')});if(this.isPossibleInvitee(parent)){if(this._isCreateAndLinkAction(parent,model)){parent.deletable=false;}
this.addAsInvitee(parent);}},handleAssignedUserChange:function(model){var user;user=app.data.createBean('Users',{id:model.get('assigned_user_id'),name:model.get('assigned_user_name')});if(this.isPossibleInvitee(user)){this.addAsInvitee(user);}},addContactFromContactIdField:function(model){var contact=app.data.createBean('Contacts',{id:model.get('contact_id'),name:model.get('contact_name')});if(this.isPossibleInvitee(contact)){if(this._isCreateAndLinkAction(contact,model)){contact.deletable=false;}
this.addAsInvitee(contact);}},_isCreateAndLinkAction:function(invitee,model){return(!_.isUndefined(model.link)&&!_.isUndefined(model.link.bean)&&model.link.bean.module===invitee.module&&model.link.bean.id===invitee.id);},isPossibleInvitee:function(person){var inviteeModuleList=['Leads','Contacts','Users'],invitees=this.model.get('invitees');return(!_.isEmpty(person.id)&&_.contains(inviteeModuleList,person.module)&&!_.isUndefined(invitees));},turnOffAutoInviteParent:function(){this.model.setDefault('auto_invite_parent',false);},addAsInvitee:function(person){this.model.get('invitees').add(person,{merge:true});}});});})(SUGAR.App);
/* End of File include/javascript/sugar7/plugins/AddAsInvitee.js */

!function(t){function e(t,n){this.list=t,this.options=n=n||{};var i,o,s,r;for(i=0,r=["sort","includeScore","shouldSort"],o=r.length;o>i;i++)s=r[i],this.options[s]=s in n?n[s]:e.defaultOptions[s];for(i=0,r=["searchFn","sortFn","keys","getFn"],o=r.length;o>i;i++)s=r[i],this.options[s]=n[s]||e.defaultOptions[s]}var n=function(t,e){if(e=e||{},this.options=e,this.options.location=e.location||n.defaultOptions.location,this.options.distance="distance"in e?e.distance:n.defaultOptions.distance,this.options.threshold="threshold"in e?e.threshold:n.defaultOptions.threshold,this.options.maxPatternLength=e.maxPatternLength||n.defaultOptions.maxPatternLength,this.pattern=e.caseSensitive?t:t.toLowerCase(),this.patternLen=t.length,this.patternLen>this.options.maxPatternLength)throw new Error("Pattern length is too long");this.matchmask=1<<this.patternLen-1,this.patternAlphabet=this._calculatePatternAlphabet()};n.defaultOptions={location:0,distance:100,threshold:.6,maxPatternLength:32},n.prototype._calculatePatternAlphabet=function(){var t={},e=0;for(e=0;e<this.patternLen;e++)t[this.pattern.charAt(e)]=0;for(e=0;e<this.patternLen;e++)t[this.pattern.charAt(e)]|=1<<this.pattern.length-e-1;return t},n.prototype._bitapScore=function(t,e){var n=t/this.patternLen,i=Math.abs(this.options.location-e);return this.options.distance?n+i/this.options.distance:i?1:n},n.prototype.search=function(t){if(t=this.options.caseSensitive?t:t.toLowerCase(),this.pattern===t)return{isMatch:!0,score:0};var e,n,i,o,s,r,a,h,p,c=t.length,l=this.options.location,f=this.options.threshold,u=t.indexOf(this.pattern,l),d=this.patternLen+c,g=1,m=[];for(-1!=u&&(f=Math.min(this._bitapScore(0,u),f),u=t.lastIndexOf(this.pattern,l+this.patternLen),-1!=u&&(f=Math.min(this._bitapScore(0,u),f))),u=-1,e=0;e<this.patternLen;e++){for(i=0,o=d;o>i;)this._bitapScore(e,l+o)<=f?i=o:d=o,o=Math.floor((d-i)/2+i);for(d=o,s=Math.max(1,l-o+1),r=Math.min(l+o,c)+this.patternLen,a=Array(r+2),a[r+1]=(1<<e)-1,n=r;n>=s;n--)if(p=this.patternAlphabet[t.charAt(n-1)],a[n]=0===e?(a[n+1]<<1|1)&p:(a[n+1]<<1|1)&p|((h[n+1]|h[n])<<1|1)|h[n+1],a[n]&this.matchmask&&(g=this._bitapScore(e,n-1),f>=g)){if(f=g,u=n-1,m.push(u),!(u>l))break;s=Math.max(1,2*l-u)}if(this._bitapScore(e+1,l)>f)break;h=a}return{isMatch:u>=0,score:g}};var i=function(t,e,n){var s,r,a;if(e){a=e.indexOf("."),-1!==a?(s=e.slice(0,a),r=e.slice(a+1)):s=e;var h=t[s];if(h)if(r||"string"!=typeof h&&"number"!=typeof h)if(o.isArray(h))for(var p=0,c=h.length;c>p;p++)i(h[p],r,n);else r&&i(h,r,n);else n.push(h)}else n.push(t);return n},o={deepValue:function(t,e){return i(t,e,[])},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)}};e.defaultOptions={id:null,caseSensitive:!1,includeScore:!1,shouldSort:!0,searchFn:n,sortFn:function(t,e){return t.score-e.score},getFn:o.deepValue,keys:[]},e.prototype.search=function(t){var e,n,i,s,r=new this.options.searchFn(t,this.options),a=this.list,h=a.length,p=this.options,c=this.options.keys,l=c.length,f=[],u={},d=[],g=function(t,e,n){if(void 0!==t&&null!==t)if("string"==typeof t)i=r.search(t),i.isMatch&&(s=u[n],s?s.score=Math.min(s.score,i.score):(u[n]={item:e,score:i.score},f.push(u[n])));else if(o.isArray(t))for(var a=0;a<t.length;a++)g(t[a],e,n)};if("string"==typeof a[0])for(var m=0;h>m;m++)g(a[m],m,m);else for(var m=0;h>m;m++)for(n=a[m],e=0;l>e;e++)g(p.getFn(n,c[e]),n,m);p.shouldSort&&f.sort(p.sortFn);for(var y=p.includeScore?function(t){return f[t]}:function(t){return f[t].item},v=p.id?function(t){f[t].item=p.getFn(f[t].item,p.id)[0]}:function(){},m=0,b=f.length;b>m;m++)v(m),d.push(y(m));return d},"object"==typeof exports?module.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):t.Fuse=e}(this);
/* End of File include/javascript/fuse/fuse.js */

